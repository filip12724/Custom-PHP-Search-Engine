a:2:{i:0;s:30:"http://r.manage.microsoft.com/";i:1;s:1050351:"<!DOCTYPE html><html><head><meta charset='utf-8'/><title>Microsoft Intune admin center</title></head><body><script>"use strict";var FxImpl,__extends,__assign,__rest,__decorate,__param,__esDecorate,__runInitializers,__propKey,__setFunctionName,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet,__classPrivateFieldIn,__createBinding,__addDisposableResource,__disposeResources,__rewriteRelativeImportExtension,MsPortalImpl;!function(e){let t,r;try{t=window.localStorage,r=window.sessionStorage}catch(e){}e.localStorage=t,e.sessionStorage=r}(MsPortalImpl||(MsPortalImpl={})),function(e){e.getOrSetBootParameters=function(e,t){if(1===arguments.length)return e.sessionStorage.getItem("Redirect_BootParameters")||e.localStorage.getItem("Redirect_BootParameters");e.sessionStorage.setItem("Redirect_BootParameters",t),e.localStorage.setItem("Redirect_BootParameters",t)}}(MsPortalImpl||(MsPortalImpl={})),function(e){e.getTenantFromPath=function(e,t){const r=e.split("/").filter((e=>e));let n="";if(1===r.length?n=r[0]:e.startsWith("/auth/login")&&3===r.length&&(n=r[2]),n){const e=n.replace(/^@*/,""),r=/^[a-f0-9]{8}-(?:[a-f0-9]{4}-){3}[a-f0-9]{12}$/i;if(/^@?(?:(?:[a-z0-9]|[a-z0-9][a-z0-9-]{0,61}[a-z0-9])\.)+[a-z0-9]+|common$/i.test(e)||r.test(e))return t?"@"+e:e}return""}}(MsPortalImpl||(MsPortalImpl={})),function(e){var t=new Uint8Array(20),r=new Array(20);function n(e,r,n){var o=t[e]&r;t[e]=o|n}var o=window.crypto||window.msCrypto,i="0123456789abcdef".split(""),a=new Array(256),s=0;function c(){var e=function(e){for(var t,r=new Array(e);e;){t=4294967296*Math.random()|0;for(var n=8;n--;){if(r[--e]=i[15&t],e<0)return r;t>>>=4}}}(36);return e[8]=e[13]=e[18]=e[23]="-",e[14]="4",e[19]=i[8+(3&i.indexOf(e[19]))],e.join("")}i.forEach((function(e){i.forEach((function(t){a[s++]=e+t}))})),e.createGuid=function(e,i){void 0===i&&(i=!1);var s=o?function(){o.getRandomValues(t),n(8,15,64),n(11,63,128);for(var e=0;e<20;e++)r[e]=a[t[e]];return r[4]=r[7]=r[10]=r[13]="-",r.join("")}():c();return s=i?s.split("-").join("").substring(0,32):s.substring(0,36),(e?"".concat(e,"_"):"")+s}}(FxImpl||(FxImpl={})),function(e){e.supportedLanguagesNeutralLocales={de:"de-de",en:"en-us",es:"es-es",fr:"fr-fr",it:"it-it",id:"id-id",hu:"hu-hu",nl:"nl-nl",pl:"pl-pl","pt-br":"pt-br","pt-pt":"pt-pt",sv:"sv-se",tr:"tr-tr",cs:"cs-cz",ru:"ru-ru","zh-hans":"zh-cn","zh-hant":"zh-hk",ja:"ja-jp",ko:"ko-kr"};const t={"zh-hk":"zh-hant","zh-tw":"zh-hant","zh-cht":"zh-hant","zh-mo":"zh-hant",zh:"zh-hans",pt:"pt-br"};function r(e){const t=[];for(let r=(e=e||"").length;r>0;r=e.lastIndexOf("-",r-1))t.push(e.substring(0,r));return t}e.sanitizeLanguage=function(t,r){const n=(t||"").toLowerCase().split(".");if(r.includes(n[0])||(n[0]=r[0]),n.length<2){const t=e.supportedLanguagesNeutralLocales[n[0]];t&&(n[1]=t)}return n.join(".")},e.getBrowserLanguage=function(n){const o=(n||navigator.languages||[]).map((e=>e?.toLowerCase?.()));for(const n of o){const o=r(n);for(const r of o){const o=t[r]||r;if(o in e.supportedLanguagesNeutralLocales){const t=o;return`${t}.${n.split("-").length>1?n:e.supportedLanguagesNeutralLocales[t]}`}}}}}(MsPortalImpl||(MsPortalImpl={})),function(e){let t=window;function r(e){return e&&e.replace(/^\?/,"")}function n(e){return e&&r(e).split("&").map((e=>e.split("=")))||[]}function o(e,t){const r=e.map((e=>e[0]&&e.join("=")));return t&&r.sort(),r.join("&")}function i(e,t,r){if(t=t.toUpperCase(),e)for(let n=0;n<e.length;n++)if(e[n][0].toUpperCase()===t)return r?e.splice(n,1)[0][1]:e[n][1]}function a(){return JSON.parse(e.getOrSetBootParameters(e)||"{}")}function s(e){return i(n(a().userQuery),e)}function c(e){if(!e||e.startsWith("/"))return c(`${t.location.protocol}//${t.location.host}`);const r=/^(\w+:\/\/)([^:/?]+)([^/?]+)?/.exec(e),n=r[3]||("https://"===r[1]?":443":":80");return r[2]+n}function u(t,a,u,l){u=u||"",l=l||{};let d="";if(t&&c()===c(t))d=function(t,r,a){const c=n(t),u=e=>{Object.keys(e).forEach((t=>{t&&e[t]&&"string"!=typeof i(c,t)&&c.push([t,e[t]])}))};if(u(JSON.parse(e.localStorage.getItem("Redirect_LocaleQuery")||"{}")),u({l:e.localStorage.getItem("Redirect_LastUsedLocale")}),r.env){const t={},n=(n,o,i)=>{o=o||["true","false"];const a=n+(i||"");let c=s(n)||r[n];c||(c=e.localStorage.getItem(a)+"",o.includes(c)||(c=o[Math.floor(Math.random()*o.length)],e.localStorage.setItem(a,c))),t[n]=c},o=new Array(100);o.fill("DefaultPartitioner",0,100),n("bundlingKind",o,"12"),u(t)}u(r),["signIn","clearedStorage"].forEach((e=>{i(c,e,!0)}));const l=i(c,"l",!0)||e.getBrowserLanguage();return u({l:e.sanitizeLanguage(l,a)}),o(c,!0)}(u,l,a);else{const e=l.loginHint;e&&(u+=u?"&":"",u+=`loginHint=${e}`),d=r(u)}return d&&(t+=t.includes("?")?"&":"?",t+=d),t}e.parseQuery=n,e.ensureTrailingSlash=function(e){return e&&!e.endsWith("/")&&(e+="/"),e},e.extractValueFromQueryString=function(e,t){return i(e,t,!1)},e.getFirstQueryValue=i,e.getBootParameters=a,e.trySaveAllowedState=function(r,n,s,c){if(!e.getOrSetBootParameters(e)||s){["selectAccount","loginHint","signInParameters","forcesignin","nonceErrorSeen","signIn","slice","mfalogin"].forEach((e=>{i(n,e,!0)}));const s=/#.*|$/.exec(t.location.href)[0];let u;s.startsWith("#code=")?(u=a(),u.msalHash=s):u={environment:r,userQuery:o(n),portalQuery:c,hash:s,msalHash:void 0},e.getOrSetBootParameters(e,JSON.stringify(u))}},e.savePageTelemetry=function(r){const n=t.performance&&t.performance.timing;if(n){const t={id:r,fetchStart:n.fetchStart,requestStart:n.requestStart,responseStart:n.responseStart,responseEnd:n.responseEnd,domComplete:n.domComplete};e.sessionStorage.setItem(`PageTelemetry_${r}`,JSON.stringify(t))}},e.getUserQueryValue=s,e.getPortalUri=function(e,t,r){r=r||{};const n=a(),o=n.hash||"";return u(e,t,r.userQuery||n.userQuery,r.portalQuery||n.portalQuery)+o},e.getPortalEnv=function(){return location.hostname.split(".")[0].toLowerCase()}}(MsPortalImpl||(MsPortalImpl={})),function(e){var t="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};function r(e,r){return e!==t&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(t,n){return e[t]=r?r(t,n):n}}"function"==typeof define&&define.amd?(
define("tslib",["exports"],(function(n){e(r(t,r(n)))})),require(["tslib"])):"object"==typeof module&&"object"==typeof module.exports?e(r(t,r(module.exports))):e(r(t))}((function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};__extends=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){Object.defineProperty(this,"constructor",{configurable:!0,value:e,writable:!0})}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)},__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},__decorate=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__param=function(e,t){return function(r,n){t(r,n,e)}},__esDecorate=function(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,p=r.length-1;p>=0;p--){var g={};for(var f in n)g[f]="access"===f?{}:n[f];for(var f in n.access)g.access[f]=n.access[f];g.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:d.get,set:d.set}:d[u],g);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=a(m.get))&&(d.get=s),(s=a(m.set))&&(d.set=s),(s=a(m.init))&&o.unshift(s)}else(s=a(m))&&("field"===c?o.unshift(s):d[u]=s)}l&&Object.defineProperty(l,n.name,d),h=!0},__runInitializers=function(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0},__propKey=function(e){return"symbol"==typeof e?e:"".concat(e)},__setFunctionName=function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},__generator=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},__exportStar=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||__createBinding(t,e,r)},__createBinding=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},__spreadArray=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))},t&&(n[e]=t(n[e])))}function s(e,t){try{(r=o[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}},__asyncDelegator=function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:__await(e[n](t)),done:!1}:o?o(t):t}:o}},__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}},__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var r=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return r(t,e),t},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},__classPrivateFieldSet=function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},__classPrivateFieldIn=function(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)},__addDisposableResource=function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(o=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t};var n="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};__disposeResources=function(e){function t(t){e.error=e.hasError?new n(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,o=0;return function n(){for(;r=e.stack.pop();)try{if(!r.async&&1===o)return o=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return o|=2,Promise.resolve(i).then(n,(function(e){return t(e),n()}))}else o|=1}catch(e){t(e)}if(1===o)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()},__rewriteRelativeImportExtension=function(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,r,n,o,i){return r?t?".jsx":".js":!n||o&&i?n+o+"."+i.toLowerCase()+"js":e})):e},e("__extends",__extends),e("__assign",__assign),e("__rest",__rest),e("__decorate",__decorate),e("__param",__param),e("__esDecorate",__esDecorate),e("__runInitializers",__runInitializers),e("__propKey",__propKey),e("__setFunctionName",__setFunctionName),e("__metadata",__metadata),e("__awaiter",__awaiter),e("__generator",__generator),e("__exportStar",__exportStar),e("__createBinding",__createBinding),e("__values",__values),e("__read",__read),e("__spread",__spread),e("__spreadArrays",__spreadArrays),e("__spreadArray",__spreadArray),e("__await",__await),e("__asyncGenerator",__asyncGenerator),e("__asyncDelegator",__asyncDelegator),e("__asyncValues",__asyncValues),e("__makeTemplateObject",__makeTemplateObject),e("__importStar",__importStar),e("__importDefault",__importDefault),e("__classPrivateFieldGet",__classPrivateFieldGet),e("__classPrivateFieldSet",__classPrivateFieldSet),e("__classPrivateFieldIn",__classPrivateFieldIn),e("__addDisposableResource",__addDisposableResource),e("__disposeResources",__disposeResources),e("__rewriteRelativeImportExtension",__rewriteRelativeImportExtension)})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).msalv2={})}(this,(function(e){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},t(e,r)};function r(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function o(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function i(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}
/*! @azure/msal-browser v2.37.0 2023-05-02 */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var c=function(e,t){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},c(e,t)};function u(e,t){function r(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)};function d(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function h(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function p(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}
/*! @azure/msal-common v13.0.0 2023-05-02 */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var m=function(e,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},m(e,t)};function v(e,t){function r(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var y=function(){return y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},y.apply(this,arguments)};function C(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function T(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function I(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}
/*! @azure/msal-common v13.0.0 2023-05-02 */var w,E,k,S,b,A={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},_=[A.OPENID_SCOPE,A.PROFILE_SCOPE,A.OFFLINE_ACCESS_SCOPE],R=I(_,[A.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(w||(w={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(E||(E={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(k||(k={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(S||(S={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(b||(b={}));var P,N={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(P||(P={}));var M,O,q,U,x,L,B={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(M||(M={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(O||(O={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(q||(q={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(U||(U={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(x||(x={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(L||(L={}));var H,D="appmetadata",F="1",K="authority-metadata",z=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(H||(H={}));var G,j={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};e.AuthenticationScheme=void 0,(G=e.AuthenticationScheme||(e.AuthenticationScheme={})).BEARER="Bearer",G.POP="pop",G.SSH="ssh-cert";var Q,W,V,Y,$,J,X=60,Z=3600,ee="throttling",te="retry-after, h429",re="invalid_grant",ne="client_mismatch";!function(e){e.username="username",e.password="password"}(Q||(Q={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(W||(W={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(V||(V={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(Y||(Y={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}($||($={})),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(J||(J={}));
/*! @azure/msal-common v13.0.0 2023-05-02 */
var oe,ie={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},ae=function(e){function t(r,n,o){var i=this,a=n?r+": "+n:r;return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||A.EMPTY_STRING,i.errorMessage=n||A.EMPTY_STRING,i.subError=o||A.EMPTY_STRING,i.name="AuthError",i}return v(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(ie.unexpectedError.code,ie.unexpectedError.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(ie.postRequestFailed.code,ie.postRequestFailed.desc+": "+e)},t}(Error),se={createNewGuid:function(){throw ae.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ae.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ae.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},ce={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},ue=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return v(t,e),t.createClientInfoDecodingError=function(e){return new t(ce.clientInfoDecodingError.code,ce.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(ce.clientInfoEmptyError.code,""+ce.clientInfoEmptyError.desc)},t.createTokenParsingError=function(e){return new t(ce.tokenParsingError.code,ce.tokenParsingError.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(ce.nullOrEmptyToken.code,ce.nullOrEmptyToken.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(ce.endpointResolutionError.code,ce.endpointResolutionError.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(ce.networkError.code,ce.networkError.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(ce.unableToGetOpenidConfigError.code,ce.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(ce.hashNotDeserialized.code,ce.hashNotDeserialized.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(ce.invalidStateError.code,ce.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(ce.stateMismatchError.code,ce.stateMismatchError.desc)},t.createStateNotFoundError=function(e){return new t(ce.stateNotFoundError.code,ce.stateNotFoundError.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(ce.nonceMismatchError.code,ce.nonceMismatchError.desc)},t.createAuthTimeNotFoundError=function(){return new t(ce.authTimeNotFoundError.code,ce.authTimeNotFoundError.desc)},t.createMaxAgeTranspiredError=function(){return new t(ce.maxAgeTranspiredError.code,ce.maxAgeTranspiredError.desc)},t.createNonceNotFoundError=function(e){return new t(ce.nonceNotFoundError.code,ce.nonceNotFoundError.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(ce.multipleMatchingTokens.code,ce.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(ce.multipleMatchingAccounts.code,ce.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(ce.multipleMatchingAppMetadata.code,ce.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(ce.tokenRequestCannotBeMade.code,ce.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(ce.appendEmptyScopeError.code,ce.appendEmptyScopeError.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(ce.removeEmptyScopeError.code,ce.removeEmptyScopeError.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(ce.appendScopeSetError.code,ce.appendScopeSetError.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(ce.emptyInputScopeSetError.code,""+ce.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(ce.DeviceCodePollingCancelled.code,""+ce.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(ce.DeviceCodeExpired.code,""+ce.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(ce.DeviceCodeUnknownError.code,""+ce.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(ce.NoAccountInSilentRequest.code,""+ce.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(ce.invalidCacheRecord.code,ce.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(ce.invalidCacheEnvironment.code,ce.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(ce.noAccountFound.code,ce.noAccountFound.desc)},t.createCachePluginError=function(){return new t(ce.CachePluginError.code,""+ce.CachePluginError.desc)},t.createNoCryptoObjectError=function(e){return new t(ce.noCryptoObj.code,""+ce.noCryptoObj.desc+e)},t.createInvalidCacheTypeError=function(){return new t(ce.invalidCacheType.code,""+ce.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(ce.unexpectedAccountType.code,""+ce.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(ce.unexpectedCredentialType.code,""+ce.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(ce.invalidAssertion.code,""+ce.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(ce.invalidClientCredential.code,""+ce.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(ce.tokenRefreshRequired.code,ce.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(ce.userTimeoutReached.code,ce.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(ce.tokenClaimsRequired.code,ce.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(ce.noAuthorizationCodeFromServer.code,ce.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(ce.bindingKeyNotRemovedError.code,ce.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(ce.logoutNotSupported.code,ce.logoutNotSupported.desc)},t.createKeyIdMissingError=function(){return new t(ce.keyIdMissing.code,ce.keyIdMissing.desc)},t.createNoNetworkConnectivityError=function(){return new t(ce.noNetworkConnectivity.code,ce.noNetworkConnectivity.desc)},t.createUserCanceledError=function(){return new t(ce.userCanceledError.code,ce.userCanceledError.desc)},t}(ae),le=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw ue.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw ue.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}();
/*! @azure/msal-common v13.0.0 2023-05-02 */
e.LogLevel=void 0,(oe=e.LogLevel||(e.LogLevel={}))[oe.Error=0]="Error",oe[oe.Warning=1]="Warning",oe[oe.Info=2]="Info",oe[oe.Verbose=3]="Verbose",oe[oe.Trace=4]="Trace";var de,he=function(){function t(r,n,o){this.level=e.LogLevel.Info;var i=r||t.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||function(){},this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level="number"==typeof i.logLevel?i.logLevel:e.LogLevel.Info,this.correlationId=i.correlationId||A.EMPTY_STRING,this.packageName=n||A.EMPTY_STRING,this.packageVersion=o||A.EMPTY_STRING}return t.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:e.LogLevel.Info}},t.prototype.clone=function(e,r,n){return new t({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,r)},t.prototype.logMessage=function(t,r){if(!(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)){var n=(new Date).toUTCString(),o=(le.isEmpty(r.correlationId)?le.isEmpty(this.correlationId)?"["+n+"]":"["+n+"] : ["+this.correlationId+"]":"["+n+"] : ["+r.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+e.LogLevel[r.logLevel]+" - "+t;this.executeCallback(r.logLevel,o,r.containsPii||!1)}},t.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},t.prototype.error=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Error,containsPii:!1,correlationId:r||A.EMPTY_STRING})},t.prototype.errorPii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Error,containsPii:!0,correlationId:r||A.EMPTY_STRING})},t.prototype.warning=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Warning,containsPii:!1,correlationId:r||A.EMPTY_STRING})},t.prototype.warningPii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Warning,containsPii:!0,correlationId:r||A.EMPTY_STRING})},t.prototype.info=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Info,containsPii:!1,correlationId:r||A.EMPTY_STRING})},t.prototype.infoPii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Info,containsPii:!0,correlationId:r||A.EMPTY_STRING})},t.prototype.verbose=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Verbose,containsPii:!1,correlationId:r||A.EMPTY_STRING})},t.prototype.verbosePii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Verbose,containsPii:!0,correlationId:r||A.EMPTY_STRING})},t.prototype.trace=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Trace,containsPii:!1,correlationId:r||A.EMPTY_STRING})},t.prototype.tracePii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Trace,containsPii:!0,correlationId:r||A.EMPTY_STRING})},t.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},t}(),pe="@azure/msal-common",ge="13.0.0";
/*! @azure/msal-common v13.0.0 2023-05-02 */!function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(de||(de={}));
/*! @azure/msal-common v13.0.0 2023-05-02 */
var fe,me={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},ve=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return v(t,e),t.createRedirectUriEmptyError=function(){return new t(me.redirectUriNotSet.code,me.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(me.postLogoutUriNotSet.code,me.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(e){return new t(me.claimsRequestParsingError.code,me.claimsRequestParsingError.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(me.authorityUriInsecure.code,me.authorityUriInsecure.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(me.urlParseError.code,me.urlParseError.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(me.urlEmptyError.code,me.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(me.emptyScopesError.code,""+me.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(e){return new t(me.clientIdSingleScopeError.code,me.clientIdSingleScopeError.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(me.invalidPrompt.code,me.invalidPrompt.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(me.invalidClaimsRequest.code,me.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(me.logoutRequestEmptyError.code,me.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(me.tokenRequestEmptyError.code,me.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(me.invalidCodeChallengeMethod.code,me.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(me.invalidCodeChallengeParams.code,me.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(me.invalidCloudDiscoveryMetadata.code,me.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(me.invalidAuthorityMetadata.code,me.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(me.untrustedAuthority.code,me.untrustedAuthority.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(me.invalidAzureCloudInstance.code,me.invalidAzureCloudInstance.desc)},t.createMissingSshJwkError=function(){return new t(me.missingSshJwk.code,me.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(me.missingSshKid.code,me.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(me.missingNonceAuthenticationHeader.code,me.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(me.invalidAuthenticationHeader.code,me.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+r)},t}(ue),ye=function(){function e(e){var t=this,r=e?le.trimArrayEntries(I(e)):[],n=r?le.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||A.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){var r=new e(t);return r.containsOnlyOIDCScopes()?r.removeScope(A.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw ve.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!le.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return R.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){le.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw ue.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(le.isEmpty(e))throw ue.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;R.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw ue.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw ue.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):A.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();
/*! @azure/msal-common v13.0.0 2023-05-02 */
function Ce(e,t){if(le.isEmpty(e))throw ue.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw ue.createClientInfoDecodingError(e.message)}}function Te(e){if(le.isEmpty(e))throw ue.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(U.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?A.EMPTY_STRING:t[1]}}
/*! @azure/msal-common v13.0.0 2023-05-02 */!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(fe||(fe={}));
/*! @azure/msal-common v13.0.0 2023-05-02 */
var Ie=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case q.ADFS_ACCOUNT_TYPE:return L.ADFS;case q.MSAV1_ACCOUNT_TYPE:return L.MSA;case q.MSSTS_ACCOUNT_TYPE:return L.MSSTS;case q.GENERIC_ACCOUNT_TYPE:return L.GENERIC;default:throw ue.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||A.EMPTY_STRING,e.tenantId||A.EMPTY_STRING].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,a,s,c){var u,l,d,h,p,g,f=new e;f.authorityType=q.MSSTS_ACCOUNT_TYPE,f.clientInfo=t,f.homeAccountId=r,f.nativeAccountId=c;var m=s||o&&o.getPreferredCache();if(!m)throw ue.createInvalidCacheEnvironmentError();if(f.environment=m,f.realm=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.tid)||A.EMPTY_STRING,n){f.idTokenClaims=n.claims,f.localAccountId=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.oid)||(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.sub)||A.EMPTY_STRING;var v=null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.preferred_username,y=(null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.emails)?n.claims.emails[0]:null;f.username=v||y||A.EMPTY_STRING,f.name=null===(g=null==n?void 0:n.claims)||void 0===g?void 0:g.name}return f.cloudGraphHostName=i,f.msGraphHost=a,f},e.createGenericAccount=function(t,r,n,o,i,a){var s,c,u,l,d=new e;d.authorityType=n&&n.authorityType===fe.Adfs?q.ADFS_ACCOUNT_TYPE:q.GENERIC_ACCOUNT_TYPE,d.homeAccountId=t,d.realm=A.EMPTY_STRING;var h=a||n&&n.getPreferredCache();if(!h)throw ue.createInvalidCacheEnvironmentError();return r&&(d.localAccountId=(null===(s=null==r?void 0:r.claims)||void 0===s?void 0:s.oid)||(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.sub)||A.EMPTY_STRING,d.username=(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.upn)||A.EMPTY_STRING,d.name=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.name)||A.EMPTY_STRING,d.idTokenClaims=null==r?void 0:r.claims),d.environment=h,d.cloudGraphHostName=o,d.msGraphHost=i,d},e.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:A.EMPTY_STRING;if(t===fe.Adfs||t===fe.Dsts)return a;if(e)try{var s=Ce(e,n);if(!le.isEmpty(s.uid)&&!le.isEmpty(s.utid))return""+s.uid+U.CLIENT_INFO_SEPARATOR+s.utid}catch(e){}return r.verbose("No client info in response"),a},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),we=function(){function e(t,r){if(le.isEmpty(t))throw ue.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=le.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw ue.createTokenParsingError(e)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw ue.createMaxAgeTranspiredError()},e}(),Ee=function(){function t(e,t,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(pe,ge)}return t.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var r=t.reduce((function(t,r){var n=e.getAccount(r);return n?(t.push(n),t):t}),[]);return r.length<1?[]:r.map((function(t){return e.getAccountInfoFromEntity(t)}))},t.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},t.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),r=this.getIdToken(t);return r&&(t.idToken=r.secret,t.idTokenClaims=new we(r.secret,this.cryptoImpl).claims),t},t.prototype.saveCacheRecord=function(e){return C(this,void 0,void 0,(function(){return T(this,(function(t){switch(t.label){case 0:if(!e)throw ue.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},t.prototype.saveAccessToken=function(e){return C(this,void 0,void 0,(function(){var t,r,n,o,i=this;return T(this,(function(a){switch(a.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=ye.fromString(e.target),o=[],r.accessToken.forEach((function(e){if(i.accessTokenKeyMatchesFilter(e,t,!1)){var r=i.getAccessTokenCredential(e);if(r&&i.credentialMatchesFilter(r,t))ye.fromString(r.target).intersectingScopeSets(n)&&o.push(i.removeAccessToken(e))}})),[4,Promise.all(o)];case 1:return a.sent(),this.setAccessTokenCredential(e),[2]}}))}))},t.prototype.getAccountsFilteredBy=function(e){var t=this,r=this.getAccountKeys(),n=[];return r.forEach((function(r){if(t.isAccountKey(r,e.homeAccountId,e.realm)){var o=t.getAccount(r);o&&(e.homeAccountId&&!t.matchHomeAccountId(o,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(o,e.localAccountId)||e.username&&!t.matchUsername(o,e.username)||e.environment&&!t.matchEnvironment(o,e.environment)||e.realm&&!t.matchRealm(o,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(o,e.nativeAccountId)||n.push(o))}})),n},t.prototype.isAccountKey=function(e,t,r){return!(e.split(U.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))},t.prototype.isCredentialKey=function(e){if(e.split(U.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(x.ID_TOKEN.toLowerCase())&&-1===t.indexOf(x.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(x.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(x.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(x.REFRESH_TOKEN.toLowerCase())>-1){var r=""+x.REFRESH_TOKEN+U.CACHE_KEY_SEPARATOR+this.clientId+U.CACHE_KEY_SEPARATOR,n=""+x.REFRESH_TOKEN+U.CACHE_KEY_SEPARATOR+F+U.CACHE_KEY_SEPARATOR;if(-1===t.indexOf(r.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0},t.prototype.credentialMatchesFilter=function(t,r){if(r.clientId&&!this.matchClientId(t,r.clientId))return!1;if(r.userAssertionHash&&!this.matchUserAssertionHash(t,r.userAssertionHash))return!1;if("string"==typeof r.homeAccountId&&!this.matchHomeAccountId(t,r.homeAccountId))return!1;if(r.environment&&!this.matchEnvironment(t,r.environment))return!1;if(r.realm&&!this.matchRealm(t,r.realm))return!1;if(r.credentialType&&!this.matchCredentialType(t,r.credentialType))return!1;if(r.familyId&&!this.matchFamilyId(t,r.familyId))return!1;if(r.target&&!this.matchTarget(t,r.target))return!1;if((r.requestedClaimsHash||t.requestedClaimsHash)&&t.requestedClaimsHash!==r.requestedClaimsHash)return!1;if(t.credentialType===x.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(r.tokenType&&!this.matchTokenType(t,r.tokenType))return!1;if(r.tokenType===e.AuthenticationScheme.SSH&&r.keyId&&!this.matchKeyId(t,r.keyId))return!1}return!0},t.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},t.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},t.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},t.prototype.removeAllAccounts=function(){return C(this,void 0,void 0,(function(){var e,t,r=this;return T(this,(function(n){switch(n.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.removeAccount=function(e){return C(this,void 0,void 0,(function(){var t;return T(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw ue.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return r.sent(),this.removeItem(e),[2]}}))}))},t.prototype.removeAccountContext=function(e){return C(this,void 0,void 0,(function(){var t,r,n,o=this;return T(this,(function(i){switch(i.label){case 0:return t=this.getTokenKeys(),r=e.generateAccountId(),n=[],t.idToken.forEach((function(e){0===e.indexOf(r)&&o.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(r)&&n.push(o.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(r)&&o.removeRefreshToken(e)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.removeAccessToken=function(t){return C(this,void 0,void 0,(function(){var r,n;return T(this,(function(o){switch(o.label){case 0:if(!(r=this.getAccessTokenCredential(t)))return[2];if(r.credentialType.toLowerCase()!==x.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(r.tokenType!==e.AuthenticationScheme.POP)return[3,4];if(!(n=r.keyId))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(n)];case 2:return o.sent(),[3,4];case 3:throw o.sent(),ue.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t)]}}))}))},t.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},t.prototype.readCacheRecord=function(e,t,r){var n=this.getTokenKeys(),o=this.readAccountFromCache(e),i=this.getIdToken(e,n),a=this.getAccessToken(e,t,n),s=this.getRefreshToken(e,!1,n),c=this.readAppMetadataFromCache(r);return o&&i&&(o.idTokenClaims=new we(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}},t.prototype.readAccountFromCache=function(e){var t=Ie.generateAccountCacheKey(e);return this.getAccount(t)},t.prototype.getIdToken=function(e,t){this.commonLogger.trace("CacheManager - getIdToken called");var r={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:x.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(r,t),o=n.length;if(o<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(o>1)throw ue.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0]},t.prototype.getIdTokensByFilter=function(e,t){var r=this,n=t&&t.idToken||this.getTokenKeys().idToken,o=[];return n.forEach((function(t){if(r.idTokenKeyMatchesFilter(t,y({clientId:r.clientId},e))){var n=r.getIdTokenCredential(t);n&&r.credentialMatchesFilter(n,e)&&o.push(n)}})),o},t.prototype.idTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))},t.prototype.removeIdToken=function(e){this.removeItem(e)},t.prototype.removeRefreshToken=function(e){this.removeItem(e)},t.prototype.getAccessToken=function(t,r,n){var o=this;this.commonLogger.trace("CacheManager - getAccessToken called");var i=ye.createSearchScopes(r.scopes),a=r.authenticationScheme||e.AuthenticationScheme.BEARER,s=a&&a.toLowerCase()!==e.AuthenticationScheme.BEARER.toLowerCase()?x.ACCESS_TOKEN_WITH_AUTH_SCHEME:x.ACCESS_TOKEN,c={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:s,clientId:this.clientId,realm:t.tenantId,target:i,tokenType:a,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,l=[];u.forEach((function(e){if(o.accessTokenKeyMatchesFilter(e,c,!0)){var t=o.getAccessTokenCredential(e);t&&o.credentialMatchesFilter(t,c)&&l.push(t)}}));var d=l.length;if(d<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(d>1)throw ue.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),l[0]},t.prototype.accessTokenKeyMatchesFilter=function(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var o=t.target.asArray(),i=0;i<o.length;i++){if(r&&!n.includes(o[i].toLowerCase()))return!1;if(!r&&n.includes(o[i].toLowerCase()))return!0}return!0},t.prototype.getAccessTokensByFilter=function(e){var t=this,r=this.getTokenKeys(),n=[];return r.accessToken.forEach((function(r){if(t.accessTokenKeyMatchesFilter(r,e,!0)){var o=t.getAccessTokenCredential(r);o&&t.credentialMatchesFilter(o,e)&&n.push(o)}})),n},t.prototype.getRefreshToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var o=t?F:void 0,i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:x.REFRESH_TOKEN,clientId:this.clientId,familyId:o},a=r&&r.refreshToken||this.getTokenKeys().refreshToken,s=[];return a.forEach((function(e){if(n.refreshTokenKeyMatchesFilter(e,i)){var t=n.getRefreshTokenCredential(e);t&&n.credentialMatchesFilter(t,i)&&s.push(t)}})),s.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),s[0])},t.prototype.refreshTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))},t.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((function(e){return r[e]})),o=n.length;if(o<1)return null;if(o>1)throw ue.createMultipleMatchingAppMetadataInCacheError();return n[0]},t.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==F)},t.prototype.matchHomeAccountId=function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)},t.prototype.matchLocalAccountId=function(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)},t.prototype.matchUsername=function(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},t.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},t.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},t.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},t.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},t.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},t.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},t.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},t.prototype.matchTarget=function(e,t){return!(e.credentialType!==x.ACCESS_TOKEN&&e.credentialType!==x.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&ye.fromString(e.target).containsScopeSet(t)},t.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},t.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},t.prototype.isAppMetadata=function(e){return-1!==e.indexOf(D)},t.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(K)},t.prototype.generateAuthorityMetadataCacheKey=function(e){return K+"-"+this.clientId+"-"+e},t.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},t}(),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.setAccount=function(){throw ae.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ae.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ae.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ae.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ae.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ae.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ae.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ae.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ae.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ae.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ae.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ae.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ae.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ae.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw ae.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw ae.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw ae.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(Ee),Se={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},be={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:e.LogLevel.Info,correlationId:A.EMPTY_STRING},Ae={sendGetRequestAsync:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return C(this,void 0,void 0,(function(){return T(this,(function(e){throw ae.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},_e={sku:A.SKU,version:ge,cpu:A.EMPTY_STRING,os:A.EMPTY_STRING},Re={clientSecret:A.EMPTY_STRING,clientAssertion:void 0},Pe={azureCloudInstance:de.None,tenant:""+A.DEFAULT_COMMON_TENANT},Ne={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v13.0.0 2023-05-02 */
/*! @azure/msal-common v13.0.0 2023-05-02 */
var Me,Oe=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return v(t,e),t}(ae),qe=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return ee+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o);throw new Oe((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||A.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[w.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(w.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||X),r+Z))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i)},e}(),Ue=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return C(this,void 0,void 0,(function(){var n,o;return T(this,(function(i){switch(i.label){case 0:qe.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof ae?o:ue.createNetworkError(t,o);case 4:return qe.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}();
/*! @azure/msal-common v13.0.0 2023-05-02 */!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Me||(Me={}));
/*! @azure/msal-common v13.0.0 2023-05-02 */
var xe,Le,Be=function(){function e(){}return e.validateRedirectUri=function(e){if(le.isEmpty(e))throw ve.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in N)t.push(N[r]);if(t.indexOf(e)<0)throw ve.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw ve.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(le.isEmpty(e)||le.isEmpty(t))throw ve.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([B.PLAIN,B.S256].indexOf(e)<0)throw ve.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),He=function(){function t(){this.parameters=new Map}return t.prototype.addResponseTypeCode=function(){this.parameters.set(S.RESPONSE_TYPE,encodeURIComponent(A.CODE_RESPONSE_TYPE))},t.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(S.RESPONSE_TYPE,encodeURIComponent(A.TOKEN_RESPONSE_TYPE+" "+A.ID_TOKEN_RESPONSE_TYPE))},t.prototype.addResponseMode=function(e){this.parameters.set(S.RESPONSE_MODE,encodeURIComponent(e||M.QUERY))},t.prototype.addNativeBroker=function(){this.parameters.set(S.NATIVE_BROKER,encodeURIComponent("1"))},t.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?I(e||[],_):e||[],n=new ye(r);this.parameters.set(S.SCOPE,encodeURIComponent(n.printScopes()))},t.prototype.addClientId=function(e){this.parameters.set(S.CLIENT_ID,encodeURIComponent(e))},t.prototype.addRedirectUri=function(e){Be.validateRedirectUri(e),this.parameters.set(S.REDIRECT_URI,encodeURIComponent(e))},t.prototype.addPostLogoutRedirectUri=function(e){Be.validateRedirectUri(e),this.parameters.set(S.POST_LOGOUT_URI,encodeURIComponent(e))},t.prototype.addIdTokenHint=function(e){this.parameters.set(S.ID_TOKEN_HINT,encodeURIComponent(e))},t.prototype.addDomainHint=function(e){this.parameters.set(P.DOMAIN_HINT,encodeURIComponent(e))},t.prototype.addLoginHint=function(e){this.parameters.set(P.LOGIN_HINT,encodeURIComponent(e))},t.prototype.addCcsUpn=function(e){this.parameters.set(w.CCS_HEADER,encodeURIComponent("UPN:"+e))},t.prototype.addCcsOid=function(e){this.parameters.set(w.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},t.prototype.addSid=function(e){this.parameters.set(P.SID,encodeURIComponent(e))},t.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Be.validateClaims(r),this.parameters.set(S.CLAIMS,encodeURIComponent(r))},t.prototype.addCorrelationId=function(e){this.parameters.set(S.CLIENT_REQUEST_ID,encodeURIComponent(e))},t.prototype.addLibraryInfo=function(e){this.parameters.set(S.X_CLIENT_SKU,e.sku),this.parameters.set(S.X_CLIENT_VER,e.version),e.os&&this.parameters.set(S.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(S.X_CLIENT_CPU,e.cpu)},t.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(S.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(S.X_APP_VER,e.appVersion)},t.prototype.addPrompt=function(e){Be.validatePrompt(e),this.parameters.set(""+S.PROMPT,encodeURIComponent(e))},t.prototype.addState=function(e){le.isEmpty(e)||this.parameters.set(S.STATE,encodeURIComponent(e))},t.prototype.addNonce=function(e){this.parameters.set(S.NONCE,encodeURIComponent(e))},t.prototype.addCodeChallengeParams=function(e,t){if(Be.validateCodeChallengeParams(e,t),!e||!t)throw ve.createInvalidCodeChallengeParamsError();this.parameters.set(S.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(S.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},t.prototype.addAuthorizationCode=function(e){this.parameters.set(S.CODE,encodeURIComponent(e))},t.prototype.addDeviceCode=function(e){this.parameters.set(S.DEVICE_CODE,encodeURIComponent(e))},t.prototype.addRefreshToken=function(e){this.parameters.set(S.REFRESH_TOKEN,encodeURIComponent(e))},t.prototype.addCodeVerifier=function(e){this.parameters.set(S.CODE_VERIFIER,encodeURIComponent(e))},t.prototype.addClientSecret=function(e){this.parameters.set(S.CLIENT_SECRET,encodeURIComponent(e))},t.prototype.addClientAssertion=function(e){le.isEmpty(e)||this.parameters.set(S.CLIENT_ASSERTION,encodeURIComponent(e))},t.prototype.addClientAssertionType=function(e){le.isEmpty(e)||this.parameters.set(S.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},t.prototype.addOboAssertion=function(e){this.parameters.set(S.OBO_ASSERTION,encodeURIComponent(e))},t.prototype.addRequestTokenUse=function(e){this.parameters.set(S.REQUESTED_TOKEN_USE,encodeURIComponent(e))},t.prototype.addGrantType=function(e){this.parameters.set(S.GRANT_TYPE,encodeURIComponent(e))},t.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},t.prototype.addExtraQueryParameters=function(e){var t=this,r=Be.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},t.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw ve.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(b.ACCESS_TOKEN)||(r[b.ACCESS_TOKEN]={}),r[b.ACCESS_TOKEN][b.XMS_CC]={values:t}),JSON.stringify(r)},t.prototype.addUsername=function(e){this.parameters.set(Q.username,encodeURIComponent(e))},t.prototype.addPassword=function(e){this.parameters.set(Q.password,encodeURIComponent(e))},t.prototype.addPopToken=function(t){le.isEmpty(t)||(this.parameters.set(S.TOKEN_TYPE,e.AuthenticationScheme.POP),this.parameters.set(S.REQ_CNF,encodeURIComponent(t)))},t.prototype.addSshJwk=function(t){le.isEmpty(t)||(this.parameters.set(S.TOKEN_TYPE,e.AuthenticationScheme.SSH),this.parameters.set(S.REQ_CNF,encodeURIComponent(t)))},t.prototype.addServerTelemetry=function(e){this.parameters.set(S.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(S.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},t.prototype.addThrottling=function(){this.parameters.set(S.X_MS_LIB_CAPABILITY,te)},t.prototype.addLogoutHint=function(e){this.parameters.set(S.LOGOUT_HINT,encodeURIComponent(e))},t.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},t}(),De=function(){function e(e,t){this.config=function(e){var t,r=e.authOptions,n=e.systemOptions,o=e.loggerOptions,i=e.storageInterface,a=e.networkInterface,s=e.cryptoInterface,c=e.clientCredentials,u=e.libraryInfo,l=e.telemetry,d=e.serverTelemetryManager,h=e.persistencePlugin,p=e.serializableCache,g=y(y({},be),o);return{authOptions:(t=r,y({clientCapabilities:[],azureCloudOptions:Pe,skipAuthorityMetadataCache:!1},t)),systemOptions:y(y({},Se),n),loggerOptions:g,storageInterface:i||new ke(r.clientId,se,new he(g)),networkInterface:a||Ae,cryptoInterface:s||se,clientCredentials:c||Re,libraryInfo:y(y({},_e),u),telemetry:y(y({},Ne),l),serverTelemetryManager:d||null,persistencePlugin:h||null,serializableCache:p||null}}(e),this.logger=new he(this.config.loggerOptions,pe,ge),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Ue(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[w.CONTENT_TYPE]=A.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Me.HOME_ACCOUNT_ID:try{var r=Te(e.credential);t[w.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Me.UPN:t[w.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return C(this,void 0,void 0,(function(){var o;return T(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw ue.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new He;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),Fe=function(){function t(){}return t.prototype.generateAccountId=function(){return t.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},t.prototype.generateCredentialId=function(){return t.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},t.prototype.generateTarget=function(){return t.generateTargetForCacheKey(this.target)},t.prototype.generateCredentialKey=function(){return t.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},t.prototype.generateType=function(){switch(this.credentialType){case x.ID_TOKEN:return L.ID_TOKEN;case x.ACCESS_TOKEN:case x.ACCESS_TOKEN_WITH_AUTH_SCHEME:return L.ACCESS_TOKEN;case x.REFRESH_TOKEN:return L.REFRESH_TOKEN;default:throw ue.createUnexpectedCredentialTypeError()}},t.generateCredentialCacheKey=function(e,t,r,n,o,i,a,s,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(s)].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},t.generateAccountIdForCacheKey=function(e,t){return[e,t].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},t.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===x.REFRESH_TOKEN&&n||t,r||A.EMPTY_STRING].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},t.generateTargetForCacheKey=function(e){return(e||A.EMPTY_STRING).toLowerCase()},t.generateClaimsHashForCacheKey=function(e){return(e||A.EMPTY_STRING).toLowerCase()},t.generateSchemeForCacheKey=function(t){return t&&t.toLowerCase()!==e.AuthenticationScheme.BEARER.toLowerCase()?t.toLowerCase():A.EMPTY_STRING},t}(),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.createIdTokenEntity=function(e,r,n,o,i){var a=new t;return a.credentialType=x.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=o,a.secret=n,a.realm=i,a},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===x.ID_TOKEN)},t}(Fe),ze=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),Ge=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return v(r,t),r.createAccessTokenEntity=function(t,n,o,i,a,s,c,u,l,d,h,p,g,f,m){var v,y,C=new r;C.homeAccountId=t,C.credentialType=x.ACCESS_TOKEN,C.secret=o;var T=ze.nowSeconds();if(C.cachedAt=T.toString(),C.expiresOn=c.toString(),C.extendedExpiresOn=u.toString(),d&&(C.refreshOn=d.toString()),C.environment=n,C.clientId=i,C.realm=a,C.target=s,C.userAssertionHash=p,C.tokenType=le.isEmpty(h)?e.AuthenticationScheme.BEARER:h,f&&(C.requestedClaims=f,C.requestedClaimsHash=m),(null===(v=C.tokenType)||void 0===v?void 0:v.toLowerCase())!==e.AuthenticationScheme.BEARER.toLowerCase())switch(C.credentialType=x.ACCESS_TOKEN_WITH_AUTH_SCHEME,C.tokenType){case e.AuthenticationScheme.POP:var I=we.extractTokenClaims(o,l);if(!(null===(y=null==I?void 0:I.cnf)||void 0===y?void 0:y.kid))throw ue.createTokenClaimsRequiredError();C.keyId=I.cnf.kid;break;case e.AuthenticationScheme.SSH:C.keyId=g}return C},r.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===x.ACCESS_TOKEN||e.credentialType===x.ACCESS_TOKEN_WITH_AUTH_SCHEME))},r}(Fe),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.clientId=o,s.credentialType=x.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.userAssertionHash=a,i&&(s.familyId=i),s},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===x.REFRESH_TOKEN)},t}(Fe),Qe=["interaction_required","consent_required","login_required"],We=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Ve={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},Ye=function(e){function t(r,n,o,i,a,s,c){var u=e.call(this,r,n,o)||this;return Object.setPrototypeOf(u,t.prototype),u.timestamp=i||A.EMPTY_STRING,u.traceId=a||A.EMPTY_STRING,u.correlationId=s||A.EMPTY_STRING,u.claims=c||A.EMPTY_STRING,u.name="InteractionRequiredAuthError",u}return v(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&Qe.indexOf(e)>-1,o=!!r&&We.indexOf(r)>-1,i=!!t&&Qe.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t(Ve.noTokensFoundError.code,Ve.noTokensFoundError.desc)},t.createNativeAccountUnavailableError=function(){return new t(Ve.native_account_unavailable.code,Ve.native_account_unavailable.desc)},t}(ae),$e=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},Je=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return le.isEmpty(r)?o:""+o+A.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw ue.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw ue.createNoCryptoObjectError("parseRequestState");if(le.isEmpty(t))throw ue.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(A.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(A.RESOURCE_DELIM):A.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:le.isEmpty(o)?A.EMPTY_STRING:o,libraryState:a}}catch(e){throw ue.createInvalidStateError(t,e)}},e}(),Xe=function(){function e(t){if(this._urlString=t,le.isEmpty(this._urlString))throw ve.createUrlEmptyError();le.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return le.endsWith(t,"?")?t=t.slice(0,-1):le.endsWith(t,"?/")&&(t=t.slice(0,-2)),le.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw ve.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw ve.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ve.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return le.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==k.COMMON&&n[0]!==k.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ve.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!le.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw ve.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===A.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):A.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):A.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(le.isEmpty(t))return{};var r=e.parseHash(t),n=le.queryStringToObject(le.isEmpty(r)?t:r);if(!n)throw ue.createHashNotDeserializedError(JSON.stringify(n));return n},e.getDeserializedQueryString=function(t){if(le.isEmpty(t))return{};var r=e.parseQueryString(t),n=le.queryStringToObject(le.isEmpty(r)?t:r);if(!n)throw ue.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(le.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}();
/*! @azure/msal-common v13.0.0 2023-05-02 */!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake"}(xe||(xe={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(Le||(Le={}));var Ze,et=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);
/*! @azure/msal-common v13.0.0 2023-05-02 */!function(e){e.SW="sw",e.UHW="uhw"}(Ze||(Ze={}));var tt=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,r;return C(this,void 0,void 0,(function(){var n,o,i;return T(this,(function(a){switch(a.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.PopTokenGenerateCnf,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(xe.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=a.sent(),o=this.cryptoUtils.base64Encode(JSON.stringify(n)),i={kid:n.kid,reqCnfString:o},[4,this.cryptoUtils.hashString(o)];case 2:return[2,(i.reqCnfHash=a.sent(),i)]}}))}))},e.prototype.generateKid=function(e){var t;return C(this,void 0,void 0,(function(){return T(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:Ze.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return C(this,void 0,void 0,(function(){return T(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return C(this,void 0,void 0,(function(){var o,i,a,s,c,u;return T(this,(function(l){switch(l.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,a=r.shrClaims,s=r.shrNonce,c=i?new Xe(i):void 0,u=null==c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(y({at:e,ts:ze.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==u?void 0:u.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:null==u?void 0:u.AbsolutePath,q:(null==u?void 0:u.QueryString)?[[],u.QueryString]:void 0,client_claims:a||void 0},n),t,r.correlationId)];case 1:return[2,l.sent()]}}))}))},e}(),rt=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[D,e,t].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(D)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),nt=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),ot=function(){function t(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}return t.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?ue.createStateNotFoundError("Cached State"):ue.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw ue.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Ye.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ye(e.error||A.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||A.EMPTY_STRING,e.trace_id||A.EMPTY_STRING,e.correlation_id||A.EMPTY_STRING,e.claims||A.EMPTY_STRING);throw new Oe(e.error||A.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Ce(e.client_info,r)},t.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Ye.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ye(e.error,e.error_description,e.suberror,e.timestamp||A.EMPTY_STRING,e.trace_id||A.EMPTY_STRING,e.correlation_id||A.EMPTY_STRING,e.claims||A.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Oe(e.error,t,e.suberror)}},t.prototype.handleServerTokenResponse=function(e,r,n,o,i,a,s,c,u){var l;return C(this,void 0,void 0,(function(){var d,h,p,g,f,m;return T(this,(function(v){switch(v.label){case 0:if(null===(l=this.performanceClient)||void 0===l||l.addQueueMeasurement(xe.HandleServerTokenResponse,e.correlation_id),e.id_token){if(d=new we(e.id_token||A.EMPTY_STRING,this.cryptoObj),i&&!le.isEmpty(i.nonce)&&d.claims.nonce!==i.nonce)throw ue.createNonceMismatchError();if(o.maxAge||0===o.maxAge){if(!(h=d.claims.auth_time))throw ue.createAuthTimeNotFoundError();we.checkMaxAge(h,o.maxAge)}}this.homeAccountIdentifier=Ie.generateHomeAccountId(e.client_info||A.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,d),i&&i.state&&(p=Je.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0,g=this.generateCacheRecord(e,r,n,o,d,a,i),v.label=1;case 1:return v.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new nt(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(f)]):[3,3];case 2:v.sent(),v.label=3;case 3:return!s||c||!g.account||(m=g.account.generateAccountKey(),this.cacheStorage.getAccount(m))?[4,this.cacheStorage.saveCacheRecord(g)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,t.generateAuthenticationResult(this.cryptoObj,r,g,!1,o,d,p,void 0,u)]);case 4:return v.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&f?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(f)]):[3,7];case 6:v.sent(),v.label=7;case 7:return[7];case 8:return[2,t.generateAuthenticationResult(this.cryptoObj,r,g,!1,o,d,p,e,u)]}}))}))},t.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,u=t.getPreferredCache();if(le.isEmpty(u))throw ue.createInvalidCacheEnvironmentError();!le.isEmpty(e.id_token)&&o&&(s=Ke.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||A.EMPTY_STRING,this.clientId,o.claims.tid||A.EMPTY_STRING),c=this.generateAccountEntity(e,o,t,a));var l=null;if(!le.isEmpty(e.access_token)){var d=e.scope?ye.fromString(e.scope):new ye(n.scopes||[]),h=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,g=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,f=r+h,m=f+p,v=g&&g>0?r+g:void 0;l=Ge.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||A.EMPTY_STRING,this.clientId,o?o.claims.tid||A.EMPTY_STRING:t.tenant,d.printScopes(),f,m,this.cryptoObj,v,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var y=null;le.isEmpty(e.refresh_token)||(y=je.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||A.EMPTY_STRING,this.clientId,e.foci,i));var C=null;return le.isEmpty(e.foci)||(C=rt.createAppMetadataEntity(this.clientId,u,e.foci)),new $e(c,s,l,y,C)},t.prototype.generateAccountEntity=function(e,t,r,n){var o=r.authorityType,i=n?n.cloud_graph_host_name:A.EMPTY_STRING,a=n?n.msgraph_host:A.EMPTY_STRING;if(o===fe.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ie.createGenericAccount(this.homeAccountIdentifier,t,r,i,a);if(le.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw ue.createClientInfoEmptyError();return e.client_info?Ie.createAccount(e.client_info,this.homeAccountIdentifier,t,r,i,a):Ie.createGenericAccount(this.homeAccountIdentifier,t,r,i,a)},t.generateAuthenticationResult=function(t,r,n,o,i,a,s,c,u){var l,d,h;return C(this,void 0,void 0,(function(){var p,g,f,m,v,y,C,I,w,E,k;return T(this,(function(T){switch(T.label){case 0:if(p=A.EMPTY_STRING,g=[],f=null,v=A.EMPTY_STRING,!n.accessToken)return[3,4];if(n.accessToken.tokenType!==e.AuthenticationScheme.POP)return[3,2];if(y=new tt(t),C=n.accessToken,I=C.secret,!(w=C.keyId))throw ue.createKeyIdMissingError();return[4,y.signPopToken(I,w,i)];case 1:return p=T.sent(),[3,3];case 2:p=n.accessToken.secret,T.label=3;case 3:g=ye.fromString(n.accessToken.target).asArray(),f=new Date(1e3*Number(n.accessToken.expiresOn)),m=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),T.label=4;case 4:return n.appMetadata&&(v=n.appMetadata.familyId===F?F:A.EMPTY_STRING),E=(null==a?void 0:a.claims.oid)||(null==a?void 0:a.claims.sub)||A.EMPTY_STRING,k=(null==a?void 0:a.claims.tid)||A.EMPTY_STRING,(null==c?void 0:c.spa_accountid)&&n.account&&(n.account.nativeAccountId=null==c?void 0:c.spa_accountid),[2,{authority:r.canonicalAuthority,uniqueId:E,tenantId:k,scopes:g,account:n.account?n.account.getAccountInfo():null,idToken:a?a.rawToken:A.EMPTY_STRING,idTokenClaims:a?a.claims:{},accessToken:p,fromCache:o,expiresOn:f,correlationId:i.correlationId,requestId:u||A.EMPTY_STRING,extExpiresOn:m,familyId:v,tokenType:(null===(l=n.accessToken)||void 0===l?void 0:l.tokenType)||A.EMPTY_STRING,state:s?s.userRequestState:A.EMPTY_STRING,cloudGraphHostName:(null===(d=n.account)||void 0===d?void 0:d.cloudGraphHostName)||A.EMPTY_STRING,msGraphHost:(null===(h=n.account)||void 0===h?void 0:h.msGraphHost)||A.EMPTY_STRING,code:null==c?void 0:c.spa_code,fromNativeBroker:!1}]}}))}))},t}(),it=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.includeRedirectUri=!0,n}return v(r,t),r.prototype.getAuthCodeUrl=function(e){var t,r;return C(this,void 0,void 0,(function(){var n;return T(this,(function(o){switch(o.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.GetAuthCodeUrl,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(xe.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return n=o.sent(),[2,Xe.appendQueryString(this.authority.authorizationEndpoint,n)]}}))}))},r.prototype.acquireToken=function(e,t){var r,n,o,i,a,s;return C(this,void 0,void 0,(function(){var c,u,l,d,h,p,g=this;return T(this,(function(f){switch(f.label){case 0:if(!e||!e.code)throw ue.createTokenRequestCannotBeMadeError();return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.AuthClientAcquireToken,e.correlationId),c=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),u=ze.nowSeconds(),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(xe.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return l=f.sent(),d=null===(i=l.headers)||void 0===i?void 0:i[w.X_MS_REQUEST_ID],(h=null===(a=l.headers)||void 0===a?void 0:a[w.X_MS_HTTP_VERSION])&&(null==c||c.addStaticFields({httpVerAuthority:h})),(p=new ot(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(l.body),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(xe.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(l.body,this.authority,u,e,t,void 0,void 0,void 0,d).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw g.logger.verbose("Error in fetching token in ACC",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},r.prototype.handleFragmentResponse=function(e,t){var r=new ot(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new Xe(e),o=Xe.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw ue.createNoAuthCodeInServerResponseError();return y(y({},o),{code:o.code})},r.prototype.getLogoutUri=function(e){if(!e)throw ve.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return Xe.appendQueryString(this.authority.endSessionEndpoint,t)},r.prototype.executeTokenRequest=function(e,t){var r,n;return C(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return T(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.AuthClientExecuteTokenRequest,t.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(xe.AuthClientCreateTokenRequestBody,t.correlationId),o=this.createTokenQueryParameters(t),i=Xe.appendQueryString(e.tokenEndpoint,o),[4,this.createTokenRequestBody(t)];case 1:if(a=d.sent(),s=void 0,t.clientInfo)try{c=Ce(t.clientInfo,this.cryptoUtils),s={credential:""+c.uid+U.CLIENT_INFO_SEPARATOR+c.utid,type:Me.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return u=this.createTokenRequestHeaders(s||t.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(i,a,u,l)]}}))}))},r.prototype.createTokenRequestBody=function(t){var r,n;return C(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d;return T(this,(function(h){switch(h.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.AuthClientCreateTokenRequestBody,t.correlationId),(o=new He).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?o.addRedirectUri(t.redirectUri):Be.validateRedirectUri(t.redirectUri),o.addScopes(t.scopes),o.addAuthorizationCode(t.code),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&o.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(i=this.config.clientCredentials.clientAssertion,o.addClientAssertion(i.assertion),o.addClientAssertionType(i.assertionType)),o.addGrantType(O.AUTHORIZATION_CODE_GRANT),o.addClientInfo(),t.authenticationScheme!==e.AuthenticationScheme.POP?[3,2]:(a=new tt(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(xe.PopTokenGenerateCnf,t.correlationId),[4,a.generateCnf(t)]);case 1:return s=h.sent(),o.addPopToken(s.reqCnfString),[3,3];case 2:if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(!t.sshJwk)throw ve.createMissingSshJwkError();o.addSshJwk(t.sshJwk)}h.label=3;case 3:if(c=t.correlationId||this.config.cryptoInterface.createNewGuid(),o.addCorrelationId(c),(!le.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),u=void 0,t.clientInfo)try{l=Ce(t.clientInfo,this.cryptoUtils),u={credential:""+l.uid+U.CLIENT_INFO_SEPARATOR+l.utid,type:Me.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else u=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&u)switch(u.type){case Me.HOME_ACCOUNT_ID:try{l=Te(u.credential),o.addCcsOid(l)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Me.UPN:o.addCcsUpn(u.credential)}return t.tokenBodyParameters&&o.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[S.RETURN_SPA_CODE]||o.addExtraQueryParameters(((d={})[S.RETURN_SPA_CODE]="1",d)),[2,o.createQueryString()]}}))}))},r.prototype.createAuthCodeUrlQueryString=function(t){var r;return C(this,void 0,void 0,(function(){var n,o,i,a,s,c,u;return T(this,(function(l){switch(l.label){case 0:if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.AuthClientCreateQueryString,t.correlationId),(n=new He).addClientId(this.config.authOptions.clientId),o=I(t.scopes||[],t.extraScopesToConsent||[]),n.addScopes(o),n.addRedirectUri(t.redirectUri),i=t.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(i),n.addResponseMode(t.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&n.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&n.addPrompt(t.prompt),t.domainHint&&n.addDomainHint(t.domainHint),t.prompt!==N.SELECT_ACCOUNT)if(t.sid&&t.prompt===N.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(t.sid);else if(t.account){if(a=this.extractAccountSid(t.account),s=this.extractLoginHint(t.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(s);try{c=Te(t.account.homeAccountId),n.addCcsOid(c)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&t.prompt===N.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(a);try{c=Te(t.account.homeAccountId),n.addCcsOid(c)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(t.loginHint),n.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(t.account.username);try{c=Te(t.account.homeAccountId),n.addCcsOid(c)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(t.loginHint),n.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&n.addNonce(t.nonce),t.state&&n.addState(t.state),(!le.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&n.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(n.addNativeBroker(),t.authenticationScheme!==e.AuthenticationScheme.POP?[3,2]:[4,new tt(this.cryptoUtils).generateCnf(t)]):[3,2];case 1:u=l.sent(),n.addPopToken(u.reqCnfHash),l.label=2;case 2:return[2,n.createQueryString()]}}))}))},r.prototype.createLogoutUrlQueryString=function(e){var t=new He;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},r.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},r.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},r}(De),at=function(t){function r(e,r){return t.call(this,e,r)||this}return v(r,t),r.prototype.acquireToken=function(e){var t,r,n,o,i,a,s;return C(this,void 0,void 0,(function(){var c,u,l,d,h,p,g=this;return T(this,(function(f){switch(f.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.RefreshTokenClientAcquireToken,e.correlationId),c=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(xe.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),u=ze.nowSeconds(),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(xe.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return l=f.sent(),d=null===(o=l.headers)||void 0===o?void 0:o[w.X_MS_HTTP_VERSION],null==c||c.addStaticFields({refreshTokenSize:(null===(i=l.body.refresh_token)||void 0===i?void 0:i.length)||0}),d&&(null==c||c.addStaticFields({httpVerToken:d})),h=null===(a=l.headers)||void 0===a?void 0:a[w.X_MS_REQUEST_ID],(p=new ot(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(l.body),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(xe.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(l.body,this.authority,u,e,void 0,void 0,!0,e.forceCache,h).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw g.logger.verbose("Error in fetching refresh token",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},r.prototype.acquireTokenByRefreshToken=function(e){var t,r,n,o;return C(this,void 0,void 0,(function(){var i,a;return T(this,(function(s){if(!e)throw ve.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw ue.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(xe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(t){if(i=t instanceof Ye&&t.errorCode===Ve.noTokensFoundError.code,a=t instanceof Oe&&t.errorCode===re&&t.subError===ne,i||a)return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(xe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw t}return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(xe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},r.prototype.acquireTokenWithCachedRefreshToken=function(t,r){var n,o,i;return C(this,void 0,void 0,(function(){var a,s,c;return T(this,(function(u){if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(xe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),a=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(xe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),!(s=this.cacheManager.getRefreshToken(t.account,r)))throw null==a||a.discardMeasurement(),Ye.createNoTokensFoundError();return null==a||a.endMeasurement({success:!0}),c=y(y({},t),{refreshToken:s.secret,authenticationScheme:t.authenticationScheme||e.AuthenticationScheme.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Me.HOME_ACCOUNT_ID}}),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(xe.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(c)]}))}))},r.prototype.executeTokenRequest=function(e,t){var r,n,o;return C(this,void 0,void 0,(function(){var i,a,s,c,u,l;return T(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.RefreshTokenClientExecuteTokenRequest,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(xe.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(xe.RefreshTokenClientCreateTokenRequestBody,e.correlationId),a=this.createTokenQueryParameters(e),s=Xe.appendQueryString(t.tokenEndpoint,a),[4,this.createTokenRequestBody(e)];case 1:return c=d.sent(),u=this.createTokenRequestHeaders(e.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(s,c,u,l).then((function(e){return null==i||i.endMeasurement({success:!0}),e})).catch((function(e){throw null==i||i.endMeasurement({success:!1}),e}))]}}))}))},r.prototype.createTokenRequestBody=function(t){var r,n,o;return C(this,void 0,void 0,(function(){var i,a,s,c,u,l,d;return T(this,(function(h){switch(h.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.RefreshTokenClientCreateTokenRequestBody,t.correlationId),i=t.correlationId,a=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(xe.BaseClientCreateTokenRequestHeaders,i),(s=new He).addClientId(this.config.authOptions.clientId),s.addScopes(t.scopes),s.addGrantType(O.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&s.addServerTelemetry(this.serverTelemetryManager),s.addCorrelationId(i),s.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(c=this.config.clientCredentials.clientAssertion,s.addClientAssertion(c.assertion),s.addClientAssertionType(c.assertionType)),t.authenticationScheme!==e.AuthenticationScheme.POP?[3,2]:(u=new tt(this.cryptoUtils,this.performanceClient),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(xe.PopTokenGenerateCnf,t.correlationId),[4,u.generateCnf(t)]);case 1:return l=h.sent(),s.addPopToken(l.reqCnfString),[3,3];case 2:if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(!t.sshJwk)throw null==a||a.endMeasurement({success:!1}),ve.createMissingSshJwkError();s.addSshJwk(t.sshJwk)}h.label=3;case 3:if((!le.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Me.HOME_ACCOUNT_ID:try{d=Te(t.ccsCredential.credential),s.addCcsOid(d)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Me.UPN:s.addCcsUpn(t.ccsCredential.credential)}return null==a||a.endMeasurement({success:!0}),[2,s.createQueryString()]}}))}))},r}(De),st=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t.prototype.acquireToken=function(e){return C(this,void 0,void 0,(function(){var t;return T(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof ue&&t.errorCode===ce.tokenRefreshRequired.code)return[2,new at(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return C(this,void 0,void 0,(function(){var i,a;return T(this,(function(s){switch(s.label){case 0:if(!e)throw ve.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome($.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),ue.createRefreshRequiredError();if(!e.account)throw ue.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(a=this.cacheManager.readCacheRecord(e.account,e,i)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome($.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),ue.createRefreshRequiredError();if(ze.wasClockTurnedBack(a.accessToken.cachedAt)||ze.isTokenExpired(a.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome($.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),ue.createRefreshRequiredError();if(a.accessToken.refreshOn&&ze.isTokenExpired(a.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome($.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),ue.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(a,e)];case 1:return[2,s.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return C(this,void 0,void 0,(function(){var r,n;return T(this,(function(o){switch(o.label){case 0:if(e.idToken&&(r=new we(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null==r?void 0:r.claims.auth_time))throw ue.createAuthTimeNotFoundError();we.checkMaxAge(n,t.maxAge)}return[4,ot.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}}))}))},t}(De);
/*! @azure/msal-common v13.0.0 2023-05-02 */
/*! @azure/msal-common v13.0.0 2023-05-02 */
function ct(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v13.0.0 2023-05-02 */var ut,lt={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},dt={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};
/*! @azure/msal-common v13.0.0 2023-05-02 */
e.ProtocolMode=void 0,(ut=e.ProtocolMode||(e.ProtocolMode={})).AAD="AAD",ut.OIDC="OIDC";
/*! @azure/msal-common v13.0.0 2023-05-02 */
var ht=function(){function e(){this.expiresAt=ze.nowSeconds()+z}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=ze.nowSeconds()+z},e.prototype.isExpired=function(){return this.expiresAt<=ze.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(K)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}();
/*! @azure/msal-common v13.0.0 2023-05-02 */
/*! @azure/msal-common v13.0.0 2023-05-02 */
var pt,gt,ft,mt,vt,yt,Ct,Tt,It,wt=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,o,i,a;return C(this,void 0,void 0,(function(){var s,c,u,l,d;return T(this,(function(h){switch(h.label){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(xe.RegionDiscoveryDetectRegion,this.correlationId),s=t)return[3,8];c=e.IMDS_OPTIONS,h.label=1;case 1:return h.trys.push([1,6,,7]),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(xe.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(A.IMDS_VERSION,c)];case 2:return(u=h.sent()).status===W.httpSuccess&&(s=u.body,r.region_source=V.IMDS),u.status!==W.httpBadRequest?[3,5]:(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(xe.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(c)]);case 3:return(l=h.sent())?(null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(xe.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(l,c)]):(r.region_source=V.FAILED_AUTO_DETECTION,[2,null]);case 4:(d=h.sent()).status===W.httpSuccess&&(s=d.body,r.region_source=V.IMDS),h.label=5;case 5:return[3,7];case 6:return h.sent(),r.region_source=V.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=V.ENVIRONMENT_VARIABLE,h.label=9;case 9:return s||(r.region_source=V.FAILED_AUTO_DETECTION),[2,s||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return C(this,void 0,void 0,(function(){return T(this,(function(n){return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(A.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,A.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return C(this,void 0,void 0,(function(){var r;return T(this,(function(n){switch(n.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(A.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===W.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),Et=function(){function t(e,t,r,n,o,i,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=i,this.correlationId=a,this.regionDiscovery=new wt(t,this.performanceClient,this.correlationId)}return Object.defineProperty(t.prototype,"authorityType",{get:function(){if(this.canonicalAuthorityUrlComponents.HostNameAndPort.endsWith(A.CIAM_AUTH_URL))return fe.Ciam;var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length)switch(e[0].toLowerCase()){case A.ADFS:return fe.Adfs;case A.DSTS:return fe.Dsts}return fe.Default},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Xe(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ue.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(e)}throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),t.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},t.prototype.replacePath=function(e){var t=e,r=new Xe(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(t.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===fe.Adfs||this.authorityType===fe.Dsts||this.protocolMode===e.ProtocolMode.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),t.prototype.discoveryComplete=function(){return!!this.metadata},t.prototype.resolveEndpointsAsync=function(){var e,t,r;return C(this,void 0,void 0,(function(){var n,o,i,a;return T(this,(function(s){switch(s.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(xe.AuthorityResolveEndpointsAsync,this.correlationId),(n=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(n=new ht).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(xe.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(n)];case 1:return o=s.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(xe.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(n)];case 2:return i=s.sent(),o!==H.CACHE&&i!==H.CACHE&&(n.resetExpiresAt(),n.updateCanonicalAuthority(this.canonicalAuthority)),a=this.cacheManager.generateAuthorityMetadataCacheKey(n.preferred_cache),this.cacheManager.setAuthorityMetadata(a,n),this.metadata=n,[2]}}))}))},t.prototype.updateEndpointMetadata=function(e){var t,r,n,o,i,a;return C(this,void 0,void 0,(function(){var s,c;return T(this,(function(u){switch(u.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.AuthorityUpdateEndpointMetadata,this.correlationId),(s=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(s,!1),[2,H.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,H.CACHE]:(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(xe.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(s=u.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(xe.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(s)]):[3,3]:[3,4];case 2:s=u.sent(),u.label=3;case 3:return e.updateEndpointMetadata(s,!0),[2,H.NETWORK];case 4:return!(c=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(xe.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(c)]):[3,6];case 5:c=u.sent(),u.label=6;case 6:return e.updateEndpointMetadata(c,!1),[2,H.HARDCODED_VALUES];case 7:throw ue.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},t.prototype.isAuthoritySameType=function(e){return new Xe(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},t.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw ve.createInvalidAuthorityMetadataError()}return null},t.prototype.getEndpointMetadataFromNetwork=function(){var e;return C(this,void 0,void 0,(function(){var t,r;return T(this,(function(n){switch(n.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(xe.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,ct((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},t.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in lt?lt[this.canonicalAuthority]:null},t.prototype.updateMetadataWithRegionalInformation=function(e){var r,n,o,i,a,s,c;return C(this,void 0,void 0,(function(){var u,l;return T(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(xe.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(xe.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata)];case 1:return u=d.sent(),l=(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)===A.AZURE_REGION_AUTO_DISCOVER_FLAG?u:null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.azureRegion,(null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion)===A.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=u?Y.AUTO_DETECTION_REQUESTED_SUCCESSFUL:Y.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=u?(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.azureRegion)===u?Y.CONFIGURED_MATCHES_DETECTED:Y.CONFIGURED_NOT_DETECTED:Y.CONFIGURED_NO_AUTO_DETECTION,l?(this.regionDiscoveryMetadata.region_used=l,[2,t.replaceWithRegionalInformation(e,l)]):[2,e]}}))}))},t.prototype.updateCloudDiscoveryMetadata=function(e){var t,r;return C(this,void 0,void 0,(function(){var n,o,i;return T(this,(function(a){switch(a.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(xe.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||A.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||A.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||A.NOT_APPLICABLE)),(n=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(n,!1),[2,H.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),o=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found metadata in the cache."),[2,H.CACHE]):(o&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(xe.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(n=a.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(n,!0),[2,H.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(i=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(i,!1),[2,H.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),ve.createUntrustedAuthorityError()}}))}))},t.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===fe.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=t.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),ve.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},t.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var e;return C(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u;return T(this,(function(l){switch(l.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(xe.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+A.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},o=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(i=l.sent(),a=void 0,s=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}
/*! @azure/msal-common v13.0.0 2023-05-02 */(i.body))a=i.body,s=a.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+a.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+i.status),(a=i.body).error===A.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+a.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+a.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=t.getCloudDiscoveryMetadataFromNetworkResponse(s,this.hostnameAndPort),[3,4];case 3:return(c=l.sent())instanceof ae?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\r\nError: "+c.errorCode+"\r\nError Description: "+c.errorMessage):(u=c,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\r\nError: "+u.name+"\r\nError Description: "+u.message)),[2,null];case 4:return o||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),o=t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,o]}}))}))},t.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in dt?dt[this.canonicalAuthority]:null},t.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return Xe.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},t.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==de.None){var n=t.tenant?t.tenant:A.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},t.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},t.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},t.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw ue.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},t.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},t.isPublicCloudAuthority=function(e){return A.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},t.buildRegionalAuthorityString=function(e,t,r){var n=new Xe(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+A.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var a=Xe.constructAuthorityUriFromObject(y(y({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?a+"?"+r:a},t.replaceWithRegionalInformation=function(e,r){return e.authorization_endpoint=t.buildRegionalAuthorityString(e.authorization_endpoint,r),e.token_endpoint=t.buildRegionalAuthorityString(e.token_endpoint,r,A.REGIONAL_AUTH_NON_MSI_QUERY_STRING),e.end_session_endpoint&&(e.end_session_endpoint=t.buildRegionalAuthorityString(e.end_session_endpoint,r)),e},t.transformCIAMAuthority=function(e){var t=e.endsWith(A.FORWARD_SLASH)?e:""+e+A.FORWARD_SLASH,r=new Xe(e).getUrlComponents();0===r.PathSegments.length&&r.HostNameAndPort.endsWith(A.CIAM_AUTH_URL)&&(t=""+t+r.HostNameAndPort.split(".")[0]+A.AAD_TENANT_DOMAIN_SUFFIX);return t},t}(),kt=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o,i,a,s){return C(this,void 0,void 0,(function(){var c,u,l;return T(this,(function(d){switch(d.label){case 0:null==a||a.addQueueMeasurement(xe.AuthorityFactoryCreateDiscoveredInstance,s),c=Et.transformCIAMAuthority(t),u=e.createInstance(c,r,n,o,i,a,s),d.label=1;case 1:return d.trys.push([1,3,,4]),null==a||a.setPreQueueTime(xe.AuthorityResolveEndpointsAsync,s),[4,u.resolveEndpointsAsync()];case 2:return d.sent(),[2,u];case 3:throw l=d.sent(),ue.createEndpointDiscoveryIncompleteError(l);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,o,i,a){if(le.isEmpty(e))throw ve.createUrlEmptyError();return new Et(e,t,r,n,o,i,a)},e}(),St=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(j.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),bt=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(ee));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),At={sendGetRequestAsync:function(){return Promise.reject(ae.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ae.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},_t={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},Rt={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Pt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,t.prototype),o}return v(t,e),t.createMissingKidError=function(){return new t(_t.code,_t.desc)},t.createMissingAlgError=function(){return new t(Rt.code,Rt.desc)},t}(ae),Nt=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw Pt.createMissingKidError();if(!t.alg)throw Pt.createMissingAlgError();var r=new e({typ:t.typ||J.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)},e}(),Mt=function(){function e(e){this.headers=e}return e.prototype.getShrNonce=function(){var e=this.headers[w.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw ve.createInvalidAuthenticationHeaderError(w.AuthenticationInfo,"nextnonce challenge is missing.")}var r=this.headers[w.WWWAuthenticate];if(r){var n=this.parseChallenges(r);if(n.nonce)return n.nonce;throw ve.createInvalidAuthenticationHeaderError(w.WWWAuthenticate,"nonce challenge is missing.")}throw ve.createMissingNonceAuthenticationHeadersError()},e.prototype.parseChallenges=function(e){var t=e.indexOf(" "),r=e.substr(t+1).split(","),n={};return r.forEach((function(e){var t=e.split("="),r=t[0],o=t[1];n[r]=unescape(o.replace(/['"]+/g,A.EMPTY_STRING))})),n},e}(),Ot=function(){function e(e,t){this.cacheOutcome=$.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||A.EMPTY_STRING,this.wrapperVer=e.wrapperVer||A.EMPTY_STRING,this.telemetryCacheKey=j.CACHE_KEY+U.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+j.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(j.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(j.VALUE_SEPARATOR);return[j.SCHEMA_VERSION,r,t].join(j.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(j.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(j.VALUE_SEPARATOR),i=t.errors.length,a=[i,r<i?j.OVERFLOW_TRUE:j.OVERFLOW_FALSE].join(j.VALUE_SEPARATOR);return[j.SCHEMA_VERSION,t.cacheHits,n,o,a].join(j.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=j.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),le.isEmpty(e.subError)?le.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(j.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new St;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new St;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||A.EMPTY_STRING,a=e.failedRequests[2*t+1]||A.EMPTY_STRING,s=e.errors[t]||A.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<j.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||A.EMPTY_STRING),e.push(this.regionSource||A.EMPTY_STRING),e.push(this.regionOutcome||A.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),qt=function(){function e(e,t,r,n,o,i){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return et},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r,n){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var o={eventName:e,queueTime:r,manuallyCompleted:n},i=this.queueMeasurements.get(t);if(i)i.push(o),this.queueMeasurements.set(t,i);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var a=[o];this.queueMeasurements.set(t,a)}this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r,n,o=this,i=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",i),this.logger.trace("PerformanceClient: Performance measurement started for "+e,i);var a=this.startPerformanceMeasuremeant(e,i);a.startMeasurement();var s={eventId:this.generateId(),status:Le.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:i,appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appVersion};return this.cacheEventByCorrelationId(s),{endMeasurement:function(e){return o.endMeasurement(y(y({},s),e),a)},discardMeasurement:function(){return o.discardMeasurements(s.correlationId)},addStaticFields:function(e){return o.addStaticFields(e,s.correlationId)},increment:function(e){return o.increment(e,s.correlationId)},measurement:a,event:s}},e.prototype.endMeasurement=function(e,t){var r,n,o=this,i=this.eventsByCorrelationId.get(e.correlationId);if(!i)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var a=e.eventId===i.eventId,s={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};a?(s=this.getQueueInfo(e.correlationId),this.discardCache(i.correlationId)):null===(r=i.incompleteSubMeasurements)||void 0===r||r.delete(e.eventId),null==t||t.endMeasurement();var c=null==t?void 0:t.flushMeasurement();if(!c)return this.logger.trace("PerformanceClient: Performance measurement not taken",i.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+c+" ms",e.correlationId),!a)return i[e.name+"DurationMs"]=Math.floor(c),y({},i);var u=y(y({},i),e),l=0;return null===(n=u.incompleteSubMeasurements)||void 0===n||n.forEach((function(t){o.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,u.correlationId),l++})),u.incompleteSubMeasurements=void 0,u=y(y({},u),{durationMs:Math.round(c),queuedTimeMs:s.totalQueueTime,queuedCount:s.totalQueueCount,queuedManuallyCompletedCount:s.manuallyCompletedCount,status:Le.Completed,incompleteSubsCount:l}),this.truncateIntegralFields(u,this.getIntFields()),this.emitEvents([u],e.correlationId),u},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,y(y({},r),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var r=this.eventsByCorrelationId.get(t);if(r)for(var n in e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,y({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var r=0,n=0,o=0;return null==t||t.forEach((function(e){r+=e.queueTime,n++,o+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:o}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,o){r.logger.trace("PerformanceClient: Emitting event to callback "+o,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),Ut=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new Ut},t.prototype.startPerformanceMeasurement=function(){return new Ut},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(qt),Lt={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},Bt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return u(t,e),t.createPkceNotGeneratedError=function(e){return new t(Lt.pkceNotGenerated.code,Lt.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Lt.cryptoDoesNotExist.code,Lt.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Lt.httpMethodNotImplementedError.code,Lt.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Lt.emptyNavigateUriError.code,Lt.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t(Lt.hashEmptyError.code,Lt.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(Lt.hashDoesNotContainStateError.code,Lt.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(Lt.hashDoesNotContainKnownPropertiesError.code,Lt.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t(Lt.unableToParseStateError.code,Lt.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(Lt.stateInteractionTypeMismatchError.code,Lt.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t(Lt.interactionInProgress.code,Lt.interactionInProgress.desc)},t.createPopupWindowError=function(e){var r=Lt.popupWindowError.desc;return r=le.isEmpty(e)?r:r+" Details: "+e,new t(Lt.popupWindowError.code,r)},t.createEmptyWindowCreatedError=function(){return new t(Lt.emptyWindowError.code,Lt.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(Lt.userCancelledError.code,Lt.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t(Lt.monitorPopupTimeoutError.code,Lt.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t(Lt.monitorIframeTimeoutError.code,Lt.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t(Lt.redirectInIframeError.code,Lt.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(Lt.blockTokenRequestsInHiddenIframeError.code,Lt.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(Lt.blockAcquireTokenInPopupsError.code,Lt.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(Lt.iframeClosedPrematurelyError.code,Lt.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(Lt.silentLogoutUnsupportedError.code,Lt.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t(Lt.noAccountError.code,Lt.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t(Lt.silentPromptValueError.code,Lt.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(Lt.unableToParseTokenRequestCacheError.code,Lt.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t(Lt.noTokenRequestCacheError.code,Lt.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t(Lt.authRequestNotSet.code,Lt.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t(Lt.noCachedAuthorityError.code,Lt.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t(Lt.invalidCacheType.code,""+Lt.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t(Lt.notInBrowserEnvironment.code,Lt.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t(Lt.databaseNotOpen.code,Lt.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t(Lt.noNetworkConnectivity.code,Lt.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(e,r){return new t(Lt.postRequestFailed.code,Lt.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(Lt.getRequestFailed.code,Lt.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(Lt.failedToParseNetworkResponse.code,Lt.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(Lt.unableToLoadTokenError.code,Lt.unableToLoadTokenError.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(Lt.signingKeyNotFoundInStorage.code,Lt.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(Lt.authCodeRequired.code,Lt.authCodeRequired.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(Lt.authCodeOrNativeAccountRequired.code,Lt.authCodeOrNativeAccountRequired.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t(Lt.spaCodeAndNativeAccountPresent.code,Lt.spaCodeAndNativeAccountPresent.desc)},t.createDatabaseUnavailableError=function(){return new t(Lt.databaseUnavailable.code,Lt.databaseUnavailable.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(Lt.unableToAcquireTokenFromNativePlatform.code,Lt.unableToAcquireTokenFromNativePlatform.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(Lt.nativeHandshakeTimeout.code,Lt.nativeHandshakeTimeout.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(Lt.nativeExtensionNotInstalled.code,Lt.nativeExtensionNotInstalled.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(Lt.nativeConnectionNotEstablished.code,Lt.nativeConnectionNotEstablished.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(Lt.nativeBrokerCalledBeforeInitialize.code,Lt.nativeBrokerCalledBeforeInitialize.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(Lt.nativePromptNotSupported.code,Lt.nativePromptNotSupported.desc)},t}(ae),Ht="invalid_grant",Dt=483,Ft=600,Kt="msal",zt=30,Gt="msal.js.browser",jt="53ee284d-920a-4b59-9d30-a60315b26836",Qt="ppnbnpeolgkicgegkbkbjmhlideopiji",Wt="MATS";
/*! @azure/msal-common v13.0.0 2023-05-02 */!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(pt||(pt={})),e.BrowserCacheLocation=void 0,(gt=e.BrowserCacheLocation||(e.BrowserCacheLocation={})).LocalStorage="localStorage",gt.SessionStorage="sessionStorage",gt.MemoryStorage="memoryStorage",function(e){e.GET="GET",e.POST="POST"}(ft||(ft={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(mt||(mt={})),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(vt||(vt={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(yt||(yt={})),e.ApiId=void 0,(Ct=e.ApiId||(e.ApiId={}))[Ct.acquireTokenRedirect=861]="acquireTokenRedirect",Ct[Ct.acquireTokenPopup=862]="acquireTokenPopup",Ct[Ct.ssoSilent=863]="ssoSilent",Ct[Ct.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",Ct[Ct.handleRedirectPromise=865]="handleRedirectPromise",Ct[Ct.acquireTokenByCode=866]="acquireTokenByCode",Ct[Ct.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",Ct[Ct.logout=961]="logout",Ct[Ct.logoutPopup=962]="logoutPopup",e.InteractionType=void 0,(Tt=e.InteractionType||(e.InteractionType={})).Redirect="redirect",Tt.Popup="popup",Tt.Silent="silent",Tt.None="none",e.InteractionStatus=void 0,(It=e.InteractionStatus||(e.InteractionStatus={})).Startup="startup",It.Login="login",It.Logout="logout",It.AcquireToken="acquireToken",It.SsoSilent="ssoSilent",It.HandleRedirect="handleRedirect",It.None="none";var Vt,Yt={scopes:_},$t="jwk";e.WrapperSKU=void 0,(Vt=e.WrapperSKU||(e.WrapperSKU={})).React="@azure/msal-react",Vt.Angular="@azure/msal-angular";var Jt,Xt="msal.db",Zt=Xt+".keys";!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(Jt||(Jt={}));
/*! @azure/msal-browser v2.37.0 2023-05-02 */
var er,tr,rr={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},nr=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return u(t,e),t.createRedirectUriEmptyError=function(){return new t(rr.redirectUriNotSet.code,rr.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(rr.postLogoutUriNotSet.code,rr.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(rr.storageNotSupportedError.code,rr.storageNotSupportedError.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(rr.noRedirectCallbacksSet.code,rr.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(rr.stubPcaInstanceCalled.code,rr.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(rr.inMemRedirectUnavailable.code,rr.inMemRedirectUnavailable.desc)},t.createEntropyNotProvided=function(){return new t(rr.entropyNotProvided.code,rr.entropyNotProvided.desc)},t}(ae),or=function(){function t(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return t.prototype.validateWindowStorage=function(t){if(t!==e.BrowserCacheLocation.LocalStorage&&t!==e.BrowserCacheLocation.SessionStorage)throw nr.createStorageNotSupportedError(t);if(!!!window[t])throw nr.createStorageNotSupportedError(t)},t.prototype.getItem=function(e){return this.windowStorage.getItem(e)},t.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},t.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},t.prototype.getKeys=function(){return Object.keys(this.windowStorage)},t.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},t}(),ir=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),ar=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(le.isEmpty(t))return null;try{return Je.parseRequestState(e,t).libraryState.meta}catch(e){throw ue.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Xe(e);return Xe.getDeserializedHash(t.getHash())},e}(),sr=function(t){function r(e,r,n,o){var i=t.call(this,e,n,o)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new ir,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.temporaryCacheLocation,i.cacheConfig.cacheLocation),r.cacheMigrationEnabled&&(i.migrateCacheEntries(),i.createKeyMaps()),i}return u(r,t),r.prototype.setupBrowserStorage=function(t){switch(t){case e.BrowserCacheLocation.LocalStorage:case e.BrowserCacheLocation.SessionStorage:try{return new or(t)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=e.BrowserCacheLocation.MemoryStorage,new ir},r.prototype.setupTemporaryCacheStorage=function(t,r){switch(r){case e.BrowserCacheLocation.LocalStorage:case e.BrowserCacheLocation.SessionStorage:try{return new or(t||e.BrowserCacheLocation.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case e.BrowserCacheLocation.MemoryStorage:default:return this.internalStorage}},r.prototype.migrateCacheEntries=function(){var e=this,t=A.CACHE_PREFIX+"."+E.ID_TOKEN,r=A.CACHE_PREFIX+"."+E.CLIENT_INFO,n=A.CACHE_PREFIX+"."+E.ERROR,o=A.CACHE_PREFIX+"."+E.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[E.ID_TOKEN,E.CLIENT_INFO,E.ERROR,E.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},r.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},r.prototype.createKeyMaps=function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(vt.ACCOUNT_KEYS),r=this.getItem(vt.TOKEN_KEYS+"."+this.clientId);t&&r?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var r;if(e.isCredentialKey(t)&&(r=e.getItem(t))){var n=e.validateAndParseJson(r);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case x.ID_TOKEN:if(Ke.isIdTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map");var o=Ee.toObject(new Ke,n),i=e.updateCredentialCacheKey(t,o);return void e.addTokenKey(i,x.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case x.ACCESS_TOKEN:case x.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Ge.isAccessTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map");var a=Ee.toObject(new Ge,n);i=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(i,x.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case x.REFRESH_TOKEN:if(je.isRefreshTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map");var s=Ee.toObject(new je,n);i=e.updateCredentialCacheKey(t,s);return void e.addTokenKey(i,x.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}if(e.isAccountKey(t)&&(r=e.getItem(t))){var c=e.validateAndParseJson(r);c&&Ie.isAccountEntity(c)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}}))},r.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},r.prototype.getItem=function(e){return this.browserStorage.getItem(e)},r.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},r.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var r=this.validateAndParseJson(t);return r&&Ie.isAccountEntity(r)?Ee.toObject(new Ie,r):(this.removeAccountKeyFromMap(e),null)},r.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},r.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(vt.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},r.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(vt.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},r.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(vt.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},r.prototype.removeAccount=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(r){return t.prototype.removeAccount.call(this,e),this.removeAccountKeyFromMap(e),[2]}))}))},r.prototype.removeIdToken=function(e){t.prototype.removeIdToken.call(this,e),this.removeTokenKey(e,x.ID_TOKEN)},r.prototype.removeAccessToken=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(r){return t.prototype.removeAccessToken.call(this,e),this.removeTokenKey(e,x.ACCESS_TOKEN),[2]}))}))},r.prototype.removeRefreshToken=function(e){t.prototype.removeRefreshToken.call(this,e),this.removeTokenKey(e,x.REFRESH_TOKEN)},r.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(vt.TOKEN_KEYS+"."+this.clientId);if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},r.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var r=this.getTokenKeys();switch(t){case x.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case x.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case x.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),ue.createUnexpectedCredentialTypeError()}this.setItem(vt.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},r.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var r=this.getTokenKeys();switch(t){case x.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case x.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map");var o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case x.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map");var i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),ue.createUnexpectedCredentialTypeError()}this.setItem(vt.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},r.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,x.ID_TOKEN),null;var r=this.validateAndParseJson(t);return r&&Ke.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Ee.toObject(new Ke,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,x.ID_TOKEN),null)},r.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,x.ID_TOKEN)},r.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,x.ACCESS_TOKEN),null;var r=this.validateAndParseJson(t);return r&&Ge.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Ee.toObject(new Ge,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,x.ACCESS_TOKEN),null)},r.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,x.ACCESS_TOKEN)},r.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,x.REFRESH_TOKEN),null;var r=this.validateAndParseJson(t);return r&&je.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Ee.toObject(new je,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,x.REFRESH_TOKEN),null)},r.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,x.REFRESH_TOKEN)},r.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&rt.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Ee.toObject(new rt,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},r.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},r.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&St.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Ee.toObject(new St,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},r.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},r.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&ht.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Ee.toObject(new ht,r)):null},r.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},r.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(yt.WRAPPER_SKU,e),this.internalStorage.setItem(yt.WRAPPER_VER,t)},r.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(yt.WRAPPER_SKU)||A.EMPTY_STRING,this.internalStorage.getItem(yt.WRAPPER_VER)||A.EMPTY_STRING]},r.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},r.prototype.getActiveAccount=function(){var e=this.generateCacheKey(E.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var r=this.generateCacheKey(E.ACTIVE_ACCOUNT),n=this.getItem(r);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var o=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o),o):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},r.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(E.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(E.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)},r.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},r.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var n=r.idTokenClaims&&r.idTokenClaims.sid;return t===n}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw ue.createMultipleMatchingAccountsInCacheError();return null},r.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&bt.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Ee.toObject(new bt,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},r.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},r.prototype.getTemporaryCache=function(t,r){var n=r?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var o=this.getItemCookie(n);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}var i=this.temporaryCacheStorage.getItem(n);if(!i){if(this.cacheConfig.cacheLocation===e.BrowserCacheLocation.LocalStorage){var a=this.browserStorage.getItem(n);if(a)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),a}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i},r.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},r.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},r.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},r.prototype.getKeys=function(){return f(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},r.prototype.clear=function(){return h(this,void 0,void 0,(function(){var e=this;return p(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(A.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},r.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},r.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return A.EMPTY_STRING},r.prototype.clearMsalCookies=function(){var e=this,t=A.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},r.prototype.clearItemCookie=function(e){this.setItemCookie(e,A.EMPTY_STRING,-1)},r.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},r.prototype.getCache=function(){return this.browserStorage},r.prototype.setCache=function(){},r.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):le.startsWith(e,A.CACHE_PREFIX)||le.startsWith(e,E.ADAL_ID_TOKEN)?e:A.CACHE_PREFIX+"."+this.clientId+"."+e},r.prototype.generateAuthorityKey=function(e){var t=Je.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(mt.AUTHORITY+"."+t)},r.prototype.generateNonceKey=function(e){var t=Je.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(mt.NONCE_IDTOKEN+"."+t)},r.prototype.generateStateKey=function(e){var t=Je.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(mt.REQUEST_STATE+"."+t)},r.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},r.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){var c={credential:o.homeAccountId,type:Me.HOME_ACCOUNT_ID};this.setTemporaryCache(mt.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!le.isEmpty(n)){c={credential:n,type:Me.UPN};this.setTemporaryCache(mt.CCS_CREDENTIAL,JSON.stringify(c),!0)}},r.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),le.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(mt.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(mt.ORIGIN_URI)),this.removeItem(this.generateCacheKey(mt.URL_HASH)),this.removeItem(this.generateCacheKey(mt.CORRELATION_ID)),this.removeItem(this.generateCacheKey(mt.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(mt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},r.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||A.EMPTY_STRING)}this.clearMsalCookies()},r.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(mt.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=ar.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},r.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(mt.REQUEST_PARAMS,r,!0)},r.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(mt.REQUEST_PARAMS,!0);if(!r)throw Bt.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw Bt.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(mt.REQUEST_PARAMS)),le.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Bt.createNoCachedAuthorityError();n.authority=i}return n},r.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(mt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},r.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},r.prototype.getInteractionInProgress=function(){var e=A.CACHE_PREFIX+"."+mt.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},r.prototype.setInteractionInProgress=function(e){var t=A.CACHE_PREFIX+"."+mt.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw Bt.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},r.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(E.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(E.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(E.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(E.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new we(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},r.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},r.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(mt.REDIRECT_CONTEXT,!0)},r.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(mt.REDIRECT_CONTEXT,e,!0)},r}(Ee),cr="@azure/msal-browser",ur="2.37.0",lr=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return h(this,void 0,void 0,(function(){var r,n,o;return p(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:ft.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?Bt.createGetRequestFailedError(n,e):Bt.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),Bt.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return h(this,void 0,void 0,(function(){var r,n,o,i;return p(this,(function(a){switch(a.label){case 0:r=t&&t.body||A.EMPTY_STRING,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:ft.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=a.sent(),[3,4];case 3:throw o=a.sent(),window.navigator.onLine?Bt.createPostRequestFailedError(o,e):Bt.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=a.sent(),i.status=n.status,i)];case 6:throw a.sent(),Bt.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),dr=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,this.sendRequestAsync(e,ft.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,this.sendRequestAsync(e,ft.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&(t===ft.POST?i(Bt.createPostRequestFailedError("Failed with status "+a.status,e)):i(Bt.createGetRequestFailedError("Failed with status "+a.status,e)));try{var r=JSON.parse(a.responseText),s={headers:n.getHeaderDict(a),body:r,status:a.status};o(s)}catch(t){i(Bt.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===ft.POST?i(Bt.createPostRequestFailedError("Failed with status "+a.status,e)):i(Bt.createGetRequestFailedError("Failed with status "+a.status,e)):i(Bt.createNoNetworkConnectivityError())},t===ft.POST&&r&&r.body)a.send(r.body);else{if(t!==ft.GET)throw Bt.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),hr=function(){function t(){}return t.clearHash=function(e){e.location.hash=A.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,A.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},t.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):A.EMPTY_STRING},t.isInIframe=function(){return window.parent!==window},t.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(Kt+".")},t.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},t.getHomepage=function(){var e=new Xe(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},t.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new lr:new dr},t.blockReloadInHiddenIframes=function(){if(Xe.hashContainsKnownProperties(window.location.hash)&&t.isInIframe())throw Bt.createBlockReloadInHiddenIframeError()},t.blockRedirectInIframe=function(r,n){var o=t.isInIframe();if(r===e.InteractionType.Redirect&&o&&!n)throw Bt.createRedirectInIframeError(o)},t.blockAcquireTokenInPopups=function(){if(t.isInPopup())throw Bt.createBlockAcquireTokenInPopupsError()},t.blockNonBrowserEnvironment=function(e){if(!e)throw Bt.createNonBrowserEnvironmentError()},t.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw Bt.createNativeBrokerCalledBeforeInitialize()},t.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},t}(),pr=function(){function t(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=n.clone(Gt,ur,this.correlationId),this.performanceClient=a}return t.prototype.clearCacheOnLogout=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];Ie.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Ie.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},t.prototype.initializeBaseRequest=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i;return p(this,(function(a){switch(a.label){case 0:if(this.performanceClient.addQueueMeasurement(xe.InitializeBaseRequest,t.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),r=t.authority||this.config.auth.authority,n=f(t&&t.scopes||[]),(o=l(l({},t),{correlationId:this.correlationId,authority:r,scopes:n})).authenticationScheme){if(o.authenticationScheme===e.AuthenticationScheme.SSH){if(!t.sshJwk)throw ve.createMissingSshJwkError();if(!t.sshKid)throw ve.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+o.authenticationScheme+'" as configured in Auth request')}else o.authenticationScheme=e.AuthenticationScheme.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!t.claims||le.isEmpty(t.claims)?[3,2]:(i=o,[4,this.browserCrypto.hashString(t.claims)]);case 1:i.requestedClaimsHash=a.sent(),a.label=2;case 2:return[2,o]}}))}))},t.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||hr.getCurrentUri();return Xe.getAbsoluteUrl(t,hr.getCurrentUri())},t.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ot(r,this.browserStorage)},t.prototype.getDiscoveredAuthority=function(e){return h(this,void 0,void 0,(function(){var t;return p(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,kt.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,kt.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}}))}))},t}(),gr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return h(this,void 0,void 0,(function(){var t,r;return p(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(xe.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=l(l({},e),{redirectUri:e.redirectUri,code:A.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=A.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=l({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Xe.getAbsoluteUrl(e.postLogoutRedirectUri,hr.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Xe.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,hr.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Xe.getAbsoluteUrl(hr.getCurrentUri(),hr.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return h(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(xe.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new it(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return h(this,void 0,void 0,(function(){var n,o;return p(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(xe.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=i.sent(),o=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Gt,version:ur,cpu:A.EMPTY_STRING,os:A.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw Bt.createHashDoesNotContainStateError();var n=ar.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw Bt.createUnableToParseStateError();if(n.interactionType!==t)throw Bt.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return h(this,void 0,void 0,(function(){var n,o,i,a;return p(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(xe.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(xe.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,a=Et.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(xe.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,kt.createDiscoveredInstance(a,this.config.system.networkClient,this.browserStorage,o,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,s.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return p(this,(function(u){switch(u.label){case 0:return this.performanceClient.addQueueMeasurement(xe.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=Je.setRequestState(this.browserCrypto,e&&e.state||A.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(xe.InitializeBaseRequest,this.correlationId),a=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=l.apply(void 0,[l.apply(void 0,a.concat([u.sent()])),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:M.FRAGMENT}]),(s=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+s.homeAccountId,this.correlationId),i.account=s),le.isEmpty(i.loginHint)&&!s&&(c=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=c),[2,i]}}))}))},t}(pr),fr=function(){function e(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return h(this,void 0,void 0,(function(){var o,i,a;return p(this,(function(s){if(this.performanceClient.addQueueMeasurement(xe.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),le.isEmpty(e))throw Bt.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw ue.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,i)}catch(e){throw e instanceof Oe&&e.subError===Lt.userCancelledError.code?Bt.createUserCancelledError():e}return this.performanceClient.setPreQueueTime(xe.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(a,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,o){return void 0===o&&(o=!0),h(this,void 0,void 0,(function(){var i,a,s,c,u,l;return p(this,(function(d){switch(d.label){case 0:if(this.performanceClient.addQueueMeasurement(xe.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw ue.createStateNotFoundError("Cached State");return s=this.browserStorage.generateNonceKey(a),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(xe.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];case 1:d.sent(),d.label=2;case 2:return o&&(e.nonce=c||void 0),e.state=a,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),this.performanceClient.setPreQueueTime(xe.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return l=d.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return h(this,void 0,void 0,(function(){var n,o;return p(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(xe.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,kt.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(mt.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),mr=function(t){function r(e,r,n,o,i,a){var s=t.call(this,e,r,n,o,a)||this;return s.browserCrypto=i,s}return u(r,t),r.prototype.initiateAuthRequest=function(t,r){return h(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),le.isEmpty(t)?[3,7]:(r.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(mt.ORIGIN_URI,r.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(mt.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),n={apiId:e.ApiId.acquireTokenRedirect,timeout:r.redirectTimeout,noHistory:!1},"function"!=typeof r.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===r.onRedirectNavigate(t)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,r.navigationClient.navigateExternal(t,n)])));case 1:case 5:return o.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,r.navigationClient.navigateExternal(t,n)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Bt.createEmptyNavigationUriError();case 8:return[2]}}))}))},r.prototype.handleCodeResponseFromHash=function(e,t,r,n){return h(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return p(this,(function(d){switch(d.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),le.isEmpty(e))throw Bt.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw ue.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,i)}catch(e){throw e instanceof Oe&&e.subError===Lt.userCancelledError.code?Bt.createUserCancelledError():e}return s=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:d.sent(),d.label=2;case 2:return a.nonce=c||void 0,a.state=i,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return l=d.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},r}(fr);
/*! @azure/msal-browser v2.37.0 2023-05-02 */
e.EventType=void 0,(er=e.EventType||(e.EventType={})).INITIALIZE_START="msal:initializeStart",er.INITIALIZE_END="msal:initializeEnd",er.ACCOUNT_ADDED="msal:accountAdded",er.ACCOUNT_REMOVED="msal:accountRemoved",er.LOGIN_START="msal:loginStart",er.LOGIN_SUCCESS="msal:loginSuccess",er.LOGIN_FAILURE="msal:loginFailure",er.ACQUIRE_TOKEN_START="msal:acquireTokenStart",er.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",er.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",er.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",er.SSO_SILENT_START="msal:ssoSilentStart",er.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",er.SSO_SILENT_FAILURE="msal:ssoSilentFailure",er.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",er.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",er.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",er.HANDLE_REDIRECT_START="msal:handleRedirectStart",er.HANDLE_REDIRECT_END="msal:handleRedirectEnd",er.POPUP_OPENED="msal:popupOpened",er.LOGOUT_START="msal:logoutStart",er.LOGOUT_SUCCESS="msal:logoutSuccess",er.LOGOUT_FAILURE="msal:logoutFailure",er.LOGOUT_END="msal:logoutEnd",function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(tr||(tr={}));var vr={code:"ContentError"},yr={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Cr={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},Tr=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=o,i}return u(t,e),t.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==tr.PERSISTENT_ERROR&&this.ext.status!==tr.DISABLED)||this.errorCode===vr.code},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case tr.ACCOUNT_UNAVAILABLE:return Ye.createNativeAccountUnavailableError();case tr.USER_INTERACTION_REQUIRED:return new Ye(e,r);case tr.USER_CANCEL:return Bt.createUserCancelledError();case tr.NO_NETWORK:return Bt.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(yr.code,yr.desc)},t.createTokensNotFoundInCacheError=function(){return new t(Cr.code,Cr.desc)},t}(ae),Ir=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return u(r,t),r.prototype.acquireToken=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a;return p(this,(function(s){switch(s.label){case 0:return r=this.performanceClient.startMeasurement(xe.SilentCacheClientAcquireToken,t.correlationId),n=this.initializeServerTelemetryManager(e.ApiId.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(n,t.authority,t.azureCloudOptions)];case 1:o=s.sent(),this.logger.verbose("Silent auth client created"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,o.acquireCachedToken(t)];case 3:return i=s.sent(),r.endMeasurement({success:!0,fromCache:!0}),[2,i];case 4:throw(a=s.sent())instanceof Bt&&a.errorCode===Lt.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r.endMeasurement({errorCode:a instanceof ae&&a.errorCode||void 0,subErrorCode:a instanceof ae&&a.subError||void 0,success:!1}),a;case 5:return[2]}}))}))},r.prototype.logout=function(){return Promise.reject(Bt.createSilentLogoutUnsupportedError())},r.prototype.createSilentFlowClient=function(e,t,r){return h(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(xe.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new st(n,this.performanceClient)]}}))}))},r.prototype.initializeSilentRequest=function(e,t){return h(this,void 0,void 0,(function(){var r;return p(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(xe.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(xe.InitializeBaseRequest,this.correlationId),r=[l({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,l.apply(void 0,[l.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},r}(gr),wr=function(t){function r(e,r,n,o,i,a,s,c,u,l,d,h){var p=t.call(this,e,r,n,o,i,a,c,u,h)||this;return p.apiId=s,p.accountId=l,p.nativeMessageHandler=u,p.nativeStorageManager=d,p.silentCacheClient=new Ir(e,p.nativeStorageManager,n,o,i,a,c,u,h),p}return u(r,t),r.prototype.acquireToken=function(e){return h(this,void 0,void 0,(function(){var t,r,n,o,i,a,s;return p(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(xe.NativeInteractionClientAcquireToken,e.correlationId),r=ze.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return o=c.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,o];case 4:return c.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:pt.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return a=c.sent(),s=this.validateNativeResponse(a),[2,this.handleNativeResponse(s,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},r.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:ye.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},r.prototype.acquireTokensFromCache=function(e,t){return h(this,void 0,void 0,(function(){var r,n;return p(this,(function(o){switch(o.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ue.createNoAccountFoundError();if(!(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw ue.createNoAccountFoundError();o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.createSilentCacheRequest(t,r),[4,this.silentCacheClient.acquireToken(n)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}}))}))},r.prototype.acquireTokenRedirect=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s;return p(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:r=c.sent(),n={method:pt.GetToken,request:r},c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(n)];case 3:return o=c.sent(),this.validateNativeResponse(o),[3,5];case 4:if((i=c.sent())instanceof Tr&&i.isFatal())throw i;return[3,5];case 5:return this.browserStorage.setTemporaryCache(mt.NATIVE_REQUEST,JSON.stringify(r),!0),a={apiId:e.ApiId.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(s,a)];case 6:return c.sent(),[2]}}))}))},r.prototype.handleRedirectPromise=function(){return h(this,void 0,void 0,(function(){var e,t,r,n,o,i,a,s;return p(this,(function(c){switch(c.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,r=d(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(mt.NATIVE_REQUEST)),n={method:pt.GetToken,request:r},o=ze.nowSeconds(),c.label=1;case 1:return c.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return i=c.sent(),this.validateNativeResponse(i),a=this.handleNativeResponse(i,r,o),this.browserStorage.setInteractionInProgress(!1),[2,a];case 3:throw s=c.sent(),this.browserStorage.setInteractionInProgress(!1),s;case 4:return[2]}}))}))},r.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},r.prototype.handleNativeResponse=function(e,t,r){return h(this,void 0,void 0,(function(){var n,o,i,a,s,c;return p(this,(function(u){switch(u.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw Tr.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return n=u.sent(),o=n.getPreferredCache(),i=this.createIdTokenObj(e),a=this.createHomeAccountIdentifier(e,i),s=this.createAccountEntity(e,a,i,o),[4,this.generateAuthenticationResult(e,t,i,s,n.canonicalAuthority,r)];case 2:return c=u.sent(),this.cacheAccount(s),this.cacheNativeTokens(e,t,a,i,c.accessToken,c.tenantId,r),[2,c]}}))}))},r.prototype.createIdTokenObj=function(e){return new we(e.id_token||A.EMPTY_STRING,this.browserCrypto)},r.prototype.createHomeAccountIdentifier=function(e,t){return Ie.generateHomeAccountId(e.client_info||A.EMPTY_STRING,fe.Default,this.logger,this.browserCrypto,t)},r.prototype.createAccountEntity=function(e,t,r,n){return Ie.createAccount(e.client_info,t,r,void 0,void 0,void 0,n,e.account.id)},r.prototype.generateScopes=function(e,t){return e.scope?ye.fromString(e.scope):ye.fromString(t.scope)},r.prototype.generatePopAccessToken=function(t,r){return h(this,void 0,void 0,(function(){var n,o;return p(this,(function(i){switch(i.label){case 0:if(r.tokenType!==e.AuthenticationScheme.POP)return[3,2];if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,t.shr];if(n=new tt(this.browserCrypto),o={resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce},!r.keyId)throw ue.createKeyIdMissingError();return[4,n.signPopToken(t.access_token,r.keyId,o)];case 1:return[2,i.sent()];case 2:return[2,t.access_token]}}))}))},r.prototype.generateAuthenticationResult=function(t,r,n,o,i,a){return h(this,void 0,void 0,(function(){var s,c,u,l,d,h,g;return p(this,(function(p){switch(p.label){case 0:return s=this.addTelemetryFromNativeResponse(t),c=t.scope?ye.fromString(t.scope):ye.fromString(r.scope),u=t.account.properties||{},l=u.UID||n.claims.oid||n.claims.sub||A.EMPTY_STRING,d=u.TenantId||n.claims.tid||A.EMPTY_STRING,[4,this.generatePopAccessToken(t,r)];case 1:return h=p.sent(),g=r.tokenType===e.AuthenticationScheme.POP?e.AuthenticationScheme.POP:e.AuthenticationScheme.BEARER,[2,{authority:i,uniqueId:l,tenantId:d,scopes:c.asArray(),account:o.getAccountInfo(),idToken:t.id_token,idTokenClaims:n.claims,accessToken:h,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(a+t.expires_in)),tokenType:g,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0}]}}))}))},r.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},r.prototype.cacheNativeTokens=function(t,r,n,o,i,a,s){var c=Ke.createIdTokenEntity(n,r.authority,t.id_token||A.EMPTY_STRING,r.clientId,o.claims.tid||A.EMPTY_STRING);this.nativeStorageManager.setIdTokenCredential(c);var u=s+(r.tokenType===e.AuthenticationScheme.POP?A.SHR_NONCE_VALIDITY:("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0),l=this.generateScopes(t,r),d=Ge.createAccessTokenEntity(n,r.authority,i,r.clientId,a,l.printScopes(),u,0,this.browserCrypto);this.nativeStorageManager.setAccessTokenCredential(d)},r.prototype.addTelemetryFromNativeResponse=function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null},r.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Tr.createUnexpectedError("Response missing expected properties.")},r.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},r.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},r.prototype.initializeNativeRequest=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,h,g=this;return p(this,(function(p){switch(p.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),r=t.authority||this.config.auth.authority,(n=new Xe(r)).validateAsUri(),o=t.scopes,i=d(t,["scopes"]),(a=new ye(o||[])).appendScopes(_),s=function(){switch(g.apiId){case e.ApiId.ssoSilent:case e.ApiId.acquireTokenSilent_silentFlow:return g.logger.trace("initializeNativeRequest: silent request sets prompt to none"),N.NONE}if(t.prompt)switch(t.prompt){case N.NONE:case N.CONSENT:case N.LOGIN:return g.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw g.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),Bt.createNativePromptParameterNotSupportedError()}else g.logger.trace("initializeNativeRequest: prompt was not provided")},c=l(l({},i),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:l(l(l({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:Wt}),extendedExpiryToken:!1}),t.authenticationScheme!==e.AuthenticationScheme.POP?[3,2]:(u={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},[4,new tt(this.browserCrypto).generateCnf(u)]);case 1:h=p.sent(),c.reqCnf=h.reqCnfHash,c.keyId=h.kid,p.label=2;case 2:return[2,c]}}))}))},r}(pr),Er=function(){function t(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(xe.NativeMessageHandlerHandshake)}return t.prototype.sendMessage=function(e){return h(this,void 0,void 0,(function(){var t,r=this;return p(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:jt,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},t.createProvider=function(e,r,n){return h(this,void 0,void 0,(function(){var o,i;return p(this,(function(a){switch(a.label){case 0:e.trace("NativeMessageHandler - createProvider called."),a.label=1;case 1:return a.trys.push([1,3,,5]),[4,(o=new t(e,r,n,Qt)).sendHandshakeRequest()];case 2:return a.sent(),[2,o];case 3:return a.sent(),[4,(i=new t(e,r,n)).sendHandshakeRequest()];case 4:return a.sent(),[2,i];case 5:return[2]}}))}))},t.prototype.sendHandshakeRequest=function(){return h(this,void 0,void 0,(function(){var e,t=this;return p(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:jt,extensionId:this.extensionId,responseId:this.responseId++,body:{method:pt.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(Bt.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},t.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===jt&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===pt.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),r.reject(Bt.createNativeExtensionNotInstalledError()))}}},t.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if(o===pt.Response){if(!r)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(i)),"Success"!==i.status)r.reject(Tr.createError(i.code,i.description,i.ext));else{if(!i.result)throw ae.createUnexpectedError("Event does not contain result.");i.result.code&&i.result.description?r.reject(Tr.createError(i.result.code,i.result.description,i.result.ext)):r.resolve(i.result)}this.resolvers.delete(t.responseId)}else if(o===pt.HandshakeResponse){if(!n)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+t.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(t):n&&n.reject(t)}},t.prototype.getExtensionId=function(){return this.extensionId},t.prototype.getExtensionVersion=function(){return this.extensionVersion},t.isNativeAvailable=function(t,r,n,o){if(r.trace("isNativeAvailable called"),!t.system.allowNativeBroker)return r.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return r.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case e.AuthenticationScheme.BEARER:case e.AuthenticationScheme.POP:return r.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return r.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},t}(),kr=function(t){function r(e,r,n,o,i,a,s,c,u,l){var d=t.call(this,e,r,n,o,i,a,s,u,l)||this;return d.nativeStorage=c,d}return u(r,t),r.prototype.acquireToken=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,d,h=this;return p(this,(function(p){switch(p.label){case 0:return this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,e.InteractionType.Redirect)];case 1:r=p.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||A.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(e.ApiId.acquireTokenRedirect),o=function(e){e.persisted&&(h.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),h.browserStorage.cleanRequestByState(r.state))},p.label=2;case 2:return p.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(r)];case 3:return i=p.sent(),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 4:return a=p.sent(),this.logger.verbose("Auth code client created"),s=new mr(a,this.browserStorage,i,this.logger,this.browserCrypto,this.performanceClient),[4,a.getAuthCodeUrl(l(l({},r),{nativeBroker:Er.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return c=p.sent(),u=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+u),window.addEventListener("pageshow",o),[4,s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,p.sent()];case 7:throw(d=p.sent())instanceof ae&&d.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",o),n.cacheFailedRequest(d),this.browserStorage.cleanRequestByState(r.state),d;case 8:return[2]}}))}))},r.prototype.handleRedirectPromise=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l,d,h,g;return p(this,(function(p){switch(p.label){case 0:r=this.initializeServerTelemetryManager(e.ApiId.handleRedirectPromise),p.label=1;case 1:if(p.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(n=this.getRedirectResponseHash(t||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect),[2,null];o=void 0;try{i=Xe.getDeserializedHash(n),o=this.validateAndExtractStateFromHash(i,e.InteractionType.Redirect),this.logger.verbose("State extracted from hash")}catch(t){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+t),this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect),[2,null]}return a=this.browserStorage.getTemporaryCache(mt.ORIGIN_URI,!0)||A.EMPTY_STRING,s=Xe.removeHashFromUrl(a),c=Xe.removeHashFromUrl(window.location.href),s===c&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(n,o,r)]):[3,3];case 2:return u=p.sent(),a.indexOf("#")>-1&&hr.replaceHash(a),[2,u];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(n,o,r)]);case 4:return hr.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(mt.URL_HASH,n,!0),l={apiId:e.ApiId.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},d=!0,a&&"null"!==a?[3,6]:(h=hr.getHomepage(),this.browserStorage.setTemporaryCache(mt.ORIGIN_URI,h,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(h,l)]));case 5:return d=p.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+a),[4,this.navigationClient.navigateInternal(a,l)];case 7:d=p.sent(),p.label=8;case 8:if(!d)return[2,this.handleHash(n,o,r)];p.label=9;case 9:return[2,null];case 10:throw(g=p.sent())instanceof ae&&g.setCorrelationId(this.correlationId),r.cacheFailedRequest(g),this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect),g;case 11:return[2]}}))}))},r.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),Xe.hashContainsKnownProperties(e))return hr.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(mt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(mt.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},r.prototype.handleHash=function(t,r,n){return h(this,void 0,void 0,(function(){var o,i,a,s,c,u,d=this;return p(this,(function(h){switch(h.label){case 0:if(o=this.browserStorage.getCachedRequest(r,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(i=Xe.getDeserializedHash(t)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Bt.createNativeConnectionNotEstablishedError();return a=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,i.accountId,this.browserStorage,o.correlationId),s=Je.parseRequestState(this.browserCrypto,r).userRequestState,[2,a.acquireToken(l(l({},o),{state:s,prompt:void 0})).finally((function(){d.browserStorage.cleanRequestByState(r)}))]}if(!(c=this.browserStorage.getCachedAuthority(r)))throw Bt.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(xe.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(n,c)];case 1:return u=h.sent(),this.logger.verbose("Auth code client created"),qe.removeThrottle(this.browserStorage,this.config.auth.clientId,o),[4,new mr(u,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(t,r,u.authority,this.networkClient)];case 2:return[2,h.sent()]}}))}))},r.prototype.logout=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s;return p(this,(function(c){switch(c.label){case 0:this.logger.verbose("logoutRedirect called"),r=this.initializeLogoutRequest(t),n=this.initializeServerTelemetryManager(e.ApiId.logout),c.label=1;case 1:return c.trys.push([1,10,,11]),this.eventHandler.emitEvent(e.EventType.LOGOUT_START,e.InteractionType.Redirect,t),[4,this.clearCacheOnLogout(r.account)];case 2:return c.sent(),o={apiId:e.ApiId.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(xe.StandardInteractionClientCreateAuthCodeClient,r.correlationId),[4,this.createAuthCodeClient(n,t&&t.authority)];case 3:return i=c.sent(),this.logger.verbose("Auth code client created"),a=i.getLogoutUri(r),this.eventHandler.emitEvent(e.EventType.LOGOUT_SUCCESS,e.InteractionType.Redirect,r),t&&"function"==typeof t.onRedirectNavigate?!1===t.onRedirectNavigate(a)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(a,o)]):[3,7];case 4:return c.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),c.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(a,o)];case 8:return c.sent(),[2];case 9:return[3,11];case 10:throw(s=c.sent())instanceof ae&&s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s),this.eventHandler.emitEvent(e.EventType.LOGOUT_FAILURE,e.InteractionType.Redirect,null,s),this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Redirect),s;case 11:return this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Redirect),[2]}}))}))},r.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return Xe.getAbsoluteUrl(t,hr.getCurrentUri())},r}(gr),Sr=function(t){function r(e,r,n,o,i,a,s,c,u,l){var d=t.call(this,e,r,n,o,i,a,s,u,l)||this;return d.unloadWindow=d.unloadWindow.bind(d),d.nativeStorage=c,d}return u(r,t),r.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||_,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}catch(e){return Promise.reject(e)}},r.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var a=this.openSizedPopup("about:blank",r,i);return this.logoutPopupAsync(t,r,i,n,a,o)}catch(e){return Promise.reject(e)}},r.prototype.acquireTokenPopupAsync=function(t,r,n,o){return h(this,void 0,void 0,(function(){var i,a,s,c,u,d,h,g,f,m,v,y,C,T,I,w,E=this;return p(this,(function(p){switch(p.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),i=this.initializeServerTelemetryManager(e.ApiId.acquireTokenPopup),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,e.InteractionType.Popup)];case 1:a=p.sent(),this.browserStorage.updateCacheEntries(a.state,a.nonce,a.authority,a.loginHint||A.EMPTY_STRING,a.account||null),p.label=2;case 2:return p.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(a)];case 3:return s=p.sent(),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(i,a.authority,a.azureCloudOptions)];case 4:return c=p.sent(),this.logger.verbose("Auth code client created"),u=Er.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),d=void 0,u&&(d=this.performanceClient.startMeasurement(xe.FetchAccountIdWithNativeBroker,t.correlationId)),[4,c.getAuthCodeUrl(l(l({},a),{nativeBroker:u}))];case 5:return h=p.sent(),g=new fr(c,this.browserStorage,s,this.logger,this.performanceClient),f={popup:o,popupName:r,popupWindowAttributes:n},m=this.initiateAuthRequest(h,f),this.eventHandler.emitEvent(e.EventType.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:m},null),[4,this.monitorPopupForHash(m)];case 6:if(v=p.sent(),y=Xe.getDeserializedHash(v),C=this.validateAndExtractStateFromHash(y,e.InteractionType.Popup,a.correlationId),qe.removeThrottle(this.browserStorage,this.config.auth.clientId,s),y.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),d&&d.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Bt.createNativeConnectionNotEstablishedError();return T=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,y.accountId,this.nativeStorage,a.correlationId),I=Je.parseRequestState(this.browserCrypto,C).userRequestState,[2,T.acquireToken(l(l({},a),{state:I,prompt:void 0})).finally((function(){E.browserStorage.cleanRequestByState(C)}))]}return[4,g.handleCodeResponseFromHash(v,C,c.authority,this.networkClient)];case 7:return[2,p.sent()];case 8:throw w=p.sent(),o&&o.close(),w instanceof ae&&w.setCorrelationId(this.correlationId),i.cacheFailedRequest(w),this.browserStorage.cleanRequestByState(a.state),w;case 9:return[2]}}))}))},r.prototype.logoutPopupAsync=function(t,r,n,o,i,a){return h(this,void 0,void 0,(function(){var s,c,u,l,d,h,g;return p(this,(function(p){switch(p.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(e.EventType.LOGOUT_START,e.InteractionType.Popup,t),s=this.initializeServerTelemetryManager(e.ApiId.logoutPopup),p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return p.sent(),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,o)];case 3:return c=p.sent(),this.logger.verbose("Auth code client created"),u=c.getLogoutUri(t),this.eventHandler.emitEvent(e.EventType.LOGOUT_SUCCESS,e.InteractionType.Popup,t),l=this.openPopup(u,{popupName:r,popupWindowAttributes:n,popup:i}),this.eventHandler.emitEvent(e.EventType.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:l},null),[4,this.waitForLogoutPopup(l)];case 4:return p.sent(),a?(d={apiId:e.ApiId.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},h=Xe.getAbsoluteUrl(a,hr.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+h),this.navigationClient.navigateInternal(h,d)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw g=p.sent(),i&&i.close(),g instanceof ae&&g.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(e.EventType.LOGOUT_FAILURE,e.InteractionType.Popup,null,g),this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Popup),s.cacheFailedRequest(g),g;case 6:return this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Popup),[2]}}))}))},r.prototype.initiateAuthRequest=function(e,t){if(le.isEmpty(e))throw this.logger.error("Navigate url is empty"),Bt.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},r.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var o=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,i=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var a=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(a),void n(Bt.createUserCancelledError());var s=A.EMPTY_STRING,c=A.EMPTY_STRING;try{s=e.location.href,c=e.location.hash}catch(e){}le.isEmpty(s)||"about:blank"===s||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i++,c?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(a),t.cleanPopup(e),Xe.hashContainsKnownProperties(c)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(c)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+c),n(Bt.createHashDoesNotContainKnownPropertiesError()))):i>o&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(a),n(Bt.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},r.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var o=A.EMPTY_STRING;try{o=e.location.href}catch(e){}le.isEmpty(o)||"about:blank"===o||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},r.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw Bt.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),Bt.createPopupWindowError(e.toString())}},r.prototype.openSizedPopup=function(e,t,r){var n,o,i,a,s=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,d=null===(n=r.popupSize)||void 0===n?void 0:n.width,h=null===(o=r.popupSize)||void 0===o?void 0:o.height,p=null===(i=r.popupPosition)||void 0===i?void 0:i.top,g=null===(a=r.popupPosition)||void 0===a?void 0:a.left;return(!d||d<0||d>u)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),d=Dt),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=Ft),(!p||p<0||p>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,l/2-Ft/2+c)),(!g||g<0||g>u)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),g=Math.max(0,u/2-Dt/2+s)),window.open(e,t,"width="+d+", height="+h+", top="+p+", left="+g+", scrollbars=yes")},r.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},r.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},r.prototype.generatePopupName=function(e,t){return Kt+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},r.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return Kt+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},r}(gr),br=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),Ar=6e3;
/*! @azure/msal-browser v2.37.0 2023-05-02 */
var _r,Rr=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r,n,o,a)||this;return s.navigateFrameWait=i.navigateFrameWait,s.pollIntervalMilliseconds=i.pollIntervalMilliseconds,s}return u(t,e),t.prototype.initiateAuthRequest=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(xe.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),le.isEmpty(e))throw this.logger.info("Navigate url is empty"),Bt.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(xe.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(xe.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,o){t<Ar&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Ar+"ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(Bt.createMonitorIframeTimeoutError());var t=A.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:A.EMPTY_STRING}catch(e){}if(!le.isEmpty(t)){var c=s?s.location.hash:A.EMPTY_STRING;return Xe.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(xe.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(fr),Pr=function(t){function r(e,r,n,o,i,a,s,c,u,l,d){var h=t.call(this,e,r,n,o,i,a,c,l,d)||this;return h.apiId=s,h.nativeStorage=u,h}return u(r,t),r.prototype.acquireToken=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a;return p(this,(function(s){switch(s.label){case 0:if(this.performanceClient.addQueueMeasurement(xe.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),r=this.performanceClient.startMeasurement(xe.SilentIframeClientAcquireToken,t.correlationId),le.isEmpty(t.loginHint)&&le.isEmpty(t.sid)&&(!t.account||le.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==N.NONE&&t.prompt!==N.NO_SESSION)throw r.endMeasurement({success:!1}),Bt.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(l(l({},t),{prompt:t.prompt||N.NONE}),e.InteractionType.Silent)];case 1:n=s.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||A.EMPTY_STRING,n.account||null),o=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(o,n.authority,n.azureCloudOptions)];case 3:return i=s.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(xe.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(i,n).then((function(e){return r.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,s.sent()];case 5:throw(a=s.sent())instanceof ae&&a.setCorrelationId(this.correlationId),o.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(n.state),r.endMeasurement({errorCode:a instanceof ae&&a.errorCode||void 0,subErrorCode:a instanceof ae&&a.subError||void 0,success:!1}),a;case 6:return[2]}}))}))},r.prototype.logout=function(){return Promise.reject(Bt.createSilentLogoutUnsupportedError())},r.prototype.silentTokenHelper=function(t,r){return h(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,d,h,g=this;return p(this,(function(p){switch(p.label){case 0:return this.performanceClient.addQueueMeasurement(xe.SilentIframeClientTokenHelper,r.correlationId),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationCodeRequest,r.correlationId),[4,this.initializeAuthorizationCodeRequest(r)];case 1:return n=p.sent(),this.performanceClient.setPreQueueTime(xe.GetAuthCodeUrl,r.correlationId),[4,t.getAuthCodeUrl(l(l({},r),{nativeBroker:Er.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme)}))];case 2:return o=p.sent(),i=new Rr(t,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(xe.SilentHandlerInitiateAuthRequest,r.correlationId),[4,i.initiateAuthRequest(o)];case 3:return a=p.sent(),this.performanceClient.setPreQueueTime(xe.SilentHandlerMonitorIframeForHash,r.correlationId),[4,i.monitorIframeForHash(a,this.config.system.iframeHashTimeout)];case 4:if(s=p.sent(),c=Xe.getDeserializedHash(s),u=this.validateAndExtractStateFromHash(c,e.InteractionType.Silent,n.correlationId),c.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Bt.createNativeConnectionNotEstablishedError();return d=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,c.accountId,this.browserStorage,this.correlationId),h=Je.parseRequestState(this.browserCrypto,u).userRequestState,[2,d.acquireToken(l(l({},r),{state:h,prompt:r.prompt||N.NONE})).finally((function(){g.browserStorage.cleanRequestByState(u)}))]}return this.performanceClient.setPreQueueTime(xe.HandleCodeResponseFromHash,r.correlationId),[2,i.handleCodeResponseFromHash(s,u,t.authority,this.networkClient)]}}))}))},r}(gr),Nr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return u(r,t),r.prototype.acquireToken=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s=this;return p(this,(function(c){switch(c.label){case 0:return this.performanceClient.addQueueMeasurement(xe.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime(xe.InitializeBaseRequest,t.correlationId),n=[l({},t)],[4,this.initializeBaseRequest(t)];case 1:return r=l.apply(void 0,n.concat([c.sent()])),o=this.performanceClient.startMeasurement(xe.SilentRefreshClientAcquireToken,r.correlationId),i=this.initializeServerTelemetryManager(e.ApiId.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(i,r.authority,r.azureCloudOptions)];case 2:return a=c.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(xe.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,a.acquireTokenByRefreshToken(r).then((function(e){return o.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof ae&&e.setCorrelationId(s.correlationId),i.cacheFailedRequest(e),o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},r.prototype.logout=function(){return Promise.reject(Bt.createSilentLogoutUnsupportedError())},r.prototype.createRefreshTokenClient=function(e,t,r){return h(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(xe.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new at(n,this.performanceClient)]}}))}))},r}(gr),Mr=function(){function t(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return t.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},t.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},t.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},t.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},t.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},t.prototype.handleAccountCacheChange=function(t){try{var r=t.newValue||t.oldValue;if(!r)return;var n=JSON.parse(r);if("object"!=typeof n||!Ie.isAccountEntity(n))return;var o=Ee.toObject(new Ie,n).getAccountInfo();!t.oldValue&&t.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(e.EventType.ACCOUNT_ADDED,void 0,o)):!t.newValue&&t.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(e.EventType.ACCOUNT_REMOVED,void 0,o))}catch(t){return}},t}(),Or=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),qr=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Or.decimalToHex(e[0])+Or.decimalToHex(e[1])+Or.decimalToHex(e[2])+Or.decimalToHex(e[3])+"-"+Or.decimalToHex(e[4])+Or.decimalToHex(e[5])+"-"+Or.decimalToHex(e[6])+Or.decimalToHex(e[7])+"-"+Or.decimalToHex(e[8])+Or.decimalToHex(e[9])+"-"+Or.decimalToHex(e[10])+Or.decimalToHex(e[11])+Or.decimalToHex(e[12])+Or.decimalToHex(e[13])+Or.decimalToHex(e[14])+Or.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o=A.EMPTY_STRING,i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Ur=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t=A.EMPTY_STRING,r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),xr=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,A.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,A.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Ur.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=A.EMPTY_STRING,n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Lr=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Ur.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,A.EMPTY_STRING),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,l=0;l<n;l++)if(s=3&l,c|=this.b64ToUint6(r.charCodeAt(l))<<18-6*s,3===s||n-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Br=function(){function e(e){this.base64Encode=new xr,this.cryptoObj=e}return e.prototype.generateCodes=function(){return h(this,void 0,void 0,(function(){var e,t;return p(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw Bt.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return h(this,void 0,void 0,(function(){var t,r;return p(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),Bt.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),Hr=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){return[2,window.crypto.subtle.exportKey($t,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return h(this,void 0,void 0,(function(){return p(this,(function(o){return[2,window.crypto.subtle.importKey($t,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),Dr=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(f(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){return[2,window.msrCrypto.subtle.exportKey($t,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return h(this,void 0,void 0,(function(){return p(this,(function(o){return[2,window.msrCrypto.subtle.importKey($t,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),Fr=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.exportKey=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey($t,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Ur.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,A.EMPTY_STRING).replace(/\n/g,A.EMPTY_STRING).replace(/\t/g,A.EMPTY_STRING).split(" ").join(A.EMPTY_STRING).replace("\0",A.EMPTY_STRING);try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return h(this,void 0,void 0,(function(){var o,i;return p(this,(function(a){return o=Ur.getSortedObjectString(e),i=Ur.stringToArrayBuffer(o),[2,new Promise((function(e,o){var a=window.msCrypto.subtle.importKey($t,i,t,r,n);a.addEventListener("complete",(function(t){e(t.target.result)})),a.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.digest=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Kr="SHA-256",zr=new Uint8Array([1,0,1]),Gr=function(){function e(e,t){var r,n;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Hr;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Fr;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),Bt.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new Dr}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),nr.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Kr,modulusLength:2048,publicExponent:zr}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return h(this,void 0,void 0,(function(){var t;return p(this,(function(r){return t=Ur.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Kr},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return h(this,void 0,void 0,(function(){return p(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),jr=function(){function e(){this.dbName=Xt,this.version=1,this.tableName=Zt,this.dbOpen=!1}return e.prototype.open=function(){return h(this,void 0,void 0,(function(){var e=this;return p(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(Bt.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return h(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return h(this,void 0,void 0,(function(){var t=this;return p(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(Bt.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return h(this,void 0,void 0,(function(){var r=this;return p(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!r.db)return o(Bt.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(){r.closeConnection(),n()})),i.addEventListener("error",(function(e){r.closeConnection(),o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return h(this,void 0,void 0,(function(){var t=this;return p(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(Bt.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){t.closeConnection(),r()})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return h(this,void 0,void 0,(function(){var e=this;return p(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(Bt.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){var n=r;e.closeConnection(),t(n.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return h(this,void 0,void 0,(function(){var t=this;return p(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(Bt.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(1===n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return h(this,void 0,void 0,(function(){return p(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(Xt);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Qr=function(){function e(e,t){this.inMemoryCache=new ir,this.indexedDBCache=new jr,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof Bt&&e.errorCode===Lt.databaseUnavailable.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return h(this,void 0,void 0,(function(){var t,r;return p(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return h(this,void 0,void 0,(function(){var r;return p(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return h(this,void 0,void 0,(function(){var t;return p(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return h(this,void 0,void 0,(function(){var e,t;return p(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return h(this,void 0,void 0,(function(){var t,r;return p(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return h(this,void 0,void 0,(function(){var e,t;return p(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();
/*! @azure/msal-browser v2.37.0 2023-05-02 */!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(_r||(_r={}));var Wr=function(){function e(e){this.logger=e,this.asymmetricKeys=new Qr(this.logger,_r.asymmetricKeys),this.symmetricKeys=new Qr(this.logger,_r.symmetricKeys)}return e.prototype.clear=function(){return h(this,void 0,void 0,(function(){var e;return p(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),Vr=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new Gr(this.logger,r),this.b64Encode=new xr,this.b64Decode=new Lr,this.guidGenerator=new qr(this.browserCrypto),this.pkceGenerator=new Br(this.browserCrypto),this.cache=new Wr(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return h(this,void 0,void 0,(function(){return p(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return h(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,l;return p(this,(function(d){switch(d.label){case 0:return n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(xe.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return o=d.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=d.sent(),a={e:i.e,kty:i.kty,n:i.n},s=Ur.getSortedObjectString(a),[4,this.hashString(s)];case 3:return c=d.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return u=d.sent(),[4,this.browserCrypto.importJwk(u,!1,["sign"])];case 5:return l=d.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:l,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return d.sent(),n&&n.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.removeTokenBindingKey=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return h(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return h(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d,h,g,f,m,v;return p(this,(function(p){switch(p.label){case 0:return o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(xe.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(i=p.sent()))throw Bt.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return a=p.sent(),s=Ur.getSortedObjectString(a),c=this.b64Encode.urlEncode(JSON.stringify({kid:t})),u=Nt.getShrHeaderString({kid:c,alg:a.alg}),l=this.b64Encode.urlEncode(u),e.cnf={jwk:JSON.parse(s)},d=this.b64Encode.urlEncode(JSON.stringify(e)),h=l+"."+d,g=Ur.stringToArrayBuffer(h),[4,this.browserCrypto.sign(i.privateKey,g)];case 3:return f=p.sent(),m=this.b64Encode.urlEncodeArr(new Uint8Array(f)),v=h+"."+m,o&&o.endMeasurement({success:!0}),[2,v]}}))}))},e.prototype.hashString=function(e){return h(this,void 0,void 0,(function(){var t,r;return p(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}(),Yr=function(){function e(t,r){this.correlationId=r,this.measureName=e.makeMeasureName(t,r),this.startMark=e.makeStartMark(t,r),this.endMark=e.makeEndMark(t,r)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,r){if(e.supportsBrowserPerformance())try{r.forEach((function(r){var n=e.makeMeasureName(r.name,t);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(e.makeStartMark(n,t)),window.performance.clearMarks(e.makeEndMark(n,t)))}))}catch(e){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(e){}return null},e}(),$r=function(e){function t(t,r,n,o,i,a,s){var c=e.call(this,t,r,n,o,i,a)||this;return c.browserCrypto=new Gr(c.logger,s),c.guidGenerator=new qr(c.browserCrypto),c}return u(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new Yr(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),r=t&&t.eventId===e.event.eventId,n=[];r&&(null==t?void 0:t.incompleteSubMeasurements)&&t.incompleteSubMeasurements.forEach((function(e){n.push(l({},e))})),n.length>0&&Yr.flushMeasurements(e.event.correlationId,n)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,o=this.getPageVisibility(),i=e.prototype.startMeasurement.call(this,t,r);return l(l({},i),{endMeasurement:function(e){var t=i.endMeasurement(l({startPageVisibility:o,endPageVisibility:n.getPageVisibility()},e));return n.deleteIncompleteSubMeasurements(i),t},discardMeasurement:function(){i.discardMeasurement(),n.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+r.name+" found",t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r,n,o){if(this.supportsBrowserPerformanceNow())if(r){var i=e.prototype.getPreQueueTime.call(this,t,r);if(i){var a=window.performance.now(),s=n||e.prototype.calculateQueuedTime.call(this,i,a);return e.prototype.addQueueMeasurement.call(this,t,r,s,o)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(qt),Jr=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw Bt.createUnableToLoadTokenError("Please ensure server response includes id token.");var n,o,i=new we(t.id_token,this.cryptoObj);if(e.account){var a=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new $e(a,this.loadIdToken(i,a.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,a.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,a.homeAccountId,e.account.environment))}else{if(!e.authority)throw Bt.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var s=Et.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(o=new Et(s,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");a=this.loadAccount(i,o.hostnameAndPort,r.clientInfo,o.authorityType);n=new $e(a,this.loadIdToken(i,a.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,a.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,a.homeAccountId,o.hostnameAndPort))}else{if(!t.client_info)throw Bt.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");a=this.loadAccount(i,o.hostnameAndPort,t.client_info,o.authorityType);n=new $e(a,this.loadIdToken(i,a.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,a.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,a.homeAccountId,o.hostnameAndPort))}}return this.generateAuthenticationResult(e,i,n,o)},e.prototype.loadAccount=function(e,t,r,n,o){var i;if(o?i=o:void 0!==n&&r&&(i=Ie.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!i)throw Bt.createUnableToLoadTokenError("Unexpected missing homeAccountId");var a=r?Ie.createAccount(r,i,e,void 0,void 0,void 0,t):Ie.createGenericAccount(i,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(a),a;throw Bt.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){var o=Ke.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(o),o;throw Bt.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw Bt.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw Bt.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new ye(e.scopes).printScopes(),s=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn,u=Ge.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,a,s,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw Bt.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var o=je.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(o),o;throw Bt.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var o,i,a,s,c=A.EMPTY_STRING,u=[],l=null;(null==r?void 0:r.accessToken)&&(c=r.accessToken.secret,u=ye.fromString(r.accessToken.target).asArray(),l=new Date(1e3*Number(r.accessToken.expiresOn)),s=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));var d=(null==t?void 0:t.claims.oid)||(null==t?void 0:t.claims.sub)||A.EMPTY_STRING,h=(null==t?void 0:t.claims.tid)||A.EMPTY_STRING;return{authority:n?n.canonicalAuthority:A.EMPTY_STRING,uniqueId:d,tenantId:h,scopes:u,account:(null==r?void 0:r.account)?r.account.getAccountInfo():null,idToken:t?t.rawToken:A.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:c,fromCache:!0,expiresOn:l,correlationId:e.correlationId||A.EMPTY_STRING,requestId:A.EMPTY_STRING,extExpiresOn:s,familyId:A.EMPTY_STRING,tokenType:(null===(o=null==r?void 0:r.accessToken)||void 0===o?void 0:o.tokenType)||A.EMPTY_STRING,state:A.EMPTY_STRING,cloudGraphHostName:(null===(i=null==r?void 0:r.account)||void 0===i?void 0:i.cloudGraphHostName)||A.EMPTY_STRING,msGraphHost:(null===(a=null==r?void 0:r.account)||void 0===a?void 0:a.msGraphHost)||A.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),Xr=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return u(t,e),t}(it),Zr=function(t){function r(e,r,n,o,i,a,s,c,u,l){var d=t.call(this,e,r,n,o,i,a,c,u,l)||this;return d.apiId=s,d}return u(r,t),r.prototype.acquireToken=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s;return p(this,(function(c){switch(c.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw Bt.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(xe.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,e.InteractionType.Silent)];case 1:r=c.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||A.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),c.label=2;case 2:return c.trys.push([2,4,,5]),o=l(l({},r),{code:t.code}),this.performanceClient.setPreQueueTime(xe.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(n,r.authority)];case 3:return i=c.sent(),a=new Xr(i),this.logger.verbose("Auth code client created"),[2,new Rr(a,this.browserStorage,o,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r.state,a.authority,this.networkClient,!1)];case 4:throw(s=c.sent())instanceof ae&&s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(r.state),s;case 5:return[2]}}))}))},r.prototype.logout=function(){return Promise.reject(Bt.createSilentLogoutUnsupportedError())},r}(gr),en=function(){function t(t){var r,n,o;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(t,r){var n=t.auth,o=t.cache,i=t.system,a=t.telemetry,s={clientId:A.EMPTY_STRING,authority:""+A.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:A.EMPTY_STRING,authorityMetadata:A.EMPTY_STRING,redirectUri:A.EMPTY_STRING,postLogoutRedirectUri:A.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:e.ProtocolMode.AAD,azureCloudOptions:{azureCloudInstance:de.None,tenant:A.EMPTY_STRING},skipAuthorityMetadataCache:!1},c={cacheLocation:e.BrowserCacheLocation.SessionStorage,temporaryCacheLocation:e.BrowserCacheLocation.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!o||o.cacheLocation!==e.BrowserCacheLocation.LocalStorage)},u={loggerCallback:function(){},logLevel:e.LogLevel.Info,piiLoggingEnabled:!1},d=l(l({},Se),{loggerOptions:u,networkClient:r?hr.getBrowserNetworkClient():At,navigationClient:new br,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||Ar,navigateFrameWait:r&&hr.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:zt,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),h=l(l({},i),{loggerOptions:(null==i?void 0:i.loggerOptions)||u}),p={application:{appName:A.EMPTY_STRING,appVersion:A.EMPTY_STRING}};return{auth:l(l({},s),n),cache:l(l({},c),o),system:l(l({},d),h),telemetry:l(l({},p),a)}}(t,this.isBrowserEnvironment),this.initialized=!1,this.logger=new he(this.config.system.loggerOptions,cr,ur),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new $r(this.config.auth.clientId,this.config.auth.authority,this.logger,cr,ur,this.config.telemetry.application,this.config.system.cryptoOptions):new xt(this.config.auth.clientId,this.config.auth.authority,this.logger,cr,ur,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Vr(this.logger,this.performanceClient,this.config.system.cryptoOptions):se,this.eventHandler=new Mr(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new sr(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(r=this.config.auth.clientId,n=this.logger,o={cacheLocation:e.BrowserCacheLocation.MemoryStorage,temporaryCacheLocation:e.BrowserCacheLocation.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1},new sr(r,o,se,n));var i={cacheLocation:e.BrowserCacheLocation.MemoryStorage,temporaryCacheLocation:e.BrowserCacheLocation.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1};this.nativeInternalStorage=new sr(this.config.auth.clientId,i,this.browserCrypto,this.logger),this.tokenCache=new Jr(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return t.prototype.initialize=function(){return h(this,void 0,void 0,(function(){var t,r,n,o;return p(this,(function(i){switch(i.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(t=this.config.system.allowNativeBroker,r=this.performanceClient.startMeasurement(xe.InitializeClientApplication),this.eventHandler.emitEvent(e.EventType.INITIALIZE_START),!t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),n=this,[4,Er.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return n.nativeExtensionProvider=i.sent(),[3,4];case 3:return o=i.sent(),this.logger.verbose(o),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(e.EventType.INITIALIZE_END),r.endMeasurement({allowNativeBroker:t,success:!0}),[2]}}))}))},t.prototype.handleRedirectPromise=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l=this;return p(this,(function(d){return this.logger.verbose("handleRedirectPromise called"),hr.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),r=this.getAllAccounts(),this.isBrowserEnvironment?(n=t||A.EMPTY_STRING,void 0===(o=this.redirectResponse.get(n))?(this.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_START,e.InteractionType.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getCachedNativeRequest(),a=void 0,i&&Er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,this.nativeInternalStorage,i.correlationId),a=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),c=this.browserStorage.getTemporaryCache(mt.CORRELATION_ID,!0)||A.EMPTY_STRING,u=this.createRedirectClient(c),a=u.handleRedirectPromise(t)),o=a.then((function(t){t&&(r.length<l.getAllAccounts().length?(l.eventHandler.emitEvent(e.EventType.LOGIN_SUCCESS,e.InteractionType.Redirect,t),l.logger.verbose("handleRedirectResponse returned result, login success")):(l.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t),l.logger.verbose("handleRedirectResponse returned result, acquire token success")));return l.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_END,e.InteractionType.Redirect),t})).catch((function(t){throw r.length>0?l.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t):l.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),l.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_END,e.InteractionType.Redirect),t})),this.redirectResponse.set(n,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},t.prototype.acquireTokenRedirect=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s=this;return p(this,(function(c){return r=this.getRequestCorrelationId(t),this.logger.verbose("acquireTokenRedirect called",r),this.preflightBrowserEnvironmentCheck(e.InteractionType.Redirect),(n=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t):this.eventHandler.emitEvent(e.EventType.LOGIN_START,e.InteractionType.Redirect,t),this.nativeExtensionProvider&&this.canUseNative(t)?(i=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId),o=i.acquireTokenRedirect(t).catch((function(e){if(e instanceof Tr&&e.isFatal())return s.nativeExtensionProvider=void 0,s.createRedirectClient(t.correlationId).acquireToken(t);if(e instanceof Ye)return s.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),s.createRedirectClient(t.correlationId).acquireToken(t);throw s.browserStorage.setInteractionInProgress(!1),e}))):(a=this.createRedirectClient(t.correlationId),o=a.acquireToken(t)),[2,o.catch((function(t){throw n?s.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t):s.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),t}))]}))}))},t.prototype.acquireTokenPopup=function(t){var r=this,n=this.getRequestCorrelationId(t),o=this.performanceClient.startMeasurement(xe.AcquireTokenPopup,n);try{this.logger.verbose("acquireTokenPopup called",n),this.preflightBrowserEnvironmentCheck(e.InteractionType.Popup)}catch(e){return Promise.reject(e)}var i,a=this.getAllAccounts();(a.length>0?this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t):this.eventHandler.emitEvent(e.EventType.LOGIN_START,e.InteractionType.Popup,t),this.canUseNative(t))?i=this.acquireTokenNative(t,e.ApiId.acquireTokenPopup).then((function(e){return r.browserStorage.setInteractionInProgress(!1),o.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){if(e instanceof Tr&&e.isFatal())return r.nativeExtensionProvider=void 0,r.createPopupClient(t.correlationId).acquireToken(t);if(e instanceof Ye)return r.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),r.createPopupClient(t.correlationId).acquireToken(t);throw r.browserStorage.setInteractionInProgress(!1),e})):i=this.createPopupClient(t.correlationId).acquireToken(t);return i.then((function(t){return a.length<r.getAllAccounts().length?r.eventHandler.emitEvent(e.EventType.LOGIN_SUCCESS,e.InteractionType.Popup,t):r.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t),o.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),o.endMeasurement({success:!0,requestId:t.requestId}),t})).catch((function(t){return a.length>0?r.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t):r.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Popup,null,t),o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),Promise.reject(t)}))},t.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},t.prototype.ssoSilent=function(t){var r;return h(this,void 0,void 0,(function(){var n,o,i,a,s=this;return p(this,(function(c){return n=this.getRequestCorrelationId(t),o=l(l({},t),{prompt:t.prompt,correlationId:n}),this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(xe.SsoSilent,n),null===(r=this.ssoSilentMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(e.EventType.SSO_SILENT_START,e.InteractionType.Silent,o),this.canUseNative(o)?i=this.acquireTokenNative(o,e.ApiId.ssoSilent).catch((function(e){if(e instanceof Tr&&e.isFatal())return s.nativeExtensionProvider=void 0,s.createSilentIframeClient(o.correlationId).acquireToken(o);throw e})):(a=this.createSilentIframeClient(o.correlationId),i=a.acquireToken(o)),[2,i.then((function(t){var r,n;return s.eventHandler.emitEvent(e.EventType.SSO_SILENT_SUCCESS,e.InteractionType.Silent,t),null===(r=s.ssoSilentMeasurement)||void 0===r||r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),null===(n=s.ssoSilentMeasurement)||void 0===n||n.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var r;throw s.eventHandler.emitEvent(e.EventType.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),null===(r=s.ssoSilentMeasurement)||void 0===r||r.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",s.trackPageVisibilityWithMeasurement)}))]}))}))},t.prototype.acquireTokenByCode=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a=this;return p(this,(function(s){r=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent),this.logger.trace("acquireTokenByCode called",r),this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_START,e.InteractionType.Silent,t),n=this.performanceClient.startMeasurement(xe.AcquireTokenByCode,t.correlationId);try{if(t.code&&t.nativeAccountId)throw Bt.createSpaCodeAndNativeAccountIdPresentError();if(t.code)return o=t.code,(i=this.hybridAuthCodeResponses.get(o))?(this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId),n.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",r),i=this.acquireTokenByCodeAsync(l(l({},t),{correlationId:r})).then((function(t){return a.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_SUCCESS,e.InteractionType.Silent,t),a.hybridAuthCodeResponses.delete(o),n.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),n.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){throw a.hybridAuthCodeResponses.delete(o),a.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t),n.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})),this.hybridAuthCodeResponses.set(o,i)),[2,i];if(t.nativeAccountId){if(this.canUseNative(t,t.nativeAccountId))return[2,this.acquireTokenNative(t,e.ApiId.acquireTokenByCode,t.nativeAccountId).catch((function(e){throw e instanceof Tr&&e.isFatal()&&(a.nativeExtensionProvider=void 0),e}))];throw Bt.createUnableToAcquireTokenFromNativePlatformError()}throw Bt.createAuthCodeOrNativeAccountIdRequiredError()}catch(t){throw this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t),n.endMeasurement({errorCode:t instanceof ae&&t.errorCode||void 0,subErrorCode:t instanceof ae&&t.subError||void 0,success:!1}),t}return[2]}))}))},t.prototype.acquireTokenByCodeAsync=function(e){var t;return h(this,void 0,void 0,(function(){var r=this;return p(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(xe.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},t.prototype.acquireTokenFromCache=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){switch(this.performanceClient.addQueueMeasurement(xe.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case Jt.Default:case Jt.AccessToken:case Jt.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw ue.createRefreshRequiredError()}return[2]}))}))},t.prototype.acquireTokenByRefreshToken=function(e,t){return h(this,void 0,void 0,(function(){var r;return p(this,(function(n){switch(this.performanceClient.addQueueMeasurement(xe.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case Jt.Default:case Jt.AccessTokenAndRefreshToken:case Jt.RefreshToken:case Jt.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(xe.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw ue.createRefreshRequiredError()}return[2]}))}))},t.prototype.acquireTokenBySilentIframe=function(e){return h(this,void 0,void 0,(function(){var t;return p(this,(function(r){return this.performanceClient.addQueueMeasurement(xe.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(xe.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},t.prototype.logout=function(e){return h(this,void 0,void 0,(function(){var t;return p(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(l({correlationId:t},e))]}))}))},t.prototype.logoutRedirect=function(t){return h(this,void 0,void 0,(function(){var r;return p(this,(function(n){return r=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(e.InteractionType.Redirect),[2,this.createRedirectClient(r).logout(t)]}))}))},t.prototype.logoutPopup=function(t){try{var r=this.getRequestCorrelationId(t);return this.preflightBrowserEnvironmentCheck(e.InteractionType.Popup),this.createPopupClient(r).logout(t)}catch(e){return Promise.reject(e)}},t.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},t.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},t.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},t.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},t.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},t.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},t.prototype.preflightBrowserEnvironmentCheck=function(t,r){if(void 0===r&&(r=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),hr.blockNonBrowserEnvironment(this.isBrowserEnvironment),hr.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe),hr.blockReloadInHiddenIframes(),hr.blockAcquireTokenInPopups(),hr.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t===e.InteractionType.Redirect&&this.config.cache.cacheLocation===e.BrowserCacheLocation.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw nr.createInMemoryRedirectUnavailableError();t!==e.InteractionType.Redirect&&t!==e.InteractionType.Popup||this.preflightInteractiveRequest(r)},t.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),hr.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},t.prototype.acquireTokenNative=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Bt.createNativeConnectionNotEstablishedError();return[2,new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},t.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!Er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case N.NONE:case N.CONSENT:case N.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},t.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},t.prototype.createPopupClient=function(e){return new Sr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},t.prototype.createRedirectClient=function(e){return new kr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},t.prototype.createSilentIframeClient=function(t){return new Pr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},t.prototype.createSilentCacheClient=function(e){return new Ir(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},t.prototype.createSilentRefreshClient=function(e){return new Nr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},t.prototype.createSilentAuthCodeClient=function(t){return new Zr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,t)},t.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},t.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},t.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},t.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},t.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},t.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},t.prototype.getTokenCache=function(){return this.tokenCache},t.prototype.getLogger=function(){return this.logger},t.prototype.setLogger=function(e){this.logger=e},t.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},t.prototype.setNavigationClient=function(e){this.navigationClient=e},t.prototype.getConfiguration=function(){return this.config},t.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():A.EMPTY_STRING},t}(),tn=function(t){function r(e){var r=t.call(this,e)||this;return r.astsAsyncMeasurement=void 0,r.activeSilentTokenRequests=new Map,r.trackPageVisibility=r.trackPageVisibility.bind(r),r}return u(r,t),r.prototype.loginRedirect=function(e){return h(this,void 0,void 0,(function(){var t;return p(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(l({correlationId:t},e||Yt))]}))}))},r.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(l({correlationId:t},e||Yt))},r.prototype.acquireTokenSilent=function(t){return h(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u=this;return p(this,(function(d){if(r=this.getRequestCorrelationId(t),(n=this.performanceClient.startMeasurement(xe.AcquireTokenSilent,r)).addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent),this.logger.verbose("acquireTokenSilent called",r),!(o=t.account||this.getActiveAccount()))throw Bt.createNoAccountError();return i={clientId:this.config.auth.clientId,authority:t.authority||A.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:o.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},a=JSON.stringify(i),void 0===(s=this.activeSilentTokenRequests.get(a))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.setPreQueueTime(xe.AcquireTokenSilentAsync,r),c=this.acquireTokenSilentAsync(l(l({},t),{correlationId:r}),o).then((function(e){return u.activeSilentTokenRequests.delete(a),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:e.requestId}),e})).catch((function(e){throw u.activeSilentTokenRequests.delete(a),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(a,c),[2,c]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),n.discardMeasurement(),[2,s])}))}))},r.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},r.prototype.acquireTokenSilentAsync=function(t,r){var n;return h(this,void 0,void 0,(function(){var o,i,a,s,c,u=this;return p(this,(function(d){switch(d.label){case 0:return this.performanceClient.addQueueMeasurement(xe.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(xe.AcquireTokenSilentAsync,t.correlationId),null===(n=this.astsAsyncMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),Er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&r.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),i=l(l({},t),{account:r}),o=this.acquireTokenNative(i,e.ApiId.acquireTokenSilent_silentFlow).catch((function(e){return h(u,void 0,void 0,(function(){return p(this,(function(r){if(e instanceof Tr&&e.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw e}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),a=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime(xe.InitializeSilentRequest,t.correlationId),[4,a.initializeSilentRequest(t,r)];case 2:s=d.sent(),c=l(l({},t),{cacheLookupPolicy:t.cacheLookupPolicy||Jt.Default}),this.performanceClient.setPreQueueTime(xe.AcquireTokenFromCache,s.correlationId),o=this.acquireTokenFromCache(a,s,c).catch((function(r){if(c.cacheLookupPolicy===Jt.AccessToken)throw r;return hr.blockReloadInHiddenIframes(),u.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_NETWORK_START,e.InteractionType.Silent,s),u.performanceClient.setPreQueueTime(xe.AcquireTokenByRefreshToken,s.correlationId),u.acquireTokenByRefreshToken(s,c).catch((function(e){var r=e instanceof Oe,n=e instanceof Ye,o=e.errorCode===Ht;if((!r||!o||n||c.cacheLookupPolicy===Jt.AccessTokenAndRefreshToken||c.cacheLookupPolicy===Jt.RefreshToken)&&c.cacheLookupPolicy!==Jt.Skip)throw e;return u.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),u.performanceClient.setPreQueueTime(xe.AcquireTokenBySilentIframe,s.correlationId),u.acquireTokenBySilentIframe(s)}))})),d.label=3;case 3:return[2,o.then((function(t){var r;return u.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,t),null===(r=u.astsAsyncMeasurement)||void 0===r||r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var r;throw u.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),null===(r=u.astsAsyncMeasurement)||void 0===r||r.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",u.trackPageVisibility)}))]}}))}))},r}(en),rn={initialize:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},acquireTokenPopup:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},acquireTokenRedirect:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},acquireTokenSilent:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},acquireTokenByCode:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},loginPopup:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},loginRedirect:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},logout:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},logoutRedirect:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},logoutPopup:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},ssoSilent:function(){return Promise.reject(nr.createStubPcaInstanceCalledError())},addEventCallback:function(){return null},removeEventCallback:function(){},addPerformanceCallback:function(){return""},removePerformanceCallback:function(){return!1},enableAccountStorageEvents:function(){},disableAccountStorageEvents:function(){},getTokenCache:function(){throw nr.createStubPcaInstanceCalledError()},getLogger:function(){throw nr.createStubPcaInstanceCalledError()},setLogger:function(){},setActiveAccount:function(){},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){},setNavigationClient:function(){},getConfiguration:function(){throw nr.createStubPcaInstanceCalledError()}},nn=function(){function t(){}return t.getInteractionStatusFromEvent=function(t,r){switch(t.eventType){case e.EventType.LOGIN_START:return e.InteractionStatus.Login;case e.EventType.SSO_SILENT_START:return e.InteractionStatus.SsoSilent;case e.EventType.ACQUIRE_TOKEN_START:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup)return e.InteractionStatus.AcquireToken;break;case e.EventType.HANDLE_REDIRECT_START:return e.InteractionStatus.HandleRedirect;case e.EventType.LOGOUT_START:return e.InteractionStatus.Logout;case e.EventType.SSO_SILENT_SUCCESS:case e.EventType.SSO_SILENT_FAILURE:if(r&&r!==e.InteractionStatus.SsoSilent)break;return e.InteractionStatus.None;case e.EventType.LOGOUT_END:if(r&&r!==e.InteractionStatus.Logout)break;return e.InteractionStatus.None;case e.EventType.HANDLE_REDIRECT_END:if(r&&r!==e.InteractionStatus.HandleRedirect)break;return e.InteractionStatus.None;case e.EventType.LOGIN_SUCCESS:case e.EventType.LOGIN_FAILURE:case e.EventType.ACQUIRE_TOKEN_SUCCESS:case e.EventType.ACQUIRE_TOKEN_FAILURE:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup){if(r&&r!==e.InteractionStatus.Login&&r!==e.InteractionStatus.AcquireToken)break;return e.InteractionStatus.None}}return null},t}(),on=function(){function e(e,t){var r=t&&t.loggerOptions||{};this.logger=new he(r,cr,ur),this.cryptoOps=new Vr(this.logger),this.popTokenGenerator=new tt(this.cryptoOps),this.shrParameters=e}return e.prototype.generatePublicKeyThumbprint=function(){return h(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return[2,e.sent().kid]}}))}))},e.prototype.signRequest=function(e,t,r){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)]}))}))},e.prototype.removeKeys=function(e){return h(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}}))}))},e}(),an="function",sn="object",cn="undefined",un="prototype",ln="hasOwnProperty",dn=Object,hn=dn[un],pn=dn.assign,gn=dn.create,fn=dn.defineProperty,mn=hn[ln],vn=null;
/*! @azure/msal-browser v2.37.0 2023-05-02 */function yn(e){return void 0===e&&(e=!0),vn&&e||(typeof globalThis!==cn&&globalThis&&(vn=globalThis),typeof self!==cn&&self&&(vn=self),typeof window!==cn&&window&&(vn=window),typeof global!==cn&&global&&(vn=global)),vn}function Cn(e){throw new TypeError(e)}function Tn(e){if(gn)return gn(e);if(null==e)return{};var t=typeof e;function r(){}return t!==sn&&t!==an&&Cn("Object prototype may only be an Object:"+e),r[un]=e,new r}(yn()||{}).Symbol,(yn()||{}).Reflect;var In=pn||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])hn[ln].call(t,o)&&(e[o]=t[o]);return e},wn=function(e,t){return wn=dn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t[ln](r)&&(e[r]=t[r])},wn(e,t)};function En(e,t){function r(){this.constructor=e}typeof t!==an&&null!==t&&Cn("Class extends value "+String(t)+" is not a constructor or null"),wn(e,t),e[un]=null===t?Tn(t):(r[un]=t[un],new r)}function kn(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}
/*!
     * Microsoft Dynamic Proto Utility, 1.1.4
     * Copyright (c) Microsoft and contributors. All rights reserved.
     */var Sn="constructor",bn="prototype",An="function",_n="_dynInstFuncs",Rn="_isDynProxy",Pn="_dynClass",Nn="_dynInstChk",Mn=Nn,On="_dfOpts",qn="_unknown_",Un="__proto__",xn="useBaseInst",Ln="setInstFuncs",Bn=Object,Hn=Bn.getPrototypeOf,Dn=0;function Fn(e,t){return e&&Bn[bn].hasOwnProperty.call(e,t)}function Kn(e){return e&&(e===Bn[bn]||e===Array[bn])}function zn(e){return Kn(e)||e===Function[bn]}function Gn(e){if(e){if(Hn)return Hn(e);var t=e[Un]||e[bn]||(e[Sn]?e[Sn][bn]:null);if(t)return t}return null}function jn(e,t){var r=[],n=Bn.getOwnPropertyNames;if(n)r=n(e);else for(var o in e)"string"==typeof o&&Fn(e,o)&&r.push(o);if(r&&r.length>0)for(var i=0;i<r.length;i++)t(r[i])}function Qn(e,t,r){return t!==Sn&&typeof e[t]===An&&(r||Fn(e,t))}function Wn(e){throw new TypeError("DynamicProto: "+e)}function Vn(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function Yn(e,t,r,n,o){function i(e,t){var r=function(){var n=function(e,t,r,n){var o=null;if(e&&Fn(r,Pn)){var i=e[_n]||{};if((o=(i[r[Pn]]||{})[t])||Wn("Missing ["+t+"] "+An),!o[Nn]&&!1!==i[Mn]){for(var a=!Fn(e,t),s=Gn(e),c=[];a&&s&&!zn(s)&&!Vn(c,s);){var u=s[t];if(u){a=u===n;break}c.push(s),s=Gn(s)}try{a&&(e[t]=o),o[Nn]=1}catch(e){i[Mn]=!1}}}return o}(this,t,e,r)||function(e,t,r){var n=t[e];return n===r&&(n=Gn(t)[e]),typeof n!==An&&Wn("["+e+"] is not a "+An),n}(t,e,r);return n.apply(this,arguments)};return r[Rn]=1,r}if(!Kn(e)){var a=r[_n]=r[_n]||{},s=a[t]=a[t]||{};!1!==a[Mn]&&(a[Mn]=!!o),jn(r,(function(t){Qn(r,t,!1)&&r[t]!==n[t]&&(s[t]=r[t],delete r[t],(!Fn(e,t)||e[t]&&!e[t][Rn])&&(e[t]=i(e,t)))}))}}function $n(e,t){return Fn(e,bn)?e.name||t||qn:((e||{})[Sn]||{}).name||t||qn}function Jn(e,t,r,n){Fn(e,bn)||Wn("theClass is an invalid class definition.");var o=e[bn];(function(e,t){if(Hn)for(var r=[],n=Gn(t);n&&!zn(n)&&!Vn(r,n);){if(n===e)return!0;r.push(n),n=Gn(n)}return!1})(o,t)||Wn("["+$n(e)+"] is not in class hierarchy of ["+$n(t)+"]");var i=null;Fn(o,Pn)?i=o[Pn]:(i="_dynCls$"+$n(e,"_")+"$"+Dn,Dn++,o[Pn]=i);var a=Jn[On],s=!!a[xn];s&&n&&void 0!==n[xn]&&(s=!!n[xn]);var c=function(e){var t={};return jn(e,(function(r){!t[r]&&Qn(e,r,!1)&&(t[r]=e[r])})),t}(t),u=function(e,t,r,n){function o(e,t,r){var o=t[r];if(o[Rn]&&n){var i=e[_n]||{};!1!==i[Mn]&&(o=(i[t[Pn]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var i={};jn(r,(function(e){i[e]=o(t,r,e)}));for(var a=Gn(e),s=[];a&&!zn(a)&&!Vn(s,a);)jn(a,(function(e){!i[e]&&Qn(a,e,!Hn)&&(i[e]=o(t,a,e))})),s.push(a),a=Gn(a);return i}(o,t,c,s);r(t,u);var l=!!Hn&&!!a[Ln];l&&n&&(l=!!n[Ln]),Yn(o,i,t,c,!1!==l)}Jn[On]={setInstFuncs:!0,useBaseInst:!0};var Xn,Zn=0,eo=1,to=2,ro=4,no=5;!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(Xn||(Xn={}));var oo={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},io="on",ao="attachEvent",so="addEventListener",co="toISOString",uo="endsWith",lo="startsWith",ho="indexOf",po="trim",go="toString",fo=fn,mo=dn.freeze,vo=dn.keys,yo=String[un],Co=yo[po],To=yo[uo],Io=yo[lo],wo=Date[un][co],Eo=Array.isArray,ko=hn[go];function So(e){return void 0===e||typeof e===cn}function bo(e){return null===e||So(e)}function Ao(e){return!bo(e)}function _o(e,t){return!(!e||!mn.call(e,t))}function Ro(e){return!(!e||typeof e!==sn)}function Po(e){return!(!e||typeof e!==an)}function No(e,t,r,n){void 0===n&&(n=!1);var o=!1;if(!bo(e))try{bo(e[so])?bo(e[ao])||(e[ao](io+t,r),o=!0):(e[so](t,r,n),o=!0)}catch(e){}return o}function Mo(e,t){if(e)for(var r in e)mn.call(e,r)&&t.call(e,r,e[r])}function Oo(e,t){var r=!1;return e&&t&&!(r=e===t)&&(r=Io?e[lo](t):function(e,t){var r=!1,n=t?t.length:0;if(e&&n&&e.length>=n&&!(r=e===t)){for(var o=0;o<n;o++)if(e[o]!==t[o])return!1;r=!0}return r}(e,t)),r}function qo(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}mn[go].call(dn);var Uo=Eo||function(e){return!(!e||"[object Array]"!==ko.call(e))};function xo(e){return"string"==typeof e}function Lo(e){return"number"==typeof e}function Bo(e){return"boolean"==typeof e}function Ho(e){if(e)return wo?e[co]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function Do(e,t,r){var n=e.length;try{for(var o=0;o<n&&(!(o in e)||-1!==t.call(r||e,e[o],o,e));o++);}catch(e){}}function Fo(e,t,r){if(e){if(e[ho])return e[ho](t,r);var n=e.length,o=r||0;try{for(var i=Math.max(o>=0?o:n-Math.abs(o),0);i<n;i++)if(i in e&&e[i]===t)return i}catch(e){}}return-1}function Ko(e){return e&&(e=Co&&e[po]?e[po]():e.replace?e.replace(/^\s+|\s+$/g,""):e),e}var zo=!{toString:null}.propertyIsEnumerable("toString"),Go=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function jo(e){var t=typeof e;if(t===an||t===sn&&null!==e||Cn("objKeys called on non-object"),!zo&&vo)return vo(e);var r=[];for(var n in e)e&&mn.call(e,n)&&r.push(n);if(zo)for(var o=Go.length,i=0;i<o;i++)e&&mn.call(e,Go[i])&&r.push(Go[i]);return r}function Qo(e,t,r,n){if(fo)try{var o={enumerable:!0,configurable:!0};return r&&(o.get=r),n&&(o.set=n),fo(e,t,o),!0}catch(e){}return!1}var Wo=mo||function(e){return e};function Vo(){var e=Date;return e.now?e.now():(new e).getTime()}function Yo(e){return(t=e)&&"[object Error]"===ko.call(t)?e.name:"";var t}function $o(e,t,r,n,o){var i=r;return e&&((i=e[t])===r||o&&!o(i)||n&&!n(r)||(i=r,e[t]=i)),i}function Jo(e){return!e}function Xo(e){return!!e}function Zo(e){throw new Error(e)}function ei(e){return e&&pn&&(e=dn(pn({},e))),e}var ti="window",ri="document",ni="navigator",oi="location",ii="console",ai="performance",si="JSON",ci="crypto",ui="msCrypto",li="msie",di="trident/",hi=null,pi=null,gi=!1,fi=null,mi=null;function vi(e,t){var r=!1;if(e){try{if(!(r=t in e)){var n=e[un];n&&(r=t in n)}}catch(e){}if(!r)try{r=!So((new e)[t])}catch(e){}}return r}function yi(e){var t=yn();return t&&t[e]?t[e]:e===ti&&Ci()?window:null}function Ci(){return Boolean(typeof window===sn&&window)}function Ti(){return Ci()?window:yi(ti)}function Ii(){return Boolean(typeof document===sn&&document)?document:yi(ri)}function wi(){return Boolean(typeof navigator===sn&&navigator)}function Ei(){return wi()?navigator:yi(ni)}function ki(e){if(e&&gi){var t=yi("__mockLocation");if(t)return t}return typeof location===sn&&location?location:yi(oi)}function Si(){return Boolean(typeof JSON===sn&&JSON||null!==yi(si))}function bi(){return Si()?JSON||yi(si):null}function Ai(){var e=Ei();return!(!e||!e.product)&&"ReactNative"===e.product}function _i(){var e=Ei();if(e&&(e.userAgent!==pi||null===hi)){var t=((pi=e.userAgent)||"").toLowerCase();hi=qo(t,li)||qo(t,di)}return hi}function Ri(e){var t=Object[un].toString.call(e),r="";return"[object Error]"===t?r="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Si()&&(r=bi().stringify(e)),t+r}function Pi(){return null===mi&&(mi=wi()&&Boolean(Ei().sendBeacon)),mi}function Ni(e){var t=!1;try{t=!!yi("fetch");var r=yi("Request");t&&e&&r&&(t=vi(r,"keepalive"))}catch(e){}return t}function Mi(){var e=!1;try{e=!!yi("XMLHttpRequest")}catch(e){}return e}var Oi,qi=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],Ui=null;function xi(e,t){return function(){var r=arguments,n=Li(t);if(n){var o=n.listener;o&&o[e]&&o[e].apply(o,r)}}}function Li(e){var t,r=Ui;return r||!0===e.disableDbgExt||(r=Ui||((t=yi("Microsoft"))&&(Ui=t.ApplicationInsights),Ui)),r?r.ChromeDbgExt:null}function Bi(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function Hi(e,t){var r=typeof console!==cn?console:yi(ii);if(r){var n="log";r[e]&&(n=e),Po(r[n])&&r[n](t)}}var Di=function(){function e(e,t,r,n){void 0===r&&(r=!1);var o=this;o.messageId=e,o.message=(r?"AI: ":"AI (Internal): ")+e;var i="";Si()&&(i=bi().stringify(n));var a=(t?" message:"+Bi(t):"")+(n?" props:"+Bi(i):"");o.message+=a}return e.dataType="MessageData",e}();function Fi(e,t){return(e||{}).logger||new Ki(t)}var Ki=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={};Jn(e,this,(function(e){function o(e,r){var n=t[e];return bo(n)?r:n}function i(e,r){var n=Li(t);n&&n.diagLog&&n.diagLog(e,r)}bo(t)&&(t={}),e.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},e.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},e.throwInternal=function(t,r,o,a,s){void 0===s&&(s=!1);var c=new Di(r,o,s,a);if(e.enableDebugExceptions())throw c;var u=t===Xn.CRITICAL?"errorToConsole":"warnToConsole";if(So(c.message))i("throw"+(t===Xn.CRITICAL?"Critical":"Warning"),c);else{var l=e.consoleLoggingLevel();if(s){var d=+c.messageId;!n[d]&&l>=t&&(e[u](c.message),n[d]=!0)}else l>=t&&e[u](c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){Hi("warn",e),i("warning",e)},e.errorToConsole=function(e){Hi("error",e),i("error",e)},e.resetInternalMessageCount=function(){r=0,n={}},e.logInternalMessage=function(t,o){if(!(r>=e.maxInternalMessageLimit())){var a=!0,s="AITR_"+o.messageId;if(n[s]?a=!1:n[s]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(o),r++,i(t===Xn.CRITICAL?"error":"warn",o)),r===e.maxInternalMessageLimit())){var c="Internal events throttle limit per PageView reached for this app.",u=new Di(oo.MessageLimitPerPVExceeded,c,!1);e.queue.push(u),t===Xn.CRITICAL?e.errorToConsole(c):e.warnToConsole(c)}}}}))},zi="ctx",Gi=function(){function e(t,r,n){var o,i=this,a=!1;(i.start=Vo(),i.name=t,i.isAsync=n,i.isChildEvt=function(){return!1},Po(r))&&(a=Qo(i,"payload",(function(){return!o&&Po(r)&&(o=r(),r=null),o})));i.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?i[t]:(i[zi]||{})[t]:null},i.setCtx=function(t,r){if(t)if(t===e.ParentContextKey)i[t]||(i.isChildEvt=function(){return!0}),i[t]=r;else if(t===e.ChildrenContextKey)i[t]=r;else{(i[zi]=i[zi]||{})[t]=r}},i.complete=function(){var t=0,n=i.getCtx(e.ChildrenContextKey);if(Uo(n))for(var o=0;o<n.length;o++){var s=n[o];s&&(t+=s.time)}i.time=Vo()-i.start,i.exTime=i.time-t,i.complete=function(){},!a&&Po(r)&&(i.payload=r())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),ji=function e(t){this.ctx={},Jn(e,this,(function(e){e.create=function(e,t,r){return new Gi(e,t,r)},e.fire=function(e){e&&(e.complete(),t&&Po(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,r){t&&((e[zi]=e[zi]||{})[t]=r)},e.getCtx=function(t){return(e[zi]||{})[t]}}))},Qi="CoreUtils.doPerf";function Wi(e,t,r,n,o){if(e){var i=e;if(Po(i.getPerfMgr)&&(i=i.getPerfMgr()),i){var a=void 0,s=i.getCtx(Qi);try{if(a=i.create(t(),n,o)){if(s&&a.setCtx&&(a.setCtx(Gi.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(Gi.ChildrenContextKey);c||(c=[],s.setCtx(Gi.ChildrenContextKey,c)),c.push(a)}return i.setCtx(Qi,a),r(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&i.fire(a),i.setCtx(Qi,s)}}}return r()}var Vi=function(e,t){var r=this,n=null,o=Po(e.processTelemetry),i=Po(e.setNextPlugin);r._hasRun=!1,r.getPlugin=function(){return e},r.getNext=function(){return n},r.setNext=function(e){n=e},r.processTelemetry=function(a,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";Wi(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&o){r._hasRun=!0;try{s.setNext(n),i&&e.setNextPlugin(n),n&&(n._hasRun=!1),e.processTelemetry(a,s)}catch(r){var t=n&&n._hasRun;n&&t||s.diagLog().throwInternal(Xn.CRITICAL,oo.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+Ri(r)),n&&!t&&n.processTelemetry(a,s)}}else n&&(r._hasRun=!0,n.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};function Yi(e,t){var r=[];if(e&&e.length>0)for(var n=null,o=0;o<e.length;o++){var i=e[o];if(i&&Po(i.processTelemetry)){var a=new Vi(i,t);r.push(a),n&&n.setNext(a),n=a}}return r.length>0?r[0]:null}var $i=function e(t,r,n,o){var i=this,a=null;null!==o&&(t&&Po(t.getPlugin)?a=function(e,t,r){var n=[],o=!r;if(e)for(;e;){var i=e.getPlugin();(o||i===r)&&(o=!0,n.push(i)),e=e.getNext()}return o||n.push(r),Yi(n,t)}(t,i,o||t.getPlugin()):o?a=function(e,t,r){var n=e,o=!1;return r&&e&&(n=[],Do(e,(function(e){(o||e===r)&&(o=!0,n.push(e))}))),r&&!o&&(n||(n=[]),n.push(r)),Yi(n,t)}(t,i,o):So(o)&&(a=Yi(t,i))),i.core=function(){return n},i.diagLog=function(){return Fi(n,r)},i.getCfg=function(){return r},i.getExtCfg=function(e,t){var n;if(void 0===t&&(t={}),r){var o=r.extensionConfig;o&&e&&(n=o[e])}return n||t},i.getConfig=function(e,t,n){var o;void 0===n&&(n=!1);var a=i.getExtCfg(e,null);return a&&!bo(a[t])?o=a[t]:r&&!bo(r[t])&&(o=r[t]),bo(o)?n:o},i.hasNext=function(){return null!=a},i.getNext=function(){return a},i.setNext=function(e){a=e},i.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,i))},i.createNew=function(t,o){return void 0===t&&(t=null),new e(t||a,r,n,o)}},Ji="extensionConfig",Xi="getPlugin",Zi=function(){function e(){var e=this,t=!1,r=null,n=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){n=e},e.processNext=function(e,t){t?t.processNext(e):n&&Po(n.processTelemetry)&&n.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var o=t;if(!o){var i=r||new $i(null,{},e.core);o=n&&n[Xi]?i.createNew(null,n[Xi]):i.createNew(null,n)}return o},e._baseTelInit=function(o,i,a,s){o&&$o(o,Ji,[],null,bo),!s&&i&&(s=i.getProcessTelContext().getNext());var c=n;n&&n[Xi]&&(c=n[Xi]()),e.core=i,r=new $i(s,o,i,c),t=!0}}return e.prototype.initialize=function(e,t,r,n){this._baseTelInit(e,t,r,n)},e}(),ea="processTelemetry",ta="priority",ra="setNextPlugin",na="isInitialized";function oa(e,t){for(var r=[],n=null,o=e.getNext();o;){var i=o.getPlugin();i&&(n&&Po(n[ra])&&Po(i[ea])&&n[ra](i),Po(i[na])&&i[na]()||r.push(i),n=i,o=o.getNext())}Do(r,(function(r){r.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function ia(e){return e.sort((function(e,t){var r=0,n=Po(t[ea]);return Po(e[ea])?r=n?e[ta]-t[ta]:1:n&&(r=-1),r}))}var aa=500,sa=function(e){function t(){var r,n=e.call(this)||this;function o(e){e&&e.length>0&&(function(e){Do(e,(function(e){e.priority<aa&&Zo("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),r.push(e))}return n.identifier="ChannelControllerPlugin",n.priority=500,Jn(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){r&&Do(r,(function(r){r.length>0&&n._getTelCtx(t).createNew(r).processNext(e)}))},e.getChannelControls=function(){return r},e.initialize=function(n,i,a){e.isInitialized()||(t.initialize(n,i,a),function(e,t){r=[],e&&Do(e,(function(e){return o(e)}));if(t){var n=[];Do(t,(function(e){e.priority>aa&&n.push(e)})),o(n)}}((n||{}).channels,a),Do(r,(function(e){return oa(new $i(e,n,i),a)})))}})),n}var r;return En(t,e),t._staticInit=(Qo(r=t.prototype,"ChannelControls",r.getChannelControls),void Qo(r,"channelQueue",r.getChannelControls)),t}(Zi),ca="toGMTString",ua="toUTCString",la="cookie",da="expires",ha="enabled",pa="isCookieUseDisabled",ga="disableCookiesUsage",fa="_ckMgr",ma="",va=null,ya=null,Ca=null,Ta=Ii(),Ia={},wa={};function Ea(e){return!e||e.isEnabled()}function ka(e,t){var r;if(e)r=e.getCookieMgr();else if(t){var n=t.cookieCfg;r=n[fa]?n[fa]:Sa(t)}return r||(r=function(e,t){var r=Sa[fa]||wa[fa];return r||(r=Sa[fa]=Sa(e,t),wa[fa]=r),r}(t,(e||{}).logger)),r}function Sa(e,t){var r=function(e){var t=e.cookieCfg=e.cookieCfg||{};if($o(t,"domain",e.cookieDomain,Ao,bo),$o(t,"path",e.cookiePath||"/",null,bo),bo(t[ha])){var r=void 0;So(e[pa])||(r=!e[pa]),So(e[ga])||(r=!e[ga]),t[ha]=r}return t}(e||wa),n=r.path||"/",o=r.domain,i=!1!==r[ha],a={isEnabled:function(){var e=i&&ba(t),r=wa[fa];return e&&r&&a!==r&&(e=Ea(r)),e},setEnabled:function(e){i=!1!==e},set:function(e,t,i,s,c){var u=!1;if(Ea(a)){var l={},d=Ko(t||ma),h=d.indexOf(";");if(-1!==h&&(d=Ko(t.substring(0,h)),l=Aa(t.substring(h+1))),$o(l,"domain",s||o,Xo,So),!bo(i)){var p=_i();if(So(l[da])){var g=Vo()+1e3*i;if(g>0){var f=new Date;f.setTime(g),$o(l,da,_a(f,p?ca:ua)||_a(f,p?ca:ua)||ma,Xo)}}p||$o(l,"max-age",ma+i,null,So)}var m=ki();m&&"https:"===m.protocol&&($o(l,"secure",null,null,So),null===ya&&(ya=!function(e){if(!xo(e))return!1;if(qo(e,"CPU iPhone OS 12")||qo(e,"iPad; CPU OS 12"))return!0;if(qo(e,"Macintosh; Intel Mac OS X 10_14")&&qo(e,"Version/")&&qo(e,"Safari"))return!0;if(qo(e,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var r=!1;return e&&t&&!(r=e===t)&&(r=To?e[uo](t):function(e,t){var r=!1,n=t?t.length:0,o=e?e.length:0;if(n&&o&&o>=n&&!(r=e===t)){for(var i=o-1,a=n-1;a>=0;a--){if(e[i]!=t[a])return!1;i--}r=!0}return r}(e,t)),r}(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))return!0;if(qo(e,"Chrome/5")||qo(e,"Chrome/6"))return!0;if(qo(e,"UnrealEngine")&&!qo(e,"Chrome"))return!0;if(qo(e,"UCBrowser/12")||qo(e,"UCBrowser/11"))return!0;return!1}((Ei()||{}).userAgent)),ya&&$o(l,"SameSite","None",null,So)),$o(l,"path",c||n,null,So),(r.setCookie||Na)(e,Ra(d,l)),u=!0}return u},get:function(e){var t=ma;return Ea(a)&&(t=(r.getCookie||Pa)(e)),t},del:function(e,t){var r=!1;return Ea(a)&&(r=a.purge(e,t)),r},purge:function(e,n){var o,i=!1;if(ba(t)){var a=((o={}).path=n||"/",o[da]="Thu, 01 Jan 1970 00:00:01 GMT",o);_i()||(a["max-age"]="0"),(r.delCookie||Na)(e,Ra(ma,a)),i=!0}return i}};return a[fa]=a,a}function ba(e){if(null===va){va=!1;try{va=void 0!==(Ta||{})[la]}catch(t){e&&e.throwInternal(Xn.WARNING,oo.CannotAccessCookie,"Cannot access document.cookie - "+Yo(t),{exception:Ri(t)})}}return va}function Aa(e){var t={};e&&e.length&&Do(Ko(e).split(";"),(function(e){if(e=Ko(e||ma)){var r=e.indexOf("=");-1===r?t[e]=null:t[Ko(e.substring(0,r))]=Ko(e.substring(r+1))}}));return t}function _a(e,t){return Po(e[t])?e[t]():null}function Ra(e,t){var r=e||ma;return Mo(t,(function(e,t){r+="; "+e+(bo(t)?ma:"="+t)})),r}function Pa(e){var t=ma;if(Ta){var r=Ta[la]||ma;Ca!==r&&(Ia=Aa(r),Ca=r),t=Ko(Ia[e]||ma)}return t}function Na(e,t){Ta&&(Ta[la]=e+"="+t)}var Ma="_notificationManager";function Oa(e,t){return new ji(t)}var qa=function e(t){this.listeners=[];var r=!!(t||{}).perfEvtsSendAll;Jn(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var r=Fo(e.listeners,t);r>-1;)e.listeners.splice(r,1),r=Fo(e.listeners,t)},e.eventsSent=function(t){Do(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,r){Do(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,r)}),0)}))},e.eventsSendRequest=function(t,r){Do(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(r)setTimeout((function(){return e.eventsSendRequest(t,r)}),0);else try{e.eventsSendRequest(t,r)}catch(e){}}))},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||Do(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},Ua=function(e){function t(){var r=e.call(this)||this,n=0;return Jn(t,r,(function(e,t){function r(t){var r=e.getNotifyMgr();r&&r.eventsDiscarded([t],to)}e.initialize=function(e,r,n,o){t.initialize(e,r,n||new Ki(e),o||new qa(e))},e.track=function(n){Wi(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===n&&(r(n),Zo("Invalid telemetry item")),function(e){if(bo(e.name))throw r(e),Error("telemetry name required")}(n),t.track(n)}),(function(){return{item:n}}),!n.sync)},e.addNotificationListener=function(t){var r=e.getNotifyMgr();r&&r.addNotificationListener(t)},e.removeNotificationListener=function(t){var r=e.getNotifyMgr();r&&r.removeNotificationListener(t)},e.pollInternalLogs=function(t){var r=e.config.diagnosticLogInterval;return r&&r>0||(r=1e4),n&&e.stopPollingInternalLogs(),n=setInterval((function(){var r=e.logger?e.logger.queue:[];Do(r,(function(r){var n={name:t||"InternalMessageId: "+r.messageId,iKey:e.config.instrumentationKey,time:Ho(new Date),baseType:Di.dataType,baseData:{message:r.message}};e.track(n)})),r.length=0}),r)},e.stopPollingInternalLogs=function(){n&&(clearInterval(n),n=0)}})),r}return En(t,e),t}((function e(){var t,r,n,o,i,a=!1;Jn(e,this,(function(e){e._extensions=new Array,r=new sa,e.logger=new Ki({loggingLevelConsole:Xn.CRITICAL}),t=[],e.isInitialized=function(){return a},e.initialize=function(t,o,i,s){var c,u,l,d;e.isInitialized()&&Zo("Core should not be initialized more than once"),t&&!bo(t.instrumentationKey)||Zo("Please provide instrumentation key"),n=s,e[Ma]=s,e.config=t||{},s&&!0!==e.config.disableDbgExt&&s.addNotificationListener(function(e){if(!Oi){Oi={};for(var t=0;t<qi.length;t++)Oi[qi[t]]=xi(qi[t],e)}return Oi}(t)),e.config.enablePerfMgr&&$o(e.config,"createPerfMgr",Oa),t.extensions=bo(t.extensions)?[]:t.extensions,(u=Ji,(c=t)?!(d=c[u])&&bo(d)&&(d=So(l)?{}:l,c[u]=d):d=So(l)?{}:l,d).NotificationManager=s,i&&(e.logger=i);var h=[];h.push.apply(h,kn(kn([],o),t.extensions)),h=ia(h);var p=[],g={};Do(h,(function(e){(bo(e)||bo(e.initialize))&&Zo("Extensions must provide callback to initialize");var t=e.priority,n=e.identifier;e&&t&&(bo(g[t])?g[t]=n:i.warnToConsole("Two extensions have same priority #"+t+" - "+g[t]+", "+n)),(!t||t<r.priority)&&p.push(e)})),h.push(r),p.push(r),h=ia(h),e._extensions=h,oa(new $i([r],t,e),h),oa(new $i(p,t,e),h),e._extensions=p,0===e.getTransmissionControls().length&&Zo("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return r.getChannelControls()},e.track=function(r){$o(r,"iKey",e.config.instrumentationKey,null,Jo),$o(r,"time",Ho(new Date),null,Jo),$o(r,"ver","4.0",null,bo),e.isInitialized()?e.getProcessTelContext().processNext(r):t.push(r)},e.getProcessTelContext=function(){var t=e._extensions,n=t;return t&&0!==t.length||(n=[r]),new $i(n,e.config,e)},e.getNotifyMgr=function(){return n||(n=Tn({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e[Ma]=n),n},e.getCookieMgr=function(){return i||(i=Sa(e.config,e.logger)),i},e.setCookieMgr=function(e){i=e},e.getPerfMgr=function(){return o||e.config&&e.config.enablePerfMgr&&Po(e.config.createPerfMgr)&&(o=e.config.createPerfMgr(e,e.getNotifyMgr())),o||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Do(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))})),xa=4294967296,La=4294967295,Ba=!1,Ha=123456789,Da=987654321;function Fa(){try{var e=2147483647&Vo();(t=(Math.random()*xa^e)+e)<0&&(t>>>=0),Ha=123456789+t&La,Da=987654321-t&La,Ba=!0}catch(e){}var t}function Ka(e){var t,r=yi(ci)||yi(ui);return r&&r.getRandomValues?t=r.getRandomValues(new Uint32Array(1))[0]&La:_i()?(Ba||Fa(),t=function(e){var t=((Da=36969*(65535&Da)+(Da>>16)&La)<<16)+(65535&(Ha=18e3*(65535&Ha)+(Ha>>16)&La))>>>0&La;e||(t>>>=0);return t}()&La):t=Math.floor(xa*Math.random()|0),e||(t>>>=0),t}var za="visibilitychange",Ga="pagehide",ja="pageshow";function Qa(e,t){var r=!1,n=Ti();n&&(r=No(n,e,t),r=No(n.body,e,t)||r);var o=Ii();return o&&(r=No(o,e,t)||r),r}function Wa(e,t,r){var n=!1;if(t&&e&&Uo(e)){var o=[];Do(e,(function(e){xo(e)&&(r&&-1!==Fo(r,e)?o.push(e):n=Qa(e,t)||n)})),!n&&o.length>0&&(n=Wa(o,t))}return n}function Va(e,t){return Wa(["beforeunload","unload","pagehide"],e,t)}function Ya(e,t){var r=!1;return t&&-1!==Fo(t,Ga)||(r=Qa(Ga,e)),t&&-1!==Fo(t,za)||(r=Qa(za,(function(t){var r=Ii();e&&r&&"hidden"===r.visibilityState&&e(t)}))||r),!r&&t&&(r=Ya(e)),r}function $a(e,t){var r=!1;return t&&-1!==Fo(t,ja)||(r=Qa(ja,e)),t&&-1!==Fo(t,za)||(r=Qa(za,(function(t){var r=Ii();e&&r&&"visible"===r.visibilityState&&e(t)}))||r),!r&&t&&(r=$a(e)),r}function Ja(){function e(){return(e=15)>0?Math.floor(Ka()/La*(e+1))>>>0:0;var e}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(es,(function(t){var r=0|e();return("x"===t?r:3&r|8).toString(16)}))}function Xa(e){void 0===e&&(e=22);for(var t=Ka()>>>0,r=0,n="";n.length<e;)r++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===r&&(t=(Ka()<<2&4294967295|3&t)>>>0,r=0);return n}var Za,es=/[xy]/g,ts={NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32},rs=1,ns=2,os=3,is=4,as={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},ss=In(In({},oo),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),cs="1DS-Web-JS-3.1.11",us="withCredentials",ls=((Za={})[0]=as.Unspecified,Za[2]=as.Double,Za[1]=as.String,Za[3]=as.Bool,Za[4098]=as.Double,Za[4097]=as.String,Za[4099]=as.Bool,Za);Boolean(Ii());var ds=Boolean(Ti());function hs(e){return!(""===e||bo(e))}function ps(e,t,r){if(!t&&!hs(t)||"string"!=typeof e)return null;var n=typeof t;if("string"===n||"number"===n||"boolean"===n||Uo(t))t={value:t};else if("object"!==n||t.hasOwnProperty("value")){if(bo(t.value)||""===t.value||!xo(t.value)&&!Lo(t.value)&&!Bo(t.value)&&!Uo(t.value))return null}else t={value:r?JSON.stringify(t):t};if(Uo(t.value)&&!(t.value.length>0))return null;if(!bo(t.kind)){if(Uo(t.value)||!function(e){if(e===ts.NotSet||e>ts.NotSet&&e<=ts.Pii_IPV4AddressLegacy||e===ts.CustomerContent_GenericContent)return!0;return!1}(t.kind))return null;t.value=t.value.toString()}return t}function gs(e,t,r){var n=-1;if(!So(e))if(t>0&&(32===t?n=8192:t<=13&&(n=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(r))-1===n&&(n=0),n|=r;else{var o=ls[Ts(e)]||-1;-1!==n&&-1!==o?n|=o:o===as.Double&&(n=o)}return n}function fs(e,t,r){var n;return void 0===r&&(r=!0),e&&(n=e.get(t),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||""}function ms(e){void 0===e&&(e="D");var t=Ja();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function vs(e,t,r,n,o){var i={},a=!1,s=0,c=arguments.length,u=arguments;for("[object Boolean]"===Object[un].toString.call(u[0])&&(a=u[0],s++);s<c;s++){Mo(u[s],(function(e,t){a&&t&&Ro(t)?Uo(t)?(i[e]=i[e]||[],Do(t,(function(t,r){t&&Ro(t)?i[e][r]=vs(!0,i[e][r],t):i[e][r]=t}))):i[e]=vs(!0,i[e],t):i[e]=t}))}return i}var ys=function(){var e=yi(ai);return e&&e.now?e.now():Vo()};function Cs(e,t){var r=e;r.timings=r.timings||{},r.timings.processTelemetryStart=r.timings.processTelemetryStart||{},r.timings.processTelemetryStart[t]=ys()}function Ts(e){var t=0;if(null!=e){var r=typeof e;"string"===r?t=1:"number"===r?t=2:"boolean"===r?t=3:r===sn&&(t=4,Uo(e)?(t=4096,e.length>0&&(t|=Ts(e[0]))):_o(e,"value")&&(t=8192|Ts(e.value)))}return t}var Is="version",ws="properties",Es=function(e){function t(){var r=e.call(this)||this;return r.pluginVersionStringArr=[],r.pluginVersionString="",Jn(t,r,(function(e,t){e.logger&&e.logger.queue||(e.logger=new Ki({loggingLevelConsole:Xn.CRITICAL})),e.initialize=function(r,n,o,i){Wi(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(r){r.endpointUrl||(r.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=r.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");r.channels&&Do(r.channels,(function(t){t&&Do(t,(function(t){if(t.identifier&&t.version){var r=t.identifier+"="+t.version;e.pluginVersionStringArr.push(r)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},n&&Do(n,(function(t){if(t&&t.identifier&&t.version){var r=t.identifier+"="+t.version;e.pluginVersionStringArr.push(r)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(r,n,o,i),e.pollInternalLogs("InternalLog")}catch(t){var s=e.logger,c=Ri(t);-1!==c.indexOf("channels")&&(c+="\r\n - Channels must be provided through config.channels only!"),s.throwInternal(Xn.CRITICAL,ss.FailedToInitializeSDK,"SDK Initialization Failed - no telemetry will be sent: "+c)}}),(function(){return{config:r,extensions:n,logger:o,notificationManager:i}}))},e.track=function(r){Wi(e,(function(){return"AppInsightsCore.track"}),(function(){var n,o=r;if(o){o.timings=o.timings||{},o.timings.trackStart=ys(),(n=o.latency)&&Lo(n)&&n>=rs&&n<=is||(o.latency=rs);var i=o.ext=o.ext||{};i.sdk=i.sdk||{},i.sdk.ver=cs;var a=o.baseData=o.baseData||{};a[ws]||(a[ws]={});var s=a[ws];s[Is]||(s[Is]=""),""!==e.pluginVersionString&&(s[Is]=e.pluginVersionString)}t.track(o)}),(function(){return{item:r}}),!r.sync)}})),r}return En(t,e),t}(Ua),ks=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function Ss(e,t){void 0===t&&(t=ks);var r=null;if(e)for(var n=e.split(","),o=0;o<n.length;o++)bs(n[o],t)&&(r?r+=","+n[o]:r=n[o]);return r}function bs(e,t){if(void 0===t&&(t=ks),!e||e.length<4)return!1;for(var r=!1,n=e.substring(0,3).toString().toUpperCase(),o=0;o<t.length;o++)if(t[o]+":"===n&&e.length<=256){r=!0;break}return r}var As=function(){function e(e,t){this.core=t,this.appExpId=null,this.flightIdNameSpaces=ks.slice(0),this.expIdCookieName="Treatments",this._cookieMgr=ka(t),this._propertiesConfig=e;var r=Ii();if(r){var n=r.documentElement;r&&(this.locale=n.lang)}this.env=e.env?e.env:this._getMetaDataFromDOM("awa-").env}return e.prototype.getExpId=function(){return this._propertiesConfig.expId?this._readExpIdFromCoreData(this._propertiesConfig.expId):this._readExpIdFromCookie()},e.prototype._getMetaDataFromDOM=function(e){var t,r={},n=Ii();if(n){t=n&&n.querySelectorAll("meta");for(var o=0;o<t.length;o++){var i=t[o];if(i.name)if(0===i.name.toLowerCase().indexOf(e))r[i.name.replace(e,"")]=i.content}}return r},e.prototype._setAppExpId=function(e){e!==this.appExpId&&(this.appExpId=Ss(e,this.flightIdNameSpaces))},e.prototype._getAppExpId=function(){return this.appExpId},e.prototype._readExpIdFromCookie=function(){var e=fs(this._cookieMgr,this.expIdCookieName);return this._setAppExpId(e),this._getAppExpId()},e.prototype._readExpIdFromCoreData=function(e){return this._setAppExpId(e),this._getAppExpId()},e.validateAppExpId=Ss,e._staticInit=void Qo(e.prototype,"expId",e.prototype.getExpId),e}(),_s=function(){},Rs=function(){function e(t,r,n){this.core=n,this._propertiesConfig=r;var o=this._cookieMgr=ka(n,t);if(o&&o.isEnabled()){if(!this._propertiesConfig.hashIdentifiers&&!this._propertiesConfig.dropIdentifiers){var i=fs(o,"MUID");i&&this.setLocalId("t:"+i)}if(this._propertiesConfig.enableApplicationInsightsUser){var a=fs(o,e.userCookieName);if(a){var s=a.split(e.cookieSeparator);s.length>0&&(this.id=s[0])}if(!this.id){this.id=Xa(t&&!So(t.idLength)?t.idLength:22);var c=Ho(new Date);this.accountAcquisitionDate=c;var u=[this.id,c],l=this._propertiesConfig.cookieDomain?this._propertiesConfig.cookieDomain:void 0;o.set(e.userCookieName,u.join(e.cookieSeparator),31536e3,l)}}}if("undefined"!=typeof navigator){var d=navigator;this.locale=d.userLanguage||d.language}}return e.prototype.getLocalId=function(){if(this._customLocalId)return this._customLocalId;if(!this._propertiesConfig.hashIdentifiers&&!this._propertiesConfig.dropIdentifiers){var e=fs(this._cookieMgr,"MUID");e&&this.setLocalId("t:"+e)}},e.prototype.setLocalId=function(e){this._customLocalId=e},e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void Qo(e.prototype,"localId",e.prototype.getLocalId,e.prototype.setLocalId),e}(),Ps="([\\d,.]+)",Ns="Unknown",Ms="Edg/",Os=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:Ms,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],qs=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];
/**
    * Cloud.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2020
    */function Us(e,t){return t.indexOf(e)>-1}function xs(e,t){for(var r=0;r<t.length;r++)if(e==t[r].brand)return t[r].version;return null}function Ls(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE "+Ps));if(t)return t[1];var r=e.match(new RegExp("rv:"+Ps));if(r)return r[1]}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&Us(Ms,t)&&(e="Edg");var r=t.match(new RegExp(e+"/"+Ps));if(r)return r[1];if("Opera"===e&&(r=t.match(new RegExp("OPR/"+Ps))))return r[1];return Ns}(t,e)}var Bs=function(){function e(t,r){var n=ka(r),o=t||{};Jn(e,this,(function(e){var t=ki();if(t){var r=t.hostname;r&&(e.domain="file:"===t.protocol?"local":r)}if(o.populateBrowserInfo){var i=o.userAgent,a=(o.userAgentData||{}).brands,s=Ei();s&&(i=i||s.userAgent||"",a=a||(s.userAgentData||{}).brands),function(t,r){if(Uo(r))try{for(var n=0;n<qs.length;n++){var o=xs(qs[n].br,r);if(o)return e.browser=qs[n].b,void(e.browserVer=o)}}catch(e){}if(t){var i=function(e){if(e)for(var t=0;t<Os.length;t++)if(Us(Os[t].ua,e))return Os[t].b;return Ns}(t);e.browser=i,e.browserVer=Ls(t,i)}}(i,a);var c=function(){var e={h:0,w:0},t=Ti();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=c.w+"X"+c.h}e.getUserConsent=function(){return o.userConsented||!!fs(n,o.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){try{var e=o.callback;if(e&&e.userConsentDetails){var t=e.userConsentDetails();if(t)return JSON.stringify({Required:t.Required||!1,Analytics:t.Analytics||!1,SocialMedia:t.SocialMedia||!1,Advertising:t.Advertising||!1})}}catch(e){}return null},Qo(e,"userConsent",e.getUserConsent)}))}return e._staticInit=void Qo(e.prototype,"userConsent",e.prototype.getUserConsent),e}(),Hs={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},Ds={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Fs="([\\d,.]+)",Ks="([\\d,_,.]+)",zs="Unknown",Gs=[{r:Hs.WINPHONE,os:"Windows Phone"},{r:Hs.WINRT,os:"Windows RT"},{r:Hs.WIN,os:"Windows"},{r:Hs.IOS,os:"iOS"},{r:Hs.ANDROID,os:"Android"},{r:Hs.LINUX,os:"Linux"},{r:Hs.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Hs.OSX,os:"Mac OS X"}];function js(e,t){return"Windows"===t?Qs(e,"Windows NT"):"Android"===t?Qs(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X "+Ks));if(t){var r=t[1].replace(/_/g,".");if(r){var n=Ws(r);return n?r.split(n)[0]:r}}return zs}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS "+Ks));if(t){var r=t[1].replace(/_/g,".");if(r){var n=Ws(r);return n?r.split(n)[0]:r}}return zs}(e):zs}function Qs(e,t){var r=e.match(new RegExp(t+" "+Fs));return r?Ds[r[1]]?Ds[r[1]]:r[1]:zs}function Ws(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var Vs=function(e){if(e.populateOperatingSystemInfo){var t=Ei()||{},r=e.userAgent||t.userAgent||"",n=e.userAgentData||t.userAgentData||{};if(r){var o=function(e){for(var t=0;t<Gs.length;t++){var r=Gs[t];if(r.r&&e.match(r.r))return r.os;if(r.s&&-1!==e.indexOf(r.s))return r.os}return zs}(r.toLowerCase());this.name=o,this.ver=js(r,o)}this.name&&this.name!==zs||!xo(n.platform)||(this.name=n.platform)}},Ys=function(){function e(e,t){this.core=t,e.serviceName&&(this.serviceName=e.serviceName),this._cookieMgr=ka(t)}return e.prototype.getMsfpc=function(){return fs(this._cookieMgr,"MSFPC")},e.prototype.getAnid=function(){return fs(this._cookieMgr,"ANON").slice(0,34)},e._staticInit=(Qo(e.prototype,"msfpc",e.prototype.getMsfpc),void Qo(e.prototype,"anid",e.prototype.getAnid)),e}(),$s=function(e){this.popSample=100,this.eventFlags=0,e.hashIdentifiers&&(this.eventFlags=1048576|this.eventFlags),e.dropIdentifiers&&(this.eventFlags=2097152|this.eventFlags)},Js=function(){var e=(new Date).getTimezoneOffset(),t=e%60,r=(e-t)/60,n="+";r>0&&(n="-"),r=Math.abs(r),t=Math.abs(t),this.tz=n+(r<10?"0"+r:r.toString())+":"+(t<10?"0"+t:t.toString())},Xs=function(){},Zs=function(){function e(){}return e.prototype.setId=function(e){this.customId=e},e.prototype.getId=function(){return xo(this.customId)?this.customId:this.automaticId},e._staticInit=void Qo(e.prototype,"id",e.prototype.getId,e.prototype.setId),e}(),ec=function(e,t,r,n){if(e.enableApplicationInsightsTrace){this.traceId=t||function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n=0;n<4;n++)r+=t[15&(e=Ka())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var o=t[8+(3&Ka())|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+o+r.substr(16,3)+r.substr(19,12)}(),this.parentId=r,this.name=n;var o=ki();o&&o.pathname&&(this.name=o.pathname)}},tc=Wo({id:"id",ver:"ver",appName:"name",locale:"locale",expId:"expId",env:"env"}),rc=Wo({domain:"domain",browser:"browser",browserVer:"browserVer",screenRes:"screenRes",userConsent:"userConsent",consentDetails:"consentDetails"}),nc=Wo({locale:"locale",localId:"localId",id:"id"}),oc=Wo({osName:"name",ver:"ver"}),ic=Wo({ver:"ver",seq:"seq",installId:"installId",epoch:"epoch"}),ac=Wo({msfpc:"msfpc",anid:"anid",serviceName:"serviceName"}),sc=Wo({popSample:"popSample",eventFlags:"eventFlags"}),cc=Wo({tz:"tz"}),uc=Wo({sessionId:"sesId"}),lc=Wo({localId:"localId",deviceClass:"deviceClass",make:"make",model:"model"}),dc=Wo({role:"role",roleInstance:"roleInstance",roleVer:"roleVer"}),hc=Wo({traceId:"traceID",traceName:"name",parentId:"parentID"}),pc=Wo({UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SdkExt:"sdk",IntWebExt:"intweb",UtcExt:"utc",LocExt:"loc",CloudExt:"cloud"}),gc="MicrosoftApplicationsTelemetryDeviceId";var fc,mc,vc=function(){function e(e,t){this._sequenceId=0;var r=e.propertyStorageOverride;this.seq=this._sequenceId,this.epoch=Ka(!1).toString();var n=ka(t,e);if(n.isEnabled()||r){var o=function(e,t,r){return t?t.getProperty(r)||"":fs(e,r)}(n,r,gc);o||(o=Ja()),function(e,t,r,n){t?t.setProperty(r,n):e.set(r,n,31536e3)}(n,r,gc,o),this.installId=o}else n.purge(gc)}return e.prototype.getSequenceId=function(){return++this._sequenceId},e}();function yc(){return void 0===fc&&(fc=!!Tc(mc.LocalStorage)),fc}function Cc(){return yc()?Tc(mc.LocalStorage):null}function Tc(e){var t,r,n=null;try{var o=yn();if(!o)return null;r=new Date,(n=e===mc.LocalStorage?o.localStorage:o.sessionStorage)&&Po(n.setItem)&&(n.setItem(r,r),t=n.getItem(r)!==r,n.removeItem(r),t&&(n=null))}catch(e){n=null}return n}!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(mc||(mc={}));var Ic=function(){function e(t,r){var n,o,i=Fi(t),a=ka(t);Jn(e,this,(function(t){var s,c={sessionRenewalMs:(s=r).sessionRenewalMs&&function(){return s.sessionRenewalMs},sessionExpirationMs:s.sessionExpirationMs&&function(){return s.sessionExpirationMs},cookieDomain:s.cookieDomain&&function(){return s.cookieDomain},namePrefix:s.namePrefix&&function(){return s.namePrefix},sessionAsGuid:function(){return s.sessionAsGuid},idLength:function(){return s.idLength?s.idLength:22}};function u(e){var r=t.automaticSession,n=e.split("|");n.length>0&&r.setId(n[0]);try{if(n.length>1){var o=+n[1];r.acquisitionDate=+new Date(o),r.acquisitionDate=r.acquisitionDate>0?r.acquisitionDate:0}if(n.length>2){var a=+n[2];r.renewalDate=+new Date(a),r.renewalDate=r.renewalDate>0?r.renewalDate:0}}catch(e){i.throwInternal(Xn.CRITICAL,ss.ErrorParsingAISessionCookie,"Error parsing ai_session cookie, session will be reset: "+e)}0===r.renewalDate&&i.throwInternal(Xn.WARNING,ss.SessionRenewalDateIsZero,"AI session renewal date is 0, session will be reset.")}function l(){var e=t.automaticSession,r=(new Date).getTime(),n=t.config.sessionAsGuid();!So(n)&&n?Bo(n)?e.setId(ms()):e.setId(ms(n)):e.setId(Xa(c&&c.idLength?c.idLength():22)),e.acquisitionDate=r,e.renewalDate=r,d(e.getId(),e.acquisitionDate,e.renewalDate),yc()||i.throwInternal(Xn.WARNING,ss.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}function d(e,r,i){var s=r+t.config.sessionExpirationMs(),c=i+t.config.sessionRenewalMs(),u=new Date,l=[e,r,i];s<c?u.setTime(s):u.setTime(c);var d=t.config.cookieDomain?t.config.cookieDomain():null;a.set(o(),l.join("|")+";expires="+u.toUTCString(),null,d),n=(new Date).getTime()}Po(r.sessionExpirationMs)||(c.sessionExpirationMs=function(){return e.acquisitionSpan}),Po(r.sessionRenewalMs)||(c.sessionRenewalMs=function(){return e.renewalSpan}),t.config=c,o=function(){return t.config.namePrefix&&t.config.namePrefix()?e.cookieNameConst+t.config.namePrefix():e.cookieNameConst},t.automaticSession=new Zs,t.update=function(){t.automaticSession.getId()||function(){var e=function(e){return ba(null)?fs(ka(null),e):""}(o());if(e&&Po(e.split))u(e);else{var r=function(e,t){var r=Cc();if(null!==r)try{return r.getItem(t)}catch(t){fc=!1,e.throwInternal(Xn.CRITICAL,ss.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+t)}return null}(i,o());r&&u(r)}t.automaticSession.getId()||l()}();var r=t.automaticSession,a=t.config,s=(new Date).getTime(),c=s-r.acquisitionDate>a.sessionExpirationMs(),h=s-r.renewalDate>a.sessionRenewalMs();if(c||h)l();else{(!n||s-n>e.cookieUpdateInterval)&&(r.renewalDate=s,d(r.getId(),r.acquisitionDate,r.renewalDate))}},t.backup=function(){var e,r,n,a=t.automaticSession;e=a.getId(),r=a.acquisitionDate,n=a.renewalDate,function(e,t,r){var n=Cc();if(null!==n)try{return n.setItem(t,r),!0}catch(t){fc=!1,e.throwInternal(Xn.CRITICAL,ss.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+t)}}(i,o(),[e,r,n].join("|"))}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e.cookieNameConst="ai_session",e}(),wc=xo,Ec=function(){function e(e,t,r){var n=this;n.app=new As(t,r),n.cloud=new _s,n.user=new Rs(e,t,r),n.os=new Vs(t),n.web=new Bs(t,r),n.sdk=new vc(e,r),n.intWeb=new Ys(t,r),n.utc=new $s(t),n.loc=new Js,n.device=new Xs,n.telemetryTrace=new ec(t),n.sessionManager=new Ic(r,t),n.session=new Zs}return e.prototype.getSessionId=function(){var e=this.session;if(e&&wc(e.customId))return e.customId;var t=this.sessionManager;t.update();var r=t.automaticSession;if(r){var n=r.getId();n&&wc(n)&&(e.automaticId=n)}return e.automaticId},e.prototype.applyApplicationContext=function(e){var t=this.app,r=e.ext[pc.AppExt];$o(r,tc.id,t.id,wc),$o(r,tc.ver,t.ver,wc),$o(r,tc.appName,t.name,wc),$o(r,tc.locale,t.locale,wc),$o(r,tc.expId,t.getExpId(),wc),$o(r,tc.env,t.env,wc)},e.prototype.applyUserContext=function(e){var t=this.user,r=e.ext[pc.UserExt];$o(r,nc.localId,t.getLocalId(),wc),$o(r,nc.locale,t.locale,wc),$o(r,nc.id,t.id,wc)},e.prototype.applyWebContext=function(e){var t=this.web,r=e.ext[pc.WebExt];$o(r,rc.domain,t.domain,wc),$o(r,rc.browser,t.browser,wc),$o(r,rc.browserVer,t.browserVer,wc),$o(r,rc.screenRes,t.screenRes,wc),r[rc.userConsent]=t.getUserConsent(),r[rc.consentDetails]=t.getUserConsentDetails()},e.prototype.applyOsContext=function(e){var t=this.os,r=e.ext[pc.OSExt];$o(r,oc.osName,t.name,wc),$o(r,oc.ver,t.ver,wc)},e.prototype.applySdkContext=function(e){var t=this.sdk,r=e.ext[pc.SdkExt];r[ic.seq]=t.getSequenceId(),r[ic.epoch]=t.epoch,$o(r,ic.installId,t.installId,wc)},e.prototype.applyIntWebContext=function(e){var t=this.intWeb,r=e.ext[pc.IntWebExt];$o(r,ac.msfpc,t.getMsfpc(),wc),$o(r,ac.anid,t.getAnid(),wc),$o(r,ac.serviceName,t.serviceName,wc)},e.prototype.applyUtcContext=function(e){var t=this.utc,r=e.ext[pc.UtcExt];r[sc.popSample]=t.popSample,t.eventFlags>0&&(r[sc.eventFlags]=t.eventFlags)},e.prototype.applyLocContext=function(e){e.ext[pc.LocExt][cc.tz]=this.loc.tz},e.prototype.applySessionContext=function(e){e.ext[pc.AppExt][uc.sessionId]=this.getSessionId()},e.prototype.applyDeviceContext=function(e){var t=this.device,r=e.ext[pc.DeviceExt];$o(r,lc.localId,t.localId,wc),$o(r,lc.make,t.make,wc),$o(r,lc.model,t.model,wc),$o(r,lc.deviceClass,t.deviceClass,wc)},e.prototype.applyCloudContext=function(e){var t=this.cloud,r=e.ext[pc.CloudExt];$o(r,dc.role,t.role,wc),$o(r,dc.roleInstance,t.roleInstance,wc),$o(r,dc.roleVer,t.roleVer,wc)},e.prototype.applyAITraceContext=function(e){var t=this.telemetryTrace,r=e.ext[pc.TraceExt];$o(r,hc.traceId,t.traceId,wc),$o(r,hc.traceName,t.name,wc),$o(r,hc.parentId,t.parentId,wc)},e}(),kc=function(e){function t(){var r,n=e.call(this)||this;n.identifier="SystemPropertiesCollector",n.priority=3,n.version="3.1.11";var o={};return Jn(t,n,(function(t,i){t.initialize=function(o,i,a){e.prototype.initialize.call(n,o,i,a),r=new Ec(o,t._getTelCtx().getExtCfg(t.identifier),i)},t.processTelemetry=function(e,n){Cs(e,t.identifier),n=t._getTelCtx(n);var i,a,s=e.ext=e.ext?e.ext:{};e.data=e.data?e.data:{},s[pc.AppExt]=s[pc.AppExt]||{},s[pc.UserExt]=s[pc.UserExt]||{},s[pc.WebExt]=s[pc.WebExt]||{},s[pc.OSExt]=s[pc.OSExt]||{},s[pc.SdkExt]=s[pc.SdkExt]||{},s[pc.IntWebExt]=s[pc.IntWebExt]||{},s[pc.UtcExt]=s[pc.UtcExt]||{},s[pc.LocExt]=s[pc.LocExt]||{},s[pc.DeviceExt]=s[pc.DeviceExt]||{},s[pc.TraceExt]=s[pc.TraceExt]||{},s[pc.CloudExt]=s[pc.CloudExt]||{},r.applyApplicationContext(e),r.applyUserContext(e),r.applyWebContext(e),r.applyOsContext(e),r.applySdkContext(e),r.applyIntWebContext(e),r.applyUtcContext(e),r.applyLocContext(e),r.applySessionContext(e),r.applyDeviceContext(e),r.applyAITraceContext(e),r.applyCloudContext(e),Do(jo(s),(function(e){0===jo(s[e]).length&&delete s[e]})),i=o,a=e.data,i&&Mo(i,(function(e,t){a[e]||(a[e]=t)})),t.processNext(e,n)},t.getPropertiesContext=function(){return r},t.setProperty=function(e,t){o[e]=t}})),n}return En(t,e),t}(Zi),Sc=kc,bc="REAL_TIME",Ac="POST",_c="drop",Rc="send",Pc="requeue",Nc="rspFail",Mc="application/x-json-stream",Oc="cache-control",qc="content-type",Uc="kill-tokens",xc="kill-duration",Lc="time-delta-millis",Bc="AuthMsaDeviceTicket",Hc="msfpc";function Dc(e){var t=(e.ext||{}).intweb;return t&&hs(t[Hc])?t[Hc]:null}function Fc(e){for(var t=null,r=0;null===t&&r<e.length;r++)t=Dc(e[r]);return t}var Kc=function(){function e(t,r){var n=r?[].concat(r):[],o=this,i=Fc(n);o.iKey=function(){return t},o.Msfpc=function(){return i||""},o.count=function(){return n.length},o.events=function(){return n},o.addEvent=function(e){return!!e&&(n.push(e),i||(i=Dc(e)),!0)},o.split=function(r,o){var a;if(r<n.length){var s=n.length-r;bo(o)||(s=o<s?o:s),a=n.splice(r,s),i=Fc(n)}return new e(t,a)}}return e.create=function(t,r){return new e(t,r)},e}(),zc=2e6,Gc=Math.min(zc,65e3),jc="metadata",Qc="f",Wc=/\./,Vc=function e(t,r,n,o){var i="data",a="baseData",s=!!o,c=!0,u=r,l={};Jn(e,this,(function(e){function r(e,t,o,i,a,c,d){Mo(e,(function(e,h){var p=null;if(h||hs(h)){var g=o,f=e,m=a,v=t;if(s&&!i&&Wc.test(e)){var y=e.split("."),C=y.length;if(C>1){m&&(m=m.slice());for(var T=0;T<C-1;T++){var I=y[T];v=v[I]=v[I]||{},g+="."+I,m&&m.push(I)}f=y[C-1]}}var w=i&&function(e){var t=l[e];return void 0===t&&(e.length>=7&&(t=Oo(e,"ext.metadata")||Oo(e,"ext.web")),l[e]=t),t}(g);if(p=!w&&u&&u.handleField(g,f)?u.value(g,f,h,n):ps(f,h,n)){var E=p.value;if(v[f]=E,c&&c(m,f,p),d&&"object"==typeof E&&!Uo(E)){var k=m;k&&(k=k.slice()).push(f),r(h,E,g+"."+f,i,k,c,d)}}}}))}e.createPayload=function(e,t,r,n,o,i){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:r,isBeacon:n,sendType:i,sendReason:o}},e.appendPayload=function(r,n,o){var i=r&&n&&!r.overflow;return i&&Wi(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=n.events(),i=r.payloadBlob,a=r.numEvents,s=!1,c=[],u=[],l=r.isBeacon,d=l?65e3:3984588,h=l?Gc:zc,p=0,g=0;p<t.length;){var f=t[p];if(f){if(a>=o){r.overflow=n.split(p);break}var m=e.getEventBlob(f);if(m&&m.length<=h){var v=m.length;if(i.length+v>d){r.overflow=n.split(p);break}i&&(i+="\r\n"),i+=m,++g>20&&(i.substr(0,1),g=0),s=!0,a++}else m?c.push(f):u.push(f),t.splice(p,1),p--}p++}if(c&&c.length>0&&r.sizeExceed.push(Kc.create(n.iKey(),c)),u&&u.length>0&&r.failedEvts.push(Kc.create(n.iKey(),u)),s){r.batches.push(n),r.payloadBlob=i,r.numEvents=a;var y=n.iKey();-1===Fo(r.apiKeys,y)&&r.apiKeys.push(y)}}),(function(){return{payload:r,theBatch:{iKey:n.iKey(),evts:n.events()},max:o}})),i},e.getEventBlob=function(e){try{return Wi(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey);var n={},o=e.ext;o&&(t.ext=n,Mo(o,(function(e,t){r(t,n[e]={},"ext."+e,!0,null,null,!0)})));var s=t[i]={};s.baseType=e.baseType;var u=s[a]={};return r(e.baseData,u,a,!1,[a],(function(e,t,r){Yc(n,e,t,r)}),c),r(e.data,s,i,!1,[],(function(e,t,r){Yc(n,e,t,r)}),c),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))};function Yc(e,t,r,n){if(n&&e){var o=gs(n.value,n.kind,n.propertyType);if(o>-1){var i=e[jc];i||(i=e[jc]={f:{}});var a=i[Qc];if(a||(a=i[Qc]={}),t)for(var s=0;s<t.length;s++){var c=t[s];a[c]||(a[c]={f:{}});var u=a[c][Qc];u||(u=a[c][Qc]={}),a=u}a=a[r]={},Uo(n.value)?a.a={t:o}:a.t=o}}}
/**
    * RetryPolicy.ts
    * @author Abhilash Panwar (abpanwar)
    * @copyright Microsoft 2018
    */var $c,Jc,Xc=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var t,r=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*r,Math.min(t,6e5)},e}(),Zc=function e(){var t={};Jn(e,this,(function(e){e.setKillSwitchTenants=function(e,r){if(e&&r)try{var n=(a=e.split(","),s=[],a&&Do(a,(function(e){s.push(Ko(e))})),s);if("this-request-only"===r)return n;for(var o=1e3*parseInt(r,10),i=0;i<n.length;++i)t[n[i]]=Vo()+o}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var r=t,n=Ko(e);return void 0!==r[n]&&r[n]>Vo()||(delete r[n],!1)}}))},eu=Zc,tu=function e(){var t=!0,r=!0,n=!0,o="use-collector-delta",i=!1;Jn(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){n&&(n=!1,i||(t=!1))},e.shouldAddClockSkewHeaders=function(){return r},e.getClockSkewHeaderValue=function(){return o},e.setClockSkew=function(e){i||(e?(o=e,r=!0,i=!0):r=!1,t=!0)}}))},ru="sendAttempt",nu="&NoResponseBody=true",ou=(($c={})[1]=Pc,$c[100]=Pc,$c[200]="sent",$c[8004]=_c,$c[8003]=_c,$c),iu={};function au(e){try{return e.responseText}catch(e){}return""}function su(e,t){var r=!1;if(e&&t){var n=jo(e);if(n&&n.length>0)for(var o=t.toLowerCase(),i=0;i<n.length;i++){var a=n[i];if(a&&_o(t,a)&&a.toLowerCase()===o){r=!0;break}}}return r}function cu(e,t,r,n){t&&r&&r.length>0&&(n&&iu[t]?(e.hdrs[iu[t]]=r,e.useHdrs=!0):e.url+="&"+t+"="+r)}Jc=Bc,iu[Bc]=Jc;var uu,lu,du,hu,pu=function e(t,r,n,o){this._responseHandlers=[];var i,a,s,c,u,l,d="?cors=true&"+qc.toLowerCase()+"="+Mc,h=new eu,p=!1,g=new tu,f=!1,m=0,v=!0,y=[],C={},T=[],I=null,w=!1,E=!1,k=!1;Jn(e,this,(function(e){var S=!0;function b(e,t){for(var r=0,n=null,o=0;null==n&&o<e.length;)1===(r=e[o])?(null===fi&&(fi="undefined"!=typeof XDomainRequest)&&Mi()&&(fi=fi&&!vi(yi("XMLHttpRequest"),"withCredentials")),fi?n=A:Mi()&&(n=R)):2===r&&Ni(t)?n=_:f&&3===r&&Pi()&&(n=N),o++;return n?{_transport:r,_isSync:t,sendPOST:n}:null}function A(e,t,r){var n=new XDomainRequest;n.open(Ac,e.urlString),e.timeout&&(n.timeout=e.timeout),n.onload=function(){var e=au(n);P(t,200,{},e),z(e)},n.onerror=function(){P(t,400,{})},n.ontimeout=function(){P(t,500,{})},n.onprogress=function(){},r?n.send(e.data):i._setTimeoutOverride((function(){n.send(e.data)}),0)}function _(e,t,r){var n,o=e.urlString,a=!1,s=!1,c=((n={body:e.data,method:Ac}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,n);r&&(c.keepalive=!0,2===e._sendReason&&(a=!0,o+=nu)),S&&(c.credentials="include"),e.headers&&jo(e.headers).length>0&&(c.headers=e.headers),fetch(o,c).then((function(e){var r={},n="";e.headers&&e.headers.forEach((function(e,t){r[t]=e})),e.body&&e.text().then((function(e){n=e})),s||(s=!0,P(t,e.status,r,n),z(n))})).catch((function(e){s||(s=!0,P(t,0,{}))})),a&&!s&&(s=!0,P(t,200,{})),!s&&e.timeout>0&&i._setTimeoutOverride((function(){s||(s=!0,P(t,500,{}))}),e.timeout)}function R(e,t,r){var n=e.urlString;function o(e,t,r){if(!e[r]&&t&&t.getResponseHeader){var n=t.getResponseHeader(r);n&&(e[r]=Ko(n))}return e}function i(e){var t,r,n={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),r={},xo(t)&&Do(Ko(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var n=Ko(e.substring(0,t)).toLowerCase(),o=Ko(e.substring(t+1));r[n]=o}else r[Ko(e)]=1}})),n=r):(n=o(n,e,Lc),n=o(n,e,xc),n=o(n,e,"kill-duration-seconds")),n}function a(e,r){P(t,e.status,i(e),r)}r&&e.disableXhrSync&&(r=!1);var s=function(e,t,r,n,o,i){function a(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===o&&(o=!1);var s=new XMLHttpRequest;return n&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",n),r&&a(s,us,r),s.open(e,t,!o),r&&a(s,us,r),!o&&i&&a(s,"timeout",i),s}(Ac,n,S,!0,r,e.timeout);Mo(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=au(s);a(s,e),z(e)},s.onerror=function(){a(s)},s.ontimeout=function(){a(s)},s.send(e.data)}function P(e,t,r,n){try{e(t,r,n)}catch(e){i.diagLog().throwInternal(Xn.WARNING,ss.SendPostOnCompleteFailure,Ri(e))}}function N(e,t,r){var n=200,o=e._thePayload,a=e.urlString+nu;try{var s=Ei();if(!s.sendBeacon(a,e.data))if(o){var c=[];Do(o.batches,(function(e){if(c&&e&&e.count()>0){for(var t=e.events(),r=0;r<t.length;r++)if(!s.sendBeacon(a,I.getEventBlob(t[r]))){c.push(e.split(r));break}}else c.push(e.split(0))})),G(c,8003,o.sendType,!0)}else n=0}catch(e){i.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),n=0}finally{P(t,n,{},"")}}function M(e){return 2===e||3===e}function O(e){return E&&M(e)&&(e=2),e}function q(){return!p&&m<r}function U(){var e=T;return T=[],e}function x(e,t,r){var n=!1;return e&&e.length>0&&!p&&a[t]&&I&&(n=0!==t||q()&&(r>0||g.allowRequestSending())),n}function L(e){var t={};return e&&Do(e,(function(e,r){t[r]={iKey:e.iKey(),evts:e.events()}})),t}function B(e,r,n,o,c){if(e&&0!==e.length)if(p)G(e,1,o);else{o=O(o);try{var u=e,l=0!==o;Wi(s,(function(){return"HttpManager:_sendBatches"}),(function(i){i&&(e=e.slice(0));for(var s=[],u=null,d=ys(),p=a[o]||(l?a[1]:a[0]),g=(E||M(o)||p&&3===p._transport)&&!v&&f&&Pi();x(e,o,r);){var m=e.shift();m&&m.count()>0&&(h.isTenantKilled(m.iKey())?s.push(m):(u=u||I.createPayload(r,n,l,g,c,o),I.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,F(u,d,ys(),c),d=ys(),u=null):(F(u,d,ys(),c),d=ys(),e=[m].concat(e),u=null)))}u&&F(u,d,ys(),c),e.length>0&&(T=e.concat(T)),G(s,8004,o)}),(function(){return{batches:L(u),retryCount:r,isTeardown:n,isSynchronous:l,sendReason:c,useSendBeacon:M(o),sendType:o}}),!l)}catch(e){i.diagLog().throwInternal(Xn.WARNING,ss.CannotSerializeObject,"Unexpected Exception sending batch: "+Ri(e))}}}function H(e,t){var r={url:d,hdrs:{},useHdrs:!1};r.hdrs=vs(r.hdrs,C),r.useHdrs=jo(r.hdrs).length>0,cu(r,"client-id","NO_AUTH",t),cu(r,"client-version",cs,t);var n="";Do(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),cu(r,"apikey",n,t),cu(r,"upload-time",Vo().toString(),t);var o=function(e){for(var t=0;t<e.batches.length;t++){var r=e.batches[t].Msfpc();if(r)return encodeURIComponent(r)}return""}(e);if(hs(o)&&(r.url+="&ext.intweb.msfpc="+o),g.shouldAddClockSkewHeaders()&&cu(r,"time-delta-to-apply-millis",g.getClockSkewHeaderValue(),t),s.getWParam){var i=s.getWParam();i>=0&&(r.url+="&w="+i)}for(var a=0;a<y.length;a++)r.url+="&"+y[a].name+"="+y[a].value;return r}function D(e,t,r){e[t]=e[t]||{},e[t][i.identifier]=r}function F(t,r,o,c){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var d=!!e.sendHook,p=a[t.sendType];!M(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=a[2]||a[3]||p);var f=k;(t.isBeacon||3===p._transport)&&(f=!1);var y=H(t,f);f=f||y.useHdrs;var C=ys();Wi(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var a=0;a<t.batches.length;a++)for(var T=t.batches[a].events(),I=0;I<T.length;I++){var k=T[I];if(w){var S=k.timings=k.timings||{};D(S,"sendEventStart",C),D(S,"serializationStart",r),D(S,"serializationCompleted",o)}k[ru]>0?k[ru]++:k[ru]=1}G(t.batches,1e3+(c||0),t.sendType,!0);var b={data:t.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:t,_sendReason:c,timeout:u};So(l)||(b.disableXhrSync=!!l),f&&(su(b.headers,Oc)||(b.headers[Oc]="no-cache, no-store"),su(b.headers,qc)||(b.headers[qc]=Mc));var A=null;p&&(A=function(r){g.firstRequestSent();var o=function(r,o){!function(t,r,o,a){var s=9e3,c=null,u=!1,l=!1;try{var d=!0;if(typeof t!==cn){if(r){g.setClockSkew(r[Lc]);var p=r[xc]||r["kill-duration-seconds"];Do(h.setKillSwitchTenants(r[Uc],p),(function(e){Do(o.batches,(function(t){if(t.iKey()===e){c=c||[];var r=t.split(0);o.numEvents-=r.count(),c.push(r)}}))}))}if(200==t||204==t)return void(s=200);(!Xc.shouldRetryForStatus(t)||o.numEvents<=0)&&(d=!1),s=9e3+t%1e3}if(d){s=100;var f=o.retryCnt;0===o.sendType&&(f<n?(u=!0,K((function(){0===o.sendType&&m--,B(o.batches,f+1,o.isTeardown,E?2:o.sendType,5)}),E,Xc.getMillisToBackoffForRetry(f))):(l=!0,E&&(s=8001)))}}finally{u||(g.setClockSkew(),function(t,r,n,o){try{o&&i._backOffTransmission(),200===r&&(o||t.isSync||i._clearBackOff(),function(e){if(w){var t=ys();Do(e,(function(e){e&&e.count()>0&&function(e,t){w&&Do(e,(function(e){D(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),G(t.batches,r,t.sendType,!0)}finally{0===t.sendType&&(m--,5!==n&&e.sendQueuedRequests(t.sendType,n))}}(o,s,a,l)),G(c,8004,o.sendType)}}(r,o,t,c)},a=t.isTeardown||t.isSync;try{p.sendPOST(r,o,a),e.sendListener&&e.sendListener(b,r,a,t.isBeacon)}catch(e){i.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+Ri(e)),P(o,0,{})}}),Wi(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(A)if(0===t.sendType&&m++,d&&!t.isBeacon&&3!==p._transport){var r={data:b.data,urlString:b.urlString,headers:vs({},b.headers),timeout:b.timeout,disableXhrSync:b.disableXhrSync},n=!1;Wi(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(r,(function(e){n=!0,v||e._thePayload||(e._thePayload=e._thePayload||b._thePayload,e._sendReason=e._sendReason||b._sendReason),A(e)}),t.isSync||t.isTeardown)}catch(e){n||A(b)}}))}else A(b)}))}),(function(){return{thePayload:t,serializationStart:r,serializationCompleted:o,sendReason:c}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&G(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&G(t.failedEvts,8002,t.sendType)}function K(e,t,r){t?e():i._setTimeoutOverride(e,r)}function z(t){var r=e._responseHandlers;try{for(var n=0;n<r.length;n++)try{r[n](t)}catch(e){i.diagLog().throwInternal(Xn.CRITICAL,ss.PostResponseHandler,"Response handler failed: "+e)}if(t){var o=JSON.parse(t);hs(o.webResult)&&hs(o.webResult[Hc])&&c.set("MSFPC",o.webResult[Hc],31536e3)}}catch(e){}}function G(e,t,r,n){if(e&&e.length>0&&o){var a=o[(u=t,l=ou[u],hs(l)||(l="oth",u>=9e3&&u<=9999?l=Nc:u>=8e3&&u<=8999?l=_c:u>=1e3&&u<=1999&&(l=Rc)),l)];if(a){var c=0!==r;Wi(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){K((function(){try{a.call(o,e,t,c,r)}catch(e){i.diagLog().throwInternal(Xn.CRITICAL,ss.NotificationException,"send request notification failed: "+e)}}),n||c,0)}),(function(){return{batches:L(e),reason:t,isSync:c,sendSync:n,sendType:r}}),!c)}}var u,l}e.initialize=function(e,t,r,n,o){var h;o||(o={}),d=e+d,k=!So(o.avoidOptions)&&!o.avoidOptions,s=t,c=t.getCookieMgr(),w=!s.config.disableEventTimings;var p=!!s.config.enableCompoundKey;i=r;var g=o.valueSanitizer,m=o.stringifyObjects;So(o.enableCompoundKey)||(p=!!o.enableCompoundKey),u=o.xhrTimeout,l=o.disableXhrSync,f=!Ai(),I=new Vc(s,g,m,p);var y=n,C=o.alwaysUseXhrOverride?n:null,T=o.alwaysUseXhrOverride?n:null;if(!n){v=!1;var E=ki();E&&E.protocol&&"file:"===E.protocol.toLowerCase()&&(S=!1);var A=[];A=Ai()?[2,1]:[1,2,3];var _=o.transports;_&&(Lo(_)?A=[_].concat(A):Uo(_)&&(A=_.concat(A))),n=b(A,!1),y=b(A,!0),n||i.diagLog().warnToConsole("No available transport to send events")}(h={})[0]=n,h[1]=y||b([1,2,3],!0),h[2]=C||b([3,2],!0)||y||b([1],!0),h[3]=T||b([2,3],!0)||y||b([1],!0),a=h},e._getDbgPlgTargets=function(){return[a[0],h,I,a]},e.addQueryStringParameter=function(e,t){for(var r=0;r<y.length;r++)if(y[r].name===e)return void(y[r].value=t);y.push({name:e,value:t})},e.addHeader=function(e,t){C[e]=t},e.canSendRequest=function(){return q()&&g.allowRequestSending()},e.sendQueuedRequests=function(e,t){So(e)&&(e=0),E&&(e=O(e),t=2),x(T,e,0)&&B(U(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!p&&0===m&&0===T.length},e.setUnloading=function(e){E=e},e.addBatch=function(e){if(e&&e.count()>0){if(h.isTenantKilled(e.iKey()))return!1;T.push(e)}return!0},e.teardown=function(){T.length>0&&B(U(),0,!0,2,2)},e.pause=function(){p=!0},e.resume=function(){p=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,r){e&&e.count()>0&&(bo(t)&&(t=1),E&&(t=O(t),r=2),B([e],0,!1,t,r||0))}}))},gu=ds?window:void 0,fu="eventsDiscarded",mu="overrideInstrumentationKey",vu="maxEventRetryAttempts",yu="maxUnloadEventRetryAttempts",Cu=function(e){function t(){var r,n=e.call(this)||this;n.identifier="PostChannel",n.priority=1011,n.version="3.1.11";var o,i,a,s,c,u=!1,l=[],d=null,h=!1,p=0,g=500,f=0,m=1e4,v={},y=bc,C=null,T=null,I=0,w=0,E={},k=-1,S=!0,b=!1,A=6,_=2;return Jn(t,n,(function(e,t){function n(e){"beforeunload"!==(e||Ti().event).type&&(b=!0,i.setUnloading(b)),x(2,2)}function R(e){b=!1,i.setUnloading(b)}function P(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=rs),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,S&&(e.ext=ei(e.ext),e.baseData&&(e.baseData=ei(e.baseData)),e.data&&(e.data=ei(e.data))),e.sync)if(I||h)e.latency=os,e.sync=!1;else if(i)return S&&(e=ei(e)),void i.sendSynchronousBatch(Kc.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var r=e.latency,n=f,o=m;r===is&&(n=p,o=g);var a=!1;if(n<o)a=!H(e,t);else{var s=rs,c=20;r===is&&(s=is,c=1),a=!0,function(e,t,r,n){for(;r<=t;){var o=L(e,t,!0);if(o&&o.count()>0){var i=o.split(0,n),a=i.count();if(a>0)return r===is?p-=a:f-=a,W(fu,[i],no),!0}r++}return D(),!1}(e.iKey,e.latency,s,c)&&(a=!H(e,t))}a&&Q(fu,[e],no)}function N(e,t,r){var n=F(e,t,r);return i.sendQueuedRequests(t,r),n}function M(){return f>0}function O(){if(k>=0&&F(k,0,c)&&i.sendQueuedRequests(0,c),p>0&&!T&&!h){var e=v[y][2];e>=0&&(T=q((function(){T=null,N(is,0,1),O()}),e))}var t=v[y][1];!C&&!d&&t>=0&&!h&&(M()?C=q((function(){C=null,N(0===w?os:rs,0,1),w++,w%=2,O()}),t):w=0)}function q(t,r){0===r&&I&&(r=1);var n=1e3;return I&&(n=Xc.getMillisToBackoffForRetry(I-1)),e._setTimeoutOverride(t,r*n)}function U(){null!==C&&(e._clearTimeoutOverride(C),C=null,w=0)}function x(t,r){U(),d&&(e._clearTimeoutOverride(d),d=null),h||N(rs,t,r)}function L(e,t,r){var n=E[t];n||(n=E[t=rs]);var o=n.iKeyMap[e];return!o&&r&&(o=Kc.create(e),n.batches.push(o),n.iKeyMap[e]=o),o}function B(t,r){i.canSendRequest()&&!I&&(a>0&&f>a&&(r=!0),r&&null==d&&e.flush(t,null,20))}function H(e,t){S&&(e=ei(e));var r=e.latency,n=L(e.iKey,r,!0);return!!n.addEvent(e)&&(r!==is?(f++,t&&0===e.sendAttempt&&B(!e.sync,s>0&&n.count()>=s)):p++,!0)}function D(){for(var e=0,t=0,r=function(r){var n=E[r];n&&n.batches&&Do(n.batches,(function(n){r===is?e+=n.count():t+=n.count()}))},n=rs;n<=is;n++)r(n);f=t,p=e}function F(t,r,n){var o=!1,a=0===r;return!a||i.canSendRequest()?Wi(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],r=is;r>=t;){var n=E[r];n&&n.batches&&n.batches.length>0&&(Do(n.batches,(function(t){i.addBatch(t)?o=o||t&&t.count()>0:e=e.concat(t.events()),r===is?p-=t.count():f-=t.count()})),n.batches=[],n.iKeyMap={}),r--}e.length>0&&Q(fu,e,ro),o&&k>=t&&(k=-1,c=0)}),(function(){return{latency:t,sendType:r,sendReason:n}}),!a):(k=k>=0?Math.min(k,t):t,c=Math.max(c,n)),o}function K(e,t){N(rs,0,t),z((function(){e&&e(),l.length>0?d=q((function(){return K(l.shift(),t)}),0):(d=null,M()&&O())}))}function z(e){i.isCompletelyIdle()?e():d=q((function(){z(e)}),.25)}function G(){(v={})[bc]=[2,1,0],v.NEAR_REAL_TIME=[6,3,0],v.BEST_EFFORT=[18,9,0]}function j(t,r){var n=e._notificationManager||{},o=n[t];if(o)try{o.apply(n,r)}catch(r){e.diagLog().throwInternal(Xn.CRITICAL,ss.NotificationException,t+" notification failed: "+r)}}function Q(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t.length>0&&j(e,[t].concat(r))}function W(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t.length>0&&Do(t,(function(t){t&&t.count()>0&&j(e,[t.events()].concat(r))}))}function V(){s=r&&r.disableAutoBatchFlushLimit?0:Math.max(1500,m/6)}G(),E[is]={batches:[],iKeyMap:{}},E[os]={batches:[],iKeyMap:{}},E[ns]={batches:[],iKeyMap:{}},E[rs]={batches:[],iKeyMap:{}},V(),i=new pu(500,2,1,{requeue:function(t,r){var n=[],o=A;b&&(o=_);Do(t,(function(t){t&&t.count()>0&&Do(t.events(),(function(t){t&&(t.sync&&(t.latency=is,t.sync=!1),t.sendAttempt<o?(Cs(t,e.identifier),P(t,!1)):n.push(t))}))})),n.length>0&&Q(fu,n,eo);b&&x(2,2)},send:function(e,t,r){e&&e.length>0&&j("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==r])},sent:function(e,t){W("eventsSent",e,t),O()},drop:function(e,t){W(fu,e,t>=8e3&&t<=8999?t-8e3:Zn)},rspFail:function(e){W(fu,e,eo),O()},oth:function(e,t){W(fu,e,Zn),O()}}),e._getDbgPlgTargets=function(){return[i]},e.initialize=function(s,c,u){Wi(c,(function(){return"PostChannel:initialize"}),(function(){var l=c;t.initialize(s,c,u),e.setInitialized(!1);var d=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},r=d.getExtCfg(e.identifier),e._setTimeoutOverride=r.setTimeoutOverride?r.setTimeoutOverride:setTimeout.bind(gu),e._clearTimeoutOverride=r.clearTimeoutOverride?r.clearTimeoutOverride:clearTimeout.bind(gu),S=!r.disableOptimizeObj&&!!yi("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return r.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(l),r.eventsLimitInMem>0&&(m=r.eventsLimitInMem),r.immediateEventLimit>0&&(g=r.immediateEventLimit),r.autoFlushEventsLimit>0&&(a=r.autoFlushEventsLimit),r.disableXhrSync,Lo(r[vu])&&(A=r[vu]),Lo(r[yu])&&(_=r[yu]),V(),r.httpXHROverride&&r.httpXHROverride.sendPOST&&(o=r.httpXHROverride),hs(s.anonCookieName)&&i.addQueryStringParameter("anoncknm",s.anonCookieName),i.sendHook=r.payloadPreprocessor,i.sendListener=r.payloadListener;var h=r.overrideEndpointUrl?r.overrideEndpointUrl:s.endpointUrl;e._notificationManager=s.extensionConfig.NotificationManager,i.initialize(h,e.core,e,o,r);var p=s.disablePageUnloadEvents||[];Va(n,p),Ya(n,p),$a(R,s.disablePageShowEvents),e.setInitialized(!0)}),(function(){return{coreConfig:s,core:c,extensions:u}}))},e.processTelemetry=function(t,n){Cs(t,e.identifier);var o=(n=e._getTelCtx(n)).getExtCfg(e.identifier),i=!!r.disableTelemetry;o&&(i=i||!!o.disableTelemetry);var a=t;i||u||(r[mu]&&(a.iKey=r[mu]),o&&o[mu]&&(a.iKey=o[mu]),P(a,!0),b?x(2,2):O()),e.processNext(a,n)},e.setEventQueueLimits=function(e,t){m=e>0?e:1e4,a=t>0?t:0,V();var r=f>e;if(!r&&s>0)for(var n=rs;!r&&n<=os;n++){var o=E[n];o&&o.batches&&Do(o.batches,(function(e){e&&e.count()>=s&&(r=!0)}))}B(!0,r)},e.teardown=function(){x(2,2),u=!0,i.teardown()},e.pause=function(){U(),h=!0,i.pause()},e.resume=function(){h=!1,i.resume(),O()},e.addResponseHandler=function(e){i._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){U(),G(),y=bc,O(),Mo(e,(function(e,t){var r=t.length;if(r>=2){var n=r>2?t[2]:0;if(t.splice(0,r-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var o=t[0]/t[1];t[0]=Math.ceil(o)*t[1]}n>=0&&t[1]>=0&&n>t[1]&&(n=t[1]),t.push(n),v[e]=t}}))},e.flush=function(e,t,r){void 0===e&&(e=!0),h||(U(),r=r||1,e?(F(rs,0,r),D(),null==d?d=q((function(){K(t,r)}),0):l.push(t)):(N(rs,1,r),null!=t&&t()))},e.setMsaAuthTicket=function(e){i.addHeader(Bc,e)},e.hasEvents=M,e._setTransmitProfile=function(e){y!==e&&void 0!==v[e]&&(U(),y=e,O())},e._backOffTransmission=function(){I<4&&(I++,U(),O())},e._clearBackOff=function(){I&&(I=0,U(),O())}})),n}return En(t,e),t}(Zi),Tu=Cu,Iu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return En(t,e),t.prototype.initialize=function(t,r){var n=this,o=this;Wi(this,(function(){return"ApplicationInsights:initialize"}),(function(){o._postChannel=new Tu,o._propertyManager=new Sc;var i=[n._propertyManager];if(r&&(i=i.concat(r)),t||Zo("You must provide a config object!"),t.channels&&t.channels.length>0){for(var a=!1,s=0;s<t.channels[0].length;s++)if(t.channels[0][s].identifier===o._postChannel.identifier){a=!0;break}a||t.channels[0].push(o._postChannel)}else t.channels=[[o._postChannel]];var c=t.extensionConfig=t.extensionConfig||[];c[o._postChannel.identifier]=t?t.channelConfiguration:{},c[o._propertyManager.identifier]=t?t.propertyConfiguration:{};try{e.prototype.initialize.call(n,t,i)}catch(e){o.logger.throwInternal(Xn.CRITICAL,ss.FailedToInitializeSDK,"Failed to initialize SDK."+Ri(e))}}),(function(){return{config:t,extensions:r}}))},t.prototype.getPropertyManager=function(){return this._propertyManager},t.prototype.getPostChannel=function(){return this._postChannel},t}(Es),wu=Iu,Eu=function(){function e(t,r){this.logger=t,this.isSampled=!(null==r?void 0:r.disabled)&&this.calculateSampling(null==r?void 0:r.samplingPercentage),this.logger.verbose("PerformanceTelemetryReporter: Sampled for 1p telemetry: "+this.isSampled.toString()),this.eventsToEmit=(null==r?void 0:r.eventsToEmit)||[xe.AcquireTokenSilent,xe.SsoSilent,xe.AcquireTokenByCode],this.logger.verbose("PerformanceTelemetryReporter: Events to be tracked include : "+this.eventsToEmit),this.logger.verbose("PerformanceTelemetryReporter: Events passed in the PerformanceTelemetryConfiguration are: "+(null==r?void 0:r.eventsToEmit));var n={instrumentationKey:e.instrumentationKey,extensions:[]};this.appInsights=new wu,this.appInsights.initialize(n,[]),this.logger.verbose("PerformanceTelemetryReporter: Initialized")}return e.prototype.calculateSampling=function(t){return 0===t?(this.logger.verbose(" PerformanceTelemetryReporter: No sampling rate configured."),!1):(this.logger.verbose("PerformanceTelemetryReporter: Configured sampling rate = "+t+" "),this.logger.verbose("PerformanceTelemetryReporter: DEFAULT sampling rate = "+e.DEFAULT_SAMPLING_RATE),Math.random()<=(t||e.DEFAULT_SAMPLING_RATE))},e.prototype.sendCustomEvent=function(e){var t=n(n({},e),{appName:void 0}),r={name:e.name,data:t};this.logger.verbose("PerformanceTelemetryReporter: Sending "+r.name+" for tracking"),this.appInsights.track(r)},e.prototype.canSendEvent=function(t){var r,n=!this.eventsToEmit||(null===(r=this.eventsToEmit)||void 0===r?void 0:r.indexOf(t.name))>-1,o=e.DEFAULT_ALLOWED_CLOUDS.some((function(e){return 0===t.authority.indexOf(e.toString())}));return this.isSampled&&n&&o},e.prototype.getPerformanceTelemetryCallback=function(){var e=this;this.logger.trace("PerformanceTelemetryReporter: Attaching callback to send custom metrics.");return this.logger.verbose(" PerformanceTelemetryReporter: Returning callback as telemetry emitted."),function(t){t.forEach((function(t){e.canSendEvent(t)?(e.logger.verbose("PerformanceTelemetryReporter: Emitting telemetry for "+t.name,t.correlationId),e.sendCustomEvent(t)):e.logger.verbose("PerformanceTelemetryReporter: Skipping telemetry for "+t.name,t.correlationId)}))}},e.DEFAULT_SAMPLING_RATE=.1,e.DEFAULT_ALLOWED_CLOUDS=[de.AzurePublic,de.AzurePpe],e.instrumentationKey="d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725",e}(),ku=function(e){function t(t,r){var n=e.call(this,t)||this,o=new Eu(n.getLogger(),null==r?void 0:r.performanceTelemetryConfiguration);return n.addPerformanceCallback(o.getPerformanceTelemetryCallback()),n}return r(t,e),t}(tn);!function(e){e.HANDSHAKE_REQUEST="BrokerHandshakeRequest",e.HANDSHAKE_RESPONSE="BrokerHandshakeResponse",e.AUTH_REQUEST="BrokerAuthRequest",e.REDIRECT_RESPONSE="BrokerRedirectResponse",e.HANDLE_REDIRECT_REQUEST="BrokerHandleRedirectRequest",e.AUTH_RESULT="BrokerAuthResult"}(uu||(uu={})),function(e){e.BROKER_RESPONSE="broker.response"}(lu||(lu={})),function(e){e.BROKER_CLIENT_ID="brk_client_id",e.BROKER_REDIRECT_URI="brk_redirect_uri"}(du||(du={})),function(e){e.BROKER_AUTH_ERROR_NAME="BrokerAuthError",e.INTERACTION_REQ_ERROR_NAME="InteractionRequiredAuthError",e.SERVER_ERROR_NAME="ServerError",e.CLIENT_AUTH_ERR_NAME="ClientAuthError",e.CLIENT_CONFIG_ERROR_NAME="ClientConfigurationError",e.BROWSER_AUTH_ERROR_NAME="BrowserAuthError",e.BROWSER_CONFIG_ERROR_NAME="BrowserConfigurationError",e.AUTH_ERROR_NAME="AuthError"}(hu||(hu={}));var Su="plain",bu="S256",Au=function(){function e(e){this.messageType=e}return e.validateMessage=function(e){if(!e.data||!e.data.messageType)return null;switch(e.data.messageType){case uu.HANDSHAKE_REQUEST:case uu.HANDSHAKE_RESPONSE:case uu.HANDLE_REDIRECT_REQUEST:case uu.AUTH_REQUEST:case uu.AUTH_RESULT:case uu.REDIRECT_RESPONSE:return e;default:return null}},e}(),_u=function(e){function t(t,r){var n=e.call(this,uu.HANDSHAKE_REQUEST)||this;return n.embeddedClientId=t,n.version=r,n}return r(t,e),t.validate=function(e){return e.data&&e.data.messageType===uu.HANDSHAKE_REQUEST&&e.data.embeddedClientId&&e.data.version?new t(e.data.embeddedClientId,e.data.version):null},t}(Au),Ru={code:"no_tokens_to_cache",desc:"The broker did not have any tokens for the client to cache."},Pu={code:"no_embedded_app",desc:"The embedded application object was not created. Please ensure you have configured your application correctly for an embedded application: https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/broker-v2/lib/msal-browser/docs/broker.md#brokered-application-configuration"},Nu={code:"broker_response_invalid",desc:"The broker response did not have the expected values."},Mu={code:"broker_request_incomplete",desc:"The brokered request did not have the expected values."},Ou={code:"broker_popup_will_redirect",desc:"The request for a brokered popup requires a redirect by the broker. If your app does not perform the redirect, please check the broker's logs."},qu={code:"broker_timeout",desc:"Message broker timed out."},Uu={code:"broker_handshake_timeout",desc:"Broker handshake response timed out."},xu={code:"invalid_broker_message",desc:"messageType for broker message is invalid"},Lu={code:"untrusted_broker_error",desc:"The given broker origin is not trusted."},Bu={code:"no_trusted_brokers_provided",desc:"No trusted brokers provided."},Hu={code:"brokering_disabled",desc:"Brokering is not enabled for the client application. Please check logs to see if handshake was performed."},Du=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name=hu.BROKER_AUTH_ERROR_NAME,o}return r(t,e),t.createNoTokensToCacheError=function(){return new t(Ru.code,""+Ru.desc)},t.createNoEmbeddedAppError=function(){return new t(Pu.code,Pu.desc)},t.createBrokerResponseInvalidError=function(){return new t(Nu.code,""+Nu.desc)},t.createBrokerRequestIncompleteError=function(){return new t(Mu.code,""+Mu.desc)},t.createBrokerPopupRequestRedirectingError=function(){return new t(Ou.code,Ou.desc)},t.createNoTrustedBrokersProvidedError=function(){return new Bt(Bu.code,Bu.desc)},t.createBrokeringDisabledError=function(e){return new Bt(Hu.code,Hu.desc+" Inner Error: "+e)},t.createMessageBrokerTimeoutError=function(){return new Bt(qu.code,qu.desc)},t.createMessageBrokerHandshakeTimeoutError=function(){return new Bt(Uu.code,Uu.desc)},t.createInvalidBrokerMessageError=function(){return new Bt(xu.code,xu.desc)},t.createUntrustedBrokerError=function(){return new Bt(Lu.code,Lu.desc)},t}(Bt),Fu=function(e){function t(t,r){var n=e.call(this,uu.HANDSHAKE_RESPONSE)||this;return n.version=t,n.brokerOrigin=r,n}return r(t,e),t.validate=function(e,r){var n=Au.validateMessage(e);if(r&&n&&n.data.messageType===uu.HANDSHAKE_RESPONSE&&n.data.version){if(r.filter((function(t){return le.matchPattern(t,e.origin)})).length<=0)throw Du.createUntrustedBrokerError();return new t(n.data.version,n.origin)}return null},t}(Au),Ku=function(e){function t(t,r,n,o){var i=e.call(this,uu.AUTH_REQUEST)||this;return i.embeddedClientId=t,i._embeddedAppOrigin=o,i.interactionType=r,i.request=n,i}return r(t,e),Object.defineProperty(t.prototype,"embeddedAppOrigin",{get:function(){return this._embeddedAppOrigin},enumerable:!1,configurable:!0}),t.validate=function(e){return e.data&&e.data.messageType===uu.AUTH_REQUEST&&e.data.embeddedClientId&&e.data.interactionType&&e.data.request?new t(e.data.embeddedClientId,e.data.interactionType,e.data.request,e.origin):null},t}(Au),zu=function(e){function t(){return e.call(this,uu.REDIRECT_RESPONSE)||this}return r(t,e),t.validate=function(e){return e.data&&e.data.messageType===uu.REDIRECT_RESPONSE?new t:null},t}(Au),Gu=function(e){function t(t,r,n){var o=e.call(this,uu.AUTH_RESULT)||this;return o.interactionType=t,o.result=r,o.errorPayload=o.generateErrorPayload(n),o}return r(t,e),t.prototype.generateErrorPayload=function(e){return e?n({},e):void 0},t.validate=function(e){return e.data&&e.data.messageType===uu.AUTH_RESULT&&e.data.interactionType&&(e.data.result||e.data.errorPayload)?new t(e.data.interactionType,e.data.result,e.data.errorPayload):null},t.detectError=function(e){switch(e.name){case hu.INTERACTION_REQ_ERROR_NAME:return new Ye(e.errorCode,e.errorMessage,e.subError);case hu.SERVER_ERROR_NAME:return new Oe(e.errorCode,e.errorMessage,e.subError);case hu.CLIENT_AUTH_ERR_NAME:return new ue(e.errorCode,e.errorMessage);case hu.CLIENT_CONFIG_ERROR_NAME:return new ve(e.errorCode,e.errorMessage);case hu.BROWSER_AUTH_ERROR_NAME:return new Bt(e.errorCode,e.errorMessage);case hu.BROWSER_CONFIG_ERROR_NAME:return new nr(e.errorCode,e.errorMessage);case hu.BROKER_AUTH_ERROR_NAME:return new Du(e.errorCode,e.errorMessage);case hu.AUTH_ERROR_NAME:return new ae(e.errorCode,e.errorMessage,e.subError);default:return ae.createUnexpectedError("Unknown error: "+JSON.stringify(e))}},t.processBrokerResponseMessage=function(e,r){var n=t.validate(e);return t.processBrokerResponse(n,r)},t.processBrokerResponse=function(e,r){if(!e)return null;if(e.errorPayload)throw t.detectError(e.errorPayload);if(!e.result||!e.result.tokensToCache)throw Du.createBrokerResponseInvalidError();var o=new Ge,i=new Ke,a=new Ie,s=e.result.tokensToCache,c={accessToken:Ee.toObject(s.accessToken,o),idToken:Ee.toObject(s.idToken,i),account:Ee.toObject(s.account,a),refreshToken:null,appMetadata:null};return r.saveCacheRecord(c),delete e.result.tokensToCache,n({},e.result)},t}(Au),ju=function(e){function t(t,r){var n=e.call(this,uu.HANDLE_REDIRECT_REQUEST)||this;return n.embeddedClientId=t,n.version=r,n}return r(t,e),t.validate=function(e){return e.data&&e.data.messageType===uu.HANDLE_REDIRECT_REQUEST&&e.data.embeddedClientId&&e.data.version?new t(e.data.embeddedClientId,e.data.version):null},t}(Au);function Qu(e){var t=e.brokerOptions,r={preferredInteractionType:null,brokerRedirectParams:{},actAsBroker:!1,allowBrokering:!1,trustedBrokerDomains:[],brokerHandshakeTimeout:(null==t?void 0:t.brokerHandshakeTimeout)||2e3,brokerMessageTimeout:(null==t?void 0:t.brokerMessageTimeout)||6e3,brokerInteractionTimeout:(null==t?void 0:t.brokerInteractionTimeout)||3e5};return{brokerOptions:n(n({},r),t)}}var Wu,Vu=function(){function e(){}return e.validateRedirectUri=function(e){if(le.isEmpty(e))throw ve.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in N)t.push(N[r]);if(t.indexOf(e)<0)throw ve.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw ve.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(le.isEmpty(e)||le.isEmpty(t))throw ve.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([Su,bu].indexOf(e)<0)throw ve.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),Yu=function(){function t(){this.parameters=new Map}return t.prototype.addResponseTypeCode=function(){this.parameters.set(S.RESPONSE_TYPE,encodeURIComponent(A.CODE_RESPONSE_TYPE))},t.prototype.addResponseMode=function(e){this.parameters.set(S.RESPONSE_MODE,encodeURIComponent(e||M.QUERY))},t.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?s(e||[],_):e||[],n=new ye(r);this.parameters.set(S.SCOPE,encodeURIComponent(n.printScopes()))},t.prototype.addClientId=function(e){this.parameters.set(S.CLIENT_ID,encodeURIComponent(e))},t.prototype.addBrokerClientId=function(e){this.parameters.set(du.BROKER_CLIENT_ID,encodeURIComponent(e))},t.prototype.addRedirectUri=function(e,t){if(Vu.validateRedirectUri(e),t){var r=this.buildRedirectUri(e,t);this.parameters.set(S.REDIRECT_URI,encodeURIComponent(r))}else this.parameters.set(S.REDIRECT_URI,encodeURIComponent(e))},t.prototype.buildRedirectUri=function(e,t){return"brk-"+t+"://"+new Xe(e).getUrlComponents().HostNameAndPort},t.prototype.addBrokerRedirectUri=function(e){this.parameters.set(du.BROKER_REDIRECT_URI,encodeURIComponent(e))},t.prototype.addPostLogoutRedirectUri=function(e){Vu.validateRedirectUri(e),this.parameters.set(S.POST_LOGOUT_URI,encodeURIComponent(e))},t.prototype.addIdTokenHint=function(e){this.parameters.set(S.ID_TOKEN_HINT,encodeURIComponent(e))},t.prototype.addDomainHint=function(e){this.parameters.set(P.DOMAIN_HINT,encodeURIComponent(e))},t.prototype.addLoginHint=function(e){this.parameters.set(P.LOGIN_HINT,encodeURIComponent(e))},t.prototype.addCcsUpn=function(e){this.parameters.set(w.CCS_HEADER,encodeURIComponent("UPN:"+e))},t.prototype.addCcsOid=function(e){this.parameters.set(w.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},t.prototype.addSid=function(e){this.parameters.set(P.SID,encodeURIComponent(e))},t.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Vu.validateClaims(r),this.parameters.set(S.CLAIMS,encodeURIComponent(r))},t.prototype.addCorrelationId=function(e){this.parameters.set(S.CLIENT_REQUEST_ID,encodeURIComponent(e))},t.prototype.addLibraryInfo=function(e){this.parameters.set(S.X_CLIENT_SKU,e.sku),this.parameters.set(S.X_CLIENT_VER,e.version),this.parameters.set(S.X_CLIENT_OS,e.os),this.parameters.set(S.X_CLIENT_CPU,e.cpu)},t.prototype.addPrompt=function(e){Vu.validatePrompt(e),this.parameters.set(""+S.PROMPT,encodeURIComponent(e))},t.prototype.addState=function(e){le.isEmpty(e)||this.parameters.set(S.STATE,encodeURIComponent(e))},t.prototype.addNonce=function(e){this.parameters.set(S.NONCE,encodeURIComponent(e))},t.prototype.addCodeChallengeParams=function(e,t){if(Vu.validateCodeChallengeParams(e,t),!e||!t)throw ve.createInvalidCodeChallengeParamsError();this.parameters.set(S.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(S.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},t.prototype.addAuthorizationCode=function(e){this.parameters.set(S.CODE,encodeURIComponent(e))},t.prototype.addDeviceCode=function(e){this.parameters.set(S.DEVICE_CODE,encodeURIComponent(e))},t.prototype.addRefreshToken=function(e){this.parameters.set(S.REFRESH_TOKEN,encodeURIComponent(e))},t.prototype.addCodeVerifier=function(e){this.parameters.set(S.CODE_VERIFIER,encodeURIComponent(e))},t.prototype.addClientSecret=function(e){this.parameters.set(S.CLIENT_SECRET,encodeURIComponent(e))},t.prototype.addClientAssertion=function(e){this.parameters.set(S.CLIENT_ASSERTION,encodeURIComponent(e))},t.prototype.addClientAssertionType=function(e){this.parameters.set(S.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},t.prototype.addOboAssertion=function(e){this.parameters.set(S.OBO_ASSERTION,encodeURIComponent(e))},t.prototype.addRequestTokenUse=function(e){this.parameters.set(S.REQUESTED_TOKEN_USE,encodeURIComponent(e))},t.prototype.addGrantType=function(e){this.parameters.set(S.GRANT_TYPE,encodeURIComponent(e))},t.prototype.addClientInfo=function(){this.parameters.set(S.CLIENT_INFO,"1")},t.prototype.addExtraQueryParameters=function(e){var t=this;Vu.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},t.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw ve.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(b.ACCESS_TOKEN)||(r[b.ACCESS_TOKEN]={}),r[b.ACCESS_TOKEN][b.XMS_CC]={values:t}),JSON.stringify(r)},t.prototype.addUsername=function(e){this.parameters.set(Q.username,e)},t.prototype.addPassword=function(e){this.parameters.set(Q.password,e)},t.prototype.addPopToken=function(t){le.isEmpty(t)||(this.parameters.set(S.TOKEN_TYPE,e.AuthenticationScheme.POP),this.parameters.set(S.REQ_CNF,encodeURIComponent(t)))},t.prototype.addSshJwk=function(t){le.isEmpty(t)||(this.parameters.set(S.TOKEN_TYPE,e.AuthenticationScheme.SSH),this.parameters.set(S.REQ_CNF,encodeURIComponent(t)))},t.prototype.addServerTelemetry=function(e){this.parameters.set(S.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(S.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},t.prototype.addThrottling=function(){this.parameters.set(S.X_MS_LIB_CAPABILITY,te)},t.prototype.addLogoutHint=function(e){this.parameters.set(S.LOGOUT_HINT,encodeURIComponent(e))},t.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},t}(),$u=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},Ju=function(){function t(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.homeAccountIdentifier=""}return t.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?ue.createStateNotFoundError("Cached State"):ue.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw ue.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Ye.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ye(e.error||A.EMPTY_STRING,e.error_description,e.suberror);throw new Oe(e.error||A.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Ce(e.client_info,r)},t.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Ye.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ye(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Oe(e.error,t,e.suberror)}},t.prototype.handleServerTokenResponse=function(e,r,n,a,s,c,u){return o(this,void 0,void 0,(function(){var o,l,d,h,p;return i(this,(function(i){switch(i.label){case 0:if(e.id_token&&(o=new we(e.id_token||A.EMPTY_STRING,this.cryptoObj),s&&!le.isEmpty(s.nonce)&&o.claims.nonce!==s.nonce))throw ue.createNonceMismatchError();this.homeAccountIdentifier=Ie.generateHomeAccountId(e.client_info||A.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,o),s&&s.state&&(l=Je.parseRequestState(this.cryptoObj,s.state)),e.key_id=e.key_id||a.sshKid||void 0,d=this.generateCacheRecord(e,r,n,a,o,c,s),i.label=1;case 1:return i.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new nt(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(h)]):[3,3];case 2:i.sent(),i.label=3;case 3:return!u||!d.account||(p=d.account.generateAccountKey(),this.cacheStorage.getAccount(p))?[4,this.cacheStorage.saveCacheRecord(d)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,t.generateAuthenticationResult(this.cryptoObj,r,d,!1,a,o,l)]);case 4:return i.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&h?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(h)]):[3,7];case 6:i.sent(),i.label=7;case 7:return[7];case 8:return[2,t.generateAuthenticationResult(this.cryptoObj,r,d,!1,a,o,l,e.spa_code)]}}))}))},t.prototype.handleBrokeredServerTokenResponse=function(e,r,a,s,c,u,l){return o(this,void 0,void 0,(function(){var o,d,h,p,g;return i(this,(function(i){switch(i.label){case 0:if(e.id_token&&(o=new we(e.id_token||A.EMPTY_STRING,this.cryptoObj),u&&!le.isEmpty(u.nonce)&&o.claims.nonce!==u.nonce))throw ue.createNonceMismatchError();return this.homeAccountIdentifier=Ie.generateHomeAccountId(e.client_info||A.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,o),u&&u.state&&(d=Je.parseRequestState(this.cryptoObj,u.state)),(h=this.generateCacheRecord(e,r,a,s,o,l,u,s.embeddedAppClientId)).refreshToken&&this.cacheStorage.setRefreshTokenCredential(h.refreshToken),h.account&&this.cacheStorage.setAccount(h.account),h.refreshToken=null,[4,t.generateAuthenticationResult(this.cryptoObj,r,h,!1,s,o,d)];case 1:return p=i.sent(),g=this.generateResponseThumbprint(r,s.scopes,s.embeddedAppClientId,c),[2,n(n({},p),{tokensToCache:h,responseThumbprint:g})]}}))}))},t.prototype.generateCacheRecord=function(e,t,r,n,o,i,a,s){var c,u,l=t.getPreferredCache();if(le.isEmpty(l))throw ue.createInvalidCacheEnvironmentError();!le.isEmpty(e.id_token)&&o&&(c=Ke.createIdTokenEntity(this.homeAccountIdentifier,l,e.id_token||A.EMPTY_STRING,s||this.clientId,o.claims.tid||A.EMPTY_STRING),u=this.generateAccountEntity(e,o,t,i,a));var d=null;if(!le.isEmpty(e.access_token)){var h=e.scope?ye.fromString(e.scope):new ye(n.scopes||[]),p=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,g=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,m=r+p,v=m+g,y=f&&f>0?r+f:void 0;d=Ge.createAccessTokenEntity(this.homeAccountIdentifier,l,e.access_token||A.EMPTY_STRING,s||this.clientId,o?o.claims.tid||A.EMPTY_STRING:t.tenant,h.printScopes(),m,v,this.cryptoObj,y,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var C=null;le.isEmpty(e.refresh_token)||(C=je.createRefreshTokenEntity(this.homeAccountIdentifier,l,e.refresh_token||A.EMPTY_STRING,this.clientId,e.foci,i));var T=null;return le.isEmpty(e.foci)||(T=rt.createAppMetadataEntity(s||this.clientId,l,e.foci)),new $u(u,c,d,C,T)},t.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,a=o?o.cloud_graph_host_name:"",s=o?o.msgraph_host:"";if(i===fe.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ie.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s);if(le.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw ue.createClientInfoEmptyError();return e.client_info?Ie.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,a,s):Ie.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s)},t.generateAuthenticationResult=function(t,r,n,a,s,c,u,l){var d,h,p;return o(this,void 0,void 0,(function(){var o,g,f,m,v,y,C,T,I,w,E;return i(this,(function(i){switch(i.label){case 0:if(o="",g=[],f=null,v=A.EMPTY_STRING,!n.accessToken)return[3,4];if(n.accessToken.tokenType!==e.AuthenticationScheme.POP||!n.accessToken.keyId)return[3,2];if(y=new tt(t),C=n.accessToken,T=C.secret,!(I=C.keyId))throw ue.createKeyIdMissingError();return[4,y.signPopToken(T,I,s)];case 1:return o=i.sent(),[3,3];case 2:o=n.accessToken.secret,i.label=3;case 3:g=ye.fromString(n.accessToken.target).asArray(),f=new Date(1e3*Number(n.accessToken.expiresOn)),m=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),i.label=4;case 4:return n.appMetadata&&(v=n.appMetadata.familyId===F?F:A.EMPTY_STRING),w=(null==c?void 0:c.claims.oid)||(null==c?void 0:c.claims.sub)||A.EMPTY_STRING,E=(null==c?void 0:c.claims.tid)||A.EMPTY_STRING,[2,{authority:r.canonicalAuthority,uniqueId:w,tenantId:E,scopes:g,account:n.account?n.account.getAccountInfo():null,idToken:c?c.rawToken:A.EMPTY_STRING,idTokenClaims:c?c.claims:{},accessToken:o,fromCache:a,expiresOn:f,correlationId:s.correlationId,extExpiresOn:m,familyId:v,tokenType:(null===(d=n.accessToken)||void 0===d?void 0:d.tokenType)||A.EMPTY_STRING,state:u?u.userRequestState:A.EMPTY_STRING,cloudGraphHostName:(null===(h=n.account)||void 0===h?void 0:h.cloudGraphHostName)||A.EMPTY_STRING,msGraphHost:(null===(p=n.account)||void 0===p?void 0:p.msGraphHost)||A.EMPTY_STRING,code:l}]}}))}))},t.prototype.generateResponseThumbprint=function(e,t,r,n){var o={authority:e.canonicalAuthority,clientId:r,scopes:t};return n+"."+this.cryptoObj.base64Encode(JSON.stringify(o))},t}(),Xu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return r(n,t),n.prototype.getAuthCodeUrl=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){return t=this.createBrokerAuthCodeUrlQueryString(e),[2,Xe.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},n.prototype.acquireToken=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:if(this.logger.verbose("in acquireToken call"),!e||le.isEmpty(e.code))throw ue.createTokenRequestCannotBeMadeError();return r=ze.nowSeconds(),[4,this.executeBrokerTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new Ju(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),e.embeddedAppClientId?[3,3]:[4,o.handleServerTokenResponse(n.body,this.authority,r,e,t)];case 2:case 4:return[2,i.sent()];case 3:return[4,o.handleBrokeredServerTokenResponse(n.body,this.authority,r,e,e.redirectUri,t)]}}))}))},n.prototype.executeBrokerTokenRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,a,s,c,u;return i(this,(function(i){switch(i.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.createBrokerTokenRequestBody(t)];case 1:if(n=i.sent(),o=this.createBrokerTokenQueryParameters(t),a=void 0,t.clientInfo)try{s=Ce(t.clientInfo,this.cryptoUtils),a={credential:s.uid+"."+s.utid,type:Me.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return c=this.createTokenRequestHeaders(a||t.ccsCredential),u=le.isEmpty(o)?e.tokenEndpoint:e.tokenEndpoint+"?"+o,[2,this.executePostToTokenEndpoint(u,n,c,r)]}}))}))},n.prototype.createBrokerAuthCodeUrlQueryString=function(e){var t=new Yu;t.addClientId(e.embeddedAppClientId);var r=s(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri,this.config.authOptions.clientId);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==N.SELECT_ACCOUNT)if(e.sid&&e.prompt===N.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var o=this.extractSidFromAccount(e.account);if(o&&e.prompt===N.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{var i=Te(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{i=Te(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!le.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.addBrokerClientId(this.config.authOptions.clientId),t.addBrokerRedirectUri(e.brokerRedirectUri),t.createQueryString()},n.prototype.createBrokerTokenQueryParameters=function(e){var t=new Yu;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},n.prototype.createBrokerTokenRequestBody=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a,s,c;return i(this,(function(i){switch(i.label){case 0:return(r=new Yu).addClientId(t.embeddedAppClientId),r.addRedirectUri(t.redirectUri,this.config.authOptions.clientId),r.addScopes(t.scopes),r.addAuthorizationCode(t.code),r.addLibraryInfo(this.config.libraryInfo),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&r.addCodeVerifier(t.codeVerifier),r.addGrantType("authorization_code"),r.addClientInfo(),t.authenticationScheme===e.AuthenticationScheme.POP&&t.resourceRequestMethod&&t.resourceRequestUri?[4,new tt(this.cryptoUtils).generateCnf(t)]:[3,2];case 1:return n=i.sent(),r.addPopToken(n.reqCnfString),[3,3];case 2:if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(!t.sshJwk)throw ve.createMissingSshJwkError();r.addSshJwk(t.sshJwk)}i.label=3;case 3:if(o=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(o),(!le.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),a=void 0,t.clientInfo)try{s=Ce(t.clientInfo,this.cryptoUtils),a={credential:s.uid+"."+s.utid,type:Me.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else a=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case Me.HOME_ACCOUNT_ID:try{s=Te(a.credential),r.addCcsOid(s)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Me.UPN:r.addCcsUpn(a.credential)}return t.tokenBodyParameters&&r.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[S.RETURN_SPA_CODE]||r.addExtraQueryParameters(((c={})[S.RETURN_SPA_CODE]="1",c)),r.addBrokerClientId(this.config.authOptions.clientId),r.addBrokerRedirectUri(t.brokerRedirectUri),[2,r.createQueryString()]}}))}))},n.prototype.extractSidFromAccount=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},n}(it),Zu=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return r(a,t),a.prototype.acquireToken=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a,s,c,u,l;return i(this,(function(i){switch(i.label){case 0:return[4,this.initializeBrokeredRequest(t,e.InteractionType.Redirect)];case 1:r=i.sent(),this.browserStorage.setRedirectRequestContext(r.embeddedAppClientId),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null),n=this.initializeServerTelemetryManager(e.ApiId.acquireTokenRedirect),i.label=2;case 2:return i.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(r)];case 3:return o=i.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 4:return a=i.sent(),this.logger.verbose("Auth code client created"),s=new mr(a,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),[4,a.getAuthCodeUrl(r)];case 5:return c=i.sent(),u=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+u),[4,s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,i.sent()];case 7:throw(l=i.sent())instanceof ae&&l.setCorrelationId(this.correlationId),n.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(r.state),l;case 8:return[2]}}))}))},a.prototype.createAuthCodeClient=function(e,t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Xu(r)]}}))}))},a.prototype.initializeBrokeredRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,o,a,c,u,l,d,h,p;return i(this,(function(i){switch(i.label){case 0:return this.logger.verbose("initializeBrokeredRequest called"),r=A.EMPTY_STRING,e.state&&(o=Je.parseRequestState(this.browserCrypto,e.state),r=o&&o.userRequestState||""),a=e.authority||this.config.auth.authority,c=new ye(e.scopes||[]),u={interactionType:t,brokeredClientId:e.embeddedAppClientId,brokeredReqAuthority:a,brokeredReqScopes:c.printScopes()},l=Je.setRequestState(this.browserCrypto,r,u),(d=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+d)),h=e.nonce||this.browserCrypto.createNewGuid(),this.browserStorage.setInteractionInProgress(!0),p=[{}],[4,this.initializeBaseRequest(e)];case 1:return[2,n.apply(void 0,[n.apply(void 0,p.concat([i.sent()])),{account:d||void 0,state:l,nonce:h,responseMode:M.FRAGMENT,authority:a,correlationId:this.correlationId,scopes:s(e&&e.scopes||[]),redirectUri:this.getRedirectUri(e.redirectUri),brokerRedirectUri:e.brokerRedirectUri,embeddedAppClientId:e.embeddedAppClientId}])]}}))}))},a}(kr),el=function(){function e(){}return e.setRequestState=function(t,r,n,o){var i=e.generateLibraryState(t,n,o);return le.isEmpty(r)?i:""+i+A.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t,r){if(!e)throw ue.createNoCryptoObjectError("generateLibraryState");var n={id:r||e.createNewGuid()};t&&(n.meta=t);var o=JSON.stringify(n);return e.base64Encode(o)},e.parseRequestState=function(e,t){if(!e)throw ue.createNoCryptoObjectError("parseRequestState");if(le.isEmpty(t))throw ue.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(A.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(A.RESOURCE_DELIM):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:le.isEmpty(o)?"":o,libraryState:a}}catch(e){throw ue.createInvalidStateError(t,e.message)}},e}(),tl=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return r(a,t),a.prototype.acquireToken=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.initializeBrokeredRequest(t,e.InteractionType.Popup)];case 1:return r=i.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null),n=this.generatePopupName(r.scopes,r.authority),o=t.popupWindowAttributes||{},this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),[2,this.acquireTokenPopupAsync(r,n,o)]):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),a=this.openSizedPopup("about:blank",n,o),[2,this.acquireTokenPopupAsync(r,n,o,a)]);case 2:return s=i.sent(),[2,Promise.reject(s)];case 3:return[2]}}))}))},a.prototype.createAuthCodeClient=function(e,t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Xu(r)]}}))}))},a.prototype.initializeBrokeredRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,o,a,c,u,l,d,h,p,g;return i(this,(function(i){switch(i.label){case 0:return this.logger.verbose("initializeBrokeredRequest called"),r=A.EMPTY_STRING,o=A.EMPTY_STRING,e.state&&(a=el.parseRequestState(this.browserCrypto,e.state),r=a&&a.userRequestState||A.EMPTY_STRING,o=a&&a.libraryState.id||A.EMPTY_STRING),c=e.authority||this.config.auth.authority,u=new ye(e.scopes||[]),l={interactionType:t,brokeredClientId:e.embeddedAppClientId,brokeredReqAuthority:c,brokeredReqScopes:u.printScopes()},d=el.setRequestState(this.browserCrypto,r,l,o),(h=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+h)),p=e.nonce||this.browserCrypto.createNewGuid(),this.browserStorage.setInteractionInProgress(!0),g=[{}],[4,this.initializeBaseRequest(e)];case 1:return[2,n.apply(void 0,[n.apply(void 0,g.concat([i.sent()])),{account:h||void 0,state:d,nonce:p,responseMode:M.FRAGMENT,authority:c,correlationId:this.correlationId,scopes:s(e&&e.scopes||[]),redirectUri:this.getRedirectUri(e.redirectUri),brokerRedirectUri:e.brokerRedirectUri,embeddedAppClientId:e.embeddedAppClientId}])]}}))}))},a}(Sr),rl=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return r(a,t),a.prototype.acquireToken=function(r){return o(this,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),le.isEmpty(r.loginHint)&&le.isEmpty(r.sid)&&(!r.account||le.isEmpty(r.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),r.prompt&&r.prompt!==N.NONE)throw Bt.createSilentPromptValueError(r.prompt);return[4,this.initializeBrokeredRequest(n(n({},r),{prompt:N.NONE}),e.InteractionType.Silent)];case 1:return o=i.sent(),[2,t.prototype.acquireToken.call(this,o)]}}))}))},a.prototype.createAuthCodeClient=function(e,t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Xu(r)]}}))}))},a.prototype.initializeBrokeredRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,o,a,c,u,l,d,h,p;return i(this,(function(i){switch(i.label){case 0:return this.logger.verbose("initializeBrokeredRequest called"),r=A.EMPTY_STRING,e.state&&(o=Je.parseRequestState(this.browserCrypto,e.state),r=o&&o.userRequestState||""),a=e.authority||this.config.auth.authority,c=new ye(e.scopes||[]),u={interactionType:t,brokeredClientId:e.embeddedAppClientId,brokeredReqAuthority:a,brokeredReqScopes:c.printScopes()},l=Je.setRequestState(this.browserCrypto,r,u),(d=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+d)),h=e.nonce||this.browserCrypto.createNewGuid(),p=[{}],[4,this.initializeBaseRequest(e)];case 1:return[2,n.apply(void 0,[n.apply(void 0,p.concat([i.sent()])),{account:d||void 0,state:l,nonce:h,responseMode:M.FRAGMENT,authority:a,correlationId:this.correlationId,scopes:s(e&&e.scopes||[]),redirectUri:this.getRedirectUri(e.redirectUri)}])]}}))}))},a}(Pr),nl=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return r(a,t),a.prototype.acquireToken=function(e){return o(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(o){switch(o.label){case 0:return t=ze.nowSeconds(),[4,this.executeBrokerTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new Ju(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),e.embeddedAppClientId?[2,n.handleBrokeredServerTokenResponse(r.body,this.authority,t,e,e.embeddedAppRedirectUri)]:[2,n.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},a.prototype.acquireTokenByRefreshToken=function(e){return o(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){if(!e)throw ve.createEmptyTokenRequestError();if(!e.account)throw ue.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return[2,this.acquireBrokerTokenWithCachedRefreshToken(e,!0)]}catch(n){if(t=n instanceof Ye&&n.errorCode===Ve.noTokensFoundError.code,r=n instanceof Oe&&n.errorCode===re&&n.subError===ne,t||r)return[2,this.acquireBrokerTokenWithCachedRefreshToken(e,!1)];throw n}return[2,this.acquireBrokerTokenWithCachedRefreshToken(e,!1)]}))}))},a.prototype.executeBrokerTokenRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.createBrokerTokenRequestBody(e)];case 1:return r=i.sent(),n=this.createBrokerTokenQueryParameters(e),o=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},s=Xe.appendQueryString(t.tokenEndpoint,n),[2,this.executePostToTokenEndpoint(s,r,o,a)]}}))}))},a.prototype.acquireBrokerTokenWithCachedRefreshToken=function(e,t){return o(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){if(!(r=this.cacheManager.getRefreshToken(e.account,t)))throw Ye.createNoTokensFoundError();return o=n(n({},e),{refreshToken:r.secret}),[2,this.acquireToken(o)]}))}))},a.prototype.createBrokerTokenQueryParameters=function(e){var t=new Yu;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},a.prototype.createBrokerTokenRequestBody=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a;return i(this,(function(i){switch(i.label){case 0:return(r=new Yu).addClientId(t.embeddedAppClientId),r.addScopes(t.scopes),r.addGrantType("refresh_token"),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),n=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(n),r.addRefreshToken(t.refreshToken),t.authenticationScheme!==e.AuthenticationScheme.POP?[3,2]:[4,new tt(this.cryptoUtils).generateCnf(t)];case 1:return o=i.sent(),r.addPopToken(o.reqCnfString),[3,3];case 2:if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(!t.sshJwk)throw ve.createMissingSshJwkError();r.addSshJwk(t.sshJwk)}i.label=3;case 3:if((!le.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Me.HOME_ACCOUNT_ID:try{a=Te(t.ccsCredential.credential),r.addCcsOid(a)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Me.UPN:r.addCcsUpn(t.ccsCredential.credential)}return r.addBrokerClientId(this.config.authOptions.clientId),r.addRedirectUri(t.embeddedAppRedirectUri,this.config.authOptions.clientId),[2,r.createQueryString()]}}))}))},a}(at),ol=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return r(a,t),a.prototype.acquireToken=function(t){return o(this,void 0,void 0,(function(){var r,o,a,s=this;return i(this,(function(i){switch(i.label){case 0:return r=n(n({},t),this.initializeBaseRequest(t)),o=this.initializeServerTelemetryManager(e.ApiId.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(o,r.authority)];case 1:return a=i.sent(),this.logger.verbose("Refresh token client created"),[2,a.acquireTokenByRefreshToken(r).catch((function(e){throw e instanceof ae&&e.setCorrelationId(s.correlationId),o.cacheFailedRequest(e),e}))]}}))}))},a.prototype.createRefreshTokenClient=function(e,t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new nl(r)]}}))}))},a}(Nr),il=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.generateBrokerResponseKey=function(e){return lu.BROKER_RESPONSE+"."+e},t.prototype.getBrokerResponseByOrigin=function(e){var t=this.getMemoryKeys(),r=lu.BROKER_RESPONSE+"."+e,n=t.filter((function(e){return e.indexOf(r)>=0}));return n.length<=0?null:(n.length>1&&this.logger.error("Too many responses found for the origin, sending back the first one found. You may need to call login/acquireTokenPopup/Silent() again."),this.getBrokerResponse(n[0]))},t.prototype.getBrokerResponseByThumbprint=function(e,t){var r=t+"."+this.cryptoImpl.base64Encode(JSON.stringify(e)),n=lu.BROKER_RESPONSE+"."+r;return this.getBrokerResponse(n)},t.prototype.getBrokerResponse=function(e){var t=this.getMemoryCache(e);return t?(this.removeMemoryItem(e),t):null},t.prototype.removeMemoryItem=function(e){return this.internalStorage.removeItem(e),!0},t.prototype.getMemoryCache=function(e){var t=this.generateCacheKey(e),r=this.internalStorage.getItem(t);return r||null},t.prototype.setMemoryCache=function(e,t){var r=this.generateCacheKey(e);this.internalStorage.setItem(r,t)},t.prototype.getMemoryKeys=function(){return this.internalStorage.getKeys()},t}(sr),al=function(e){function t(t,r,n,o,i,a,s,c,u,l,d,h){var p=e.call(this,t,r,n,o,i,a,s,c,u,l,d,h)||this;return p.embeddedAppClientId="",p.embeddedAppOrigin="",p}return r(t,e),t.prototype.acquireToken=function(t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return this.logger.verbose("Getting tokens from brokered native flow."),r=t,this.embeddedAppClientId=r.embeddedAppClientId,this.embeddedAppOrigin=r.embeddedAppRedirectUri,[4,e.prototype.acquireToken.call(this,r)];case 1:return[2,n.sent()]}}))}))},t.prototype.handleNativeResponse=function(t,r,a){var s;return o(this,void 0,void 0,(function(){var o,c,u,l,d,h,p,g;return i(this,(function(i){switch(i.label){case 0:return this.logger.trace("BrokerNativeInteractionClient - handleNativeResponse called"),c="",u=this.createIdTokenObj(t),l=this.createHomeAccountIdentifier(t,u),d=null===(s=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:r.accountId}))||void 0===s?void 0:s.homeAccountId,h=new Ju(this.config.auth.clientId,this.browserStorage,this.browserCrypto,this.logger,null,null),[4,this.getDiscoveredAuthority(r.authority)];case 1:return p=i.sent(),l!==d||t.account.id===r.accountId?[3,3]:(this.logger.verbose("Getting tokens from brokered native flow."),[4,this.handleEmbeddedNativeResponse(t,r,l,u,a)]);case 2:return o=i.sent(),c=h.generateResponseThumbprint(p,ye.fromString(t.scope).asArray(),this.embeddedAppClientId||r.embeddedAppClientId,this.embeddedAppOrigin||r.embeddedAppRedirectUri),[3,5];case 3:return[4,e.prototype.handleNativeResponse.call(this,t,r,a)];case 4:o=i.sent(),i.label=5;case 5:return g=h.generateCacheRecord(t,p,a,this.convertNativeRequestToBaseAuthRequest(r),u,void 0,void 0,this.embeddedAppClientId||r.embeddedAppClientId),[2,n(n({},o),{tokensToCache:g,responseThumbprint:c})]}}))}))},t.prototype.handleEmbeddedNativeResponse=function(e,t,r,n,a){return o(this,void 0,void 0,(function(){var o,s,c;return i(this,(function(i){switch(i.label){case 0:return[4,this.getDiscoveredAuthority(t.authority)];case 1:return o=i.sent(),s=o.getPreferredCache(),c=this.createAccountEntity(e,r,n,s),[4,this.generateAuthenticationResult(e,t,n,c,o.canonicalAuthority,a)];case 2:return[2,i.sent()]}}))}))},t.prototype.convertNativeRequestToBaseAuthRequest=function(e){var t=e.scope,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["scope"]),o=ye.fromString(t);return n(n({},r),{scopes:o.asArray()})},t}(wr);!function(e){e.ExperimentalPublicClientApplicationInitializeBrokering="experimentalPublicClientApplicationInitializeBrokering",e.BrokerClientApplicationHandleBrokerHandshake="brokerClientApplicationHandleBrokerHandshake",e.BrokerClientApplicationBrokeredSSOSilentRequest="brokerClientApplicationBrokeredSSOSilentRequest",e.BrokerClientApplicationBrokeredSilentRequest="brokerClientApplicationBrokeredSilentRequest",e.EmbeddedClientApplicationSendSSOSilentRequest="embeddedClientApplicationSendSSOSilentRequest",e.EmbeddedClientApplicationSendPopupRequest="embeddedClientApplicationSendPopupRequest",e.EmbeddedClientApplicationSendRedirectRequest="embeddedClientApplicationSendRedirectRequest",e.EmbeddedClientApplicationHandleRedirectRequest="embeddedClientApplicationHandleRedirectRequest",e.EmbeddedClientApplicationSendSilentRefreshRequest="embeddedClientApplicationSendSilentRefreshRequest"}(Wu||(Wu={}));var sl=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);function cl(e,t,r){return e.startMeasurement(t,r)}function ul(e,t){e&&e.addStaticFields(function(e){var t,r;try{for(var n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.keys(e)),o=n.next();!o.done;o=n.next()){var i=o.value;sl.has(i)&&"number"==typeof e[i]&&(e[i]=Math.floor(e[i]))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return e}(t))}var ll,dl,hl=function(t){function a(e,r){var n=t.call(this,e)||this;return n.brokerStorage=new il(n.config.auth.clientId,n.config.cache,n.browserCrypto,n.logger),n.currentBrokerRedirectResponse=void 0,n.hybridAuthPromise=void 0,n.experimentalConfig=Qu(r),n}return r(a,t),a.prototype.handleRedirectPromise=function(e){return o(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return t=this.handleBrokerRedirect(e),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(mt.REDIRECT_CONTEXT)),this.currentBrokerRedirectResponse=this.waitForBrokeredResponse(t),[4,this.currentBrokerRedirectResponse];case 1:return r=n.sent(),this.currentBrokerRedirectResponse=void 0,[2,r&&!r.tokensToCache?r:null]}}))}))},a.prototype.getRequestContext=function(){return this.brokerStorage.getRedirectRequestContext()},a.prototype.handleBrokerRedirect=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a,s,c,u,l,d=this;return i(this,(function(i){return this.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_START,e.InteractionType.Redirect),this.logger.verbose("handleBrokerRedirect called"),r=this.getAllAccounts(),this.isBrowserEnvironment?(n=t||A.EMPTY_STRING,void 0===(o=this.redirectResponse.get(n))?(this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),a=this.browserStorage.getCachedNativeRequest(),s=void 0,a&&Er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),c=new al(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.ssoSilent,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(a),this.nativeInternalStorage,a.correlationId),s=c.handleRedirectPromise()):(u=this.browserStorage.getTemporaryCache(mt.CORRELATION_ID,!0)||"",l=new Zu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,u),s=l.handleRedirectPromise(t)),o=s.then((function(t){t&&(r.length<d.getAllAccounts().length?(d.eventHandler.emitEvent(e.EventType.LOGIN_SUCCESS,e.InteractionType.Redirect,t),d.logger.verbose("handleRedirectResponse returned result, login success")):(d.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t),d.logger.verbose("handleRedirectResponse returned result, acquire token success")));return d.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_END,e.InteractionType.Redirect),t})).catch((function(t){throw r.length>0?d.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t):d.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),d.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_END,e.InteractionType.Redirect),t})),this.redirectResponse.set(n,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},a.prototype.waitForBrokeredResponse=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return[4,e];case 1:if(t=r.sent()){if(!t.tokensToCache)return[2,t];this.brokerStorage.setMemoryCache(this.brokerStorage.generateBrokerResponseKey(t.responseThumbprint),JSON.stringify(t)),this.setActiveAccount(t.account)}return[2,null]}}))}))},a.prototype.listenForBrokerMessage=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){return this.logger.verbose("listening for child broker messages."),window.addEventListener("message",this.handleBrokerMessage.bind(this)),e&&e.codeRequest&&(this.hybridAuthPromise=this.acquireTokenByCode(e.codeRequest)),[2,this.hybridAuthPromise]}))}))},a.prototype.handleBrokerMessage=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:if(!(t=Au.validateMessage(e)))return[3,8];switch(t.data.messageType){case uu.HANDSHAKE_REQUEST:return[3,1];case uu.HANDLE_REDIRECT_REQUEST:return[3,3];case uu.AUTH_REQUEST:return[3,5]}return[3,7];case 1:return this.logger.verbose("Broker handshake request received"),[4,this.handleBrokerHandshake(t)];case 2:case 4:case 6:return[2,r.sent()];case 3:return this.logger.verbose("Broker handle redirect request received"),[4,this.handleBrokerRedirectResponse(t)];case 5:return this.logger.verbose("Broker auth request received"),[4,this.handleBrokerAuthRequest(t)];case 7:case 8:return[2]}}))}))},a.prototype.handleBrokerHandshake=function(e){return o(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:if(t=cl(this.performanceClient,Wu.BrokerClientApplicationHandleBrokerHandshake),r=_u.validate(e),this.logger.verbose("Broker handshake validated: "+JSON.stringify(r)),n=new Fu(ur,""),!this.hybridAuthPromise)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.hybridAuthPromise];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.logger.error("Broker could obtain tokens use authorization code initializer: "+o),[3,4];case 4:return e.source.postMessage(n,e.origin),t.endMeasurement({success:!0}),this.logger.verbose("Sending handshake response to "+e.origin),[2]}}))}))},a.prototype.handleBrokerRedirectResponse=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:return ju.validate(t)?(r=t.ports[0],this.currentBrokerRedirectResponse?[4,this.currentBrokerRedirectResponse]:[3,2]):[3,3];case 1:i.sent(),i.label=2;case 2:if(n=this.brokerStorage.getBrokerResponseByOrigin(this.getEmbeddedAppRedirectUri(t.origin)))return o=JSON.parse(n),a=t.ports[0],s=new Gu(e.InteractionType.Redirect,o),this.logger.verbosePii("Sending auth response"),a.postMessage(s),a.close(),[2];s=new Gu(e.InteractionType.Redirect,null),r.postMessage(s),r.close(),i.label=3;case 3:return[2]}}))}))},a.prototype.handleBrokerAuthRequest=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a,s,c,u,l;return i(this,(function(i){switch(i.label){case 0:if(!(r=Ku.validate(t)))return[3,3];if(!r.request.authority||!r.request.scopes)throw Du.createBrokerRequestIncompleteError();return cl(this.performanceClient,xe.AcquireTokenByBroker,r.request.correlationId),this.logger.verbose("Broker auth request validated: "+r),this.currentBrokerRedirectResponse?[4,this.currentBrokerRedirectResponse]:[3,2];case 1:i.sent(),i.label=2;case 2:if(n={authority:r.request.authority,clientId:r.embeddedClientId,scopes:r.request.scopes},o=this.brokerStorage.getBrokerResponseByThumbprint(n,this.getEmbeddedAppRedirectUri(r.embeddedAppOrigin)))return a=JSON.parse(o),s=t.ports[0],c=new Gu(e.InteractionType.Redirect,a),this.logger.verbosePii("Sending auth response"),s.postMessage(c),s.close(),[2];switch(u=r.request.account||this.getActiveAccount(),r.interactionType){case e.InteractionType.Silent:return u?[2,this.brokeredSilentRequest(r,t.ports[0],u)]:[2,this.brokeredSsoSilentRequest(r,t.ports[0])];case e.InteractionType.Redirect:case e.InteractionType.Popup:default:return l=this.getInteractionType(r.interactionType),[2,this.interactiveBrokerRequest(l,r,t)]}i.label=3;case 3:return[2]}}))}))},a.prototype.getInteractionType=function(e){var t=this.experimentalConfig.brokerOptions.preferredInteractionType;return t||e},a.prototype.interactiveBrokerRequest=function(t,r,n){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(t){case e.InteractionType.Redirect:return[2,this.brokeredRedirectRequest(r,n.ports[0])];case e.InteractionType.Popup:return[2,this.brokeredPopupRequest(r,n.ports[0])];case e.InteractionType.Silent:return this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests."),[2];case e.InteractionType.None:return this.logger.error("Broker is blocking interactive requests. Please attempt a silent request or sign into the broker first."),[2];default:return this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests."),[2]}}))}))},a.prototype.brokeredRedirectRequest=function(t,r){var a,s;return o(this,void 0,void 0,(function(){var o,c,u,l,d,h,p;return i(this,(function(i){switch(i.label){case 0:this.logger.verbose("Brokered redirect request initiated."),i.label=1;case 1:return i.trys.push([1,5,,6]),o=new zu,r.postMessage(o),r.close(),this.logger.verbose("Sending redirect response: "+o),c=t.request,u=new Zu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c.correlationId),c.redirectUri=t.embeddedAppOrigin,c.embeddedAppClientId=t.embeddedClientId,c.brokerRedirectUri=u.getRedirectUri(),c.redirectStartPage=null===(a=this.experimentalConfig.brokerOptions.brokerRedirectParams)||void 0===a?void 0:a.redirectStartPage,c.onRedirectNavigate=null===(s=this.experimentalConfig.brokerOptions.brokerRedirectParams)||void 0===s?void 0:s.onRedirectNavigate,l=c.account||this.getActiveAccount(),this.canUseNative(c,null==l?void 0:l.nativeAccountId)?(this.logger.verbose("Native flow available for broker."),c.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(t.embeddedAppOrigin),(d=t.request).extraQueryParameters=n(n({},d.extraQueryParameters),{child_client_id:c.embeddedAppClientId,child_redirect_uri:c.embeddedAppRedirectUri}),d.redirectUri=hr.getCurrentUri(),this.browserStorage.setRedirectRequestContext(c.embeddedAppClientId),this.browserStorage.setInteractionInProgress(!0),[4,this.acquireTokenByNative(d,e.ApiId.acquireTokenRedirect)]):[3,3];case 2:return i.sent(),[3,4];case 3:return[2,u.acquireToken(c)];case 4:return[3,6];case 5:return h=i.sent(),p=new Gu(e.InteractionType.Redirect,null,h),this.logger.verbose("Found auth error in redirect: "+h),r.postMessage(p),r.close(),[3,6];case 6:return[2]}}))}))},a.prototype.brokeredPopupRequest=function(t,r){return o(this,void 0,void 0,(function(){var o,a,s,c,u,l,d;return i(this,(function(i){switch(i.label){case 0:this.logger.verbose("Brokered popup request initiated."),i.label=1;case 1:return i.trys.push([1,6,,7]),o=t.request,a=new tl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,o.correlationId),o.redirectUri=t.embeddedAppOrigin,o.embeddedAppClientId=t.embeddedClientId,o.brokerRedirectUri=a.getRedirectUri(),s=void 0,c=o.account||this.getActiveAccount(),this.canUseNative(o,null==c?void 0:c.nativeAccountId)?(this.logger.verbose("Native flow available for broker."),o.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(t.embeddedAppOrigin),(u=t.request).extraQueryParameters=n(n({},u.extraQueryParameters),{child_client_id:o.embeddedAppClientId,child_redirect_uri:o.embeddedAppRedirectUri}),u.redirectUri=hr.getCurrentUri(),[4,this.acquireTokenByNative(u,e.ApiId.acquireTokenPopup)]):[3,3];case 2:return s=i.sent(),[3,5];case 3:return[4,a.acquireToken(o)];case 4:s=i.sent(),i.label=5;case 5:return d=new Gu(e.InteractionType.Popup,s),this.logger.verbosePii("Sending auth response"),r.postMessage(d),r.close(),[3,7];case 6:return l=i.sent(),d=new Gu(e.InteractionType.Popup,null,l),this.logger.verbose("Found auth error in popup: "+l),r.postMessage(d),r.close(),[3,7];case 7:return[2]}}))}))},a.prototype.brokeredSsoSilentRequest=function(t,r){var a,s,c,u;return o(this,void 0,void 0,(function(){var o,l,d,h,p,g,f,m;return i(this,(function(i){switch(i.label){case 0:o=cl(this.performanceClient,Wu.BrokerClientApplicationBrokeredSSOSilentRequest,t.request.correlationId),this.logger.verbose("Brokered SSO Silent request initiated."),i.label=1;case 1:return i.trys.push([1,6,,7]),l=t.request,d=new rl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,l.correlationId),l.redirectUri=t.embeddedAppOrigin,l.embeddedAppClientId=t.embeddedClientId,l.brokerRedirectUri=d.getRedirectUri(),h=void 0,p=l.account||this.getActiveAccount(),this.canUseNative(l,null==p?void 0:p.nativeAccountId)?(this.logger.verbose("Native flow available for broker."),l.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(t.embeddedAppOrigin),(g=t.request).extraQueryParameters=n(n({},g.extraQueryParameters),{child_client_id:l.embeddedAppClientId,child_redirect_uri:l.embeddedAppRedirectUri}),g.redirectUri=hr.getCurrentUri(),[4,this.acquireTokenByNative(g,e.ApiId.ssoSilent)]):[3,3];case 2:return h=i.sent(),[3,5];case 3:return[4,d.acquireToken(l)];case 4:h=i.sent(),i.label=5;case 5:return m=new Gu(e.InteractionType.Silent,h),this.logger.verbosePii("Sending auth response"),r.postMessage(m),r.close(),o.endMeasurement({success:!0,fromCache:null===(a=m.result)||void 0===a?void 0:a.fromCache,accessTokenSize:null===(s=m.result)||void 0===s?void 0:s.accessToken.length,idTokenSize:null===(c=m.result)||void 0===c?void 0:c.idToken.length,requestId:null===(u=m.result)||void 0===u?void 0:u.requestId}),[3,7];case 6:return f=i.sent(),m=new Gu(e.InteractionType.Silent,null,f),this.logger.verbose("Found auth error in ssoSilent: "+f),r.postMessage(m),r.close(),o.endMeasurement({errorCode:f.errorCode,subErrorCode:f.subError,success:!1}),[3,7];case 7:return[2]}}))}))},a.prototype.brokeredSilentRequest=function(t,r,a){return o(this,void 0,void 0,(function(){var o,s,c,u,l,d,h,p;return i(this,(function(i){switch(i.label){case 0:o=cl(this.performanceClient,Wu.BrokerClientApplicationBrokeredSilentRequest,t.request.correlationId),this.logger.verbose("Brokered Silent request initiated."),i.label=1;case 1:return i.trys.push([1,6,,7]),(s=t.request).embeddedAppClientId=t.embeddedClientId,s.embeddedAppRedirectUri=t.embeddedAppOrigin,s.account||(s.account=a),c=void 0,this.canUseNative(s)?(this.logger.verbose("Native flow available for broker."),s.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(t.embeddedAppOrigin),(u=t.request).extraQueryParameters=n(n({},u.extraQueryParameters),{child_client_id:s.embeddedAppClientId,child_redirect_uri:s.embeddedAppRedirectUri}),u.redirectUri=hr.getCurrentUri(),[4,this.acquireTokenByNative(u,e.ApiId.acquireTokenSilent_silentFlow)]):[3,3];case 2:return c=i.sent(),[3,5];case 3:return[4,this.acquireTokenByRefreshToken(s)];case 4:c=i.sent(),i.label=5;case 5:return(p=new Gu(e.InteractionType.Silent,c)).result&&p.result.tokensToCache?(this.logger.verbosePii("Sending auth response: "+JSON.stringify(p)),r.postMessage(p),r.close(),o.endMeasurement({success:!0,fromCache:p.result.fromCache,accessTokenSize:p.result.accessToken.length,idTokenSize:p.result.idToken.length,isNativeBroker:p.result.fromNativeBroker,requestId:p.result.requestId})):(l=Du.createNoTokensToCacheError(),d=new Gu(e.InteractionType.Silent,null,l),this.logger.verbose(""+l),r.postMessage(d),r.close(),o.endMeasurement({errorCode:l.errorCode,subErrorCode:l.subError,success:!1})),[3,7];case 6:return h=i.sent(),p=new Gu(e.InteractionType.Silent,null,h),this.logger.verbose("Found auth error in silent: "+h),r.postMessage(p),r.close(),o.endMeasurement({errorCode:h.errorCode,subErrorCode:h.subError,success:!1}),[3,7];case 7:return[2]}}))}))},a.prototype.acquireTokenByRefreshToken=function(t){return o(this,void 0,void 0,(function(){var r,o=this;return i(this,(function(i){return this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_NETWORK_START,e.InteractionType.Silent,t),hr.blockReloadInHiddenIframes(),[2,(r=new ol(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t.correlationId)).acquireToken(t).catch((function(i){var a=i instanceof Oe,s=i instanceof Ye,c=i.errorCode===Ht;if(a&&c&&!s)return o.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",t.correlationId),new rl(o.config,o.browserStorage,o.browserCrypto,o.logger,o.eventHandler,o.navigationClient,e.ApiId.acquireTokenSilent_authCode,o.performanceClient,o.nativeInternalStorage,o.nativeExtensionProvider).acquireToken(n(n({},t),{brokerRedirectUri:r.getRedirectUri()}));throw i}))]}))}))},a.prototype.acquireTokenByNative=function(t,r,n){return o(this,void 0,void 0,(function(){var o,a=this;return i(this,(function(i){if(this.logger.trace("Brokered acquireTokenNative called"),!this.nativeExtensionProvider)throw Bt.createNativeConnectionNotEstablishedError();return o=new al(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.ssoSilent,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId),r===e.ApiId.acquireTokenRedirect?[2,o.acquireTokenRedirect(t)]:[2,o.acquireToken(t).catch((function(e){throw e instanceof Tr&&e.isFatal()&&(a.nativeExtensionProvider=void 0),e}))]}))}))},a.prototype.getEmbeddedAppRedirectUri=function(e){return(new Yu).buildRedirectUri(e,this.config.auth.clientId)},a}(ku);!function(e){e.Interaction="brokerInteractionTimeoutMs",e.Message="brokerMessageTimeoutMs",e.Iframe="brokerIframeTimeoutMs"}(ll||(ll={})),function(e){e.Interaction="brokerInteractionTimedOut",e.Message="brokerMessageTimedOut",e.Iframe="brokerIframeTimedOut"}(dl||(dl={}));var pl=function(){function t(e,t,r,n,o){this.brokerOpts=t,this.clientId=e,this.logger=r,this.browserStorage=n,this.brokerConnectionEstablished=!1,this.version=ur,this.brokerOrigin=A.EMPTY_STRING,this.performanceClient=o}return Object.defineProperty(t.prototype,"trustedBrokersProvided",{get:function(){return!!this.brokerOpts.trustedBrokerDomains&&this.brokerOpts.trustedBrokerDomains.length>=1},enumerable:!1,configurable:!0}),t.prototype.initiateHandshake=function(e){return o(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:if(!this.trustedBrokersProvided)throw Du.createNoTrustedBrokersProvidedError();n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.sendHandshakeRequest(e)];case 2:return t=n.sent(),this.brokerOrigin=t.brokerOrigin,this.brokerConnectionEstablished=!0,[3,4];case 3:return r=n.sent(),this.logger.error(r.message),this.brokerConnectionEstablished=!1,[3,4];case 4:return[2]}}))}))},t.prototype.preflightBrokerRequest=function(){return o(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:if(this.brokerConnectionEstablished)return[3,4];this.logger.verbose("Attempting handshake..."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.initiateHandshake(this.performanceEvent)];case 2:return t.sent(),[3,4];case 3:throw e=t.sent(),this.logger.error("Handshake rejected"),Du.createBrokeringDisabledError(e.message);case 4:return[2]}}))}))},t.prototype.sendSsoSilentRequest=function(t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:this.performanceEvent=cl(this.performanceClient,Wu.EmbeddedClientApplicationSendSSOSilentRequest,t.correlationId),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return i.sent(),[4,this.sendRequest(t,e.InteractionType.Silent,{type:ll.Iframe,error:dl.Iframe,value:Ar})];case 3:if(r=i.sent(),!(n=Gu.processBrokerResponseMessage(r,this.browserStorage)))throw this.performanceEvent.endMeasurement({success:!1}),this.logger.errorPii("Broker response is empty in brokered ssoSilent request: "+JSON.stringify(n)),Du.createBrokerResponseInvalidError();return this.performanceEvent.endMeasurement({success:!0,fromCache:n.fromCache,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length,isNativeBroker:n.fromNativeBroker,requestId:n.requestId}),[2,n];case 4:throw o=i.sent(),this.performanceEvent.endMeasurement({success:!1}),o;case 5:return[2]}}))}))},t.prototype.sendPopupRequest=function(t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:this.performanceEvent=cl(this.performanceClient,Wu.EmbeddedClientApplicationSendPopupRequest,t.correlationId),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return i.sent(),[4,this.sendRequest(t,e.InteractionType.Popup,{type:ll.Interaction,error:dl.Interaction,value:this.brokerOpts.brokerInteractionTimeout})];case 3:if(r=i.sent(),!(n=Gu.processBrokerResponseMessage(r,this.browserStorage))){if(this.performanceEvent.endMeasurement({success:!1}),!zu.validate(r))throw this.logger.errorPii("Broker response is empty in brokered popup request: "+JSON.stringify(n)),Du.createBrokerResponseInvalidError();throw this.logger.verbose("popupRequest requires a redirect by the broker, this app will now redirect."),Du.createBrokerPopupRequestRedirectingError()}return this.performanceEvent.endMeasurement({success:!0,fromCache:n.fromCache,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length,isNativeBroker:n.fromNativeBroker,requestId:n.requestId}),[2,n];case 4:throw o=i.sent(),this.performanceEvent.endMeasurement({success:!1}),o;case 5:return[2]}}))}))},t.prototype.sendRedirectRequest=function(t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:this.performanceEvent=cl(this.performanceClient,Wu.EmbeddedClientApplicationSendRedirectRequest,t.correlationId),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return i.sent(),[4,this.sendRequest(t,e.InteractionType.Redirect,{type:ll.Interaction,error:dl.Interaction,value:this.brokerOpts.brokerInteractionTimeout})];case 3:if(r=i.sent(),!(n=zu.validate(r)))throw this.logger.errorPii("Broker response is not a redirect: "+JSON.stringify(n)),Du.createBrokerResponseInvalidError();return this.logger.verbose("Broker redirecting: "+n),this.performanceEvent.endMeasurement({success:!0}),[3,5];case 4:throw o=i.sent(),this.performanceEvent.endMeasurement({success:!1}),o;case 5:return[2]}}))}))},t.prototype.sendHandleRedirectRequest=function(){return o(this,void 0,void 0,(function(){var e,t,r,n;return i(this,(function(o){switch(o.label){case 0:this.performanceEvent=cl(this.performanceClient,Wu.EmbeddedClientApplicationHandleRedirectRequest),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return o.sent(),e=new ju(this.clientId,this.version),[4,this.messageBroker(e,{type:ll.Message,error:dl.Message,value:this.brokerOpts.brokerMessageTimeout})];case 3:return t=o.sent(),r=Gu.processBrokerResponseMessage(t,this.browserStorage),this.performanceEvent.endMeasurement({success:!0,fromCache:null==r?void 0:r.fromCache,accessTokenSize:null==r?void 0:r.accessToken.length,idTokenSize:null==r?void 0:r.idToken.length,isNativeBroker:null==r?void 0:r.fromNativeBroker}),[2,r];case 4:throw n=o.sent(),this.performanceEvent.endMeasurement({success:!1}),n;case 5:return[2]}}))}))},t.prototype.sendSilentRefreshRequest=function(t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:this.performanceEvent=cl(this.performanceClient,Wu.EmbeddedClientApplicationSendSilentRefreshRequest,t.correlationId),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return i.sent(),[4,this.sendRequest(t,e.InteractionType.Silent,{type:ll.Message,error:dl.Message,value:this.brokerOpts.brokerMessageTimeout})];case 3:if(r=i.sent(),!(n=Gu.processBrokerResponseMessage(r,this.browserStorage)))throw this.logger.errorPii("Broker response is empty in brokered silent refresh request: "+JSON.stringify(n)),Du.createBrokerResponseInvalidError();return this.performanceEvent.endMeasurement({success:!0,fromCache:n.fromCache,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length,isNativeBroker:n.fromNativeBroker}),[2,n];case 4:throw o=i.sent(),this.performanceEvent.endMeasurement({success:!1}),o;case 5:return[2]}}))}))},t.prototype.sendRequest=function(e,t,r){return o(this,void 0,void 0,(function(){var n;return i(this,(function(o){return n=new Ku(this.clientId,t,e,A.EMPTY_STRING),[2,this.messageBroker(n,r)]}))}))},t.prototype.sendHandshakeRequest=function(e){return o(this,void 0,void 0,(function(){var t=this;return i(this,(function(r){return[2,new Promise((function(r,n){var o,i=setTimeout((function(){t.logger.warning("Broker handshake timed out"),window.removeEventListener("message",a),ul(e,{brokerHandshakeTimedOut:!0}),n(Du.createMessageBrokerHandshakeTimeoutError())}),t.brokerOpts.brokerHandshakeTimeout);ul(e,{brokerHandshakeTimeoutMs:t.brokerOpts.brokerHandshakeTimeout});var a=function(e){try{var o=Fu.validate(e,t.brokerOpts.trustedBrokerDomains);o?(clearTimeout(i),t.logger.verbose("Received handshake response: "+JSON.stringify(o)),window.removeEventListener("message",a),r(o)):(t.logger.warning("Message is not handshake response"),t.logger.verbosePii(""+JSON.stringify(e.data)))}catch(e){window.removeEventListener("message",a),n(e)}};window.addEventListener("message",a);var s=new _u(t.clientId,t.version);t.logger.verbose("Sending handshake request: "+s),null===(o=window.top)||void 0===o||o.postMessage(s,"*")}))]}))}))},t.prototype.messageBroker=function(e,t){return void 0===t&&(t={type:ll.Message,error:dl.Message,value:this.brokerOpts.brokerMessageTimeout}),o(this,void 0,void 0,(function(){var r=this;return i(this,(function(n){return[2,new Promise((function(n,o){var i,a=setTimeout((function(){var e={};e[t.error.toString()]=!0,ul(r.performanceEvent,e),o(Du.createMessageBrokerTimeoutError())}),t.value),s={};s[t.type.toString()]=t.value,ul(r.performanceEvent,s);var c=r.messageChannel||new MessageChannel;c.port1.onmessage=function(e){r.logger.verbose("in messageBroker<T> w/ origin: "+e),clearTimeout(a),c.port1.close(),n(e)},null===(i=window.top)||void 0===i||i.postMessage(e,r.brokerOrigin,[c.port2])}))]}))}))},t.prototype.setMessageChannel=function(e){this.messageChannel=e},t}(),gl=function(t){function a(e,r,n,o,i,a,s,c,u,l,d,h){var p=t.call(this,e,r,n,o,i,a,c,u,l)||this;return p.experimentalConfig=s,p.embeddedApp=d,p.broker=h,p}return r(a,t),a.prototype.acquireToken=function(){throw new Error("Method not implemented.")},a.prototype.acquireTokenPopup=function(t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:if(!this.embeddedApp)throw Du.createNoEmbeddedAppError();return[4,this.initializeAuthorizationRequest(t,e.InteractionType.Popup)];case 1:return r=n.sent(),[2,this.embeddedApp.sendPopupRequest(r)]}}))}))},a.prototype.ssoSilent=function(t){return o(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:if(!this.embeddedApp)throw Du.createNoEmbeddedAppError();return[4,this.initializeAuthorizationRequest(n(n({},t),{prompt:N.NONE}),e.InteractionType.Silent)];case 1:r=i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.embeddedApp.sendSsoSilentRequest(r)];case 3:return[2,i.sent()];case 4:throw(o=i.sent())instanceof ae&&o.setCorrelationId(this.correlationId),this.browserStorage.cleanRequestByState(r.state),o;case 5:return[2]}}))}))},a.prototype.acquireTokenByBrokerRefresh=function(t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:if(!this.embeddedApp)throw Du.createNoEmbeddedAppError();return[4,this.embeddedApp.sendSilentRefreshRequest(t)];case 1:return r=n.sent(),this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,r),[2,r]}}))}))},a.prototype.logout=function(){throw new Error("Method not implemented.")},a}(gr),fl=function(t){function a(e,r,n){var o=t.call(this,e,n)||this;return o.experimentalConfig=Qu(r),o}return r(a,t),a.prototype.initializeBrokering=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return this.isBrowserEnvironment?(t=cl(this.performanceClient,Wu.ExperimentalPublicClientApplicationInitializeBrokering),!this.experimentalConfig.brokerOptions.actAsBroker||hr.isInIframe()?[3,3]:(this.experimentalConfig.brokerOptions.allowBrokering&&this.logger.verbose("Running in top frame and both actAsBroker, allowBrokering flags set to true. actAsBroker takes precedence."),this.broker=new hl(this.config,this.experimentalConfig),this.logger.verbose("Acting as Broker"),this.logger.verbose("Initialize the extension for the new broker instance"),[4,this.broker.initialize()])):[2];case 1:return r.sent(),[4,this.broker.listenForBrokerMessage(e)];case 2:return r.sent(),t.endMeasurement({success:!0}),[3,5];case 3:return this.experimentalConfig.brokerOptions.allowBrokering?(this.embeddedApp=new pl(this.config.auth.clientId,this.experimentalConfig.brokerOptions,this.logger,this.browserStorage,this.performanceClient),this.logger.verbose("Acting as child"),[4,this.embeddedApp.initiateHandshake(t)]):[3,5];case 4:r.sent(),t.endMeasurement({success:this.embeddedApp.brokerConnectionEstablished}),r.label=5;case 5:return[2]}}))}))},a.prototype.handleRedirectPromise=function(e){var r;return o(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return n=null===(r=this.broker)||void 0===r?void 0:r.getRequestContext(),this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?[4,this.embeddedApp.sendHandleRedirectRequest()]:[3,2];case 1:return o=i.sent(),this.browserStorage.setInteractionInProgress(!1),[2,o];case 2:return this.broker&&n&&n!==this.config.auth.clientId?[2,this.broker.handleRedirectPromise(e)]:[2,t.prototype.handleRedirectPromise.call(this,e)];case 3:return[2]}}))}))},a.prototype.acquireTokenRedirect=function(e){var r;return o(this,void 0,void 0,(function(){return i(this,(function(n){if(null===(r=this.embeddedApp)||void 0===r?void 0:r.brokerConnectionEstablished)throw Bt.createRedirectInIframeError(hr.isInIframe());return[2,t.prototype.acquireTokenRedirect.call(this,e)]}))}))},a.prototype.acquireTokenPopup=function(t){var r,n=this,o=cl(this.performanceClient,xe.AcquireTokenPopup,t.correlationId);try{var i=!!(null===(r=this.embeddedApp)||void 0===r?void 0:r.brokerConnectionEstablished);if(this.preflightBrowserEnvironmentCheck(e.InteractionType.Popup,!i),this.logger.verbose("experimental acquireTokenPopup called",t.correlationId),i)return new gl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.experimentalConfig,this.performanceClient,this.nativeExtensionProvider,t.correlationId,this.embeddedApp,this.broker).acquireTokenPopup(t).then((function(e){return ul(o,{accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),o.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return o.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),Promise.reject(e)}));var a=this.getAllAccounts();a.length>0?this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t):this.eventHandler.emitEvent(e.EventType.LOGIN_START,e.InteractionType.Popup,t);var s=void 0;if(this.canUseNative(t))this.logger.verbose("Native popup flow activated"),s=this.acquireTokenNative(t,e.ApiId.acquireTokenPopup).then((function(e){return n.browserStorage.setInteractionInProgress(!1),o.endMeasurement({success:!0,isNativeBroker:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,requestId:e.requestId}),e})).catch((function(e){if(e instanceof Tr&&e.isFatal())return n.logger.verbose("Native Auth Error"),n.nativeExtensionProvider=void 0,n.createPopupClient(t.correlationId).acquireToken(t);if(e instanceof Ye)return n.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),n.createPopupClient(t.correlationId).acquireToken(t);throw n.browserStorage.setInteractionInProgress(!1),e}));else s=new Sr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t.correlationId).acquireToken(t);return s.then((function(t){return a.length<n.getAllAccounts().length?n.eventHandler.emitEvent(e.EventType.LOGIN_SUCCESS,e.InteractionType.Popup,t):n.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t),ul(o,{accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),o.endMeasurement({success:!0,requestId:t.requestId}),t})).catch((function(t){return a.length>0?n.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t):n.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Popup,null,t),o.endMeasurement({success:!1}),Promise.reject(t)}))}catch(e){return o.endMeasurement({success:!1}),Promise.reject(e)}},a.prototype.ssoSilent=function(t){return o(this,void 0,void 0,(function(){var r,n,o,a=this;return i(this,(function(i){this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent),r=cl(this.performanceClient,xe.SsoSilent,t.correlationId),this.logger.verbose("ssoSilent called",t.correlationId),this.eventHandler.emitEvent(e.EventType.SSO_SILENT_START,e.InteractionType.Silent,t);try{return this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?[2,new gl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.experimentalConfig,this.performanceClient,this.nativeExtensionProvider,t.correlationId,this.embeddedApp,this.broker).ssoSilent(t).then((function(e){return r.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){throw r.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e}))]:(n=void 0,this.canUseNative(t)?(this.logger.verbose("Native sso silent flow activated"),n=this.acquireTokenNative(t,e.ApiId.ssoSilent).catch((function(e){if(e instanceof Tr&&e.isFatal())return a.logger.verbose("Native Auth Error"),a.nativeExtensionProvider=void 0,a.createSilentIframeClient(t.correlationId).acquireToken(t);throw e}))):(o=new Pr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t.correlationId),n=o.acquireToken(t)),[2,n.then((function(t){return a.eventHandler.emitEvent(e.EventType.SSO_SILENT_SUCCESS,e.InteractionType.Silent,t),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,requestId:t.requestId}),t})).catch((function(e){throw e}))])}catch(t){throw this.eventHandler.emitEvent(e.EventType.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),r.endMeasurement({success:!1,errorCode:t.errorCode,subErrorCode:t.subError}),t}return[2]}))}))},a.prototype.acquireTokenSilentAsync=function(t,r){return o(this,void 0,void 0,(function(){var a,s,c,u,l,d=this;return i(this,(function(h){switch(h.label){case 0:return this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t),a=cl(this.performanceClient,xe.AcquireTokenSilentAsync,t.correlationId),this.canUseNative(t)?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),c=n(n({},t),{account:r}),s=this.acquireTokenNative(c,e.ApiId.acquireTokenSilent_silentFlow).catch((function(e){return o(d,void 0,void 0,(function(){return i(this,(function(r){if(e instanceof Tr&&e.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw e}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),[4,(u=new Ir(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient)).initializeSilentRequest(t,r)];case 2:l=h.sent(),s=u.acquireToken(l).catch((function(){return o(d,void 0,void 0,(function(){return i(this,(function(e){return this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?[2,new gl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.experimentalConfig,this.performanceClient,this.nativeExtensionProvider,t.correlationId,this.embeddedApp,this.broker).acquireTokenByBrokerRefresh(l)]:[2,this.acquireTokenByRefreshToken(l,t)]}))}))})),h.label=3;case 3:return[2,s.then((function(t){return d.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,t),a.endMeasurement({success:!0,fromCache:t.fromCache,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){throw d.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),a.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},a.prototype.setActiveAccount=function(e){this.broker&&this.broker.setActiveAccount(e),t.prototype.setActiveAccount.call(this,e)},a}(ku);e.AccountEntity=Ie,e.AuthError=ae,e.AuthErrorMessage=ie,e.AuthenticationHeaderParser=Mt,e.BrowserAuthError=Bt,e.BrowserAuthErrorMessage=Lt,e.BrowserConfigurationAuthError=nr,e.BrowserConfigurationAuthErrorMessage=rr,e.BrowserUtils=hr,e.ClientAuthError=ue,e.ClientAuthErrorMessage=ce,e.ClientConfigurationError=ve,e.ClientConfigurationErrorMessage=me,e.DEFAULT_IFRAME_TIMEOUT_MS=Ar,e.EventMessageUtils=nn,e.ExperimentalPublicClientApplication=fl,e.InteractionRequiredAuthError=Ye,e.InteractionRequiredAuthErrorMessage=Ve,e.Logger=he,e.NavigationClient=br,e.PublicClientApplication=ku,e.ServerError=Oe,e.SignedHttpRequest=on,e.StringUtils=le,e.UrlString=Xe,e.stubbedPublicClientApplication=rn,e.version="2.37.0",Object.defineProperty(e,"__esModule",{value:!0})})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).msalv4={})}(this,(function(e){
/*! @azure/msal-common v15.3.0 2025-03-20 */
const t={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},r=400,n=499,o=500,i=599,a=[t.OPENID_SCOPE,t.PROFILE_SCOPE,t.OFFLINE_ACCESS_SCOPE],s=[...a,t.EMAIL_SCOPE],c={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},u="active-account-filters",l="common",d="organizations",h="consumers",p={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},g={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},f={PLAIN:"plain",S256:"S256"},m={QUERY:"query",FRAGMENT:"fragment"},v={...m,FORM_POST:"form_post"},y="authorization_code",C="refresh_token",T="MSSTS",I="ADFS",w="Generic",E={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},k={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},S="appmetadata",b="client_info",A="1",_="authority-metadata",R=86400,P="config",N="cache",M="network",O="hardcoded_values",q={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},U={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},x=60,L=3600,B="throttling",H="retry-after, h429",D="invalid_grant",F="client_mismatch",K=200,z=400,G="1",j="3",Q="4",W="2",V="4",Y="5",$="0",J="1",X="2",Z="3",ee="4",te={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},re="unexpected_error",ne="post_request_failed";var oe=Object.freeze({__proto__:null,postRequestFailed:ne,unexpectedError:re});
/*! @azure/msal-common v15.3.0 2025-03-20 */const ie={[re]:"Unexpected error in authentication.",[ne]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},ae={unexpectedError:{code:re,desc:ie[re]},postRequestFailed:{code:ne,desc:ie[ne]}};class se extends Error{constructor(e,r,n){super(r?`${e}: ${r}`:e),Object.setPrototypeOf(this,se.prototype),this.errorCode=e||t.EMPTY_STRING,this.errorMessage=r||t.EMPTY_STRING,this.subError=n||t.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function ce(e,t){return new se(e,t?`${ie[e]} ${t}`:ie[e])}
/*! @azure/msal-common v15.3.0 2025-03-20 */const ue="client_info_decoding_error",le="client_info_empty_error",de="token_parsing_error",he="null_or_empty_token",pe="endpoints_resolution_error",ge="network_error",fe="openid_config_error",me="hash_not_deserialized",ve="invalid_state",ye="state_mismatch",Ce="state_not_found",Te="nonce_mismatch",Ie="auth_time_not_found",we="max_age_transpired",Ee="multiple_matching_tokens",ke="multiple_matching_accounts",Se="multiple_matching_appMetadata",be="request_cannot_be_made",Ae="cannot_remove_empty_scope",_e="cannot_append_scopeset",Re="empty_input_scopeset",Pe="device_code_polling_cancelled",Ne="device_code_expired",Me="device_code_unknown_error",Oe="no_account_in_silent_request",qe="invalid_cache_record",Ue="invalid_cache_environment",xe="no_account_found",Le="no_crypto_object",Be="unexpected_credential_type",He="invalid_assertion",De="invalid_client_credential",Fe="token_refresh_required",Ke="user_timeout_reached",ze="token_claims_cnf_required_for_signedjwt",Ge="authorization_code_missing_from_server_response",je="binding_key_not_removed",Qe="end_session_endpoint_not_supported",We="key_id_missing",Ve="no_network_connectivity",Ye="user_canceled",$e="missing_tenant_id_error",Je="method_not_implemented",Xe="nested_app_auth_bridge_disabled";var Ze=Object.freeze({__proto__:null,authTimeNotFound:Ie,authorizationCodeMissingFromServerResponse:Ge,bindingKeyNotRemoved:je,cannotAppendScopeSet:_e,cannotRemoveEmptyScope:Ae,clientInfoDecodingError:ue,clientInfoEmptyError:le,deviceCodeExpired:Ne,deviceCodePollingCancelled:Pe,deviceCodeUnknownError:Me,emptyInputScopeSet:Re,endSessionEndpointNotSupported:Qe,endpointResolutionError:pe,hashNotDeserialized:me,invalidAssertion:He,invalidCacheEnvironment:Ue,invalidCacheRecord:qe,invalidClientCredential:De,invalidState:ve,keyIdMissing:We,maxAgeTranspired:we,methodNotImplemented:Je,missingTenantIdError:$e,multipleMatchingAccounts:ke,multipleMatchingAppMetadata:Se,multipleMatchingTokens:Ee,nestedAppAuthBridgeDisabled:Xe,networkError:ge,noAccountFound:xe,noAccountInSilentRequest:Oe,noCryptoObject:Le,noNetworkConnectivity:Ve,nonceMismatch:Te,nullOrEmptyToken:he,openIdConfigError:fe,requestCannotBeMade:be,stateMismatch:ye,stateNotFound:Ce,tokenClaimsCnfRequiredForSignedJwt:ze,tokenParsingError:de,tokenRefreshRequired:Fe,unexpectedCredentialType:Be,userCanceled:Ye,userTimeoutReached:Ke});
/*! @azure/msal-common v15.3.0 2025-03-20 */const et={[ue]:"The client info could not be parsed/decoded correctly",[le]:"The client info was empty",[de]:"Token cannot be parsed",[he]:"The token is null or empty",[pe]:"Endpoints cannot be resolved",[ge]:"Network request failed",[fe]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[me]:"The hash parameters could not be deserialized",[ve]:"State was not the expected format",[ye]:"State mismatch error",[Ce]:"State not found",[Te]:"Nonce mismatch error",[Ie]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[we]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Ee]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ke]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Se]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[be]:"Token request cannot be made without authorization code or refresh token.",[Ae]:"Cannot remove null or empty scope from ScopeSet",[_e]:"Cannot append ScopeSet",[Re]:"Empty input ScopeSet cannot be processed",[Pe]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Ne]:"Device code is expired.",[Me]:"Device code stopped polling for unknown reasons.",[Oe]:"Please pass an account object, silent flow is not supported without account information",[qe]:"Cache record object was null or undefined.",[Ue]:"Invalid environment when attempting to create cache entry",[xe]:"No account found in cache for given key.",[Le]:"No crypto object detected.",[Be]:"Unexpected credential type.",[He]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[De]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Fe]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Ke]:"User defined timeout for device code polling reached",[ze]:"Cannot generate a POP jwt if the token_claims are not populated",[Ge]:"Server response does not contain an authorization code to proceed",[je]:"Could not remove the credential's binding key from storage.",[Qe]:"The provided authority does not support logout",[We]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Ve]:"No network connectivity. Check your internet connection.",[Ye]:"User cancelled the flow.",[$e]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Je]:"This method has not been implemented",[Xe]:"The nested app auth bridge is disabled"},tt={clientInfoDecodingError:{code:ue,desc:et[ue]},clientInfoEmptyError:{code:le,desc:et[le]},tokenParsingError:{code:de,desc:et[de]},nullOrEmptyToken:{code:he,desc:et[he]},endpointResolutionError:{code:pe,desc:et[pe]},networkError:{code:ge,desc:et[ge]},unableToGetOpenidConfigError:{code:fe,desc:et[fe]},hashNotDeserialized:{code:me,desc:et[me]},invalidStateError:{code:ve,desc:et[ve]},stateMismatchError:{code:ye,desc:et[ye]},stateNotFoundError:{code:Ce,desc:et[Ce]},nonceMismatchError:{code:Te,desc:et[Te]},authTimeNotFoundError:{code:Ie,desc:et[Ie]},maxAgeTranspired:{code:we,desc:et[we]},multipleMatchingTokens:{code:Ee,desc:et[Ee]},multipleMatchingAccounts:{code:ke,desc:et[ke]},multipleMatchingAppMetadata:{code:Se,desc:et[Se]},tokenRequestCannotBeMade:{code:be,desc:et[be]},removeEmptyScopeError:{code:Ae,desc:et[Ae]},appendScopeSetError:{code:_e,desc:et[_e]},emptyInputScopeSetError:{code:Re,desc:et[Re]},DeviceCodePollingCancelled:{code:Pe,desc:et[Pe]},DeviceCodeExpired:{code:Ne,desc:et[Ne]},DeviceCodeUnknownError:{code:Me,desc:et[Me]},NoAccountInSilentRequest:{code:Oe,desc:et[Oe]},invalidCacheRecord:{code:qe,desc:et[qe]},invalidCacheEnvironment:{code:Ue,desc:et[Ue]},noAccountFound:{code:xe,desc:et[xe]},noCryptoObj:{code:Le,desc:et[Le]},unexpectedCredentialType:{code:Be,desc:et[Be]},invalidAssertion:{code:He,desc:et[He]},invalidClientCredential:{code:De,desc:et[De]},tokenRefreshRequired:{code:Fe,desc:et[Fe]},userTimeoutReached:{code:Ke,desc:et[Ke]},tokenClaimsRequired:{code:ze,desc:et[ze]},noAuthorizationCodeFromServer:{code:Ge,desc:et[Ge]},bindingKeyNotRemovedError:{code:je,desc:et[je]},logoutNotSupported:{code:Qe,desc:et[Qe]},keyIdMissing:{code:We,desc:et[We]},noNetworkConnectivity:{code:Ve,desc:et[Ve]},userCanceledError:{code:Ye,desc:et[Ye]},missingTenantIdError:{code:$e,desc:et[$e]},nestedAppAuthBridgeDisabled:{code:Xe,desc:et[Xe]}};class rt extends se{constructor(e,t){super(e,t?`${et[e]}: ${t}`:et[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,rt.prototype)}}function nt(e,t){return new rt(e,t)}
/*! @azure/msal-common v15.3.0 2025-03-20 */const ot={createNewGuid:()=>{throw nt(Je)},base64Decode:()=>{throw nt(Je)},base64Encode:()=>{throw nt(Je)},base64UrlEncode:()=>{throw nt(Je)},encodeKid:()=>{throw nt(Je)},async getPublicKeyThumbprint(){throw nt(Je)},async removeTokenBindingKey(){throw nt(Je)},async clearKeystore(){throw nt(Je)},async signJwt(){throw nt(Je)},async hashString(){throw nt(Je)}};
/*! @azure/msal-common v15.3.0 2025-03-20 */var it;e.LogLevel=void 0,(it=e.LogLevel||(e.LogLevel={}))[it.Error=0]="Error",it[it.Warning=1]="Warning",it[it.Info=2]="Info",it[it.Verbose=3]="Verbose",it[it.Trace=4]="Trace";class at{constructor(r,n,o){this.level=e.LogLevel.Info;const i=r||at.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||(()=>{}),this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level="number"==typeof i.logLevel?i.logLevel:e.LogLevel.Info,this.correlationId=i.correlationId||t.EMPTY_STRING,this.packageName=n||t.EMPTY_STRING,this.packageVersion=o||t.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:e.LogLevel.Info}}clone(e,t,r){return new at({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(t,r){if(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)return;const n=`${`[${(new Date).toUTCString()}] : [${r.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${e.LogLevel[r.logLevel]} - ${t}`;this.executeCallback(r.logLevel,n,r.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(r,n){this.logMessage(r,{logLevel:e.LogLevel.Error,containsPii:!1,correlationId:n||t.EMPTY_STRING})}errorPii(r,n){this.logMessage(r,{logLevel:e.LogLevel.Error,containsPii:!0,correlationId:n||t.EMPTY_STRING})}warning(r,n){this.logMessage(r,{logLevel:e.LogLevel.Warning,containsPii:!1,correlationId:n||t.EMPTY_STRING})}warningPii(r,n){this.logMessage(r,{logLevel:e.LogLevel.Warning,containsPii:!0,correlationId:n||t.EMPTY_STRING})}info(r,n){this.logMessage(r,{logLevel:e.LogLevel.Info,containsPii:!1,correlationId:n||t.EMPTY_STRING})}infoPii(r,n){this.logMessage(r,{logLevel:e.LogLevel.Info,containsPii:!0,correlationId:n||t.EMPTY_STRING})}verbose(r,n){this.logMessage(r,{logLevel:e.LogLevel.Verbose,containsPii:!1,correlationId:n||t.EMPTY_STRING})}verbosePii(r,n){this.logMessage(r,{logLevel:e.LogLevel.Verbose,containsPii:!0,correlationId:n||t.EMPTY_STRING})}trace(r,n){this.logMessage(r,{logLevel:e.LogLevel.Trace,containsPii:!1,correlationId:n||t.EMPTY_STRING})}tracePii(r,n){this.logMessage(r,{logLevel:e.LogLevel.Trace,containsPii:!0,correlationId:n||t.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const st="@azure/msal-common",ct="15.3.0",ut={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};
/*! @azure/msal-common v15.3.0 2025-03-20 */
function lt(e,t){const r=function(e){if(!e)throw nt(he);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw nt(de);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw nt(de)}}function dt(e,t){if(0===t||Date.now()-3e5>e+t)throw nt(we)}
/*! @azure/msal-common v15.3.0 2025-03-20 */function ht(){return Math.round((new Date).getTime()/1e3)}function pt(e){return e.getTime()/1e3}function gt(e){return e?new Date(1e3*Number(e)):new Date}function ft(e,t){const r=Number(e)||0;return ht()+t>r}function mt(e){return Number(e)>ht()}
/*! @azure/msal-common v15.3.0 2025-03-20 */function vt(e){return[wt(e),Et(e),kt(e),St(e),bt(e)].join(E.CACHE_KEY_SEPARATOR).toLowerCase()}function yt(e,t,r,n,o){return{credentialType:k.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function Ct(e,t,r,n,o,i,a,s,c,u,l,d,h,p,g){const f={homeAccountId:e,credentialType:k.ACCESS_TOKEN,secret:r,cachedAt:ht().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:l||U.BEARER};if(d&&(f.userAssertionHash=d),u&&(f.refreshOn=u.toString()),p&&(f.requestedClaims=p,f.requestedClaimsHash=g),f.tokenType?.toLowerCase()!==U.BEARER.toLowerCase())switch(f.credentialType=k.ACCESS_TOKEN_WITH_AUTH_SCHEME,f.tokenType){case U.POP:const e=lt(r,c);if(!e?.cnf?.kid)throw nt(ze);f.keyId=e.cnf.kid;break;case U.SSH:f.keyId=h}return f}function Tt(e,t,r,n,o,i,a){const s={credentialType:k.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function It(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function wt(e){return[e.homeAccountId,e.environment].join(E.CACHE_KEY_SEPARATOR).toLowerCase()}function Et(e){const t=e.credentialType===k.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(E.CACHE_KEY_SEPARATOR).toLowerCase()}function kt(e){return(e.target||"").toLowerCase()}function St(e){return(e.requestedClaimsHash||"").toLowerCase()}function bt(e){return e.tokenType&&e.tokenType.toLowerCase()!==U.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function At(){return ht()+R}function _t(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function Rt(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function Pt(e){return e.expiresAt<=ht()}
/*! @azure/msal-common v15.3.0 2025-03-20 */const Nt="redirect_uri_empty",Mt="claims_request_parsing_error",Ot="authority_uri_insecure",qt="url_parse_error",Ut="empty_url_error",xt="empty_input_scopes_error",Lt="invalid_prompt_value",Bt="invalid_claims",Ht="token_request_empty",Dt="logout_request_empty",Ft="invalid_code_challenge_method",Kt="pkce_params_missing",zt="invalid_cloud_discovery_metadata",Gt="invalid_authority_metadata",jt="untrusted_authority",Qt="missing_ssh_jwk",Wt="missing_ssh_kid",Vt="missing_nonce_authentication_header",Yt="invalid_authentication_header",$t="cannot_set_OIDCOptions",Jt="cannot_allow_platform_broker",Xt="authority_mismatch";var Zt=Object.freeze({__proto__:null,authorityMismatch:Xt,authorityUriInsecure:Ot,cannotAllowPlatformBroker:Jt,cannotSetOIDCOptions:$t,claimsRequestParsingError:Mt,emptyInputScopesError:xt,invalidAuthenticationHeader:Yt,invalidAuthorityMetadata:Gt,invalidClaims:Bt,invalidCloudDiscoveryMetadata:zt,invalidCodeChallengeMethod:Ft,invalidPromptValue:Lt,logoutRequestEmpty:Dt,missingNonceAuthenticationHeader:Vt,missingSshJwk:Qt,missingSshKid:Wt,pkceParamsMissing:Kt,redirectUriEmpty:Nt,tokenRequestEmpty:Ht,untrustedAuthority:jt,urlEmptyError:Ut,urlParseError:qt});
/*! @azure/msal-common v15.3.0 2025-03-20 */const er={[Nt]:"A redirect URI is required for all calls, and none has been set.",[Mt]:"Could not parse the given claims request object.",[Ot]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[qt]:"URL could not be parsed into appropriate segments.",[Ut]:"URL was empty or null.",[xt]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Lt]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Bt]:"Given claims parameter must be a stringified JSON object.",[Ht]:"Token request was empty and not found in cache.",[Dt]:"The logout request was null or undefined.",[Ft]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Kt]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[zt]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Gt]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[jt]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Qt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Wt]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Vt]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Yt]:"Invalid authentication header provided",[$t]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Jt]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Xt]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},tr={redirectUriNotSet:{code:Nt,desc:er[Nt]},claimsRequestParsingError:{code:Mt,desc:er[Mt]},authorityUriInsecure:{code:Ot,desc:er[Ot]},urlParseError:{code:qt,desc:er[qt]},urlEmptyError:{code:Ut,desc:er[Ut]},emptyScopesError:{code:xt,desc:er[xt]},invalidPrompt:{code:Lt,desc:er[Lt]},invalidClaimsRequest:{code:Bt,desc:er[Bt]},tokenRequestEmptyError:{code:Ht,desc:er[Ht]},logoutRequestEmptyError:{code:Dt,desc:er[Dt]},invalidCodeChallengeMethod:{code:Ft,desc:er[Ft]},invalidCodeChallengeParams:{code:Kt,desc:er[Kt]},invalidCloudDiscoveryMetadata:{code:zt,desc:er[zt]},invalidAuthorityMetadata:{code:Gt,desc:er[Gt]},untrustedAuthority:{code:jt,desc:er[jt]},missingSshJwk:{code:Qt,desc:er[Qt]},missingSshKid:{code:Wt,desc:er[Wt]},missingNonceAuthenticationHeader:{code:Vt,desc:er[Vt]},invalidAuthenticationHeader:{code:Yt,desc:er[Yt]},cannotSetOIDCOptions:{code:$t,desc:er[$t]},cannotAllowPlatformBroker:{code:Jt,desc:er[Jt]},authorityMismatch:{code:Xt,desc:er[Xt]}};class rr extends se{constructor(e){super(e,er[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,rr.prototype)}}function nr(e){return new rr(e)}
/*! @azure/msal-common v15.3.0 2025-03-20 */class or{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class ir{constructor(e){const t=e?or.trimArrayEntries([...e]):[],r=t?or.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw nr(xt);this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const r=(e||t.EMPTY_STRING).split(" ");return new ir(r)}static createSearchScopes(e){const r=new ir(e);return r.containsOnlyOIDCScopes()?r.removeScope(t.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new ir(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e))))}containsOnlyOIDCScopes(){let e=0;return s.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw nt(_e)}}removeScope(e){if(!e)throw nt(Ae);this.scopes.delete(e.trim())}removeOIDCScopes(){s.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw nt(Re);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw nt(Re);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return t.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}
/*! @azure/msal-common v15.3.0 2025-03-20 */function ar(e,t){if(!e)throw nt(le);try{const r=t(e);return JSON.parse(r)}catch(e){throw nt(ue)}}function sr(e){if(!e)throw nt(ue);const r=e.split(E.CLIENT_INFO_SEPARATOR,2);return{uid:r[0],utid:r.length<2?t.EMPTY_STRING:r[1]}}
/*! @azure/msal-common v15.3.0 2025-03-20 */function cr(e,t){return!!e&&!!t&&e===t.split(".")[1]}function ur(e,t,r,n){if(n){const{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,c=o||a||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:cr(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:cr(r,e)}}function lr(e,t,r,n){let o=e;if(t){const{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){const{isHomeTenant:t,...i}=ur(e.homeAccountId,e.localAccountId,e.tenantId,r);return o={...o,...i,idTokenClaims:r,idToken:n},o}return o}
/*! @azure/msal-common v15.3.0 2025-03-20 */const dr=0,hr=1,pr=2,gr=3;
/*! @azure/msal-common v15.3.0 2025-03-20 */function fr(e){if(e){return e.tid||e.tfp||e.acr||null}return null}
/*! @azure/msal-common v15.3.0 2025-03-20 */const mr={AAD:"AAD",OIDC:"OIDC"};
/*! @azure/msal-common v15.3.0 2025-03-20 */class vr{generateAccountId(){return[this.homeAccountId,this.environment].join(E.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return vr.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(E.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){const n=new vr;let o;t.authorityType===hr?n.authorityType=I:t.protocolMode===mr.AAD?n.authorityType=T:n.authorityType=w,e.clientInfo&&r&&(o=ar(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw nt(Ue);n.environment=i,n.realm=o?.utid||fr(e.idTokenClaims)||"",n.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=a||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=ur(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new vr;return n.authorityType=e.authorityType||w,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(t!==hr&&t!==pr){if(e)try{const t=ar(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}
/*! @azure/msal-common v15.3.0 2025-03-20 */function yr(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Cr(e){if(!e||e.indexOf("=")<0)return null;try{const t=yr(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.error||r.error_description||r.state)return r}catch(e){throw nt(me)}return null}function Tr(e){const t=new Array;return e.forEach(((e,r)=>{t.push(`${r}=${encodeURIComponent(e)}`)})),t.join("&")}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Ir{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw nr(Ut);e.includes("#")||(this._urlString=Ir.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return or.endsWith(t,"?")?t=t.slice(0,-1):or.endsWith(t,"?/")&&(t=t.slice(0,-2)),or.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw nr(qt)}if(!e.HostNameAndPort||!e.PathSegments)throw nr(qt);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw nr(Ot)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Ir.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==l&&r[0]!==d||(r[0]=e),Ir.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw nr(qt);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw nr(qt);return r[2]}static getAbsoluteUrl(e,r){if(e[0]===t.FORWARD_SLASH){const t=new Ir(r).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Ir(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Cr(e)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const wr={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Er={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},kr=new Set;function Sr(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const o=br(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function br(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}
/*! @azure/msal-common v15.3.0 2025-03-20 */Er.metadata.forEach((e=>{e.aliases.forEach((e=>{kr.add(e)}))}));const Ar="cache_quota_exceeded",_r="cache_error_unknown",Rr={[Ar]:"Exceeded cache storage capacity.",[_r]:"Unexpected error occurred when using cache storage."};class Pr extends Error{constructor(e,t){const r=t||(Rr[e]?Rr[e]:Rr[_r]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Pr.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Nr{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(st,ct),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);if(t.length>1){return t.sort((e=>e.idTokenClaims?-1:1))[0]}return 1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let o,i=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(o=lt(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,n))?null:(i=lr(e,r,o,a?.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let o=n.tenantProfiles||new Map;const i=this.getTokenKeys();if(t){const e=o.get(t);if(!e)return[];o=new Map([[t,e]])}const a=[];return o.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&a.push(t)})),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw nt(qe);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==r?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==r?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==r?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,t),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new Pr(Ar)):new Pr(e.name,e.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,t),new Pr(_r))}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=ir.fromString(e.target),i=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const t=this.getAccessTokenCredential(e);if(t&&this.credentialMatchesFilter(t,r)){ir.fromString(t.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(e))}})),await Promise.all(i),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const o={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,o)));i&&0===i.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(E.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))}isCredentialKey(e){if(e.split(E.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(k.ID_TOKEN.toLowerCase())&&-1===t.indexOf(k.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(k.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(k.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(k.REFRESH_TOKEN.toLowerCase())>-1){const e=`${k.REFRESH_TOKEN}${E.CACHE_KEY_SEPARATOR}${this.clientId}${E.CACHE_KEY_SEPARATOR}`,r=`${k.REFRESH_TOKEN}${E.CACHE_KEY_SEPARATOR}${A}${E.CACHE_KEY_SEPARATOR}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===k.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===U.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await Promise.all(n)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===k.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===U.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw nt(je)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=vr.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:k.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=a;if(!r){const r=new Map;a.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&o&&n.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,o,i){this.commonLogger.trace("CacheManager - getAccessToken called");const a=ir.createSearchScopes(t.scopes),s=t.authenticationScheme||U.BEARER,c=s&&s.toLowerCase()!==U.BEARER.toLowerCase()?k.ACCESS_TOKEN_WITH_AUTH_SCHEME:k.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=r&&r.accessToken||this.getTokenKeys().accessToken,d=[];l.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,u,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,u)&&d.push(t)}}));const h=d.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach((e=>{this.removeAccessToken(vt(e))})),o&&i&&o.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?A:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:k.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}}));const u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&n&&o&&n.addFields({multiMatchedRT:u},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),o=n.length;if(o<1)return null;if(o>1)throw nt(Se);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==A)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const o=new Ir(n).getUrlComponents().HostNameAndPort;r=Sr(o,e.cloudDiscoveryMetadata?.metadata,P,t)||Sr(o,Er.metadata,O,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==k.ACCESS_TOKEN&&e.credentialType!==k.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return ir.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(S)}isAuthorityMetadata(e){return-1!==e.indexOf(_)}generateAuthorityMetadataCacheKey(e){return`${_}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class Mr extends Nr{async setAccount(){throw nt(Je)}getAccount(){throw nt(Je)}async setIdTokenCredential(){throw nt(Je)}getIdTokenCredential(){throw nt(Je)}async setAccessTokenCredential(){throw nt(Je)}getAccessTokenCredential(){throw nt(Je)}async setRefreshTokenCredential(){throw nt(Je)}getRefreshTokenCredential(){throw nt(Je)}setAppMetadata(){throw nt(Je)}getAppMetadata(){throw nt(Je)}setServerTelemetry(){throw nt(Je)}getServerTelemetry(){throw nt(Je)}setAuthorityMetadata(){throw nt(Je)}getAuthorityMetadata(){throw nt(Je)}getAuthorityMetadataKeys(){throw nt(Je)}setThrottlingCache(){throw nt(Je)}getThrottlingCache(){throw nt(Je)}removeItem(){throw nt(Je)}getKeys(){throw nt(Je)}getAccountKeys(){throw nt(Je)}getTokenKeys(){throw nt(Je)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const Or={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},qr={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:e.LogLevel.Info,correlationId:t.EMPTY_STRING},Ur={claimsBasedCachingEnabled:!1},xr={async sendGetRequestAsync(){throw nt(Je)},async sendPostRequestAsync(){throw nt(Je)}},Lr={sku:t.SKU,version:ct,cpu:t.EMPTY_STRING,os:t.EMPTY_STRING},Br={clientSecret:t.EMPTY_STRING,clientAssertion:void 0},Hr={azureCloudInstance:ut.None,tenant:`${t.DEFAULT_COMMON_TENANT}`},Dr={application:{appName:"",appVersion:""}};function Fr(e){return e.authOptions.authority.options.protocolMode===mr.OIDC}
/*! @azure/msal-common v15.3.0 2025-03-20 */const Kr="home_account_id",zr="UPN",Gr="client_id",jr="redirect_uri",Qr="response_type",Wr="response_mode",Vr="claims",Yr="scope",$r="state",Jr="nonce",Xr="prompt",Zr="code_challenge",en="code_challenge_method",tn="client-request-id",rn="x-client-SKU",nn="x-client-VER",on="x-client-OS",an="x-client-CPU",sn="x-app-name",cn="x-app-ver",un="token_type",ln="req_cnf",dn="return_spa_code",hn="nativebroker",pn="sid",gn="login_hint",fn="domain_hint",mn="x-client-xtra-sku",vn="brk_client_id",yn="brk_redirect_uri",Cn="instance_aware";
/*! @azure/msal-common v15.3.0 2025-03-20 */
/*! @azure/msal-common v15.3.0 2025-03-20 */
function Tn(e,t,r){if(!t)return;const n=e.get(Gr);n&&e.has(vn)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(jr)},t)}function In(e,t,r=!0,n=a){!r||n.includes("openid")||t.includes("openid")||n.push("openid");const o=r?[...t||[],...n]:t||[],i=new ir(o);e.set(Yr,i.printScopes())}function wn(e,t){e.set(Gr,t)}function En(e,t){e.set(jr,t)}function kn(e,t){e.set(gn,t)}function Sn(e,t){e.set(c.CCS_HEADER,`UPN:${t}`)}function bn(e,t){e.set(c.CCS_HEADER,`Oid:${t.uid}@${t.utid}`)}function An(e,t){e.set(pn,t)}function _n(e,t,r){const n=Dn(t,r);try{JSON.parse(n)}catch(e){throw nr(Bt)}e.set(Vr,n)}function Rn(e,t){e.set(tn,t)}function Pn(e,t){e.set(rn,t.sku),e.set(nn,t.version),t.os&&e.set(on,t.os),t.cpu&&e.set(an,t.cpu)}function Nn(e,t){t?.appName&&e.set(sn,t.appName),t?.appVersion&&e.set(cn,t.appVersion)}function Mn(e,t){t&&e.set($r,t)}function On(e,t){e.set("client_secret",t)}function qn(e,t){t&&e.set("client_assertion",t)}function Un(e,t){t&&e.set("client_assertion_type",t)}function xn(e,t){e.set("grant_type",t)}function Ln(e){e.set(b,"1")}function Bn(e){e.has(Cn)||e.set(Cn,"true")}function Hn(e,t){Object.entries(t).forEach((([t,r])=>{!e.has(t)&&r&&e.set(t,r)}))}function Dn(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw nr(Bt)}else r={};return t&&t.length>0&&(r.hasOwnProperty(p.ACCESS_TOKEN)||(r[p.ACCESS_TOKEN]={}),r[p.ACCESS_TOKEN][p.XMS_CC]={values:t}),JSON.stringify(r)}function Fn(e,t){t&&(e.set(un,U.POP),e.set(ln,t))}function Kn(e,t){t&&(e.set(un,U.SSH),e.set(ln,t))}function zn(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Gn(e){e.set("x-ms-lib-capability",H)}function jn(e,t,r){e.has(vn)||e.set(vn,t),e.has(yn)||e.set(yn,r)}
/*! @azure/msal-common v15.3.0 2025-03-20 */
/*! @azure/msal-common v15.3.0 2025-03-20 */
const Qn={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt"},Wn=new Map([[Qn.AcquireTokenByCode,"ATByCode"],[Qn.AcquireTokenByRefreshToken,"ATByRT"],[Qn.AcquireTokenSilent,"ATS"],[Qn.AcquireTokenSilentAsync,"ATSAsync"],[Qn.AcquireTokenPopup,"ATPopup"],[Qn.AcquireTokenRedirect,"ATRedirect"],[Qn.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[Qn.CryptoOptsSignJwt,"CryptoSignJwt"],[Qn.SilentCacheClientAcquireToken,"SltCacheClientAT"],[Qn.SilentIframeClientAcquireToken,"SltIframeClientAT"],[Qn.SilentRefreshClientAcquireToken,"SltRClientAT"],[Qn.SsoSilent,"SsoSlt"],[Qn.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[Qn.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[Qn.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[Qn.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[Qn.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[Qn.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[Qn.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[Qn.BrokerHandhshake,"BrokerHandshake"],[Qn.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[Qn.AcquireTokenByBroker,"ATByBroker"],[Qn.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[Qn.RefreshTokenClientAcquireToken,"RTClientAT"],[Qn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[Qn.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[Qn.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[Qn.AcquireTokenFromCache,"ATFromCache"],[Qn.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[Qn.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[Qn.AcquireTokenBySilentIframe,"ATBySltIframe"],[Qn.InitializeBaseRequest,"InitBaseReq"],[Qn.InitializeSilentRequest,"InitSltReq"],[Qn.InitializeClientApplication,"InitClientApplication"],[Qn.InitializeCache,"InitCache"],[Qn.ImportExistingCache,"importCache"],[Qn.SetUserData,"setUserData"],[Qn.LocalStorageUpdated,"localStorageUpdated"],[Qn.SilentIframeClientTokenHelper,"SIClientTHelper"],[Qn.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[Qn.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[Qn.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[Qn.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[Qn.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[Qn.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[Qn.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[Qn.GetAuthCodeUrl,"GetAuthCodeUrl"],[Qn.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[Qn.HandleCodeResponse,"HandleCodeResp"],[Qn.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[Qn.AuthClientAcquireToken,"AuthClientAT"],[Qn.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[Qn.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[Qn.PopTokenGenerateCnf,"PopTGenCnf"],[Qn.PopTokenGenerateKid,"PopTGenKid"],[Qn.HandleServerTokenResponse,"HandleServerTRes"],[Qn.DeserializeResponse,"DeserializeRes"],[Qn.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[Qn.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[Qn.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[Qn.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[Qn.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[Qn.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[Qn.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[Qn.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[Qn.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[Qn.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[Qn.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[Qn.AcquireTokenByCodeAsync,"ATByCodeAsync"],[Qn.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[Qn.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[Qn.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[Qn.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[Qn.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[Qn.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[Qn.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[Qn.NativeGenerateAuthResult,"NtvGenAuthRes"],[Qn.RemoveHiddenIframe,"RemoveHiddenIframe"],[Qn.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[Qn.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[Qn.GeneratePkceCodes,"GenPkceCodes"],[Qn.GenerateCodeVerifier,"GenCodeVerifier"],[Qn.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[Qn.Sha256Digest,"Sha256Digest"],[Qn.GetRandomValues,"GetRandomValues"],[Qn.GenerateHKDF,"genHKDF"],[Qn.GenerateBaseKey,"genBaseKey"],[Qn.Base64Decode,"b64Decode"],[Qn.UrlEncodeArr,"urlEncArr"],[Qn.Encrypt,"encrypt"],[Qn.Decrypt,"decrypt"]]),Vn=1,Yn=2,$n=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]),Jn=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}try{const n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},Xn=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}return n?.setPreQueueTime(t,o),e(...i).then((e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}))};
/*! @azure/msal-common v15.3.0 2025-03-20 */
class Zn{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,r){this.performanceClient?.addQueueMeasurement(Qn.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)r.region_source=j;else{const e=Zn.IMDS_OPTIONS;try{const o=await Xn(this.getRegionFromIMDS.bind(this),Qn.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(t.IMDS_VERSION,e);if(o.status===K&&(n=o.body,r.region_source=Q),o.status===z){const t=await Xn(this.getCurrentVersion.bind(this),Qn.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(e);if(!t)return r.region_source=G,null;const o=await Xn(this.getRegionFromIMDS.bind(this),Qn.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(t,e);o.status===K&&(n=o.body,r.region_source=Q)}}catch(e){return r.region_source=G,null}}return n||(r.region_source=G),n||null}async getRegionFromIMDS(e,r){return this.performanceClient?.addQueueMeasurement(Qn.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${t.IMDS_ENDPOINT}?api-version=${e}&format=text`,r,t.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(Qn.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${t.IMDS_ENDPOINT}?format=json`,e);return r.status===z&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch(e){return null}}}Zn.IMDS_OPTIONS={headers:{Metadata:"true"}};
/*! @azure/msal-common v15.3.0 2025-03-20 */
class eo{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new Zn(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(t.CIAM_AUTH_URL))return gr;const r=e.PathSegments;if(r.length)switch(r[0].toLowerCase()){case t.ADFS:return hr;case t.DSTS:return pr}return dr}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Ir(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw nt(pe)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw nt(pe)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw nt(pe)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw nt(Qe);return this.replacePath(this.metadata.end_session_endpoint)}throw nt(pe)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw nt(pe)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw nt(pe)}canReplaceTenant(e){return 1===e.PathSegments.length&&!eo.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===dr&&this.protocolMode===mr.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new Ir(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){const e=new Ir(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===hr||this.protocolMode!==mr.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Qn.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Xn(this.updateCloudDiscoveryMetadata.bind(this),Qn.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Xn(this.updateEndpointMetadata.bind(this),Qn.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:At(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==N&&r?.source!==N&&(e.expiresAt=At(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Qn.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===O&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){_t(e,await Xn(this.updateMetadataWithRegionalInformation.bind(this),Qn.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority}return t.source}let r=await Xn(this.getEndpointMetadataFromNetwork.bind(this),Qn.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await Xn(this.updateMetadataWithRegionalInformation.bind(this),Qn.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),_t(e,r,!0),M;throw nt(fe,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),_t(e,t,!1),{source:P};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return _t(e,t,!1),{source:O,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=Pt(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:N}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Ir(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw nr(Gt)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Qn.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v15.3.0 2025-03-20 */(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in wr?wr[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Qn.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const r=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(r){if(r!==t.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=W,this.regionDiscoveryMetadata.region_used=r,eo.replaceWithRegionalInformation(e,r);const n=await Xn(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Qn.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=V,this.regionDiscoveryMetadata.region_used=n,eo.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Y}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Qn.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await Xn(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Qn.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return Rt(e,r,!0),M;throw nr(jt)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||t.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||t.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||t.NOT_APPLICABLE}`);const r=this.getCloudDiscoveryMetadataFromConfig();if(r)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Rt(e,r,!1),P;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,br(Er.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Rt(e,t,!1),O;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const o=Pt(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found cloud discovery metadata in the cache."),N):(o&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===gr)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),eo.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=br(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),nr(zt)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),eo.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Qn.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${t.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,r={};let n=null;try{const o=await this.networkInterface.sendGetRequestAsync(e,r);let i,a;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}
/*! @azure/msal-common v15.3.0 2025-03-20 */(o.body))i=o.body,a=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(o.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===t.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=br(a,this.hostnameAndPort)}catch(e){if(e instanceof se)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=eo.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&Ir.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,r){let n;if(r&&r.azureCloudInstance!==ut.None){const e=r.tenant?r.tenant:t.DEFAULT_COMMON_TENANT;n=`${r.azureCloudInstance}/${e}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return t.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw nt(pe)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return kr.has(e)}static isPublicCloudAuthority(e){return t.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,r,n){const o=new Ir(e);o.validateAsUri();const i=o.getUrlComponents();let a=`${r}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${r}.${t.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=Ir.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:a}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=eo.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=eo.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=eo.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let r=e;const n=new Ir(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(t.CIAM_AUTH_URL)){r=`${r}${n.HostNameAndPort.split(".")[0]}${t.AAD_TENANT_DOMAIN_SUFFIX}`}return r}}function to(e){return e.endsWith(t.FORWARD_SLASH)?e:`${e}${t.FORWARD_SLASH}`}function ro(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw nr(zt)}return{canonicalAuthority:e.authority?to(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}
/*! @azure/msal-common v15.3.0 2025-03-20 */async function no(e,t,r,n,o,i,a){a?.addQueueMeasurement(Qn.AuthorityFactoryCreateDiscoveredInstance,i);const s=eo.transformCIAMAuthority(to(e)),c=new eo(s,t,r,n,o,i,a);try{return await Xn(c.resolveEndpointsAsync.bind(c),Qn.AuthorityResolveEndpointsAsync,o,a,i)(),c}catch(e){throw nt(pe)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */eo.reservedTenantDomains=new Set(["{tenant}","{tenantid}",l,h,d]);class oo extends se{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,oo.prototype)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */function io(e,t,r){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class ao{static generateThrottlingStorageKey(e){return`${B}.${JSON.stringify(e)}`}static preProcess(e,r){const n=ao.generateThrottlingStorageKey(r),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now())return void e.removeItem(n);throw new oo(o.errorCodes?.join(" ")||t.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,r){if(ao.checkResponseStatus(r)||ao.checkResponseForRetryAfter(r)){const n={throttleTime:ao.calculateThrottleTime(parseInt(r.headers[c.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(ao.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(c.RETRY_AFTER)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||x),r+L))}static removeThrottle(e,t,r,n){const o=io(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class so extends se{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,so.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function co(e,t,r){return new so(e,t,r)}
/*! @azure/msal-common v15.3.0 2025-03-20 */class uo{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:u,serverTelemetryManager:l,persistencePlugin:d,serializableCache:h}){const p={...qr,...r};return{authOptions:(g=e,{clientCapabilities:[],azureCloudOptions:Hr,skipAuthorityMetadataCache:!1,instanceAware:!1,...g}),systemOptions:{...Or,...t},loggerOptions:p,cacheOptions:{...Ur,...n},storageInterface:o||new Mr(e.clientId,ot,new at(p)),networkInterface:i||xr,cryptoInterface:a||ot,clientCredentials:s||Br,libraryInfo:{...Lr,...c},telemetry:{...Dr,...u},serverTelemetryManager:l||null,persistencePlugin:d||null,serializableCache:h||null};var g}(e),this.logger=new at(this.config.loggerOptions,st,ct),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const r={};if(r[c.CONTENT_TYPE]=t.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Kr:try{const t=sr(e.credential);r[c.CCS_HEADER]=`Oid:${t.uid}@${t.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case zr:r[c.CCS_HEADER]=`UPN: ${e.credential}`}return r}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;ao.preProcess(this.cacheManager,e);try{o=await Xn(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Qn.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,n)(t,r);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[c.X_MS_HTTP_VERSION]||"",requestId:e[c.X_MS_REQUEST_ID]||""},n)}catch(e){if(e instanceof so){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[c.X_MS_HTTP_VERSION]||"",requestId:t[c.X_MS_REQUEST_ID]||"",contentTypeHeader:t[c.CONTENT_TYPE]||void 0,contentLengthHeader:t[c.CONTENT_LENGTH]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof se?e:nt(ge)}return ao.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(Qn.UpdateTokenEndpointAuthority,t);const r=`https://${e}/${this.authority.tenant}/`,n=await no(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&jn(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Hn(t,e.tokenQueryParameters),Rn(t,e.correlationId),Tn(t,e.correlationId,this.performanceClient),Tr(t)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const lo="no_tokens_found",ho="native_account_unavailable",po="refresh_token_expired",go="interaction_required",fo="consent_required",mo="login_required",vo="bad_token";var yo=Object.freeze({__proto__:null,badToken:vo,consentRequired:fo,interactionRequired:go,loginRequired:mo,nativeAccountUnavailable:ho,noTokensFound:lo,refreshTokenExpired:po});
/*! @azure/msal-common v15.3.0 2025-03-20 */const Co=[go,fo,mo,vo],To=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Io={[lo]:"No refresh token found in the cache. Please sign-in.",[ho]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[po]:"Refresh token has expired.",[vo]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},wo={noTokensFoundError:{code:lo,desc:Io[lo]},native_account_unavailable:{code:ho,desc:Io[ho]},bad_token:{code:vo,desc:Io[vo]}};class Eo extends se{constructor(e,r,n,o,i,a,s,c){super(e,r,n),Object.setPrototypeOf(this,Eo.prototype),this.timestamp=o||t.EMPTY_STRING,this.traceId=i||t.EMPTY_STRING,this.correlationId=a||t.EMPTY_STRING,this.claims=s||t.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}}function ko(e,t,r){const n=!!e&&Co.indexOf(e)>-1,o=!!r&&To.indexOf(r)>-1,i=!!t&&Co.some((e=>t.indexOf(e)>-1));return n||i||o}function So(e){return new Eo(e,Io[e])}
/*! @azure/msal-common v15.3.0 2025-03-20 */class bo{static setRequestState(e,r,n){const o=bo.generateLibraryState(e,n);return r?`${o}${t.RESOURCE_DELIM}${r}`:o}static generateLibraryState(e,t){if(!e)throw nt(Le);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,r){if(!e)throw nt(Le);if(!r)throw nt(ve);try{const n=r.split(t.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(t.RESOURCE_DELIM):t.EMPTY_STRING,a=e.base64Decode(o),s=JSON.parse(a);return{userRequestState:i||t.EMPTY_STRING,libraryState:s}}catch(e){throw nt(ve)}}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const Ao="sw";class _o{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Qn.PopTokenGenerateCnf,e.correlationId);const r=await Xn(this.generateKid.bind(this),Qn.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){this.performanceClient?.addQueueMeasurement(Qn.PopTokenGenerateKid,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Ao}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=r,u=i?new Ir(i):void 0,l=u?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:ht(),m:o?.toUpperCase(),u:l?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:l?.AbsolutePath,q:l?.QueryString?[[],l.QueryString]:void 0,client_claims:a||void 0,...n},t,c,r.correlationId)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Ro{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Po{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,a){if(e.error||e.error_description||e.suberror){const s=`Error(s): ${e.error_codes||t.NOT_AVAILABLE} - Timestamp: ${e.timestamp||t.NOT_AVAILABLE} - Description: ${e.error_description||t.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||t.NOT_AVAILABLE} - Trace ID: ${e.trace_id||t.NOT_AVAILABLE}`,c=e.error_codes?.length?e.error_codes[0]:void 0,u=new oo(e.error,s,e.suberror,c,e.status);if(a&&e.status&&e.status>=o&&e.status<=i)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${u}`);if(a&&e.status&&e.status>=r&&e.status<=n)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${u}`);if(ko(e.error,e.error_description,e.suberror))throw new Eo(e.error,e.error_description,e.suberror,e.timestamp||t.EMPTY_STRING,e.trace_id||t.EMPTY_STRING,e.correlation_id||t.EMPTY_STRING,e.claims||t.EMPTY_STRING,c);throw u}}async handleServerTokenResponse(e,r,n,o,i,a,s,c,u){let l,d;if(this.performanceClient?.addQueueMeasurement(Qn.HandleServerTokenResponse,e.correlation_id),e.id_token){if(l=lt(e.id_token||t.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&l.nonce!==i.nonce)throw nt(Te);if(o.maxAge||0===o.maxAge){const e=l.auth_time;if(!e)throw nt(Ie);dt(e,o.maxAge)}}this.homeAccountIdentifier=vr.generateHomeAccountId(e.client_info||t.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,l),i&&i.state&&(d=bo.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;const h=this.generateCacheRecord(e,r,n,o,l,a,i);let p;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new Ro(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(p)),s&&!c&&h.account){const e=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Po.generateAuthenticationResult(this.cryptoObj,r,h,!1,o,l,d,void 0,u)}await this.cacheStorage.saveCacheRecord(h,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&p&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(p))}return Po.generateAuthenticationResult(this.cryptoObj,r,h,!1,o,l,d,e,u)}generateCacheRecord(e,t,r,n,o,i,a){const s=t.getPreferredCache();if(!s)throw nt(Ue);const c=fr(o);let u,l;e.id_token&&o&&(u=yt(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),l=No(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,s,c,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?ir.fromString(e.scope):new ir(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,u=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,l=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=r+a,p=h+u,g=l&&l>0?r+l:void 0;d=Ct(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,p,this.cryptoObj.base64Decode,g,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=Tt(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:s,familyId:e.foci}),{account:l,idToken:u,accessToken:d,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,r,n,o,i,a,s,c,u){let l,d,h=t.EMPTY_STRING,p=[],g=null,f=t.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==U.POP||i.popKid)h=n.accessToken.secret;else{const t=new _o(e),{secret:r,keyId:o}=n.accessToken;if(!o)throw nt(We);h=await t.signPopToken(r,o,i)}p=ir.fromString(n.accessToken.target).asArray(),g=gt(n.accessToken.expiresOn),l=gt(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(d=gt(n.accessToken.refreshOn))}n.appMetadata&&(f=n.appMetadata.familyId===A?A:"");const m=a?.oid||a?.sub||"",v=a?.tid||"";c?.spa_accountid&&n.account&&(n.account.nativeAccountId=c?.spa_accountid);const y=n.account?lr(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:r.canonicalAuthority,uniqueId:m,tenantId:v,scopes:p,account:y,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:h,fromCache:o,expiresOn:g,extExpiresOn:l,refreshOn:d,correlationId:i.correlationId,requestId:u||t.EMPTY_STRING,familyId:f,tokenType:n.accessToken?.tokenType||t.EMPTY_STRING,state:s?s.userRequestState:t.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||t.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||t.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}}}function No(e,t,r,n,o,i,a,s,c,u,l){l?.verbose("setCachedAccount called");const d=e.getAccountKeys().find((e=>e.startsWith(r)));let h=null;d&&(h=e.getAccount(d));const p=h||vr.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:u},t,n),g=p.tenantProfiles||[],f=s||p.realm;if(f&&!g.find((e=>e.tenantId===f))){const e=ur(r,p.localAccountId,f,o);g.push(e)}return p.tenantProfiles=g,p}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Mo{static validateRedirectUri(e){if(!e)throw nr(Nt)}static validatePrompt(e){const t=[];for(const e in g)t.push(g[e]);if(t.indexOf(e)<0)throw nr(Lt)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw nr(Bt)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw nr(Kt);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([f.PLAIN,f.S256].indexOf(e)<0)throw nr(Ft)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */async function Oo(e,t,r){if("string"==typeof e)return e;return e({clientId:t,tokenEndpoint:r})}
/*! @azure/msal-common v15.3.0 2025-03-20 */class qo extends uo{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(Qn.AuthClientAcquireToken,e.correlationId),!e.code)throw nt(be);const r=ht(),n=await Xn(this.executeTokenRequest.bind(this),Qn.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[c.X_MS_REQUEST_ID],i=new Po(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),Xn(i.handleServerTokenResponse.bind(i),Qn.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw nr(Dt);const t=this.createLogoutUrlQueryString(e);return Ir.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Qn.AuthClientExecuteTokenRequest,t.correlationId);const r=this.createTokenQueryParameters(t),n=Ir.appendQueryString(e.tokenEndpoint,r),o=await Xn(this.createTokenRequestBody.bind(this),Qn.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=ar(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}${E.CLIENT_INFO_SEPARATOR}${e.utid}`,type:Kr}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=io(this.config.authOptions.clientId,t);return Xn(this.executePostToTokenEndpoint.bind(this),Qn.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(n,o,a,s,t.correlationId,Qn.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Qn.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(wn(t,e.embeddedClientId||e.tokenBodyParameters?.[Gr]||this.config.authOptions.clientId),this.includeRedirectUri?En(t,e.redirectUri):Mo.validateRedirectUri(e.redirectUri),In(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),Pn(t,this.config.libraryInfo),Nn(t,this.config.telemetry.application),Gn(t),this.serverTelemetryManager&&!Fr(this.config)&&zn(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&On(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;qn(t,await Oo(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Un(t,r.assertionType)}if(xn(t,y),Ln(t),e.authenticationScheme===U.POP){const r=new _o(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await Xn(r.generateCnf.bind(r),Qn.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Fn(t,n)}else if(e.authenticationScheme===U.SSH){if(!e.sshJwk)throw nr(Qt);Kn(t,e.sshJwk)}let r;if((!or.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&_n(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=ar(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}${E.CLIENT_INFO_SEPARATOR}${t.utid}`,type:Kr}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case Kr:try{bn(t,sr(r.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case zr:Sn(t,r.credential)}return e.embeddedClientId&&jn(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Hn(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[dn]||Hn(t,{[dn]:"1"}),Tn(t,e.correlationId,this.performanceClient),Tr(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&Rn(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&Mn(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&Hn(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Bn(t),Tr(t)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Uo extends uo{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Qn.RefreshTokenClientAcquireToken,e.correlationId);const t=ht(),r=await Xn(this.executeTokenRequest.bind(this),Qn.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[c.X_MS_REQUEST_ID],o=new Po(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),Xn(o.handleServerTokenResponse.bind(o),Qn.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw nr(Ht);if(this.performanceClient?.addQueueMeasurement(Qn.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw nt(Oe);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Xn(this.acquireTokenWithCachedRefreshToken.bind(this),Qn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof Eo&&t.errorCode===lo,n=t instanceof oo&&t.errorCode===D&&t.subError===F;if(r||n)return Xn(this.acquireTokenWithCachedRefreshToken.bind(this),Qn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return Xn(this.acquireTokenWithCachedRefreshToken.bind(this),Qn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Qn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=Jn(this.cacheManager.getRefreshToken.bind(this.cacheManager),Qn.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw So(lo);if(r.expiresOn&&ft(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),So(po);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||U.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Kr}};try{return await Xn(this.acquireToken.bind(this),Qn.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof Eo&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===vo)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=vt(r);this.cacheManager.removeRefreshToken(e)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Qn.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),n=Ir.appendQueryString(t.tokenEndpoint,r),o=await Xn(this.createTokenRequestBody.bind(this),Qn.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=io(this.config.authOptions.clientId,e);return Xn(this.executePostToTokenEndpoint.bind(this),Qn.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,Qn.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Qn.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(wn(t,e.embeddedClientId||e.tokenBodyParameters?.[Gr]||this.config.authOptions.clientId),e.redirectUri&&En(t,e.redirectUri),In(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),xn(t,C),Ln(t),Pn(t,this.config.libraryInfo),Nn(t,this.config.telemetry.application),Gn(t),this.serverTelemetryManager&&!Fr(this.config)&&zn(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&On(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;qn(t,await Oo(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Un(t,r.assertionType)}if(e.authenticationScheme===U.POP){const r=new _o(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await Xn(r.generateCnf.bind(r),Qn.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Fn(t,n)}else if(e.authenticationScheme===U.SSH){if(!e.sshJwk)throw nr(Qt);Kn(t,e.sshJwk)}if((!or.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&_n(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Kr:try{bn(t,sr(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case zr:Sn(t,e.ccsCredential.credential)}return e.embeddedClientId&&jn(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Hn(t,e.tokenBodyParameters),Tn(t,e.correlationId,this.performanceClient),Tr(t)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class xo extends uo{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Qn.SilentFlowClientAcquireCachedToken,e.correlationId);let t=$;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!or.isEmptyObj(e.claims))throw this.setCacheOutcome(J,e.correlationId),nt(Fe);if(!e.account)throw nt(Oe);const r=e.account.tenantId||function(e){const t=new Ir(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case l:case d:case h:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!o)throw this.setCacheOutcome(X,e.correlationId),nt(Fe);if(mt(o.cachedAt)||ft(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Z,e.correlationId),nt(Fe);o.refreshOn&&ft(o.refreshOn,0)&&(t=ee);const i=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(i)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Xn(this.generateResultFromCacheRecord.bind(this),Qn.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==$&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(Qn.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId),e.idToken&&(r=lt(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw nt(Ie);dt(e,t.maxAge)}return Po.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const Lo={sendGetRequestAsync:()=>Promise.reject(nt(Je)),sendPostRequestAsync:()=>Promise.reject(nt(Je))};
/*! @azure/msal-common v15.3.0 2025-03-20 */function Bo(e,t,r,n){const o=t.correlationId,i=new Map;wn(i,t.embeddedClientId||t.extraQueryParameters?.[Gr]||e.clientId);if(In(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),En(i,t.redirectUri),Rn(i,o),function(e,t){e.set(Wr,t||v.QUERY)}(i,t.responseMode),Ln(i),t.prompt&&(!function(e,t){e.set(Xr,t)}(i,t.prompt),n?.addFields({prompt:t.prompt},o)),t.domainHint&&(!function(e,t){e.set(fn,t)}(i,t.domainHint),n?.addFields({domainHintFromRequest:!0},o)),t.prompt!==g.SELECT_ACCOUNT)if(t.sid&&t.prompt===g.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),An(i,t.sid),n?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.idTokenClaims?.login_hint||null}
/*! @azure/msal-common v15.3.0 2025-03-20 */(t.account);if(s&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),kn(i,s),n?.addFields({loginHintFromClaim:!0},o);try{bn(i,sr(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===g.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),An(i,e),n?.addFields({sidFromClaim:!0},o);try{bn(i,sr(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),kn(i,t.loginHint),Sn(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),kn(i,t.account.username),n?.addFields({loginHintFromUpn:!0},o);try{bn(i,sr(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),kn(i,t.loginHint),Sn(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set(Jr,t)}(i,t.nonce),t.state&&Mn(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&_n(i,t.claims,e.clientCapabilities),t.embeddedClientId&&jn(i,e.clientId,e.redirectUri),t.extraQueryParameters&&Hn(i,t.extraQueryParameters),e.instanceAware&&Bn(i),i}function Ho(e,t){if(function(e,t){if(!e.state||!t)throw e.state?nt(Ce,"Cached State"):nt(Ce,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw nt(ve,e.state)}try{n=decodeURIComponent(t)}catch(t){throw nt(ve,e.state)}if(r!==n)throw nt(ye);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+t.length):void 0}(e);if(ko(e.error,e.error_description,e.suberror))throw new Eo(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new oo(e.error||"",e.error_description,e.suberror,t)}}(e,t),!e.code)throw nt(Ge);return e}
/*! @azure/msal-common v15.3.0 2025-03-20 */
const Do="|";function Fo(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},(()=>Do));return a.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:o}=e;if(r>=t.length)return;t[r]=[n,o].join(Do)}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})})),s.join(",")}class Ko{constructor(e,r){this.cacheOutcome=$,this.cacheManager=r,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||t.EMPTY_STRING,this.wrapperVer=e.wrapperVer||t.EMPTY_STRING,this.telemetryCacheKey=q.CACHE_KEY+E.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${q.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(q.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,o,n].join(q.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Ko.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(q.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(q.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?q.OVERFLOW_TRUE:q.OVERFLOW_FALSE].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,e.cacheHits,r,n,i].join(q.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=q.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof se?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(q.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Ko.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let r,n=0,o=0;const i=e.errors.length;for(r=0;r<i;r++){const i=e.failedRequests[2*r]||t.EMPTY_STRING,a=e.failedRequests[2*r+1]||t.EMPTY_STRING,s=e.errors[r]||t.EMPTY_STRING;if(o+=i.toString().length+a.toString().length+s.length+3,!(o<q.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||t.EMPTY_STRING),e.push(this.regionSource||t.EMPTY_STRING),e.push(this.regionOutcome||t.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return Fo(e)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */const zo="missing_kid_error",Go="missing_alg_error",jo={[zo]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Go]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Qo extends se{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Qo.prototype)}}function Wo(e){return new Qo(e,jo[e])}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Vo{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Wo(zo);if(!e.alg)throw Wo(Go);const t=new Vo({typ:e.typ||te.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}
/*! @azure/msal-common v15.3.0 2025-03-20 */class Yo{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class $o{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Vn,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Yo}}startPerformanceMeasurement(){return new Yo}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}
/*! @azure/msal-common v15.3.0 2025-03-20 */function Jo(e,t,r,n=5){if(e instanceof Error)return e instanceof se?(r.errorCode=e.errorCode,r.subErrorCode=e.subError,void((e instanceof oo||e instanceof Eo)&&(r.serverErrorNo=e.errorNo))):void(e instanceof Pr?r.errorCode=e.errorCode:r.errorStack?.length?t.trace("PerformanceClient.addErrorStack: Stack already exist",r.correlationId):e.stack?.length?(e.stack&&(r.errorStack=function(e,t){if(t<0)return[];const r=e.split("\n")||[],n=[],o=r[0];o.startsWith("TypeError: Cannot read property")||o.startsWith("TypeError: Cannot read properties of")||o.startsWith("TypeError: Cannot set property")||o.startsWith("TypeError: Cannot set properties of")||o.endsWith("is not a function")?n.push(Xo(o)):(o.startsWith("SyntaxError")||o.startsWith("TypeError"))&&n.push(Xo(o.replace(/['].*[']|["].*["]/g,"<redacted>")));for(let e=1;e<r.length&&!(n.length>=t);e++){const t=r[e];n.push(Xo(t))}return n}(e.stack,n)),r.errorName=e.name):t.trace("PerformanceClient.addErrorStack: Input stack is empty",r.correlationId));t.trace("PerformanceClient.addErrorStack: Input error is not instance of Error",r.correlationId)}function Xo(e){const t=e.lastIndexOf(" ")+1;if(t<1)return e;const r=e.substring(t);let n=r.lastIndexOf("/");return n=n<0?r.lastIndexOf("\\"):n,n>=0?(e.substring(0,t)+"("+r.substring(n+1)+(")"===r.charAt(r.length-1)?"":")")).trimStart():e.trimStart()}class Zo{constructor(e,t,r,n,o,i,a,s){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.eventStack=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=a||new Set;for(const e of $n)this.intFields.add(e);this.abbreviations=s||new Map;for(const[e,t]of Wn)this.abbreviations.set(e,t)}startPerformanceMeasurement(e,t){return{}}getPreQueueTime(e,t){const r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${e}, unable to add queue measurement`)}else this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${t}, unable to add queue measurement`)}calculateQueuedTime(e,t){return e<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${e}`),0):t<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${t}`),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e}addQueueMeasurement(e,t,r,n){if(!t)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${e}, cannot add queue measurement`);if(0===r)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${e} is ${r}`);else if(!r)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${e}`);const o={eventName:e,queueTime:n?0:r,manuallyCompleted:n},i=this.queueMeasurements.get(t);if(i)i.push(o),this.queueMeasurements.set(t,i);else{this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${t} to queue measurements`);const e=[o];this.queueMeasurements.set(t,e)}this.preQueueTimeByCorrelationId.delete(t)}startMeasurement(e,t){const r=t||this.generateId();t||this.logger.info(`PerformanceClient: No correlation id provided for ${e}, generating`,r),this.logger.trace(`PerformanceClient: Performance measurement started for ${e}`,r);const n={eventId:this.generateId(),status:Vn,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:r,appName:this.applicationTelemetry?.appName,appVersion:this.applicationTelemetry?.appVersion};var o,i,a;return this.cacheEventByCorrelationId(n),o=n,i=this.abbreviations,(a=this.eventStack.get(r))&&a.push({name:i.get(o.name)||o.name}),{end:(e,t)=>this.endMeasurement({...n,...e},t),discard:()=>this.discardMeasurements(n.correlationId),add:e=>this.addFields(e,n.correlationId),increment:e=>this.incrementFields(e,n.correlationId),event:n,measurement:new Yo}}endMeasurement(e,t){const r=this.eventsByCorrelationId.get(e.correlationId);if(!r)return this.logger.trace(`PerformanceClient: Measurement not found for ${e.eventId}`,e.correlationId),null;const n=e.eventId===r.eventId;let o={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};e.durationMs=Math.round(e.durationMs||this.getDurationMs(e.startTimeMs));const i=JSON.stringify(function(e,t,r,n){if(!r?.length)return;const o=e=>e.length?e[e.length-1]:void 0,i=t.get(e.name)||e.name,a=o(r);if(a?.name!==i)return;const s=r?.pop();if(!s)return;const c=n instanceof se?n.errorCode:n instanceof Error?n.name:void 0,u=n instanceof se?n.subError:void 0;c&&s.childErr!==c&&(s.err=c,u&&(s.subErr=u)),delete s.name,delete s.childErr;const l={...s,dur:e.durationMs};e.success||(l.fail=1);const d=o(r);if(!d)return{[i]:l};let h;if(c&&(d.childErr=c),d[i]){const e=Object.keys(d).filter((e=>e.startsWith(i))).length;h=`${i}_${e+1}`}else h=i;return d[h]=l,d}(e,this.abbreviations,this.eventStack.get(r.correlationId),t));if(n?(o=this.getQueueInfo(e.correlationId),this.discardMeasurements(r.correlationId)):r.incompleteSubMeasurements?.delete(e.eventId),this.logger.trace(`PerformanceClient: Performance measurement ended for ${e.name}: ${e.durationMs} ms`,e.correlationId),t&&Jo(t,this.logger,r),!n)return r[e.name+"DurationMs"]=Math.floor(e.durationMs),{...r};n&&!t&&(r.errorCode||r.subErrorCode)&&(this.logger.trace(`PerformanceClient: Remove error and sub-error codes for root event ${e.name} as intermediate error was successfully handled`,e.correlationId),r.errorCode=void 0,r.subErrorCode=void 0);let a={...r,...e},s=0;return a.incompleteSubMeasurements?.forEach((t=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${t.name} found for ${e.name}`,a.correlationId),s++})),a.incompleteSubMeasurements=void 0,a={...a,queuedTimeMs:o.totalQueueTime,queuedCount:o.totalQueueCount,queuedManuallyCompletedCount:o.manuallyCompletedCount,status:Yn,incompleteSubsCount:s,context:i},this.truncateIntegralFields(a),this.emitEvents([a],e.correlationId),a}addFields(e,t){this.logger.trace("PerformanceClient: Updating static fields");const r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,{...r,...e}):this.logger.trace("PerformanceClient: Event not found for",t)}incrementFields(e,t){this.logger.trace("PerformanceClient: Updating counters");const r=this.eventsByCorrelationId.get(t);if(r)for(const t in e){if(r.hasOwnProperty(t)){if(isNaN(Number(r[t])))return}else r[t]=0;r[t]+=e[t]}else this.logger.trace("PerformanceClient: Event not found for",t)}cacheEventByCorrelationId(e){const t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} added/updated`,e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} started`,e.correlationId),this.eventsByCorrelationId.set(e.correlationId,{...e}),this.eventStack.set(e.correlationId,[]))}getQueueInfo(e){const t=this.queueMeasurements.get(e);t||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${e}`);let r=0,n=0,o=0;return t?.forEach((e=>{r+=e.queueTime,n++,o+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:o}}discardMeasurements(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e),this.logger.trace("PerformanceClient: Event stack discarded",e),this.eventStack.delete(e)}addPerformanceCallback(e){for(const[t,r]of this.callbacks)if(r.toString()===e.toString())return this.logger.warning(`PerformanceClient: Performance callback is already registered with id: ${t}`),t;const t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${t}`),t}removePerformanceCallback(e){const t=this.callbacks.delete(e);return t?this.logger.verbose(`PerformanceClient: Performance callback ${e} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${e} not removed.`),t}emitEvents(e,t){this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(((r,n)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${n}`,t),r.apply(null,[e])}))}truncateIntegralFields(e){this.intFields.forEach((t=>{t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))}getDurationMs(e){const t=Date.now()-e;return t<0?t:0}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const ei="pkce_not_created",ti="crypto_nonexistent",ri="empty_navigate_uri",ni="hash_empty_error",oi="no_state_in_hash",ii="hash_does_not_contain_known_properties",ai="unable_to_parse_state",si="state_interaction_type_mismatch",ci="interaction_in_progress",ui="popup_window_error",li="empty_window_error",di="user_cancelled",hi="monitor_popup_timeout",pi="monitor_window_timeout",gi="redirect_in_iframe",fi="block_iframe_reload",mi="block_nested_popups",vi="iframe_closed_prematurely",yi="silent_logout_unsupported",Ci="no_account_error",Ti="silent_prompt_value_error",Ii="no_token_request_cache_error",wi="unable_to_parse_token_request_cache_error",Ei="no_cached_authority_error",ki="auth_request_not_set_error",Si="invalid_cache_type",bi="non_browser_environment",Ai="database_not_open",_i="no_network_connectivity",Ri="post_request_failed",Pi="get_request_failed",Ni="failed_to_parse_response",Mi="unable_to_load_token",Oi="crypto_key_not_found",qi="auth_code_required",Ui="auth_code_or_nativeAccountId_required",xi="spa_code_and_nativeAccountId_present",Li="database_unavailable",Bi="unable_to_acquire_token_from_native_platform",Hi="native_handshake_timeout",Di="native_extension_not_installed",Fi="native_connection_not_established",Ki="uninitialized_public_client_application",zi="native_prompt_not_supported",Gi="invalid_base64_string",ji="invalid_pop_token_request",Qi="failed_to_build_headers",Wi="failed_to_parse_headers";var Vi=Object.freeze({__proto__:null,authCodeOrNativeAccountIdRequired:Ui,authCodeRequired:qi,authRequestNotSetError:ki,blockIframeReload:fi,blockNestedPopups:mi,cryptoKeyNotFound:Oi,cryptoNonExistent:ti,databaseNotOpen:Ai,databaseUnavailable:Li,emptyNavigateUri:ri,emptyWindowError:li,failedToBuildHeaders:Qi,failedToParseHeaders:Wi,failedToParseResponse:Ni,getRequestFailed:Pi,hashDoesNotContainKnownProperties:ii,hashEmptyError:ni,iframeClosedPrematurely:vi,interactionInProgress:ci,invalidBase64String:Gi,invalidCacheType:Si,invalidPopTokenRequest:ji,monitorPopupTimeout:hi,monitorWindowTimeout:pi,nativeConnectionNotEstablished:Fi,nativeExtensionNotInstalled:Di,nativeHandshakeTimeout:Hi,nativePromptNotSupported:zi,noAccountError:Ci,noCachedAuthorityError:Ei,noNetworkConnectivity:_i,noStateInHash:oi,noTokenRequestCacheError:Ii,nonBrowserEnvironment:bi,pkceNotCreated:ei,popupWindowError:ui,postRequestFailed:Ri,redirectInIframe:gi,silentLogoutUnsupported:yi,silentPromptValueError:Ti,spaCodeAndNativeAccountIdPresent:xi,stateInteractionTypeMismatch:si,unableToAcquireTokenFromNativePlatform:Bi,unableToLoadToken:Mi,unableToParseState:ai,unableToParseTokenRequestCacheError:wi,uninitializedPublicClientApplication:Ki,userCancelled:di});
/*! @azure/msal-browser v4.8.0 2025-03-20 */const Yi="For more visit: aka.ms/msaljs/browser-errors",$i={[ei]:"The PKCE code challenge and verifier could not be generated.",[ti]:"The crypto object or function is not available.",[ri]:"Navigation URI is empty. Please check stack trace for more info.",[ni]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Yi}`,[oi]:"Hash does not contain state. Please verify that the request originated from msal.",[ii]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Yi}`,[ai]:"Unable to parse state. Please verify that the request originated from msal.",[si]:"Hash contains state but the interaction type does not match the caller.",[ci]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Yi}`,[ui]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[li]:"window.open returned null or undefined window object.",[di]:"User cancelled the flow.",[hi]:`Token acquisition in popup failed due to timeout.  ${Yi}`,[pi]:`Token acquisition in iframe failed due to timeout.  ${Yi}`,[gi]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[fi]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Yi}`,[mi]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[vi]:"The iframe being monitored was closed prematurely.",[yi]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Ci]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Ti]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Ii]:"No token request found in cache.",[wi]:"The cached token request could not be parsed.",[Ei]:"No cached authority found.",[ki]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Si]:"Invalid cache type",[bi]:"Login and token requests are not supported in non-browser environments.",[Ai]:"Database is not open!",[_i]:"No network connectivity. Check your internet connection.",[Ri]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Pi]:"Network request failed. Please check the network trace to determine root cause.",[Ni]:"Failed to parse network response. Check network trace.",[Mi]:"Error loading token to cache.",[Oi]:"Cryptographic Key or Keypair not found in browser storage.",[qi]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Ui]:"An authorization code or nativeAccountId must be provided to this flow.",[xi]:"Request cannot contain both spa code and native account id.",[Li]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Bi]:`Unable to acquire token from native platform.  ${Yi}`,[Hi]:"Timed out while attempting to establish connection to browser extension",[Di]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Fi]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Yi}`,[Ki]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Yi}`,[zi]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Gi]:"Invalid base64 encoded string.",[ji]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Qi]:"Failed to build request headers object.",[Wi]:"Failed to parse response headers"},Ji={pkceNotGenerated:{code:ei,desc:$i[ei]},cryptoDoesNotExist:{code:ti,desc:$i[ti]},emptyNavigateUriError:{code:ri,desc:$i[ri]},hashEmptyError:{code:ni,desc:$i[ni]},hashDoesNotContainStateError:{code:oi,desc:$i[oi]},hashDoesNotContainKnownPropertiesError:{code:ii,desc:$i[ii]},unableToParseStateError:{code:ai,desc:$i[ai]},stateInteractionTypeMismatchError:{code:si,desc:$i[si]},interactionInProgress:{code:ci,desc:$i[ci]},popupWindowError:{code:ui,desc:$i[ui]},emptyWindowError:{code:li,desc:$i[li]},userCancelledError:{code:di,desc:$i[di]},monitorPopupTimeoutError:{code:hi,desc:$i[hi]},monitorIframeTimeoutError:{code:pi,desc:$i[pi]},redirectInIframeError:{code:gi,desc:$i[gi]},blockTokenRequestsInHiddenIframeError:{code:fi,desc:$i[fi]},blockAcquireTokenInPopupsError:{code:mi,desc:$i[mi]},iframeClosedPrematurelyError:{code:vi,desc:$i[vi]},silentLogoutUnsupportedError:{code:yi,desc:$i[yi]},noAccountError:{code:Ci,desc:$i[Ci]},silentPromptValueError:{code:Ti,desc:$i[Ti]},noTokenRequestCacheError:{code:Ii,desc:$i[Ii]},unableToParseTokenRequestCacheError:{code:wi,desc:$i[wi]},noCachedAuthorityError:{code:Ei,desc:$i[Ei]},authRequestNotSet:{code:ki,desc:$i[ki]},invalidCacheType:{code:Si,desc:$i[Si]},notInBrowserEnvironment:{code:bi,desc:$i[bi]},databaseNotOpen:{code:Ai,desc:$i[Ai]},noNetworkConnectivity:{code:_i,desc:$i[_i]},postRequestFailed:{code:Ri,desc:$i[Ri]},getRequestFailed:{code:Pi,desc:$i[Pi]},failedToParseNetworkResponse:{code:Ni,desc:$i[Ni]},unableToLoadTokenError:{code:Mi,desc:$i[Mi]},signingKeyNotFoundInStorage:{code:Oi,desc:$i[Oi]},authCodeRequired:{code:qi,desc:$i[qi]},authCodeOrNativeAccountRequired:{code:Ui,desc:$i[Ui]},spaCodeAndNativeAccountPresent:{code:xi,desc:$i[xi]},databaseUnavailable:{code:Li,desc:$i[Li]},unableToAcquireTokenFromNativePlatform:{code:Bi,desc:$i[Bi]},nativeHandshakeTimeout:{code:Hi,desc:$i[Hi]},nativeExtensionNotInstalled:{code:Di,desc:$i[Di]},nativeConnectionNotEstablished:{code:Fi,desc:$i[Fi]},uninitializedPublicClientApplication:{code:Ki,desc:$i[Ki]},nativePromptNotSupported:{code:zi,desc:$i[zi]},invalidBase64StringError:{code:Gi,desc:$i[Gi]},invalidPopTokenRequest:{code:ji,desc:$i[ji]}};class Xi extends se{constructor(e,t){super(e,$i[e],t),Object.setPrototypeOf(this,Xi.prototype),this.name="BrowserAuthError"}}function Zi(e,t){return new Xi(e,t)}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const ea={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},ta="53ee284d-920a-4b59-9d30-a60315b26836",ra="ppnbnpeolgkicgegkbkbjmhlideopiji",na="MATS",oa="Handshake",ia="HandshakeResponse",aa="GetToken",sa="Response",ca={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},ua="GET",la="POST",da="authority",ha="request.state",pa="nonce.id_token",ga="request.origin",fa="urlHash",ma="request.params",va="interaction.status",ya="ccs.credential",Ca="request.correlationId",Ta="request.native",Ia="msal.account.keys",wa="msal.token.keys",Ea="wrapper.sku",ka="wrapper.version",Sa={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var ba;e.InteractionType=void 0,(ba=e.InteractionType||(e.InteractionType={})).Redirect="redirect",ba.Popup="popup",ba.Silent="silent",ba.None="none";const Aa={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},_a={scopes:a},Ra="msal.db",Pa=`${Ra}.keys`,Na={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},Ma=[Na.Default,Na.Skip,Na.RefreshTokenAndNetwork];
/*! @azure/msal-browser v4.8.0 2025-03-20 */
function Oa(e){return encodeURIComponent(Ua(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function qa(e){return xa(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ua(e){return xa((new TextEncoder).encode(e))}function xa(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}
/*! @azure/msal-browser v4.8.0 2025-03-20 */function La(e){return(new TextDecoder).decode(Ba(e))}function Ba(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Zi(Gi)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const Ha="AES-GCM",Da="HKDF",Fa="SHA-256",Ka=new Uint8Array([1,0,1]),za="0123456789abcdef",Ga=new Uint32Array(1),ja="encrypt",Qa="decrypt",Wa={name:"RSASSA-PKCS1-v1_5",hash:Fa,modulusLength:2048,publicExponent:Ka};async function Va(e,t,r){t?.addQueueMeasurement(Qn.Sha256Digest,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(Fa,n)}function Ya(e){return window.crypto.getRandomValues(e)}function $a(){return window.crypto.getRandomValues(Ga),Ga[0]}function Ja(){const e=Date.now(),t=1024*$a()+(1023&$a()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=$a();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=za.charAt(r[e]>>>4),a+=za.charAt(15&r[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function Xa(e){return window.crypto.subtle.exportKey("jwk",e)}async function Za(){const e=await window.crypto.subtle.generateKey({name:Ha,length:256},!0,[ja,Qa]);return window.crypto.subtle.exportKey("raw",e)}async function es(e){return window.crypto.subtle.importKey("raw",e,Da,!1,["deriveKey"])}async function ts(e,t,r){return window.crypto.subtle.deriveKey({name:Da,salt:t,hash:Fa,info:(new TextEncoder).encode(r)},e,{name:Ha,length:256},!1,[ja,Qa])}async function rs(e,t,r){const n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await ts(e,o,r),a=await window.crypto.subtle.encrypt({name:Ha,iv:new Uint8Array(12)},i,n);return{data:qa(new Uint8Array(a)),nonce:qa(o)}}async function ns(e,t,r,n){const o=Ba(n),i=await ts(e,Ba(t),r),a=await window.crypto.subtle.decrypt({name:Ha,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function os(e){const t=await Va(e);return qa(new Uint8Array(t))}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const is="storage_not_supported",as="stubbed_public_client_application_called",ss="in_mem_redirect_unavailable";var cs=Object.freeze({__proto__:null,inMemRedirectUnavailable:ss,storageNotSupported:is,stubbedPublicClientApplicationCalled:as});
/*! @azure/msal-browser v4.8.0 2025-03-20 */const us={[is]:"Given storage configuration option was not supported.",[as]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[ss]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},ls={storageNotSupportedError:{code:is,desc:us[is]},stubPcaInstanceCalled:{code:as,desc:us[as]},inMemRedirectUnavailable:{code:ss,desc:us[ss]}};class ds extends se{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,ds.prototype)}}function hs(e){return new ds(e,us[e])}
/*! @azure/msal-browser v4.8.0 2025-03-20 */function ps(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function gs(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}function fs(){return window.parent!==window}function ms(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${ea.POPUP_NAME_PREFIX}.`)}function vs(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function ys(){const e=new Ir(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function Cs(){if(Ir.hashContainsKnownProperties(window.location.hash)&&fs())throw Zi(fi)}function Ts(e){if(fs()&&!e)throw Zi(gi)}function Is(){if(ms())throw Zi(mi)}function ws(){if("undefined"==typeof window)throw Zi(bi)}function Es(e){if(!e)throw Zi(Ki)}function ks(e){ws(),Cs(),Is(),Es(e)}function Ss(e,t){if(ks(e),Ts(t.system.allowRedirectInIframe),t.cache.cacheLocation===ca.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw hs(ss)}function bs(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}function As(){return Ja()}var _s=Object.freeze({__proto__:null,blockAPICallsBeforeInitialize:Es,blockAcquireTokenInPopups:Is,blockNonBrowserEnvironment:ws,blockRedirectInIframe:Ts,blockReloadInHiddenIframes:Cs,clearHash:ps,createGuid:As,getCurrentUri:vs,getHomepage:ys,invoke:Jn,invokeAsync:Xn,isInIframe:fs,isInPopup:ms,preconnect:bs,preflightCheck:ks,redirectPreflightCheck:Ss,replaceHash:gs});
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Rs{navigateInternal(e,t){return Rs.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Rs.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Ps{async sendGetRequestAsync(e,t){let r,n={},o=0;const i=Ns(t);try{r=await fetch(e,{method:ua,headers:i})}catch(e){throw Zi(window.navigator.onLine?Pi:_i)}n=Ms(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw co(Zi(Ni),o,n)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",n=Ns(t);let o,i=0,a={};try{o=await fetch(e,{method:la,headers:n,body:r})}catch(e){throw Zi(window.navigator.onLine?Ri:_i)}a=Ms(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw co(Zi(Ni),i,a)}}}function Ns(e){try{const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.entries(r).forEach((([e,r])=>{t.append(e,r)})),t}catch(e){throw Zi(Qi)}}function Ms(e){try{const t={};return e.forEach(((e,r)=>{t[r]=e})),t}catch(e){throw Zi(Wi)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const Os=1e4;
/*! @azure/msal-browser v4.8.0 2025-03-20 */
const qs="@azure/msal-browser",Us="4.8.0";
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class xs{static loggerCallback(t,r){switch(t){case e.LogLevel.Error:return void console.error(r);case e.LogLevel.Info:return void console.info(r);case e.LogLevel.Verbose:return void console.debug(r);case e.LogLevel.Warning:return void console.warn(r);default:return void console.log(r)}}constructor(r){let n;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:r,cache:n,system:o,telemetry:i},a){const s={clientId:t.EMPTY_STRING,authority:`${t.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:t.EMPTY_STRING,authorityMetadata:t.EMPTY_STRING,redirectUri:"undefined"!=typeof window?vs():"",postLogoutRedirectUri:t.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:mr.AAD,OIDCOptions:{serverResponseType:m.FRAGMENT,defaultScopes:[t.OPENID_SCOPE,t.PROFILE_SCOPE,t.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:ut.None,tenant:t.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},c={cacheLocation:ca.SessionStorage,temporaryCacheLocation:ca.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==ca.LocalStorage),claimsBasedCachingEnabled:!1},u={loggerCallback:()=>{},logLevel:e.LogLevel.Info,piiLoggingEnabled:!1},l={...{...Or,loggerOptions:u,networkClient:a?new Ps:Lo,navigationClient:new Rs,loadFrameTimeout:0,windowHashTimeout:o?.loadFrameTimeout||6e4,iframeHashTimeout:o?.loadFrameTimeout||Os,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:o?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:ea.DEFAULT_POLL_INTERVAL_MS},...o,loggerOptions:o?.loggerOptions||u},d={application:{appName:t.EMPTY_STRING,appVersion:t.EMPTY_STRING},client:new $o};r?.protocolMode!==mr.OIDC&&r?.OIDCOptions&&new at(l.loggerOptions).warning(JSON.stringify(nr($t)));if(r?.protocolMode&&r.protocolMode!==mr.AAD&&l?.allowPlatformBroker)throw nr(Jt);return{auth:{...s,...r,OIDCOptions:{...s.OIDCOptions,...r?.OIDCOptions}},cache:{...c,...n},system:l,telemetry:{...d,...i}}}(r,this.browserEnvironment);try{n=window[ca.SessionStorage]}catch(e){}const o=n?.getItem("msal.browser.log.level"),i=n?.getItem("msal.browser.log.pii")?.toLowerCase(),a="true"===i||"false"!==i&&void 0,s={...this.config.system.loggerOptions},c=o&&Object.keys(e.LogLevel).includes(o)?e.LogLevel[o]:void 0;c&&(s.loggerCallback=xs.loggerCallback,s.logLevel=c),void 0!==a&&(s.piiLoggingEnabled=a),this.logger=new at(s,qs,Us),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const Ls="USER_INTERACTION_REQUIRED",Bs="USER_CANCEL",Hs="NO_NETWORK",Ds="TRANSIENT_ERROR",Fs="PERSISTENT_ERROR",Ks="DISABLED",zs="ACCOUNT_UNAVAILABLE",Gs="NESTED_APP_AUTH_UNAVAILABLE";
/*! @azure/msal-browser v4.8.0 2025-03-20 */class js{static async initializeNestedAppAuthBridge(){if(void 0===window)throw new Error("window is undefined");if(void 0===window.nestedAppAuthBridge)throw new Error("window.nestedAppAuthBridge is undefined");try{window.nestedAppAuthBridge.addEventListener("message",(e=>{const t="string"==typeof e?e:e.data,r=JSON.parse(t),n=js.bridgeRequests.find((e=>e.requestId===r.requestId));void 0!==n&&(js.bridgeRequests.splice(js.bridgeRequests.indexOf(n),1),r.success?n.resolve(r):n.reject(r.error))}));const e=await new Promise(((e,t)=>{const r=js.buildRequest("GetInitContext"),n={requestId:r.requestId,method:r.method,resolve:e,reject:t};js.bridgeRequests.push(n),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))}));return js.validateBridgeResultOrThrow(e.initContext)}catch(e){throw window.console.log(e),e}}getTokenInteractive(e){return this.getToken("GetTokenPopup",e)}getTokenSilent(e){return this.getToken("GetToken",e)}async getToken(e,t){const r=await this.sendRequest(e,{tokenParams:t});return{token:js.validateBridgeResultOrThrow(r.token),account:js.validateBridgeResultOrThrow(r.account)}}getHostCapabilities(){return this.capabilities??null}getAccountContext(){return this.accountContext?this.accountContext:null}static buildRequest(e,t){return{messageType:"NestedAppAuthRequest",method:e,requestId:Ja(),sendTime:Date.now(),clientLibrary:ea.MSAL_SKU,clientLibraryVersion:Us,...t}}sendRequest(e,t){const r=js.buildRequest(e,t);return new Promise(((e,t)=>{const n={requestId:r.requestId,method:r.method,resolve:e,reject:t};js.bridgeRequests.push(n),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))}))}static validateBridgeResultOrThrow(e){if(void 0===e){throw{status:Gs}}return e}constructor(e,t,r,n){this.sdkName=e,this.sdkVersion=t,this.accountContext=r,this.capabilities=n}static async create(){const e=await js.initializeNestedAppAuthBridge();return new js(e.sdkName,e.sdkVersion,e.accountContext,e.capabilities)}}js.bridgeRequests=[];
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class Qs extends xs{constructor(){super(...arguments),this.bridgeProxy=void 0,this.accountContext=null}getModuleName(){return Qs.MODULE_NAME}getId(){return Qs.ID}getBridgeProxy(){return this.bridgeProxy}async initialize(){try{if("undefined"!=typeof window){"function"==typeof window.__initializeNestedAppAuth&&await window.__initializeNestedAppAuth();const e=await js.create();this.accountContext=e.getAccountContext(),this.bridgeProxy=e,this.available=void 0!==e}}catch(e){this.logger.infoPii(`Could not initialize Nested App Auth bridge (${e})`)}return this.logger.info(`Nested App Auth Bridge available: ${this.available}`),this.available}}Qs.MODULE_NAME="",Qs.ID="NestedAppOperatingContext";
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class Ws extends xs{getModuleName(){return Ws.MODULE_NAME}getId(){return Ws.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}Ws.MODULE_NAME="",Ws.ID="StandardOperatingContext";
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class Vs{constructor(){this.dbName=Ra,this.version=1,this.tableName=Pa,this.dbOpen=!1}async open(){return new Promise(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t(Zi(Li))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Zi(Ai));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Promise(((r,n)=>{if(!this.db)return n(Zi(Ai));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",(()=>{this.closeConnection(),r()})),o.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Zi(Ai));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((e,t)=>{if(!this.db)return t(Zi(Ai));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Zi(Ai));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((e,t)=>{const r=window.indexedDB.deleteDatabase(Ra),n=setTimeout((()=>t(!1)),200);r.addEventListener("success",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("blocked",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("error",(()=>(clearTimeout(n),t(!1))))}))}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Ys{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class $s{constructor(e){this.inMemoryCache=new Ys,this.indexedDBCache=new Vs,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof Xi&&e.errorCode===Li))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Js{constructor(e,t,r){this.logger=e,function(e){if(!window)throw Zi(bi);if(!window.crypto)throw Zi(ti);if(!e&&!window.crypto.subtle)throw Zi(ti,"crypto_subtle_undefined")}(r??!1),this.cache=new $s(this.logger),this.performanceClient=t}createNewGuid(){return Ja()}base64Encode(e){return Ua(e)}base64Decode(e){return La(e)}base64UrlEncode(e){return Oa(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(Qn.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(Wa,e,t)}(Js.EXTRACTABLE,Js.POP_KEY_USAGES),n=await Xa(r.publicKey),o=Xs({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await Xa(r.privateKey),s=await async function(e,t,r){return window.crypto.subtle.importKey("jwk",e,Wa,t,r)}(a,!1,["sign"]);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){await this.cache.removeItem(e);return!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const o=this.performanceClient?.startMeasurement(Qn.CryptoOptsSignJwt,n),i=await this.cache.getItem(t);if(!i)throw Zi(Oi);const a=await Xa(i.publicKey),s=Xs(a),c=Oa(JSON.stringify({kid:t})),u=Oa(Vo.getShrHeaderString({...r?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const l=`${u}.${Oa(JSON.stringify(e))}`,d=(new TextEncoder).encode(l),h=await async function(e,t){return window.crypto.subtle.sign(Wa,e,t)}(i.privateKey,d),p=`${l}.${qa(new Uint8Array(h))}`;return o&&o.end({success:!0}),p}async hashString(e){return os(e)}}function Xs(e){return JSON.stringify(e,Object.keys(e).sort())}
/*! @azure/msal-browser v4.8.0 2025-03-20 */Js.POP_KEY_USAGES=["sign","verify"],Js.EXTRACTABLE=!0;const Zs=864e5,ec="Lax",tc="None";class rc{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){const n=r[e],[o,...i]=decodeURIComponent(n).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw nt(Je)}setItem(e,t,r,n=!0,o=ec){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){const e=function(e){const t=new Date,r=new Date(t.getTime()+e*Zs);return r.toUTCString()}
/*! @azure/msal-browser v4.8.0 2025-03-20 */(r);i+=`expires=${e};`}(n||o===tc)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Promise.reject(nt(Je))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach((e=>{const r=decodeURIComponent(e).trim().split("=");t.push(r[0])})),t}containsKey(e){return this.getKeys().includes(e)}}function nc(e){const t=e.getItem(Ia);return t?JSON.parse(t):[]}function oc(e,t){const r=t.getItem(`${wa}.${e}`);if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const ic="msal.cache.encryption";class ac{constructor(e,t,r){if(!window.localStorage)throw hs(is);this.memoryStorage=new Ys,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){this.initialized=!0;const t=new rc,r=t.getItem(ic);let n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){const t=Jn(Ba,Qn.Base64Decode,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await Xn(es,Qn.GenerateHKDF,this.logger,this.performanceClient,e)(t)},await Xn(this.importExistingCache.bind(this),Qn.ImportExistingCache,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=Ja(),n=await Xn(Za,Qn.GenerateBaseKey,this.logger,this.performanceClient,e)(),o=Jn(qa,Qn.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await Xn(es,Qn.GenerateHKDF,this.logger,this.performanceClient,e)(n)};const i={id:r,key:o};t.setItem(ic,JSON.stringify(i),0,!0,tc)}this.broadcast.addEventListener("message",this.updateCache.bind(this))}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Zi(Ki);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r){if(!this.initialized||!this.encryptionCookie)throw Zi(Ki);const{data:n,nonce:o}=await Xn(rs,Qn.Encrypt,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),i={id:this.encryptionCookie.id,nonce:o,data:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(i)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear();nc(this).forEach((e=>this.removeItem(e)));const e=oc(this.clientId,this);e.idToken.forEach((e=>this.removeItem(e))),e.accessToken.forEach((e=>this.removeItem(e))),e.refreshToken.forEach((e=>this.removeItem(e))),this.getKeys().forEach((e=>{(e.startsWith(t.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)}))}async importExistingCache(e){if(!this.encryptionCookie)return;let t=nc(this);t=await this.importArray(t,e),this.setItem(Ia,JSON.stringify(t));const r=oc(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${wa}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const r=this.getItem(e);if(!r)return null;let n;try{n=JSON.parse(r)}catch(e){return null}return n.id&&n.nonce&&n.data?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Xn(ns,Qn.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,n.nonce,this.getContext(e),n.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const r=[],n=[];return e.forEach((e=>{const o=this.getItemFromEncryptedCache(e,t).then((t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)}));n.push(o)})),await Promise.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Qn.LocalStorageUpdated);t.add({isBackground:!0});const{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class sc{constructor(){if(!window.sessionStorage)throw hs(is)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */function cc(e,t){if(!t)return null;try{return bo.parseRequestState(e,t).libraryState.meta}catch(e){throw nt(ve)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const uc={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};
/*! @azure/msal-browser v4.8.0 2025-03-20 */class lc extends Nr{constructor(e,t,r,n,o,i,a){super(e,r,n,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new Ys,this.browserStorage=dc(e,t.cacheLocation,n,o),this.temporaryCacheStorage=dc(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new rc,this.performanceClient=o,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&vr.isAccountEntity(r)?Nr.toObject(new vr,r):(this.removeAccountKeyFromMap(e),null)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();await Xn(this.browserStorage.setUserData.bind(this.browserStorage),Qn.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t);const n=this.addAccountKeyToMap(r);this.cacheConfig.cacheLocation===ca.LocalStorage&&n&&this.eventHandler.emitEvent(uc.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return nc(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return-1===t.indexOf(e)?(t.push(e),this.browserStorage.setItem(Ia,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.browserStorage.setItem(Ia,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===ca.LocalStorage&&this.eventHandler.emitEvent(uc.ACCOUNT_REMOVED,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,k.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,k.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,k.REFRESH_TOKEN)}getTokenKeys(){return oc(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case k.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case k.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case k.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),nt(Be)}this.browserStorage.setItem(`${wa}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case k.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case k.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case k.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),nt(Be)}this.browserStorage.setItem(`${wa}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,k.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&((n=r)&&It(n)&&n.hasOwnProperty("realm")&&n.credentialType===k.ID_TOKEN)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,k.ID_TOKEN),null);var n}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=vt(e);await Xn(this.browserStorage.setUserData.bind(this.browserStorage),Qn.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,k.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,k.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&It(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===k.ACCESS_TOKEN||n.credentialType===k.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,k.ACCESS_TOKEN),null);var n}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=vt(e);await Xn(this.browserStorage.setUserData.bind(this.browserStorage),Qn.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,k.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,k.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&It(n)&&n.credentialType===k.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,k.REFRESH_TOKEN),null);var n}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=vt(e);await Xn(this.browserStorage.setUserData.bind(this.browserStorage),Qn.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,k.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&(n=e,(o=r)&&0===n.indexOf(S)&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n,o}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function({environment:e,clientId:t}){return[S,e,t].join(E.CACHE_KEY_SEPARATOR).toLowerCase()}(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(q.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(_)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(Ea,e),this.internalStorage.setItem(ka,t)}getWrapperMetadata(){return[this.internalStorage.getItem(Ea)||t.EMPTY_STRING,this.internalStorage.getItem(ka)||t.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(u),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(u);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(uc.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(B));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===ca.LocalStorage){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf(t.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf(t.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Qn.ClearTokensAndKeysWithClaims,t);const r=this.getTokenKeys(),n=[];r.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))})),await Promise.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):or.startsWith(e,t.CACHE_PREFIX)?e:`${t.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=bo.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${da}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=bo.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${pa}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=bo.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ha}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)}updateCacheEntries(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);const s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){const e={credential:o.homeAccountId,type:Kr};this.setTemporaryCache(ya,JSON.stringify(e),!0)}else if(n){const e={credential:n,type:zr};this.setTemporaryCache(ya,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach((t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)})),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(ma)),this.removeTemporaryItem(this.generateCacheKey(ga)),this.removeTemporaryItem(this.generateCacheKey(fa)),this.removeTemporaryItem(this.generateCacheKey(Ca)),this.removeTemporaryItem(this.generateCacheKey(ya)),this.removeTemporaryItem(this.generateCacheKey(Ta)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const r=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(r);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||t.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach((t=>{if(-1===t.indexOf(ha))return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const n=cc(this.cryptoImpl,r);n&&n.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))})),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=Ua(JSON.stringify(e));this.setTemporaryCache(ma,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(ma,!0);if(!t)throw Zi(Ii);let r;try{r=JSON.parse(La(t))}catch(e){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${e}`),Zi(wi)}if(this.removeTemporaryItem(this.generateCacheKey(ma)),!r.authority){const t=this.generateAuthorityKey(e),n=this.getTemporaryCache(t);if(!n)throw Zi(Ei);r.authority=n}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Ta,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${t.CACHE_PREFIX}.${va}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const r=`${t.CACHE_PREFIX}.${va}`;if(e){if(this.getInteractionInProgress())throw Zi(ci);this.setTemporaryCache(r,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){const r=yt(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const o={idToken:r,accessToken:Ct(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?pt(e.expiresOn):0,e.extExpiresOn?pt(e.extExpiresOn):0,La,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof Pr&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function dc(e,t,r,n){try{switch(t){case ca.LocalStorage:return new ac(e,r,n);case ca.SessionStorage:return new sc}}catch(e){r.error(e)}return new Ys}const hc=(e,t,r,n)=>new lc(e,{cacheLocation:ca.MemoryStorage,temporaryCacheLocation:ca.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},ot,t,r,n);
/*! @azure/msal-browser v4.8.0 2025-03-20 */function pc(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}function gc(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}function fc(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function mc(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function vc(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function yc(e,t){t.setActiveAccount(e)}function Cc(e){return e.getActiveAccount()}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Tc{constructor(e){this.eventCallbacks=new Map,this.logger=e||new at({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){const n=r||As();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){const o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case uc.ACCOUNT_ADDED:case uc.ACCOUNT_REMOVED:case uc.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach((([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))}))}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Ic{constructor(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||Ja(),this.logger=n.clone(ea.MSAL_SKU,Us,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){vr.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(vr.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Ir.getAbsoluteUrl(t,vs())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ko(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Qn.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(Ir.getDomainFromUrl(o),t.environment):o,s=eo.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Xn(no,Qn.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw nr(Xt);return c}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */async function wc(e,t,r,n){r.addQueueMeasurement(Qn.InitializeBaseRequest,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===U.SSH){if(!e.sshJwk)throw nr(Qt);if(!e.sshKid)throw nr(Wt)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=U.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!or.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await os(e.claims)),a}async function Ec(e,t,r,n,o){n.addQueueMeasurement(Qn.InitializeSilentRequest,e.correlationId);const i=await Xn(wc,Qn.InitializeBaseRequest,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class kc extends Ic{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||Ja(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Ir.getAbsoluteUrl(e.postLogoutRedirectUri,vs())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Ir.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,vs())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Ir.getAbsoluteUrl(vs(),vs())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Qn.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await Xn(this.getClientConfiguration.bind(this),Qn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new qo(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:r,requestAuthority:n,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}=e;this.performanceClient.addQueueMeasurement(Qn.StandardInteractionClientGetClientConfiguration,this.correlationId);const s=await Xn(this.getDiscoveredAuthority.bind(this),Qn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:r,libraryInfo:{sku:ea.MSAL_SKU,version:Us,cpu:t.EMPTY_STRING,os:t.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,r){this.performanceClient.addQueueMeasurement(Qn.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const n=this.getRedirectUri(e.redirectUri),o={interactionType:r},i=bo.setRequestState(this.browserCrypto,e&&e.state||t.EMPTY_STRING,o),a={...await Xn(wc,Qn.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:n,state:i,nonce:e.nonce||Ja(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return a;const s=e.account||this.browserStorage.getActiveAccount();return s&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${s.homeAccountId}`,this.correlationId),a.account=s),a}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const Sc="user_switch",bc={[Sc]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Ac extends se{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Ac.prototype),this.name="NativeAuthError",this.ext=r}}function _c(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function Rc(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return So(ho);case"USER_INTERACTION_REQUIRED":return new Eo(e,t);case"USER_CANCEL":return Zi(di);case"NO_NETWORK":return Zi(_i)}return new Ac(e,bc[e]||t,r)}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Pc extends kc{async acquireToken(e){this.performanceClient.addQueueMeasurement(Qn.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Sa.acquireTokenSilent_silentFlow),r=await Xn(this.getClientConfiguration.bind(this),Qn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new xo(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Xn(n.acquireCachedToken.bind(n),Qn.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof Xi&&e.errorCode===Oi&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Nc extends Ic{constructor(e,t,r,n,o,i,a,s,c,u,l,d){super(e,t,r,n,o,i,s,c,d),this.apiId=a,this.accountId=u,this.nativeMessageHandler=c,this.nativeStorageManager=l,this.silentCacheClient=new Pc(e,this.nativeStorageManager,r,n,o,i,s,c,d);const h=this.nativeMessageHandler.getExtensionId()===ra?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Ko.makeExtraSkuString({libraryName:ea.MSAL_SKU,libraryVersion:Us,extensionName:h,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[mn]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Qn.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement(Qn.NativeInteractionClientAcquireToken,e.correlationId),n=ht(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(t===Na.AccessToken)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=i,s={method:aa,request:a},c=await this.nativeMessageHandler.sendMessage(s),u=this.validateNativeResponse(c);return await this.handleNativeResponse(u,i,n).then((e=>(r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e))).catch((e=>{throw r.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(e){throw e instanceof Ac&&o.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:ir.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),nt(xe);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw nt(xe);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r),o={method:aa,request:n};try{const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(e){if(e instanceof Ac){if(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),_c(e))throw e}}this.browserStorage.setTemporaryCache(Ta,JSON.stringify(n),!0);const i={apiId:Sa.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ta));const i={method:aa,request:o},a=ht();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,o,a);this.browserStorage.setInteractionInProgress(!1);const r=await t;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),r}catch(e){throw this.browserStorage.setInteractionInProgress(!1),e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=lt(e.id_token,La),o=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw Rc(Sc);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=No(this.browserStorage,a,o,La,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,n,s,a.canonicalAuthority,r);return await this.cacheAccount(s),await this.cacheNativeTokens(e,t,o,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,r){return vr.generateHomeAccountId(e.client_info||t.EMPTY_STRING,dr,this.logger,this.browserCrypto,r)}generateScopes(e,t){return e.scope?ir.fromString(e.scope):ir.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===U.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new _o(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw nt(We);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,r,n,o,i,a){const s=this.addTelemetryFromNativeResponse(e),c=e.scope?ir.fromString(e.scope):ir.fromString(r.scope),u=e.account.properties||{},l=u.UID||n.oid||n.sub||t.EMPTY_STRING,d=u.TenantId||n.tid||t.EMPTY_STRING,h=lr(o.getAccountInfo(),void 0,n,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const p=await this.generatePopAccessToken(e,r),g=r.tokenType===U.POP?U.POP:U.BEARER;return{authority:i,uniqueId:l,tenantId:d,scopes:c.asArray(),account:h,idToken:e.id_token,idTokenClaims:n,accessToken:p,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:gt(a+e.expires_in),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,r,n,o,i,a,s){const c=yt(n,r.authority,e.id_token||"",r.clientId,o.tid||""),u=s+(r.tokenType===U.POP?t.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,r),d={idToken:c,accessToken:Ct(n,r.authority,i,r.clientId,o.tid||a,l.printScopes(),u,0,La,void 0,r.tokenType,void 0,r.keyId)};return this.nativeStorageManager.saveCacheRecord(d,this.correlationId,r.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw ce(re,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new Ir(t);r.validateAsUri();const{scopes:n,...o}=e,i=new ir(n||[]);i.appendScopes(a);const s={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case Sa.ssoSilent:case Sa.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),g.NONE}if(e.prompt)switch(e.prompt){case g.NONE:case g.CONSENT:case g.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Zi(zi)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(s.signPopToken&&e.popKid)throw Zi(ji);if(this.handleExtraBrokerParams(s),s.extraParameters=s.extraParameters||{},s.extraParameters.telemetry=na,e.authenticationScheme===U.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new _o(this.browserCrypto);let n;if(s.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:s.keyId})),s.signPopToken=!1;else{const o=await Xn(r.generateCnf.bind(r),Qn.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=o.reqCnfString,s.keyId=o.kid,s.signPopToken=!0}s.reqCnf=n}return this.addRequestSKUs(s),s}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(vn)&&e.extraParameters.hasOwnProperty(yn)&&e.extraParameters.hasOwnProperty(Gr);if(!e.embeddedClientId&&!t)return;let r="";const n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[yn],r=e.extraParameters[Gr]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Mc{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(Qn.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:ta,extensionId:this.extensionId,responseId:Ja(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new Mc(e,t,r,ra);return await n.sendHandshakeRequest(),n}catch(n){const o=new Mc(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:ta,extensionId:this.extensionId,responseId:Ja(),body:{method:oa}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Zi(Hi)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===ta&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===oa){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(Zi(Di))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===sa){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(Rc(e.code,e.description,e.ext));else{if(!e.result)throw ce(re,"Event does not contain result.");e.result.code&&e.result.description?r.reject(Rc(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===ia){if(!n)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,r,n){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(n)switch(n){case U.BEARER:case U.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Oc{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(Qn.HandleCodeResponse,t.correlationId);try{r=Ho(e,t.state)}catch(e){throw e instanceof oo&&e.subError===di?Zi(di):e}return Xn(this.handleCodeResponseFromServer.bind(this),Qn.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(Qn.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Xn(this.authModule.updateAuthority.bind(this.authModule),Qn.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Xn(this.authModule.acquireToken.bind(this.authModule),Qn.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Kr}:e.loginHint?{credential:e.loginHint,type:zr}:null}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */function qc(e,t,r){const n=Cr(e);if(!n)throw yr(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),Zi(ii)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Zi(ni));return n}
/*! @azure/msal-browser v4.8.0 2025-03-20 */
async function Uc(e,t,r,n,o){const i=Bo({...e.auth,authority:t},r,n,o);if(Pn(i,{sku:ea.MSAL_SKU,version:Us,os:"",cpu:""}),e.auth.protocolMode!==mr.OIDC&&Nn(i,e.telemetry.application),r.platformBroker&&(function(e){e.set(hn,"1")}(i),r.authenticationScheme===U.POP)){const e=new Js(n,o),t=new _o(e);let a;if(r.popKid)a=e.encodeKid(r.popKid);else{a=(await Xn(t.generateCnf.bind(t),Qn.PopTokenGenerateCnf,n,o,r.correlationId)(r,n)).reqCnfString}Fn(i,a)}return Tn(i,r.correlationId,o),i}async function xc(e,r,n,o,i){if(!n.codeChallenge)throw nr(Kt);const a=await Xn(Uc,Qn.GetStandardParams,o,i,n.correlationId)(e,r,n,o,i);return function(e){e.set(Qr,t.CODE_RESPONSE_TYPE)}(a),function(e,t,r){if(!t||!r)throw nr(Kt);e.set(Zr,t),e.set(en,r)}(a,n.codeChallenge,t.S256_CODE_CHALLENGE_METHOD),function(e,t){const r=Tr(t);return Ir.appendQueryString(e.authorizationEndpoint,r)}(r,a)}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const Lc=32;async function Bc(e,t,r){e.addQueueMeasurement(Qn.GeneratePkceCodes,r);const n=Jn(Hc,Qn.GenerateCodeVerifier,t,e,r)(e,t,r);return{verifier:n,challenge:await Xn(Dc,Qn.GenerateCodeChallengeFromVerifier,t,e,r)(n,e,t,r)}}function Hc(e,t,r){try{const n=new Uint8Array(Lc);Jn(Ya,Qn.GetRandomValues,t,e,r)(n);return qa(n)}catch(e){throw Zi(ei)}}async function Dc(e,t,r,n){t.addQueueMeasurement(Qn.GenerateCodeChallengeFromVerifier,n);try{const o=await Xn(Va,Qn.Sha256Digest,r,t,n)(e,t,n);return qa(new Uint8Array(o))}catch(e){throw Zi(ei)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Fc extends kc{constructor(e,t,r,n,o,i,a,s,c,u){super(e,t,r,n,o,i,a,c,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s}acquireToken(e,t){try{const r={popupName:this.generatePopupName(e.scopes||a,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t))}catch(e){return Promise.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o))}catch(e){return Promise.reject(e)}}async acquireTokenPopupAsync(t,r,n){this.logger.verbose("acquireTokenPopupAsync called");const o=this.initializeServerTelemetryManager(Sa.acquireTokenPopup),i=await Xn(this.initializeAuthorizationRequest.bind(this),Qn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,e.InteractionType.Popup),a=n||await Xn(Bc,Qn.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId);i.codeChallenge=a.challenge,r.popup&&bs(i.authority);try{const n=await Xn(this.createAuthCodeClient.bind(this),Qn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),s=Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme);let c;s&&(c=this.performanceClient.startMeasurement(Qn.FetchAccountIdWithNativeBroker,t.correlationId));const u=await Xn(xc,Qn.GetAuthCodeUrl,this.logger,this.performanceClient,i.correlationId)(this.config,n.authority,{...i,platformBroker:s},this.logger,this.performanceClient),l=this.initiateAuthRequest(u,r);this.eventHandler.emitEvent(uc.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:l},null);const d=await this.monitorPopupForHash(l,r.popupWindowParent),h=Jn(qc,Qn.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(d,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(ao.removeThrottle(this.browserStorage,this.config.auth.clientId,i),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Zi(Fi);const e=new Nc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Sa.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,h.accountId,this.nativeStorage,i.correlationId),{userRequestState:t}=bo.parseRequestState(this.browserCrypto,i.state);return await e.acquireToken({...i,state:t,prompt:void 0})}const p={...i,code:h.code||"",codeVerifier:a.verifier},g=new Oc(n,this.browserStorage,p,this.logger,this.performanceClient);return await g.handleCodeResponse(h,i)}catch(e){throw r.popup?.close(),e instanceof se&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}async logoutPopupAsync(t,r,n,o){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(uc.LOGOUT_START,e.InteractionType.Popup,t);const i=this.initializeServerTelemetryManager(Sa.logoutPopup);try{await this.clearCacheOnLogout(t.account);const a=await Xn(this.createAuthCodeClient.bind(this),Qn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:t.account||void 0});try{a.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId&&t.postLogoutRedirectUri&&a.authority.protocolMode===mr.OIDC){if(this.browserStorage.removeAccount(t.account?.homeAccountId),this.eventHandler.emitEvent(uc.LOGOUT_SUCCESS,e.InteractionType.Popup,t),o){const e={apiId:Sa.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Ir.getAbsoluteUrl(o,vs());await this.navigationClient.navigateInternal(t,e)}return void r.popup?.close()}}const s=a.getLogoutUri(t);this.eventHandler.emitEvent(uc.LOGOUT_SUCCESS,e.InteractionType.Popup,t);const c=this.openPopup(s,r);if(this.eventHandler.emitEvent(uc.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:c},null),await this.monitorPopupForHash(c,r.popupWindowParent).catch((()=>{})),o){const e={apiId:Sa.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Ir.getAbsoluteUrl(o,vs());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(t){throw r.popup?.close(),t instanceof se&&(t.setCorrelationId(this.correlationId),i.cacheFailedRequest(t)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(uc.LOGOUT_FAILURE,e.InteractionType.Popup,null,t),this.eventHandler.emitEvent(uc.LOGOUT_END,e.InteractionType.Popup),t}this.eventHandler.emitEvent(uc.LOGOUT_END,e.InteractionType.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Zi(ri)}monitorPopupForHash(e,t){return new Promise(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(Zi(di));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===m.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Zi(li);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),Zi(ui)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){const o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,u=r.popupSize?.height,l=r.popupPosition?.top,d=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=ea.POPUP_WIDTH),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=ea.POPUP_HEIGHT),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),l=Math.max(0,s/2-ea.POPUP_HEIGHT/2+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-ea.POPUP_WIDTH/2+o)),n.open(e,t,`width=${c}, height=${u}, top=${l}, left=${d}, scrollbars=yes`)}unloadWindow(t){this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${ea.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${ea.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Kc{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ga,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Ca,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:Sa.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if("function"==typeof t.onRedirectNavigate){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,r)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Zi(ri)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),n=this.browserStorage.getTemporaryCache(r);if(!n)throw nt(Ce,"Cached State");let o;try{o=Ho(e,n)}catch(e){throw e instanceof oo&&e.subError===di?Zi(di):e}const i=this.browserStorage.generateNonceKey(n),a=this.browserStorage.getTemporaryCache(i);if(this.authCodeRequest.code=o.code,o.cloud_instance_host_name&&await Xn(this.authModule.updateAuthority.bind(this.authModule),Qn.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(o.cloud_instance_host_name,this.authCodeRequest.correlationId),o.nonce=a||void 0,o.state=n,o.client_info)this.authCodeRequest.clientInfo=o.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const s=await this.authModule.acquireToken(this.authCodeRequest,o);return this.browserStorage.cleanRequestByState(t),s}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(ya,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class zc extends kc{constructor(e,t,r,n,o,i,a,s,c,u){super(e,t,r,n,o,i,a,c,u),this.nativeStorage=s}async acquireToken(t){const r=await Xn(this.initializeAuthorizationRequest.bind(this),Qn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,e.InteractionType.Redirect),n=await Xn(Bc,Qn.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId);r.codeChallenge=n.challenge,this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null);const o=this.initializeServerTelemetryManager(Sa.acquireTokenRedirect),i=t=>{t.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(r.state),this.eventHandler.emitEvent(uc.RESTORE_FROM_BFCACHE,e.InteractionType.Redirect))};try{const e=await Xn(this.createAuthCodeClient.bind(this),Qn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),a={...r,code:"",codeVerifier:n.verifier},s=new Kc(e,this.browserStorage,a,this.logger,this.performanceClient),c=await Xn(xc,Qn.GetAuthCodeUrl,this.logger,this.performanceClient,r.correlationId)(this.config,e.authority,{...r,platformBroker:Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)},this.logger,this.performanceClient),u=this.getRedirectStartPage(t.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",i),await s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:t.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(e){throw e instanceof se&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),window.removeEventListener("pageshow",i),this.browserStorage.cleanRequestByState(r.state),e}}async handleRedirectPromise(r="",n){const o=this.initializeServerTelemetryManager(Sa.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[i,a]=this.getRedirectResponse(r||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(ga,!0)||t.EMPTY_STRING,c=Ir.removeHashFromUrl(s);if(c===Ir.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&gs(s);return await this.handleResponse(i,o)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,o);if(!fs()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(fa,a,!0);const e={apiId:Sa.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let t=!0;if(s&&"null"!==s)this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),t=await this.navigationClient.navigateInternal(s,e);else{const r=ys();this.browserStorage.setTemporaryCache(ga,r,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(r,e)}if(!t)return await this.handleResponse(i,o)}return null}catch(t){throw t instanceof se&&(t.setCorrelationId(this.correlationId),o.cacheFailedRequest(t)),this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect),t}}getRedirectResponse(t){this.logger.verbose("getRedirectResponseHash called");let r=t;r||(r=this.config.auth.OIDCOptions.serverResponseType===m.QUERY?window.location.search:window.location.hash);let n=Cr(r);if(n){try{!function(e,t,r){if(!e.state)throw Zi(oi);const n=cc(t,e.state);if(!n)throw Zi(ai);if(n.interactionType!==r)throw Zi(si)}(n,this.browserCrypto,e.InteractionType.Redirect)}catch(e){return e instanceof se&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return ps(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,r]}const o=this.browserStorage.getTemporaryCache(fa,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(fa)),o&&(n=Cr(o),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,o]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw Zi(oi);const n=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Zi(Fi);const t=new Nc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Sa.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,n.correlationId),{userRequestState:o}=bo.parseRequestState(this.browserCrypto,r);return t.acquireToken({...n,state:o,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(r)}))}const o=this.browserStorage.getCachedAuthority(r);if(!o)throw Zi(Ei);const i=await Xn(this.createAuthCodeClient.bind(this),Qn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:o});ao.removeThrottle(this.browserStorage,this.config.auth.clientId,n);return new Kc(i,this.browserStorage,n,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(t){this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(t),n=this.initializeServerTelemetryManager(Sa.logout);try{this.eventHandler.emitEvent(uc.LOGOUT_START,e.InteractionType.Redirect,t),await this.clearCacheOnLogout(r.account);const o={apiId:Sa.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=await Xn(this.createAuthCodeClient.bind(this),Qn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t&&t.authority,requestExtraQueryParameters:t?.extraQueryParameters,account:t&&t.account||void 0});if(i.authority.protocolMode===mr.OIDC)try{i.authority.endSessionEndpoint}catch{if(r.account?.homeAccountId)return this.browserStorage.removeAccount(r.account?.homeAccountId),void this.eventHandler.emitEvent(uc.LOGOUT_SUCCESS,e.InteractionType.Redirect,r)}const a=i.getLogoutUri(r);if(this.eventHandler.emitEvent(uc.LOGOUT_SUCCESS,e.InteractionType.Redirect,r),!t||"function"!=typeof t.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(a,o);if(!1!==t.onRedirectNavigate(a))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(a,o);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(t){throw t instanceof se&&(t.setCorrelationId(this.correlationId),n.cacheFailedRequest(t)),this.eventHandler.emitEvent(uc.LOGOUT_FAILURE,e.InteractionType.Redirect,null,t),this.eventHandler.emitEvent(uc.LOGOUT_END,e.InteractionType.Redirect),t}this.eventHandler.emitEvent(uc.LOGOUT_END,e.InteractionType.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Ir.getAbsoluteUrl(t,vs())}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */async function Gc(e,t,r,n,o){if(t.addQueueMeasurement(Qn.SilentHandlerInitiateAuthRequest,n),!e)throw r.info("Navigate url is empty"),Zi(ri);return o?Xn(Qc,Qn.SilentHandlerLoadFrame,r,t,n)(e,o,t,n):Jn(Wc,Qn.SilentHandlerLoadFrameSync,r,t,n)(e)}async function jc(e,t,r,n,o,i,a){return n.addQueueMeasurement(Qn.SilentHandlerMonitorIframeForHash,i),new Promise(((n,i)=>{t<Os&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout((()=>{window.clearInterval(c),i(Zi(pi))}),t),c=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===m.QUERY?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(o)}),r)})).finally((()=>{Jn(Yc,Qn.RemoveHiddenIframe,o,n,i)(e)}))}function Qc(e,t,r,n){return r.addQueueMeasurement(Qn.SilentHandlerLoadFrame,n),new Promise(((r,n)=>{const o=Vc();window.setTimeout((()=>{o?(o.src=e,r(o)):n("Unable to load iframe")}),t)}))}function Wc(e){const t=Vc();return t.src=e,t}function Vc(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Yc(e){document.body===e.parentNode&&document.body.removeChild(e)}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class $c extends kc{constructor(e,t,r,n,o,i,a,s,c,u,l){super(e,t,r,n,o,i,s,u,l),this.apiId=a,this.nativeStorage=c}async acquireToken(t){this.performanceClient.addQueueMeasurement(Qn.SilentIframeClientAcquireToken,t.correlationId),t.loginHint||t.sid||t.account&&t.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const r={...t};r.prompt?r.prompt!==g.NONE&&r.prompt!==g.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with ${g.NONE}`),r.prompt=g.NONE):r.prompt=g.NONE;const n=await Xn(this.initializeAuthorizationRequest.bind(this),Qn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(r,e.InteractionType.Silent);bs(n.authority);const o=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await Xn(this.createAuthCodeClient.bind(this),Qn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:o,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await Xn(this.silentTokenHelper.bind(this),Qn.SilentIframeClientTokenHelper,this.logger,this.performanceClient,t.correlationId)(i,n)}catch(n){if(n instanceof se&&(n.setCorrelationId(this.correlationId),o.cacheFailedRequest(n)),!(i&&n instanceof se&&n.errorCode===ea.INVALID_GRANT_ERROR))throw n;this.performanceClient.addFields({retryError:n.errorCode},this.correlationId);const a=await Xn(this.initializeAuthorizationRequest.bind(this),Qn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(r,e.InteractionType.Silent);return await Xn(this.silentTokenHelper.bind(this),Qn.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,a)}}logout(){return Promise.reject(Zi(yi))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(Qn.SilentIframeClientTokenHelper,r);const n=await Xn(Bc,Qn.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),o={...t,codeChallenge:n.challenge},i=await Xn(xc,Qn.GetAuthCodeUrl,this.logger,this.performanceClient,r)(this.config,e.authority,{...o,platformBroker:Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)},this.logger,this.performanceClient),a=await Xn(Gc,Qn.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await Xn(jc,Qn.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),u=Jn(qc,Qn.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,s,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Zi(Fi);const e=new Nc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,r),{userRequestState:t}=bo.parseRequestState(this.browserCrypto,o.state);return Xn(e.acquireToken.bind(e),Qn.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...o,state:t,prompt:o.prompt||g.NONE})}const l={...o,code:u.code||"",codeVerifier:n.verifier},d=new Oc(e,this.browserStorage,l,this.logger,this.performanceClient);return Xn(d.handleCodeResponse.bind(d),Qn.HandleCodeResponse,this.logger,this.performanceClient,r)(u,o)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Jc extends kc{async acquireToken(e){this.performanceClient.addQueueMeasurement(Qn.SilentRefreshClientAcquireToken,e.correlationId);const t=await Xn(wc,Qn.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(Sa.acquireTokenSilent_silentFlow),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Xn(o.acquireTokenByRefreshToken.bind(o),Qn.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return Promise.reject(Zi(yi))}async createRefreshTokenClient(e){const t=await Xn(this.getClientConfiguration.bind(this),Qn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Uo(t,this.performanceClient)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Xc{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Zi(bi);const n=e.correlationId||Ja(),o=t.id_token?lt(t.id_token,La):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new eo(eo.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Ja()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),u=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),l=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:u,refreshToken:l},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=vr.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Zi(Mi);const i=vr.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=No(this.storage,o,i,La,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=yt(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?ir.fromString(t.scope):new ir(e.scopes),c=i.expiresOn||t.expires_in+ht(),u=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+ht(),l=Ct(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,u,La);return await this.storage.setAccessTokenCredential(l,a),l}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=Tt(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=ir.fromString(t.accessToken.target).asArray(),s=gt(t.accessToken.expiresOn),o=gt(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Zc extends qo{constructor(e){super(e),this.includeRedirectUri=!1}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class eu extends kc{constructor(e,t,r,n,o,i,a,s,c,u){super(e,t,r,n,o,i,s,c,u),this.apiId=a}async acquireToken(t){if(!t.code)throw Zi(qi);const r=await Xn(this.initializeAuthorizationRequest.bind(this),Qn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const e={...r,code:t.code},o=await Xn(this.getClientConfiguration.bind(this),Qn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),i=new Zc(o);this.logger.verbose("Auth code client created");const a=new Oc(i,this.browserStorage,e,this.logger,this.performanceClient);return await Xn(a.handleCodeResponseFromServer.bind(a),Qn.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r,!1)}catch(e){throw e instanceof se&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}logout(){return Promise.reject(Zi(yi))}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */function tu(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function ru(e,t){try{ks(e)}catch(e){throw t.end({success:!1},e),e}}class nu{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Js(this.logger,this.performanceClient):ot,this.eventHandler=new Tc(this.logger),this.browserStorage=this.isBrowserEnvironment?new lc(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,ro(this.config.auth)):hc(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:ca.MemoryStorage,temporaryCacheLocation:ca.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new lc(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new Xc(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const r=new nu(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(uc.INITIALIZE_END);const t=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,n=this.performanceClient.startMeasurement(Qn.InitializeClientApplication,t);if(this.eventHandler.emitEvent(uc.INITIALIZE_START),await Xn(this.browserStorage.initialize.bind(this.browserStorage),Qn.InitializeCache,this.logger,this.performanceClient,t)(t),r)try{this.nativeExtensionProvider=await Mc.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Xn(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Qn.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t),this.initialized=!0,this.eventHandler.emitEvent(uc.INITIALIZE_END),n.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Es(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(t){const r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t,i=o?n?.correlationId:this.browserStorage.getTemporaryCache(Ca,!0)||"",a=this.performanceClient.startMeasurement(Qn.AcquireTokenRedirect,i);let s;if(this.eventHandler.emitEvent(uc.HANDLE_REDIRECT_START,e.InteractionType.Redirect),o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new Nc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Sa.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);s=Xn(e.handleRedirectPromise.bind(e),Qn.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const e=this.createRedirectClient(i);s=Xn(e.handleRedirectPromise.bind(e),Qn.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(t,a)}return s.then((t=>{if(t){r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(uc.LOGIN_SUCCESS,e.InteractionType.Redirect,t),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:tu(t.account)})}else a.event.errorCode?a.end({success:!1}):a.discard();return this.eventHandler.emitEvent(uc.HANDLE_REDIRECT_END,e.InteractionType.Redirect),t})).catch((t=>{const n=t;throw r.length>0?this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,n):this.eventHandler.emitEvent(uc.LOGIN_FAILURE,e.InteractionType.Redirect,null,n),this.eventHandler.emitEvent(uc.HANDLE_REDIRECT_END,e.InteractionType.Redirect),a.end({success:!1},n),t}))}async acquireTokenRedirect(t){const r=this.getRequestCorrelationId(t);this.logger.verbose("acquireTokenRedirect called",r);const n=this.performanceClient.startMeasurement(Qn.AcquireTokenPreRedirect,r);n.add({accountType:tu(t.account),scenarioId:t.scenarioId});const o=t.onRedirectNavigate;if(o)t.onRedirectNavigate=e=>{const t="function"==typeof o?o(e):void 0;return!1!==t?n.end({success:!0}):n.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const r="function"==typeof e?e(t):void 0;return!1!==r?n.end({success:!0}):n.discard(),r}}const i=this.getAllAccounts().length>0;try{let o;if(Ss(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t):this.eventHandler.emitEvent(uc.LOGIN_START,e.InteractionType.Redirect,t),this.nativeExtensionProvider&&this.canUsePlatformBroker(t)){o=new Nc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Sa.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,r).acquireTokenRedirect(t,n).catch((e=>{if(e instanceof Ac&&_c(e)){this.nativeExtensionProvider=void 0;return this.createRedirectClient(r).acquireToken(t)}if(e instanceof Eo){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(r).acquireToken(t)}throw this.browserStorage.setInteractionInProgress(!1),e}))}else{o=this.createRedirectClient(r).acquireToken(t)}return await o}catch(t){throw n.end({success:!1},t),i?this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t):this.eventHandler.emitEvent(uc.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),t}}acquireTokenPopup(t){const r=this.getRequestCorrelationId(t),n=this.performanceClient.startMeasurement(Qn.AcquireTokenPopup,r);n.add({scenarioId:t.scenarioId,accountType:tu(t.account)});try{this.logger.verbose("acquireTokenPopup called",r),ru(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(e){return Promise.reject(e)}const o=this.getAllAccounts();let i;o.length>0?this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t):this.eventHandler.emitEvent(uc.LOGIN_START,e.InteractionType.Popup,t);const a=this.getPreGeneratedPkceCodes(r);if(this.canUsePlatformBroker(t))i=this.acquireTokenNative({...t,correlationId:r},Sa.acquireTokenPopup).then((e=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,accountType:tu(e.account)}),e))).catch((e=>{if(e instanceof Ac&&_c(e)){this.nativeExtensionProvider=void 0;return this.createPopupClient(r).acquireToken(t,a)}if(e instanceof Eo){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(r).acquireToken(t,a)}throw this.browserStorage.setInteractionInProgress(!1),e}));else{i=this.createPopupClient(r).acquireToken(t,a)}return i.then((t=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(uc.LOGIN_SUCCESS,e.InteractionType.Popup,t):this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t),n.end({success:!0,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,accountType:tu(t.account)}),t))).catch((t=>(o.length>0?this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t):this.eventHandler.emitEvent(uc.LOGIN_FAILURE,e.InteractionType.Popup,null,t),n.end({success:!1},t),Promise.reject(t)))).finally((()=>this.config.system.asyncPopups&&this.preGeneratePkceCodes(r)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(t){const r=this.getRequestCorrelationId(t),n={...t,prompt:t.prompt,correlationId:r};let o;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Qn.SsoSilent,r),this.ssoSilentMeasurement?.add({scenarioId:t.scenarioId,accountType:tu(t.account)}),ru(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(uc.SSO_SILENT_START,e.InteractionType.Silent,n),this.canUsePlatformBroker(n))o=this.acquireTokenNative(n,Sa.ssoSilent).catch((e=>{if(e instanceof Ac&&_c(e)){this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(n.correlationId).acquireToken(n)}throw e}));else{o=this.createSilentIframeClient(n.correlationId).acquireToken(n)}return o.then((t=>(this.eventHandler.emitEvent(uc.SSO_SILENT_SUCCESS,e.InteractionType.Silent,t),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:t.fromNativeBroker,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,accountType:tu(t.account)}),t))).catch((t=>{throw this.eventHandler.emitEvent(uc.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),this.ssoSilentMeasurement?.end({success:!1},t),t})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(t){const r=this.getRequestCorrelationId(t);this.logger.trace("acquireTokenByCode called",r);const n=this.performanceClient.startMeasurement(Qn.AcquireTokenByCode,r);ru(this.initialized,n),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_BY_CODE_START,e.InteractionType.Silent,t),n.add({scenarioId:t.scenarioId});try{if(t.code&&t.nativeAccountId)throw Zi(xi);if(t.code){const o=t.code;let i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",r),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",r),i=this.acquireTokenByCodeAsync({...t,correlationId:r}).then((t=>(this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_BY_CODE_SUCCESS,e.InteractionType.Silent,t),this.hybridAuthCodeResponses.delete(o),n.end({success:!0,isNativeBroker:t.fromNativeBroker,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,accountType:tu(t.account)}),t))).catch((t=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t),n.end({success:!1},t),t})),this.hybridAuthCodeResponses.set(o,i)),await i}if(t.nativeAccountId){if(this.canUsePlatformBroker(t,t.nativeAccountId)){const e=await this.acquireTokenNative({...t,correlationId:r},Sa.acquireTokenByCode,t.nativeAccountId).catch((e=>{throw e instanceof Ac&&_c(e)&&(this.nativeExtensionProvider=void 0),e}));return n.end({accountType:tu(e.account),success:!0}),e}throw Zi(Bi)}throw Zi(Ui)}catch(t){throw this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t),n.end({success:!1},t),t}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Qn.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Qn.AcquireTokenFromCache,e.correlationId),t){case Na.Default:case Na.AccessToken:case Na.AccessTokenAndRefreshToken:const t=this.createSilentCacheClient(e.correlationId);return Xn(t.acquireToken.bind(t),Qn.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw nt(Fe)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Qn.AcquireTokenByRefreshToken,e.correlationId),t){case Na.Default:case Na.AccessTokenAndRefreshToken:case Na.RefreshToken:case Na.RefreshTokenAndNetwork:const t=this.createSilentRefreshClient(e.correlationId);return Xn(t.acquireToken.bind(t),Qn.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw nt(Fe)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Qn.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Xn(t.acquireToken.bind(t),Qn.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Ss(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);ks(this.initialized),this.browserStorage.setInteractionInProgress(!0);return this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return pc(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return gc(e,this.logger,this.browserStorage)}getAccountByUsername(e){return fc(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return mc(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return vc(e,this.logger,this.browserStorage)}setActiveAccount(e){yc(e,this.browserStorage)}getActiveAccount(){return Cc(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=vr.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Zi(Fi);return new Nc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,n)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case g.NONE:case g.CONSENT:case g.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Fc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new $c(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Sa.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Pc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Jc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new eu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Sa.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return ws(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===ca.LocalStorage?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===ca.LocalStorage?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Ja():t.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||_a})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||_a})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Qn.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),ru(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw Zi(Ci);return r.add({accountType:tu(n)}),this.acquireTokenSilentDeduped(e,n,t).then((n=>(r.end({success:!0,fromCache:n.fromCache,isNativeBroker:n.fromNativeBroker,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length}),{...n,state:e.state,correlationId:t}))).catch((e=>{throw e instanceof se&&e.setCorrelationId(t),r.end({success:!1},e),e}))}async acquireTokenSilentDeduped(e,t,r){const n=io(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:r},t.homeAccountId),o=JSON.stringify(n),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.addFields({deduped:!1},r);const n=Xn(this.acquireTokenSilentAsync.bind(this),Qn.AcquireTokenSilentAsync,this.logger,this.performanceClient,r)({...e,correlationId:r},t);return this.activeSilentTokenRequests.set(o,n),n.finally((()=>{this.activeSilentTokenRequests.delete(o)}))}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),this.performanceClient.addFields({deduped:!0},r),i}async acquireTokenSilentAsync(t,r){const n=()=>this.trackPageVisibility(t.correlationId);this.performanceClient.addQueueMeasurement(Qn.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t),t.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},t.correlationId),document.addEventListener("visibilitychange",n);const o=await Xn(Ec,Qn.InitializeSilentRequest,this.logger,this.performanceClient,t.correlationId)(t,r,this.config,this.performanceClient,this.logger),i=t.cacheLookupPolicy||Na.Default;return this.acquireTokenSilentNoIframe(o,i).catch((async e=>{const t=function(e,t){const r=!(e instanceof Eo&&e.subError!==vo),n=e.errorCode===ea.INVALID_GRANT_ERROR||e.errorCode===Fe,o=r&&n||e.errorCode===lo||e.errorCode===po,i=Ma.includes(t);return o&&i}
/*! @azure/msal-browser v4.8.0 2025-03-20 */(e,i);if(t){if(this.activeIframeRequest){if(i!==Na.Skip){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,o.correlationId);const n=this.performanceClient.startMeasurement(Qn.AwaitConcurrentIframe,o.correlationId);n.add({awaitIframeCorrelationId:r});const a=await t;if(n.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,i);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),Xn(this.acquireTokenBySilentIframe.bind(this),Qn.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o)}{let e;return this.activeIframeRequest=[new Promise((t=>{e=t})),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),Xn(this.acquireTokenBySilentIframe.bind(this),Qn.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((r=>(this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,r),t.correlationId&&this.performanceClient.addFields({fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker},t.correlationId),r))).catch((t=>{throw this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),t})).finally((()=>{document.removeEventListener("visibilitychange",n)}))}async acquireTokenSilentNoIframe(t,r){return Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&t.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(t,Sa.acquireTokenSilent_silentFlow,t.account.nativeAccountId,r).catch((async e=>{if(e instanceof Ac&&_c(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,nt(Fe);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),r===Na.AccessToken&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Xn(this.acquireTokenFromCache.bind(this),Qn.AcquireTokenFromCache,this.logger,this.performanceClient,t.correlationId)(t,r).catch((n=>{if(r===Na.AccessToken)throw n;return this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_NETWORK_START,e.InteractionType.Silent,t),Xn(this.acquireTokenByRefreshToken.bind(this),Qn.AcquireTokenByRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,r)})))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Xn(Bc,Qn.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class ou{constructor(e,t,r,n){this.clientId=e,this.clientCapabilities=t,this.crypto=r,this.logger=n}toNaaTokenRequest(e){let t;t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));const r=e.correlationId||this.crypto.createNewGuid(),n=Dn(e.claims,this.clientCapabilities),o=e.scopes||a;return{platformBrokerId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:o.join(" "),correlationId:r,claims:or.isEmptyObj(n)?void 0:n,state:e.state,authenticationScheme:e.authenticationScheme||U.BEARER,extraParameters:t}}fromNaaTokenResponse(e,t,r){if(!t.token.id_token||!t.token.access_token)throw nt(he);const n=gt(r+(t.token.expires_in||0)),o=lt(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,t.token.id_token,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!1,expiresOn:n,tokenType:e.authenticationScheme||U.BEARER,correlationId:e.correlationId,extExpiresOn:n,state:e.state}}fromNaaAccountInfo(e,t,r){const n=r||e.idTokenClaims,o=e.localAccountId||n?.oid||n?.sub||"",i=e.tenantId||n?.tid||"",a=e.homeAccountId||`${o}.${i}`,s=e.username||n?.preferred_username||"",c=e.name||n?.name,u=new Map,l=ur(a,o,i,n);u.set(i,l);return{homeAccountId:a,environment:e.environment,tenantId:i,username:s,localAccountId:o,name:c,idToken:t,idTokenClaims:n,tenantProfiles:u}}fromBridgeError(e){if(!function(e){return void 0!==e.status}(e))return new se("unknown_error","An unknown error occurred");switch(e.status){case Bs:return new rt(Ye);case Hs:return new rt(Ve);case zs:return new rt(xe);case Ks:return new rt(Xe);case Gs:return new rt(e.code||Xe,e.description);case Ds:case Fs:return new oo(e.code,e.description);case Ls:return new Eo(e.code,e.description);default:return new se(e.code,e.description)}}toAuthenticationResultFromCache(e,t,r,n,o){if(!t||!r)throw nt(he);const i=lt(t.secret,this.crypto.base64Decode),a=r.target||n.scopes.join(" ");return{authority:r.environment||e.environment,uniqueId:e.localAccountId,tenantId:e.tenantId,scopes:a.split(" "),account:e,idToken:t.secret,idTokenClaims:i||{},accessToken:r.secret,fromCache:!0,expiresOn:gt(r.expiresOn),extExpiresOn:gt(r.extendedExpiresOn),tokenType:n.authenticationScheme||U.BEARER,correlationId:o,state:n.state}}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const iu={code:"unsupported_method",desc:"This method is not supported in nested app environment."};class au extends se{constructor(e,t){super(e,t),Object.setPrototypeOf(this,au.prototype),this.name="NestedAppAuthError"}static createUnsupportedError(){return new au(iu.code,iu.desc)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class su{constructor(e){this.operatingContext=e;const t=this.operatingContext.getBridgeProxy();if(void 0===t)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=t,this.config=e.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=e.isBrowserEnvironment()?new Js(this.logger,this.performanceClient,!0):ot,this.eventHandler=new Tc(this.logger),this.browserStorage=this.operatingContext.isBrowserEnvironment()?new lc(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,ro(this.config.auth)):hc(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler),this.nestedAppAuthAdapter=new ou(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger);const r=this.bridgeProxy.getAccountContext();this.currentAccountContext=r||null}static async createController(e){const t=new su(e);return Promise.resolve(t)}async initialize(e){const t=e?.correlationId||Ja();return await this.browserStorage.initialize(t),Promise.resolve()}ensureValidRequest(e){return e?.correlationId?e:{...e,correlationId:this.browserCrypto.createNewGuid()}}async acquireTokenInteractive(t){const r=this.ensureValidRequest(t);this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,r);const n=this.performanceClient.startMeasurement(Qn.AcquireTokenPopup,r.correlationId);n?.add({nestedAppAuthRequest:!0});try{const o=this.nestedAppAuthAdapter.toNaaTokenRequest(r),i=ht(),a=await this.bridgeProxy.getTokenInteractive(o),s={...this.nestedAppAuthAdapter.fromNaaTokenResponse(o,a,i)};return await this.hydrateCache(s,t),this.currentAccountContext={homeAccountId:s.account.homeAccountId,environment:s.account.environment,tenantId:s.account.tenantId},this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,s),n.add({accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length}),n.end({success:!0,requestId:s.requestId}),s}catch(t){const r=t instanceof se?t:this.nestedAppAuthAdapter.fromBridgeError(t);throw this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t),n.end({success:!1},t),r}}async acquireTokenSilentInternal(t){const r=this.ensureValidRequest(t);this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,r);const n=await this.acquireTokenFromCache(r);if(n)return this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,n),n;const o=this.performanceClient.startMeasurement(Qn.SsoSilent,r.correlationId);o?.increment({visibilityChangeCount:0}),o?.add({nestedAppAuthRequest:!0});try{const n=this.nestedAppAuthAdapter.toNaaTokenRequest(r),i=ht(),a=await this.bridgeProxy.getTokenSilent(n),s=this.nestedAppAuthAdapter.fromNaaTokenResponse(n,a,i);return await this.hydrateCache(s,t),this.currentAccountContext={homeAccountId:s.account.homeAccountId,environment:s.account.environment,tenantId:s.account.tenantId},this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,s),o?.add({accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length}),o?.end({success:!0,requestId:s.requestId}),s}catch(t){const r=t instanceof se?t:this.nestedAppAuthAdapter.fromBridgeError(t);throw this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),o?.end({success:!1},t),r}}async acquireTokenFromCache(t){const r=this.performanceClient.startMeasurement(Qn.AcquireTokenSilent,t.correlationId);if(r?.add({nestedAppAuthRequest:!0}),t.claims)return this.logger.verbose("Claims are present in the request, skipping cache lookup"),null;if(t.forceRefresh)return this.logger.verbose("forceRefresh is set to true, skipping cache lookup"),null;let n=null;switch(t.cacheLookupPolicy||(t.cacheLookupPolicy=Na.Default),t.cacheLookupPolicy){case Na.Default:case Na.AccessToken:case Na.AccessTokenAndRefreshToken:n=await this.acquireTokenFromCacheInternal(t);break;default:return null}return n?(this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,n),r?.add({accessTokenSize:n?.accessToken.length,idTokenSize:n?.idToken.length}),r?.end({success:!0}),n):(this.logger.error("Cached tokens are not found for the account, proceeding with silent token request."),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null),r?.end({success:!1}),null)}async acquireTokenFromCacheInternal(e){const t=this.bridgeProxy.getAccountContext()||this.currentAccountContext;let r=null;if(t&&(r=gc(t,this.logger,this.browserStorage)),!r)return this.logger.verbose("No active account found, falling back to the host"),Promise.resolve(null);this.logger.verbose("active account found, attempting to acquire token silently");const n={...e,correlationId:e.correlationId||this.browserCrypto.createNewGuid(),authority:e.authority||r.environment,scopes:e.scopes?.length?e.scopes:[...a]},o=this.browserStorage.getTokenKeys(),i=this.browserStorage.getAccessToken(r,n,o,r.tenantId,this.performanceClient,n.correlationId);if(!i)return this.logger.verbose("No cached access token found"),Promise.resolve(null);if(mt(i.cachedAt)||ft(i.expiresOn,this.config.system.tokenRenewalOffsetSeconds))return this.logger.verbose("Cached access token has expired"),Promise.resolve(null);const s=this.browserStorage.getIdToken(r,o,r.tenantId,this.performanceClient,n.correlationId);return s?this.nestedAppAuthAdapter.toAuthenticationResultFromCache(r,s,i,n,n.correlationId):(this.logger.verbose("No cached id token found"),Promise.resolve(null))}async acquireTokenPopup(e){return this.acquireTokenInteractive(e)}acquireTokenRedirect(e){throw au.createUnsupportedError()}async acquireTokenSilent(e){return this.acquireTokenSilentInternal(e)}acquireTokenByCode(e){throw au.createUnsupportedError()}acquireTokenNative(e,t,r){throw au.createUnsupportedError()}acquireTokenByRefreshToken(e,t){throw au.createUnsupportedError()}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){throw au.createUnsupportedError()}removePerformanceCallback(e){throw au.createUnsupportedError()}enableAccountStorageEvents(){throw au.createUnsupportedError()}disableAccountStorageEvents(){throw au.createUnsupportedError()}getAllAccounts(e){return pc(this.logger,this.browserStorage,this.isBrowserEnv(),e)}getAccount(e){return gc(e,this.logger,this.browserStorage)}getAccountByUsername(e){return fc(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return mc(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return vc(e,this.logger,this.browserStorage)}setActiveAccount(e){return yc(e,this.browserStorage)}getActiveAccount(){return Cc(this.browserStorage)}handleRedirectPromise(e){return Promise.resolve(null)}loginPopup(e){return this.acquireTokenInteractive(e||_a)}loginRedirect(e){throw au.createUnsupportedError()}logout(e){throw au.createUnsupportedError()}logoutRedirect(e){throw au.createUnsupportedError()}logoutPopup(e){throw au.createUnsupportedError()}ssoSilent(e){return this.acquireTokenSilentInternal(e)}getTokenCache(){throw au.createUnsupportedError()}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){}setNavigationClient(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}getConfiguration(){return this.config}isBrowserEnv(){return this.operatingContext.isBrowserEnvironment()}getBrowserCrypto(){return this.browserCrypto}getPerformanceClient(){throw au.createUnsupportedError()}getRedirectResponse(){throw au.createUnsupportedError()}async clearCache(e){throw au.createUnsupportedError()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=vr.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),this.browserStorage.hydrateCache(e,t)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */async function cu(e){const t=new Ws(e),r=new Qs(e),n=[t.initialize(),r.initialize()];return await Promise.all(n),r.isAvailable()&&e.auth.supportsNestedAppAuth?su.createController(r):t.isAvailable()?nu.createController(t):null}
/*! @azure/msal-browser v4.8.0 2025-03-20 */let uu=class e{static async createPublicClientApplication(t){const r=await async function(e,t){const r=new Ws(e);return await r.initialize(),nu.createController(r,t)}(t);return new e(t,r)}constructor(e,t){this.controller=t||new nu(new Ws(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}};async function lu(e){const t=new uu(e);return await t.initialize(),t}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class du{constructor(e){this.initialized=!1,this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.logger=e.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Js(this.logger,this.performanceClient):ot,this.eventHandler=new Tc(this.logger),this.browserStorage=this.isBrowserEnvironment?new lc(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,void 0):hc(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler)}getBrowserStorage(){return this.browserStorage}getAccount(e){return null}getAccountByHomeId(e){return null}getAccountByLocalId(e){return null}getAccountByUsername(e){return null}getAllAccounts(){return[]}initialize(){return this.initialized=!0,Promise.resolve()}acquireTokenPopup(e){return Es(this.initialized),ws(),{}}acquireTokenRedirect(e){return Es(this.initialized),ws(),Promise.resolve()}acquireTokenSilent(e){return Es(this.initialized),ws(),{}}acquireTokenByCode(e){return Es(this.initialized),ws(),{}}acquireTokenNative(e,t,r){return Es(this.initialized),ws(),{}}acquireTokenByRefreshToken(e,t){return Es(this.initialized),ws(),{}}addEventCallback(e,t){return null}removeEventCallback(e){}addPerformanceCallback(e){return Es(this.initialized),ws(),""}removePerformanceCallback(e){return Es(this.initialized),ws(),!0}enableAccountStorageEvents(){Es(this.initialized),ws()}disableAccountStorageEvents(){Es(this.initialized),ws()}handleRedirectPromise(e){return Es(this.initialized),Promise.resolve(null)}loginPopup(e){return Es(this.initialized),ws(),{}}loginRedirect(e){return Es(this.initialized),ws(),{}}logout(e){return Es(this.initialized),ws(),{}}logoutRedirect(e){return Es(this.initialized),ws(),{}}logoutPopup(e){return Es(this.initialized),ws(),{}}ssoSilent(e){return Es(this.initialized),ws(),{}}getTokenCache(){return Es(this.initialized),ws(),{}}getLogger(){return this.logger}setLogger(e){Es(this.initialized),ws()}setActiveAccount(e){Es(this.initialized),ws()}getActiveAccount(){return Es(this.initialized),ws(),null}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){Es(this.initialized),ws()}getConfiguration(){return this.config}isBrowserEnv(){return Es(this.initialized),ws(),!0}getBrowserCrypto(){return Es(this.initialized),ws(),{}}getPerformanceClient(){return Es(this.initialized),ws(),{}}getRedirectResponse(){return Es(this.initialized),ws(),{}}async clearCache(e){Es(this.initialized),ws()}async hydrateCache(e,t){Es(this.initialized),ws()}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class hu extends xs{getId(){return hu.ID}getModuleName(){return hu.MODULE_NAME}async initialize(){return!0}}hu.MODULE_NAME="",hu.ID="UnknownOperatingContext";
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class pu{static async createPublicClientApplication(e){const t=await cu(e);let r;return r=null!==t?new pu(e,t):new pu(e),r}constructor(e,t){if(this.configuration=e,t)this.controller=t;else{const t=new hu(e);this.controller=new du(t)}}async initialize(){if(this.controller instanceof du){const e=await cu(this.configuration);return null!==e&&(this.controller=e),this.controller.initialize()}return Promise.resolve()}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */const gu={initialize:()=>Promise.reject(hs(as)),acquireTokenPopup:()=>Promise.reject(hs(as)),acquireTokenRedirect:()=>Promise.reject(hs(as)),acquireTokenSilent:()=>Promise.reject(hs(as)),acquireTokenByCode:()=>Promise.reject(hs(as)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(hs(as)),loginPopup:()=>Promise.reject(hs(as)),loginRedirect:()=>Promise.reject(hs(as)),logout:()=>Promise.reject(hs(as)),logoutRedirect:()=>Promise.reject(hs(as)),logoutPopup:()=>Promise.reject(hs(as)),ssoSilent:()=>Promise.reject(hs(as)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw hs(as)},getLogger:()=>{throw hs(as)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw hs(as)},hydrateCache:()=>Promise.reject(hs(as)),clearCache:()=>Promise.reject(hs(as))};
/*! @azure/msal-browser v4.8.0 2025-03-20 */
/*! @azure/msal-browser v4.8.0 2025-03-20 */
class fu{constructor(e,t){const r=t&&t.loggerOptions||{};this.logger=new at(r,qs,Us),this.cryptoOps=new Js(this.logger),this.popTokenGenerator=new _o(this.cryptoOps),this.shrParameters=e}async generatePublicKeyThumbprint(){const{kid:e}=await this.popTokenGenerator.generateKid(this.shrParameters);return e}async signRequest(e,t,r){return this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)}async removeKeys(e){return this.cryptoOps.removeTokenBindingKey(e)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */function mu(){let e;try{e=window[ca.SessionStorage];const t=e?.getItem("msal.browser.performance.enabled");if(1===Number(t))return Promise.resolve().then((function(){return Iu}))}catch(e){}}function vu(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now}function yu(e){if(e&&vu())return Math.round(window.performance.now()-e)}class Cu extends Zo{constructor(e,r,n){super(e.auth.clientId,e.auth.authority||`${t.DEFAULT_AUTHORITY}`,new at(e.system?.loggerOptions||{},qs,Us),qs,Us,e.telemetry?.application||{appName:"",appVersion:""},r,n)}generateId(){return Ja()}getPageVisibility(){return document.visibilityState?.toString()||null}deleteIncompleteSubMeasurements(e){mu()?.then((t=>{const r=this.eventsByCorrelationId.get(e.event.correlationId),n=r&&r.eventId===e.event.eventId,o=[];n&&r?.incompleteSubMeasurements&&r.incompleteSubMeasurements.forEach((e=>{o.push({...e})})),t.BrowserPerformanceMeasurement.flushMeasurements(e.event.correlationId,o)}))}startMeasurement(e,t){const r=this.getPageVisibility(),n=super.startMeasurement(e,t),o=vu()?window.performance.now():void 0,i=mu()?.then((t=>new t.BrowserPerformanceMeasurement(e,n.event.correlationId)));return i?.then((e=>e.startMeasurement())),{...n,end:(e,t)=>{const a=n.end({...e,startPageVisibility:r,endPageVisibility:this.getPageVisibility(),durationMs:yu(o)},t);return i?.then((e=>e.endMeasurement())),this.deleteIncompleteSubMeasurements(n),a},discard:()=>{n.discard(),i?.then((e=>e.flushMeasurement())),this.deleteIncompleteSubMeasurements(n)}}}setPreQueueTime(e,t){if(!vu())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${e}`);if(!t)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to set telemetry queue time`);const r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${r.name} found`,t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}addQueueMeasurement(e,t,r,n){if(!vu())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${e}`);if(!t)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to add queue measurement`);const o=super.getPreQueueTime(e,t);if(!o)return;const i=window.performance.now(),a=r||super.calculateQueuedTime(o,i);return super.addQueueMeasurement(e,t,a,n)}}
/*! @azure/msal-browser v4.8.0 2025-03-20 */class Tu{constructor(e,t){this.correlationId=t,this.measureName=Tu.makeMeasureName(e,t),this.startMark=Tu.makeStartMark(e,t),this.endMark=Tu.makeEndMark(e,t)}static makeMeasureName(e,t){return`msal.measure.${e}.${t}`}static makeStartMark(e,t){return`msal.start.${e}.${t}`}static makeEndMark(e,t){return`msal.end.${e}.${t}`}static supportsBrowserPerformance(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName}static flushMeasurements(e,t){if(Tu.supportsBrowserPerformance())try{t.forEach((t=>{const r=Tu.makeMeasureName(t.name,e);window.performance.getEntriesByName(r,"measure").length>0&&(window.performance.clearMeasures(r),window.performance.clearMarks(Tu.makeStartMark(r,e)),window.performance.clearMarks(Tu.makeEndMark(r,e)))}))}catch(e){}}startMeasurement(){if(Tu.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}}endMeasurement(){if(Tu.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}}flushMeasurement(){if(Tu.supportsBrowserPerformance())try{const e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){const t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch(e){}return null}}var Iu=Object.freeze({__proto__:null,BrowserPerformanceMeasurement:Tu});const wu={...Qn,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedSSOSilent",EmbeddedClientApplicationSendPopupRequest:"embeddedPopup",EmbeddedClientApplicationSendRedirectRequest:"embeddedRedirect",EmbeddedClientApplicationHandleRedirectRequest:"embeddedHandleRedirect",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedSilentRefresh",SendHandshakeRequest:"sendHandshakeRequest",SendMessageToBroker:"sendMessageToBroker",SendRequest:"sendRequest",HandleResponse:"handleBrokerResponse",GetFrameDepth:"getFrameDepth",OnHandshakeResponse:"onHandshakeResponse",HandleBrokerMessage:"handleBrokerMessage",PostMessageToAllDescendantFrames:"postMessageToAllDescendantFrames",HandleBrokerAuthRequest:"handleBrokerAuthRequest",BrokeredSilentRequest:"brokeredSilentRequest",BrokeredSsoSilentRequest:"brokeredSsoSilentRequest",BrokeredRedirectRequest:"brokeredRedirectRequest",BrokeredPopupRequest:"brokeredPopupRequest",InteractiveBrokerRequest:"interactiveBrokerRequest"},Eu=new Map([[wu.PairwiseBrokerApplicationInitializeBrokering,"PWBInitBrk"],[wu.BrokerClientApplicationHandleBrokerHandshake,"BrkClientHandeBrkHandshake"],[wu.BrokerClientApplicationBrokeredSSOSilentRequest,"BrkClientBrkSSOReq"],[wu.BrokerClientApplicationBrokeredSilentRequest,"BrkClientBrkSltReq"],[wu.EmbeddedClientApplicationSendSSOSilentRequest,"EmbClientSendSSOReq"],[wu.EmbeddedClientApplicationSendPopupRequest,"EmbClientSendPopupReq"],[wu.EmbeddedClientApplicationSendRedirectRequest,"EmbClientSendRedirectReq"],[wu.EmbeddedClientApplicationHandleRedirectRequest,"EmbClientHandleRedirectReq"],[wu.EmbeddedClientApplicationSendSilentRefreshRequest,"EmbClientSendSltRefreshReq"],[wu.SendHandshakeRequest,"sendHandshakeReq"],[wu.SendMessageToBroker,"sendMsgToBrk"],[wu.SendRequest,"sendReq"],[wu.HandleResponse,"handleBrkRes"],[wu.GetFrameDepth,"getFrameDepth"],[wu.OnHandshakeResponse,"onHandshakeRes"],[wu.HandleBrokerMessage,"handleBrkMsg"],[wu.PostMessageToAllDescendantFrames,"postMsgToDescFrames"],[wu.HandleBrokerAuthRequest,"handleBrkAuthReq"],[wu.BrokeredSilentRequest,"brkSltReq"],[wu.BrokeredSsoSilentRequest,"brkSsoSltReq"],[wu.BrokeredRedirectRequest,"brkRedirectReq"],[wu.BrokeredPopupRequest,"brkPopupSltReq"],[wu.InteractiveBrokerRequest,"intBrkReq"]]),ku=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);var Su="object",bu="undefined",Au="prototype",_u=Object,Ru=_u[Au];
/*! https://github.com/nevware21/ts-utils v0.11.7 */
function Pu(e,t){return e||t}function Nu(e,t){return e[t]}var Mu,Ou=void 0,qu=null,Uu="",xu="function",Lu="object",Bu="prototype",Hu="__proto__",Du="undefined",Fu="constructor",Ku="Symbol",zu="_polyfill",Gu="length",ju="name",Qu="call",Wu="toString",Vu=Pu(Object),Yu=Nu(Vu,Bu),$u=Pu(String),Ju=Nu($u,Bu),Xu=Pu(Math),Zu=Pu(Array),el=Nu(Zu,Bu),tl=Nu(el,"slice");function rl(e,t){try{return{v:e.apply(this,t)}}catch(e){return{e:e}}}function nl(e){return function(t){return typeof t===e}}function ol(e){var t="[object "+e+"]";return function(e){return!(!e||function(e){return Yu[Wu].call(e)}(e)!==t)}}function il(e){return typeof e===Du||e===Du}function al(e){return e===qu||il(e)}function sl(e){return!!e||e!==Ou}var cl=nl("string"),ul=nl(xu);function ll(e){return!(!e&&al(e))&&(!!e&&typeof e===Lu)}var dl=Nu(Zu,"isArray"),hl=ol("Date"),pl=nl("number"),gl=nl("boolean"),fl=ol("Error");function ml(e){return!!(e&&e.then&&ul(e.then))}function vl(e){return!(!e||(t=function(){return!(e&&0+e)},r=!e,n=rl(t),n.e?r:n.v));var t,r,n}var yl=Nu(Vu,"getOwnPropertyDescriptor");function Cl(e,t){return!!e&&Yu.hasOwnProperty[Qu](e,t)}var Tl=Pu(Nu(Vu,"hasOwn"),Il);function Il(e,t){return Cl(e,t)||!!yl(e,t)}function wl(e,t,r){if(e&&ll(e))for(var n in e)if(Tl(e,n)&&-1===t[Qu](r||e,n,e[n]))break}var El={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function kl(e){var t={};if(t[El.c]=!0,t[El.e]=!0,e.l){t.get=function(){return e.l.v};var r=yl(e.l,"v");r&&r.set&&(t.set=function(t){e.l.v=t})}return wl(e,(function(e,r){t[El[e]]=sl(r)?r:t[El[e]]})),t}var Sl=Nu(Vu,"defineProperty"),bl=Nu(Vu,"defineProperties");function Al(e,t,r){return Sl(e,t,kl(r))}function _l(e,t){var r={};return wl(t,(function(e,t){r[e]=kl(t)})),bl(e,r)}function Rl(e,t,r,n,o){var i={};return wl(e,(function(e,n){Pl(i,e,t?n:e),Pl(i,n,r?n:e)})),n?n(i):i}function Pl(e,t,r,n){Sl(e,t,{value:r,enumerable:!0,writable:!1})}var Nl=Pu($u),Ml="[object Error]";function Ol(e,t){var r=Uu,n=Yu[Wu][Qu](e);n===Ml&&(e={stack:Nl(e.stack),message:Nl(e.message),name:Nl(e.name)});try{r=((r=JSON.stringify(e,qu,t?"number"==typeof t?t:4:Ou))?r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):qu)||Nl(e)}catch(e){r=" - "+Ol(e,t)}return n+": "+r}function ql(e){throw new Error(e)}function Ul(e){throw new TypeError(e)}var xl=Nu(Vu,"freeze");function Ll(e){return e}function Bl(e){return e[Hu]||qu}var Hl=Nu(Vu,"assign"),Dl=Nu(Vu,"keys");function Fl(e){return xl&&wl(e,(function(e,t){(dl(t)||ll(t))&&Fl(t)})),Kl(e)}var Kl=Pu(xl,Ll),zl=Pu(Nu(Vu,"getPrototypeOf"),Bl);function Gl(e){return Rl(e,0,0,Kl)}var jl,Ql=Gl({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),Wl="__tsUtils$gblCfg";function Vl(){var e;return typeof globalThis!==Du&&(e=globalThis),e||typeof self===Du||(e=self),e||typeof window===Du||(e=window),e||typeof global===Du||(e=global),e}function Yl(){if(!jl){var e=rl(Vl).v||{};jl=e[Wl]=e[Wl]||{}}return jl}var $l=Jl;function Jl(e,t,r){var n=t?t[e]:qu;return function(t){var o=(t?t[e]:qu)||n;if(o||r){var i=arguments;return(o||r).apply(t,o?tl[Qu](i,1):i)}Ul('"'+Nl(e)+'" not defined for '+Ol(t))}}function Xl(e){return function(t){return t[e]}}var Zl=Nu(Xu,"max"),ed=$l("slice",Ju),td=$l("substring",Ju),rd=Jl("substr",Ju,nd);function nd(e,t,r){return al(e)&&Ul("Invalid "+Ol(e)),r<0?Uu:((t=t||0)<0&&(t=Zl(t+e[Gu],0)),il(r)?ed(e,t):ed(e,t,t+r))}function od(e,t){return td(e,0,t)}var id,ad,sd,cd="_urid";function ud(e){var t={description:Nl(e),toString:function(){return Ku+"("+e+")"}};return t[zu]=!0,t}function ld(e){var t=function(){if(!id){var e=Yl();id=e.gblSym=e.gblSym||{k:{},s:{}}}return id}();if(!Tl(t.k,e)){var r=ud(e),n=Dl(t.s).length;r[cd]=function(){return n+"_"+r[Wu]()},t.k[e]=r,t.s[r[cd]()]=Nl(e)}return t.k[e]}function dd(){sd=Yl()}function hd(e){return Sl({toJSON:function(){return e}},"v",{value:e})}var pd,gd="window";function fd(e,t){var r;return function(){return!sd&&dd(),r&&!sd.lzy||(r=hd(rl(e,t).v)),r.v}}function md(e){return!sd&&dd(),pd&&!1!==e&&!sd.lzy||(pd=hd(rl(Vl).v||qu)),pd.v}function vd(e,t){var r;if((r=pd&&!1!==t?pd.v:md(t))&&r[e])return r[e];if(e===gd)try{return window}catch(e){}return qu}function yd(){return!!Cd()}var Cd=fd(vd,["document"]);var Td=fd(vd,[gd]);var Id,wd,Ed,kd=fd(vd,["navigator"]),Sd=fd((function(){return!!rl((function(){return process&&(process.versions||{}).node})).v}));function bd(){return Id=hd(rl(vd,[Ku]).v)}function Ad(e){var t=(sd.lzy?0:Id)||bd();return t.v?t.v[e]:Ou}function _d(){return!sd&&dd(),((sd.lzy?0:Id)||bd()).v}function Rd(e,t){var r=Ql[e];!sd&&dd();var n=(sd.lzy?0:Id)||bd();return n.v?n.v[r||e]:t?Ou:function(e){var t;!ad&&(ad={});var r=Ql[e];return r&&(t=ad[r]=ad[r]||ud(Ku+"."+r)),t}(e)}function Pd(e,t){!sd&&dd();var r=(sd.lzy?0:Id)||bd();return r.v?r.v(e):t?qu:ud(e)}function Nd(e){return!sd&&dd(),((wd=(sd.lzy?0:wd)||hd(rl(Ad,["for"]).v)).v||ld)(e)}function Md(e){return!!e&&ul(e.next)}function Od(e){return!function(e){return e===qu||!sl(e)}(e)&&ul(e[Rd(3)])}function qd(e,t,r){if(e&&(Md(e)||(!Ed&&(Ed=hd(Rd(3))),e=e[Ed.v]?e[Ed.v]():qu),Md(e))){var n=Ou,o=Ou;try{for(var i=0;!(o=e.next()).done&&-1!==t[Qu](r||e,o.value,i,e);)i++}catch(t){n={e:t},e.throw&&(o=qu,e.throw(n))}finally{try{o&&!o.done&&e.return&&e.return(o)}finally{if(n)throw n.e}}}}function Ud(e,t,r){return e.apply(t,r)}function xd(e,t){return!il(t)&&e&&(dl(t)?Ud(e.push,e,t):Md(t)||Od(t)?qd(t,(function(t){e.push(t)})):e.push(t)),e}function Ld(e,t,r){if(e)for(var n=e[Gu]>>>0,o=0;o<n&&(!(o in e)||-1!==t[Qu](r||e,e[o],o,e));o++);}var Bd=$l("indexOf",el);function Hd(e,t,r){return((e?e.slice:qu)||tl).apply(e,tl[Qu](arguments,1))}var Dd,Fd=Pu(Nu(Vu,"create"),Kd);function Kd(e){if(!e)return{};var t=typeof e;function r(){}return t!==Lu&&t!==xu&&Ul("Prototype must be an Object or function: "+Ol(e)),r[Bu]=e,new r}function zd(e,t){var r=Vu.setPrototypeOf||function(e,t){var r;!Dd&&(Dd=hd(((r={})[Hu]=[],r instanceof Array))),Dd.v?e[Hu]=t:wl(t,(function(t,r){return e[t]=r}))};return r(e,t)}function Gd(e,t){t&&(e[ju]=t)}function jd(e,t,r){var n=r||Error,o=n[Bu][ju],i=Error.captureStackTrace;return function(e,t,r){function n(){this[Fu]=t,rl(Al,[this,ju,{v:e,c:!0,e:!1}])}return rl(Al,[t,ju,{v:e,c:!0,e:!1}]),(t=zd(t,r))[Bu]=r===qu?Fd(r):(n[Bu]=r[Bu],new n),t}(e,(function(){var r=this,a=arguments;try{rl(Gd,[n,e]);var s=Ud(n,r,tl[Qu](a))||r;if(s!==r){var c=zl(r);c!==zl(s)&&zd(s,c)}return i&&i(s,r[Fu]),t&&t(s,a),s}finally{rl(Gd,[n,o])}}),n)}function Qd(){return(Date.now||Wd)()}function Wd(){return(new Date).getTime()}function Vd(e){return function(t){return al(t)&&Ul("strTrim called ["+Ol(t)+"]"),t&&t.replace&&(t=t.replace(e,Uu)),t}}var Yd,$d,Jd,Xd=Jl("trim",Ju,Vd(/^\s+|(?=\s)\s+$/g));function Zd(e){if(!e||typeof e!==Lu)return!1;Jd||(Jd=!Td()||Td());var t=!1;if(e!==Jd){$d||(Yd=Function[Bu][Wu],$d=Yd[Qu](Vu));try{var r=zl(e);(t=!r)||(Cl(r,Fu)&&(r=r[Fu]),t=!(!r||typeof r!==xu||Yd[Qu](r)!==$d))}catch(e){}}return t}function eh(e){return e.value&&oh(e),!0}var th=[function(e){var t=e.value;if(dl(t)){var r=e.result=[];return r.length=t.length,e.copyTo(r,t),!0}return!1},oh,function(e){if(e.type===xu)return!0;return!1},function(e){var t=e.value;if(hl(t))return e.result=new Date(t.getTime()),!0;return!1}];function rh(e,t,r,n){var o=r.handler,i=r.path?n?r.path.concat(n):r.path:[],a={handler:r.handler,src:r.src,path:i},s=typeof t,c=!1,u=t===qu;u||(t&&s===Lu?c=Zd(t):u=function(e){return!Mu&&(Mu=["string","number","boolean",Du,"symbol","bigint"]),!(e===Lu||-1===Mu.indexOf(e))}(s));var l={type:s,isPrim:u,isPlain:c,value:t,result:t,path:i,origin:r.src,copy:function(t,n){return rh(e,t,n?a:r,n)},copyTo:function(t,r){return nh(e,t,r,a)}};return l.isPrim?o&&o[Qu](r,l)?l.result:t:function(e,t,r,n){var o;return Ld(e,(function(e){if(e.k===t)return o=e,-1})),o||(o={k:t,v:t},e.push(o),n(o)),o.v}(e,t,0,(function(e){Al(l,"result",{g:function(){return e.v},s:function(t){e.v=t}});for(var t=0,n=o;!(n||(t<th.length?th[t++]:eh))[Qu](r,l);)n=qu}))}function nh(e,t,r,n){if(!al(r))for(var o in r)t[o]=rh(e,r[o],n,o);return t}function oh(e){var t=e.value;if(t&&e.isPlain){var r=e.result={};return e.copyTo(r,t),!0}return!1}function ih(e,t){return Ld(t,(function(t){!function(e,t,r){nh([],e,t,{handler:r,src:t,path:[]})}(e,t)})),e}function ah(e,t,r,n,o,i,a){return ih(rh([],s=e,{handler:c,src:s})||{},tl[Qu](arguments));var s,c}var sh=Xl(Gu);var ch=Jl("endsWith",Ju,uh);function uh(e,t,r){cl(e)||Ul("'"+Ol(e)+"' is not a string");var n=cl(t)?t:Nl(t),o=!il(r)&&r<e[Gu]?r:e[Gu];return td(e,o-n[Gu],o)===n}var lh=$l("indexOf",Ju),dh=Jl("startsWith",Ju,hh);function hh(e,t,r){cl(e)||Ul("'"+Ol(e)+"' is not a string");var n=cl(t)?t:Nl(t),o=r>0?r:0;return td(e,o,o+n[Gu])===n}var ph="ref",gh="unref",fh="hasRef",mh="enabled";function vh(e,t,r){var n=dl(t),o=n?t.length:0,i=(o>0?t[0]:n?Ou:t)||setTimeout,a=(o>1?t[1]:Ou)||clearTimeout,s=r[0];r[0]=function(){c.dn(),Ud(s,Ou,tl[Qu](arguments))};var c=function(e,t,r){var n,o=!0,i=e?t(qu):qu;function a(){return o=!1,i&&i[gh]&&i[gh](),n}function s(){i&&r(i),i=qu}function c(){return i=t(i),o||a(),n}return(n={cancel:s,refresh:c})[fh]=function(){return i&&i[fh]?i[fh]():o},n[ph]=function(){return o=!0,i&&i[ph]&&i[ph](),n},n[gh]=a,{h:n=Sl(n,mh,{get:function(){return!!i},set:function(e){!e&&i&&s(),e&&!i&&c()}}),dn:function(){i=qu}}}(e,(function(e){if(e){if(e.refresh)return e.refresh(),e;Ud(a,Ou,[e])}return Ud(i,Ou,r)}),(function(e){Ud(a,Ou,[e])}));return c.h}function yh(e,t){return vh(!0,Ou,tl[Qu](arguments))}(md()||{}).Symbol,(md()||{}).Reflect;var Ch,Th=function(e,t){return Th=_u.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},Th(e,t)};function Ih(e,t){function r(){this.constructor=e}"function"!=typeof t&&null!==t&&Ul("Class extends value "+String(t)+" is not a constructor or null"),Th(e,t),e[Au]=null===t?Fd(t):(r[Au]=t[Au],new r)}function wh(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}var Eh="constructor",kh="prototype",Sh="function",bh="_dynInstFuncs",Ah="_isDynProxy",_h="_dynClass",Rh="_dynInstChk",Ph=Rh,Nh="_dfOpts",Mh="_unknown_",Oh="__proto__",qh="_dyn"+Oh,Uh="__dynProto$Gbl",xh="_dynInstProto",Lh="useBaseInst",Bh="setInstFuncs",Hh=Object,Dh=Hh.getPrototypeOf,Fh=Hh.getOwnPropertyNames,Kh=md(),zh=Kh[Uh]||(Kh[Uh]={o:(Ch={},Ch[Bh]=!0,Ch[Lh]=!0,Ch),n:1e3});function Gh(e){return e&&(e===Hh[kh]||e===Array[kh])}function jh(e){return Gh(e)||e===Function[kh]}function Qh(e){var t;if(e){if(Dh)return Dh(e);var r=e[Oh]||e[kh]||(e[Eh]?e[Eh][kh]:null);t=e[qh]||r,Cl(e,qh)||(delete e[xh],t=e[qh]=e[xh]||e[qh],e[xh]=r)}return t}function Wh(e,t){var r=[];if(Fh)r=Fh(e);else for(var n in e)"string"==typeof n&&Cl(e,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)t(r[o])}function Vh(e,t,r){return t!==Eh&&typeof e[t]===Sh&&(r||Cl(e,t))&&t!==Oh&&t!==kh}function Yh(e){Ul("DynamicProto: "+e)}function $h(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function Jh(e,t,r,n,o){function i(e,t){var r=function(){var n=function(e,t,r,n){var o=null;if(e&&Cl(r,_h)){var i=e[bh]||Fd(null);if((o=(i[r[_h]]||Fd(null))[t])||Yh("Missing ["+t+"] "+Sh),!o[Rh]&&!1!==i[Ph]){for(var a=!Cl(e,t),s=Qh(e),c=[];a&&s&&!jh(s)&&!$h(c,s);){var u=s[t];if(u){a=u===n;break}c.push(s),s=Qh(s)}try{a&&(e[t]=o),o[Rh]=1}catch(e){i[Ph]=!1}}}return o}(this,t,e,r)||function(e,t,r){var n=t[e];return n===r&&(n=Qh(t)[e]),typeof n!==Sh&&Yh("["+e+"] is not a "+Sh),n}(t,e,r);return n.apply(this,arguments)};return r[Ah]=1,r}if(!Gh(e)){var a=r[bh]=r[bh]||Fd(null);if(!Gh(a)){var s=a[t]=a[t]||Fd(null);!1!==a[Ph]&&(a[Ph]=!!o),Gh(s)||Wh(r,(function(t){Vh(r,t,!1)&&r[t]!==n[t]&&(s[t]=r[t],delete r[t],(!Cl(e,t)||e[t]&&!e[t][Ah])&&(e[t]=i(e,t)))}))}}}function Xh(e,t){return Cl(e,kh)?e.name||t||Mh:((e||{})[Eh]||{}).name||t||Mh}function Zh(e,t,r,n){Cl(e,kh)||Yh("theClass is an invalid class definition.");var o=e[kh];(function(e,t){if(Dh){for(var r=[],n=Qh(t);n&&!jh(n)&&!$h(r,n);){if(n===e)return!0;r.push(n),n=Qh(n)}return!1}return!0})(o,t)||Yh("["+Xh(e)+"] not in hierarchy of ["+Xh(t)+"]");var i=null;Cl(o,_h)?i=o[_h]:(i="_dynCls$"+Xh(e,"_")+"$"+zh.n,zh.n++,o[_h]=i);var a=Zh[Nh],s=!!a[Lh];s&&n&&void 0!==n[Lh]&&(s=!!n[Lh]);var c=function(e){var t=Fd(null);return Wh(e,(function(r){!t[r]&&Vh(e,r,!1)&&(t[r]=e[r])})),t}(t),u=function(e,t,r,n){function o(e,t,r){var o=t[r];if(o[Ah]&&n){var i=e[bh]||{};!1!==i[Ph]&&(o=(i[t[_h]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var i=Fd(null);Wh(r,(function(e){i[e]=o(t,r,e)}));for(var a=Qh(e),s=[];a&&!jh(a)&&!$h(s,a);)Wh(a,(function(e){!i[e]&&Vh(a,e,!Dh)&&(i[e]=o(t,a,e))})),s.push(a),a=Qh(a);return i}(o,t,c,s);r(t,u);var l=!!Dh&&!!a[Bh];l&&n&&(l=!!n[Bh]),Jh(o,i,t,c,!1!==l)}Zh[Nh]=zh.o;var ep,tp=function(e){return Rl(e,1,0,Kl)},rp=function(e){return function(e){var t={};return wl(e,(function(e,r){Pl(t,e,r[1]),Pl(t,r[0],r[1])})),Kl(t)}(e)},np=tp({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),op=tp({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),ip="toLowerCase",ap="blkVal",sp="length",cp="rdOnly",up="notify",lp="warnToConsole",dp="throwInternal",hp="setDf",pp="watch",gp="logger",fp="apply",mp="push",vp="splice",yp="hdlr",Cp="cancel",Tp="initialize",Ip="identifier",wp="removeNotificationListener",Ep="addNotificationListener",kp="isInitialized",Sp="instrumentationKey",bp="INACTIVE",Ap="value",_p="getNotifyMgr",Rp="getPlugin",Pp="name",Np="iKey",Mp="time",Op="processNext",qp="getProcessTelContext",Up="pollInternalLogs",xp="enabled",Lp="stopPollingInternalLogs",Bp="unload",Hp="onComplete",Dp="version",Fp="loggingLevelConsole",Kp="createNew",zp="teardown",Gp="messageId",jp="message",Qp="isAsync",Wp="diagLog",Vp="_doTeardown",Yp="update",$p="getNext",Jp="setNextPlugin",Xp="protocol",Zp="userAgent",eg="split",tg="nodeType",rg="replace",ng="type",og="handler",ig="status",ag="getResponseHeader",sg="getAllResponseHeaders",cg="isChildEvt",ug="data",lg="getCtx",dg="setCtx",hg="complete",pg="urlString",gg="sendPOST",fg="headers",mg="timeout",vg="setRequestHeader",yg="traceId",Cg="spanId",Tg="traceFlags";
/*!
     * NevWare21 Solutions LLC - ts-async, 0.5.4
     * https://github.com/nevware21/ts-async
     * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.
     * Licensed under the MIT license.
     */
var Ig="Promise",wg="rejected";function Eg(e,t){return kg(e,(function(e){return t?t({status:"fulfilled",rejected:!1,value:e}):e}),(function(e){return t?t({status:wg,rejected:!0,reason:e}):e}))}function kg(e,t,r,n){var o=e;try{if(ml(e))(t||r)&&(o=e.then(t,r));else try{t&&(o=t(e))}catch(e){if(!r)throw e;o=r(e)}}finally{n&&function(e,t){var r=e;t&&(ml(e)?r=e.finally?e.finally(t):e.then((function(e){return t(),e}),(function(e){throw t(),e})):t())}(o,n)}return o}var Sg,bg=["pending","resolving","resolved",wg],Ag="dispatchEvent";function _g(e){var t;return e&&e.createEvent&&(t=e.createEvent("Event")),!!t&&t.initEvent}var Rg,Pg,Ng,Mg,Og="unhandledRejection",qg=Og.toLowerCase(),Ug=[],xg=0,Lg=10;function Bg(e){return ul(e)?e.toString():Ol(e)}function Hg(e,t,r){var n,o,i=Hd(arguments,3),a=0,s=!1,c=[],u=xg++,l=!1,d=null;function h(t,r){try{return Ug.push(u),l=!0,d&&d.cancel(),d=null,e((function(e,o){c.push((function(){try{var i=2===a?t:r,s=il(i)?n:ul(i)?i(n):i;ml(s)?s.then(e,o):i?e(s):3===a?o(s):e(s)}catch(e){o(e)}})),s&&g()}),i)}finally{Ug.pop()}}function p(){return bg[a]}function g(){if(c.length>0){var e=c.slice();c=[],l=!0,d&&d.cancel(),d=null,t(e)}}function f(e,t){return function(r){if(a===t){if(2===e&&ml(r))return a=1,void r.then(f(2,1),f(3,1));a=e,s=!0,n=r,g(),l||3!==e||d||(d=yh(m,Lg))}}}function m(){if(!l)if(l=!0,Sd())process.emit(Og,n,o);else{var e=Td()||md();!Rg&&(Rg=hd(rl(vd,[Ig+"RejectionEvent"]).v)),function(e,t,r,n){var o=Cd();!Sg&&(Sg=hd(!!rl(_g,[o]).v));var i=Sg.v?o.createEvent("Event"):n?new Event(t):{};if(r&&r(i),Sg.v&&i.initEvent(t,!1,!0),i&&e[Ag])e[Ag](i);else{var a=e["on"+t];if(a)a(i);else{var s=vd("console");s&&(s.error||s.log)(t,Ol(i))}}}(e,qg,(function(e){return Al(e,"promise",{g:function(){return o}}),e.reason=n,e}),!!Rg.v)}}return Sl(o={then:h,catch:function(e){return h(void 0,e)},finally:function(e){var t=e,r=e;return ul(e)&&(t=function(t){return e&&e(),t},r=function(t){throw e&&e(),t}),h(t,r)}},"state",{get:p}),_d()&&(o[Rd(11)]="IPromise"),o.toString=function(){return"IPromise "+p()+(s?" - "+Bg(n):"")},function(){ul(r)||Ul(Ig+": executor is not a function - "+Bg(r));var e=f(3,0);try{r.call(o,f(2,0),e)}catch(t){e(t)}}(),o}function Dg(e){return function(t){var r=Hd(arguments,1);return e((function(e,r){try{var n=[],o=1;qd(t,(function(t,i){t&&(o++,kg(t,(function(t){n[i]=t,0==--o&&e(n)}),r))})),0===--o&&e(n)}catch(e){r(e)}}),r)}}function Fg(e){Ld(e,(function(e){try{e()}catch(e){}}))}function Kg(e,t){return Hg(Kg,function(e){var t=pl(e)?e:0;return function(e){yh((function(){Fg(e)}),t)}}(t),e,t)}function zg(e,t){!Pg&&(Pg=hd(rl(vd,[Ig]).v||null));var r=Pg.v;if(!r)return Kg(e);ul(e)||Ul(Ig+": executor is not a function - "+Ol(e));var n=0;var o=new r((function(t,r){e((function(e){n=2,t(e)}),(function(e){n=3,r(e)}))}));return Sl(o,"state",{get:function(){return bg[n]}}),o}function Gg(e){return Hg(Gg,Fg,e)}function jg(e,t){var r;return!Ng&&(r=Gg,Ng=hd((function(e){var t=Hd(arguments,1);return r((function(t,r){var n=[],o=1;function i(e,r){o++,Eg(e,(function(e){e.rejected?n[r]={status:wg,reason:e.reason}:n[r]={status:"fulfilled",value:e.value},0==--o&&t(n)}))}try{dl(e)?Ld(e,i):Od(e)?qd(e,i):Ul("Input is not an iterable"),0==--o&&t(n)}catch(e){r(e)}}),t)}))),Ng.v(e,t)}function Qg(e,t){return!Mg&&(Mg=hd(zg)),Mg.v.call(this,e,t)}var Wg=Dg(Qg),Vg=void 0,Yg="",$g="channels",Jg="core",Xg="createPerfMgr",Zg="disabled",ef="extensionConfig",tf="extensions",rf="processTelemetry",nf="priority",of="eventsSent",af="eventsDiscarded",sf="eventsSendRequest",cf="perfEvent",uf="offlineEventsStored",lf="offlineBatchSent",df="offlineBatchDrop",hf="getPerfMgr",pf="domain",gf="path",ff="Not dynamic - ",mf=/-([a-z])/g,vf=/([^\w\d_$])/g,yf=/^(\d+[\w\d_$])/;function Cf(e){return!al(e)}function Tf(e){var t=e;return t&&cl(t)&&(t=(t=(t=t[rg](mf,(function(e,t){return t.toUpperCase()})))[rg](vf,"_"))[rg](yf,(function(e,t){return"_"+t}))),t}function If(e,t){return!(!e||!t)&&-1!==lh(e,t)}function wf(e){return e&&e.toISOString()||""}function Ef(e){return fl(e)?e[Pp]:Yg}function kf(e,t,r,n,o){var i=r;return e&&((i=e[t])===r||o&&!o(i)||n&&!n(r)||(i=r,e[t]=i)),i}function Sf(e,t,r,n,o){e&&t&&r&&(!1!==o||il(e[t]))&&(e[t]=function(e,t){var r=null,n=null;return ul(e)?r=e:n=e,function(){var e=arguments;if(r&&(n=r()),n)return n[t][fp](n,e)}}(r,n))}function bf(e,t,r,n){return e&&t&&ll(e)&&dl(r)&&Ld(r,(function(r){cl(r)&&Sf(e,r,t,r,n)})),e}function Af(e){return e&&Hl&&(e=_u(Hl({},e))),e}function _f(e){try{return e.responseText}catch(e){}return null}function Rf(e,t){return e?"XMLHttpRequest,Status:"+e[ig]+",Response:"+_f(e)||e.response||"":t}function Pf(e,t){return t&&(pl(t)?e=[t].concat(e):dl(t)&&(e=t.concat(e))),e}var Nf="withCredentials";function Mf(e,t,r){if(!e[r]&&t&&t[ag]){var n=t[ag](r);n&&(e[r]=Xd(n))}return e}function Of(e,t){var r,n,o={};return e[sg]?(r=e[sg](),n={},cl(r)&&Ld(Xd(r)[eg](/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=Xd(e.substring(0,t))[ip](),o=Xd(e.substring(t+1));n[r]=o}else n[Xd(e)]=1}})),o=n):t&&(o=Mf(o,e,"time-delta-millis"),o=Mf(o,e,"kill-duration"),o=Mf(o,e,"kill-duration-seconds")),o}var qf="location",Uf="console",xf="JSON",Lf="crypto",Bf="msCrypto",Hf="msie",Df="trident/",Ff="XMLHttpRequest",Kf=null,zf=null,Gf=!1,jf=null,Qf=null;function Wf(e,t){var r=!1;if(e){try{if(!(r=t in e)){var n=e[Au];n&&(r=t in n)}}catch(e){}if(!r)try{r=!il((new e)[t])}catch(e){}}return r}function Vf(e){if(e&&Gf){var t=vd("__mockLocation");if(t)return t}return typeof location===Su&&location?location:vd(qf)}function Yf(){return Boolean(typeof JSON===Su&&JSON||null!==vd(xf))}function $f(){var e=kd();return!(!e||!e.product)&&"ReactNative"===e.product}function Jf(){var e=kd();if(e&&(e[Zp]!==zf||null===Kf)){var t=((zf=e[Zp])||Yg)[ip]();Kf=If(t,Hf)||If(t,Df)}return Kf}function Xf(e){return null!==Qf&&!1!==e||(Qf=!!kd()&&Boolean(kd().sendBeacon)),Qf}function Zf(e){var t=!1;try{t=!!vd("fetch");var r=vd("Request");t&&e&&r&&(t=Wf(r,"keepalive"))}catch(e){}return t}function em(){return null===jf&&(jf=typeof XDomainRequest!==bu)&&tm()&&(jf=jf&&!Wf(vd(Ff),"withCredentials")),jf}function tm(){var e=!1;try{e=!!vd(Ff)}catch(e){}return e}var rm=4294967296,nm=4294967295,om=123456789,im=987654321,am=!1,sm=om,cm=im;function um(){try{var e=2147483647&Qd();(t=(Math.random()*rm^e)+e)<0&&(t>>>=0),sm=om+t&nm,cm=im-t&nm,am=!0}catch(e){}var t}function lm(e){var t=0,r=vd(Lf)||vd(Bf);return r&&r.getRandomValues&&(t=r.getRandomValues(new Uint32Array(1))[0]&nm),0===t&&Jf()&&(am||um(),t=function(e){var t=((cm=36969*(65535&cm)+(cm>>16)&nm)<<16)+(65535&(sm=18e3*(65535&sm)+(sm>>16)&nm))>>>0&nm;e||(t>>>=0);return t}()&nm),0===t&&(t=Math.floor(rm*Math.random()|0)),e||(t>>>=0),t}function dm(e){void 0===e&&(e=22);for(var t=lm()>>>0,r=0,n=Yg;n[sp]<e;)r++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===r&&(t=(lm()<<2&4294967295|3&t)>>>0,r=0);return n}var hm="3.3.5",pm="."+dm(6),gm=0;function fm(e){return 1===e[tg]||9===e[tg]||!+e[tg]}function mm(e,t){return void 0===t&&(t=!1),Tf(e+gm+++(t?"."+hm:Yg)+pm)}function vm(e){var t={id:mm("_aiData-"+(e||Yg)+"."+hm),accept:function(e){return fm(e)},get:function(e,r,n,o){var i=e[t.id];return i?i[Tf(r)]:(o&&(i=function(e,t){var r=t[e.id];if(!r){r={};try{fm(t)&&Al(t,e.id,{e:!1,v:r})}catch(e){}}return r}(t,e),i[Tf(r)]=n),n)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}function ym(e){return e&&ll(e)&&(e.isVal||e.fb||Tl(e,"v")||Tl(e,"mrg")||Tl(e,"ref")||e.set)}function Cm(e,t,r){var n,o=r.dfVal||sl;if(t&&r.fb){var i=r.fb;dl(i)||(i=[i]);for(var a=0;a<i[sp];a++){var s=i[a],c=t[s];if(o(c)?n=c:e&&(o(c=e.cfg[s])&&(n=c),e.set(e.cfg,Nl(s),c)),o(n))break}}return!o(n)&&o(r.v)&&(n=r.v),n}function Tm(e,t,r){var n,o=r;(r&&ym(r)&&(o=Cm(e,t,r)),o)&&(ym(o)&&(o=Tm(e,t,o)),dl(o)?(n=[])[sp]=o[sp]:Zd(o)&&(n={}),n&&(wl(o,(function(r,o){o&&ym(o)&&(o=Tm(e,t,o)),n[r]=o})),o=n));return o}function Im(e,t,r,n){var o,i,a,s,c,u,l,d,h=n;ym(h)?(o=h.isVal,i=h.set,u=h[cp],l=h[ap],s=h.mrg,!(c=h.ref)&&il(c)&&(c=!!s),a=Cm(e,t,h)):a=n,l&&e[ap](t,r);var p=!0,g=t[r];!g&&al(g)||(d=g,p=!1,o&&d!==a&&!o(d)&&(d=a,p=!0),i&&(p=(d=i(d,a,t))===a)),p?d=a?Tm(e,t,a):a:(Zd(d)||dl(a))&&s&&a&&(Zd(a)||dl(a))&&wl(a,(function(t,r){Im(e,d,t,r)})),e.set(t,r,d),c&&e.ref(t,r),u&&e[cp](t,r)}var wm=Nd("[[ai_dynCfg_1]]"),Em=Nd("[[ai_blkDynCfg_1]]"),km=Nd("[[ai_frcDynCfg_1]]");function Sm(e){var t;if(e&&(dl(e)?(t=[])[sp]=e[sp]:Zd(e)&&(t={}),t))return wl(e,(function(e,r){t[e]=Sm(r)})),t;return e}function bm(e,t,r){var n=!1;return r&&!e[t.blkVal]&&((n=r[km])||r[Em]||(n=Zd(r)||dl(r))),n}function Am(e){Ul("InvalidAccess:"+e)}var _m=["push","pop","shift","unshift","splice"],Rm=function(e,t,r,n){e&&e[dp](3,108,"".concat(r," [").concat(t,"] failed - ")+Ol(n))};function Pm(e,t){var r=yl(e,t);return r&&r.get}function Nm(e,t,r,n){if(t){var o=Pm(t,r);o&&!!o[e.prop]?t[r]=n:function(e,t,r,n){var o={n:r,h:[],trk:function(t){t&&t.fn&&(-1===Bd(o.h,t)&&o.h[mp](t),e.trk(t,o))},clr:function(e){var t=Bd(o.h,e);-1!==t&&o.h[vp](t,1)}},i=!0,a=!1;function s(){i&&(a=a||bm(s,e,n),n&&!n[wm]&&a&&(n=Om(e,n,r,"Converting")),i=!1);var t=e.act;return t&&o.trk(t),n}s[e.prop]={chng:function(){e.add(o)}},Al(t,o.n,{g:s,s:function(c){if(n!==c){s[e.ro]&&!e.upd&&Am("["+r+"] is read-only:"+Ol(t)),i&&(a=a||bm(s,e,n),i=!1);var u=a&&s[e.rf];if(a)if(u){wl(n,(function(e){n[e]=c?c[e]:Vg}));try{wl(c,(function(t,r){Nm(e,n,t,r)})),c=n}catch(t){Rm((e.hdlr||{})[gp],r,"Assigning",t),a=!1}}else n&&n[wm]&&wl(n,(function(t){var r=Pm(n,t);if(r){var o=r[e.prop];o&&o.chng()}}));if(c!==n){var l=c&&bm(s,e,c);!u&&l&&(c=Om(e,c,r,"Converting")),n=c,a=l}e.add(o)}}})}(e,t,r,n)}return t}function Mm(e,t,r,n){if(t){var o=Pm(t,r),i=o&&!!o[e.prop],a=n&&n[0],s=n&&n[1],c=n&&n[2];if(!i){if(c)try{!function(e){if(e&&(Zd(e)||dl(e)))try{e[Em]=!0}catch(e){}}(t)}catch(t){Rm((e.hdlr||{})[gp],r,"Blocking",t)}try{Nm(e,t,r,t[r]),o=Pm(t,r)}catch(t){Rm((e.hdlr||{})[gp],r,"State",t)}}a&&(o[e.rf]=a),s&&(o[e.ro]=s),c&&(o[e.blkVal]=!0)}return t}function Om(e,t,r,n){try{wl(t,(function(r,n){Nm(e,t,r,n)})),t[wm]||(Sl(t,wm,{get:function(){return e[yp]}}),function(e,t,r){dl(t)&&Ld(_m,(function(n){var o=t[n];t[n]=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=o[fp](this,n);return Om(e,t,r,"Patching"),a}}))}(e,t,r))}catch(t){Rm((e.hdlr||{})[gp],r,n,t)}return t}var qm="[[ai_",Um="]]";function xm(e){var t,r,n=Pd(qm+"get"+e.uid+Um),o=Pd(qm+"ro"+e.uid+Um),i=Pd(qm+"rf"+e.uid+Um),a=Pd(qm+"blkVal"+e.uid+Um),s=Pd(qm+"dtl"+e.uid+Um),c=null,u=null;function l(t,n){var o=r.act;try{r.act=t,t&&t[s]&&(Ld(t[s],(function(e){e.clr(t)})),t[s]=[]),n({cfg:e.cfg,set:e.set.bind(e),setDf:e[hp].bind(e),ref:e.ref.bind(e),rdOnly:e[cp].bind(e)})}catch(t){var i=e[gp];throw i&&i[dp](1,107,Ol(t)),t}finally{r.act=o||null}}function d(){if(c){var e=c;c=null,u&&u[Cp](),u=null;var t=[];if(Ld(e,(function(e){if(e&&(e[s]&&(Ld(e[s],(function(t){t.clr(e)})),e[s]=null),e.fn))try{l(e,e.fn)}catch(e){t[mp](e)}})),c)try{d()}catch(e){t[mp](e)}t[sp]>0&&function(e,t){ep||(ep=jd("AggregationError",(function(e,t){t[sp]>1&&(e.errors=t[1])})));var r=e||"One or more errors occurred.";throw Ld(t,(function(e,t){r+="\n".concat(t," > ").concat(Ol(e))})),new ep(r,t||[])}("Watcher error(s): ",t)}}return(t={prop:n,ro:o,rf:i})[ap]=a,t[yp]=e,t.add=function(e){if(e&&e.h[sp]>0){c||(c=[]),u||(u=yh((function(){u=null,d()}),0));for(var t=0;t<e.h[sp];t++){var r=e.h[t];r&&-1===Bd(c,r)&&c[mp](r)}}},t[up]=d,t.use=l,t.trk=function(e,t){if(e){var r=e[s]=e[s]||[];-1===Bd(r,t)&&r[mp](t)}},r=t}function Lm(e,t,r){var n,o=function(e){if(e){var t=e[wm]||e;if(t.cfg&&(t.cfg===e||t.cfg[wm]===t))return t}return null}(t);if(o)return o;var i,a=mm("dyncfg",!0),s=t&&!1!==r?t:Sm(t);var c=((n={uid:null,cfg:s})[gp]=e,n[up]=function(){i[up]()},n.set=function(t,r,n){try{t=Nm(i,t,r,n)}catch(t){Rm(e,r,"Setting value",t)}return t[r]},n[hp]=function(e,t){return t&&wl(t,(function(t,r){Im(c,e,t,r)})),e},n[pp]=function(e){return function(e,t){var r={fn:t,rm:function(){r.fn=null,e=null,t=null}};return Al(r,"toJSON",{v:function(){return"WatcherHandler"+(r.fn?"":"[X]")}}),e.use(r,t),r}(i,e)},n.ref=function(e,t){var r;return Mm(i,e,t,(r={},r[0]=!0,r))[t]},n[cp]=function(e,t){var r;return Mm(i,e,t,(r={},r[1]=!0,r))[t]},n[ap]=function(e,t){var r;return Mm(i,e,t,(r={},r[2]=!0,r))[t]},n._block=function(e,t){i.use(null,(function(r){var n=i.upd;try{il(t)||(i.upd=t),e(r)}finally{i.upd=n}}))},n);return Al(c,"uid",{c:!1,e:!1,w:!1,v:a}),Om(i=xm(c),s,"config","Creating"),c}function Bm(e,t,r,n){var o=Lm(r,e||{},n);return t&&o[hp](o.cfg,t),o}function Hm(e,t,r){var n=e[wm]||e;return!n.cfg||n.cfg!==e&&n.cfg[wm]!==n?(function(e,t){e?(e[lp](t),e[dp](2,108,t)):Am(t)}(r,ff+Ol(e)),Bm(e,null,r)[pp](t)):n[pp](t)}function Dm(e,t){if(e&&e[Bp])return e[Bp](t)}function Fm(e,t,r){var n;return r||(n=Qg((function(e){r=e}))),e&&sh(e)>0?Eg(Dm(e[0],t),(function(){Fm(Hd(e,1),t,r)})):r(),n}var Km="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function zm(e){return{mrg:!0,v:e}}function Gm(e){return{isVal:cl,v:Nl(e||Yg)}}var jm,Qm,Wm=[of,af,sf,cf],Vm=null;function Ym(e,t){return function(){var r=arguments,n=$m(t);if(n){var o=n.listener;o&&o[e]&&o[e][fp](o,r)}}}function $m(e){var t,r=Vm;return r||!0===e.disableDbgExt||(r=Vm||((t=vd("Microsoft"))&&(Vm=t.ApplicationInsights),Vm)),r?r.ChromeDbgExt:null}var Jm="warnToConsole",Xm={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},Zm=((Qm={})[0]=null,Qm[1]="errorToConsole",Qm[2]=Jm,Qm[3]="debugToConsole",Qm);function ev(e){return e?'"'+e[rg](/\"/g,Yg)+'"':Yg}function tv(e,t){var r=typeof console!==bu?console:vd(Uf);if(r){var n="log";r[e]&&(n=e),ul(r[n])&&r[n](t)}}var rv=function(){function e(e,t,r,n){void 0===r&&(r=!1);var o=this;o[Gp]=e,o[jp]=(r?"AI: ":"AI (Internal): ")+e;var i=Yg;Yf()&&(i=(Yf()?JSON||vd(xf):null).stringify(n));var a=(t?" message:"+ev(t):Yg)+(n?" props:"+ev(i):Yg);o[jp]+=a}return e.dataType="MessageData",e}();function nv(e,t){return(e||{})[gp]||new av(t)}var ov,iv,av=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var r,n,o,i,a,s=0,c={};Zh(e,this,(function(e){function u(t,r){if(!(s>=o)){var i=!0,a="AITR_"+r[Gp];if(c[a]?i=!1:c[a]=!0,i&&(t<=n&&(e.queue[mp](r),s++,l(1===t?"error":"warn",r)),s===o)){var u="Internal events throttle limit per PageView reached for this app.",d=new rv(23,u,!1);e.queue[mp](d),1===t?e.errorToConsole(u):e[lp](u)}}}function l(e,r){var n=$m(t||{});n&&n[Wp]&&n[Wp](e,r)}a=function(t){return Hm(Bm(t,Xm,e).cfg,(function(e){var t=e.cfg;r=t[Fp],n=t.loggingLevelTelemetry,o=t.maxMessageLimit,i=t.enableDebug}))}(t||{}),e.consoleLoggingLevel=function(){return r},e[dp]=function(t,n,o,a,s){void 0===s&&(s=!1);var d=new rv(n,o,s,a);if(i)throw Ol(d);var h=Zm[t]||Jm;if(il(d[jp]))l("throw"+(1===t?"Critical":"Warning"),d);else{if(s){var p=+d[Gp];!c[p]&&r>=t&&(e[h](d[jp]),c[p]=!0)}else r>=t&&e[h](d[jp]);u(t,d)}},e.debugToConsole=function(e){tv("debug",e),l("warning",e)},e[lp]=function(e){tv("warn",e),l("warning",e)},e.errorToConsole=function(e){tv("error",e),l("error",e)},e.resetInternalMessageCount=function(){s=0,c={}},e.logInternalMessage=u,e[Bp]=function(e){a&&a.rm(),a=null}}))}return e.__ieDyn=1,e}();function sv(e){return e||new av}function cv(e,t,r,n,o,i){void 0===i&&(i=!1),sv(e)[dp](t,r,n,o,i)}function uv(e,t){sv(e)[lp](t)}var lv,dv="toGMTString",hv="toUTCString",pv="cookie",gv="expires",fv="isCookieUseDisabled",mv="disableCookiesUsage",vv="_ckMgr",yv=null,Cv=null,Tv=null,Iv={},wv={},Ev=((ov={cookieCfg:zm((iv={},iv[pf]={fb:"cookieDomain",dfVal:Cf},iv.path={fb:"cookiePath",dfVal:Cf},iv.enabled=Vg,iv.ignoreCookies=Vg,iv.blockedCookies=Vg,iv)),cookieDomain:Vg,cookiePath:Vg})[mv]=Vg,ov);function kv(){var e,t;!lv&&(e=function(){return Cd()},t={},!sd&&dd(),t.b=sd.lzy,Sl(t,"v",{configurable:!0,get:function(){var r=e();return sd.lzy||Sl(t,"v",{value:r}),t.b=sd.lzy,r}}),lv=t)}function Sv(e){return!e||e.isEnabled()}function bv(e,t){return!!(t&&e&&dl(e.ignoreCookies))&&-1!==Bd(e.ignoreCookies,t)}function Av(e,t){var r=t[xp];if(al(r)){var n=void 0;il(e[fv])||(n=!e[fv]),il(e[mv])||(n=!e[mv]),r=n}return r}function _v(e,t){var r;if(e)r=e.getCookieMgr();else if(t){var n=t.cookieCfg;r=n&&n[vv]?n[vv]:Rv(t)}return r||(r=function(e,t){var r=Rv[vv]||wv[vv];return r||(r=Rv[vv]=Rv(e,t),wv[vv]=r),r}(t,(e||{})[gp])),r}function Rv(e,t){var r,n,o,i,a,s,c,u,l;e=Bm(e||wv,null,t).cfg,a=Hm(e,(function(t){t[hp](t.cfg,Ev),n=t.ref(t.cfg,"cookieCfg"),o=n[gf]||"/",i=n[pf],s=!1!==Av(e,n),c=n.getCookie||qv,u=n.setCookie||Uv,l=n.delCookie||Uv}),t);var d=(r={isEnabled:function(){var r=!1!==Av(e,n)&&s&&Pv(t),o=wv[vv];return r&&o&&d!==o&&(r=Sv(o)),r},setEnabled:function(e){s=!1!==e,n[xp]=e},set:function(e,t,r,a,s){var c=!1;if(Sv(d)&&!function(e,t){return!!(t&&e&&dl(e.blockedCookies)&&-1!==Bd(e.blockedCookies,t))||bv(e,t)}(n,e)){var l={},h=Xd(t||Yg),p=lh(h,";");if(-1!==p&&(h=Xd(od(t,p)),l=Nv(td(t,p+1))),kf(l,pf,a||i,vl,il),!al(r)){var g=Jf();if(il(l[gv])){var f=Qd()+1e3*r;if(f>0){var m=new Date;m.setTime(f),kf(l,gv,Mv(m,g?dv:hv)||Mv(m,g?dv:hv)||Yg,vl)}}g||kf(l,"max-age",Yg+r,null,il)}var v=Vf();v&&"https:"===v[Xp]&&(kf(l,"secure",null,null,il),null===Cv&&(Cv=!function(e){if(!cl(e))return!1;if(If(e,"CPU iPhone OS 12")||If(e,"iPad; CPU OS 12"))return!0;if(If(e,"Macintosh; Intel Mac OS X 10_14")&&If(e,"Version/")&&If(e,"Safari"))return!0;if(If(e,"Macintosh; Intel Mac OS X 10_14")&&ch(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))return!0;if(If(e,"Chrome/5")||If(e,"Chrome/6"))return!0;if(If(e,"UnrealEngine")&&!If(e,"Chrome"))return!0;if(If(e,"UCBrowser/12")||If(e,"UCBrowser/11"))return!0;return!1}((kd()||{})[Zp])),Cv&&kf(l,"SameSite","None",null,il)),kf(l,gf,s||o,null,il),u(e,Ov(h,l)),c=!0}return c},get:function(e){var t=Yg;return Sv(d)&&!bv(n,e)&&(t=c(e)),t},del:function(e,t){var r=!1;return Sv(d)&&(r=d.purge(e,t)),r},purge:function(e,r){var n,o=!1;if(Pv(t)){var i=((n={})[gf]=r||"/",n[gv]="Thu, 01 Jan 1970 00:00:01 GMT",n);Jf()||(i["max-age"]="0"),l(e,Ov(Yg,i)),o=!0}return o}},r[Bp]=function(e){a&&a.rm(),a=null},r);return d[vv]=d,d}function Pv(e){if(null===yv){yv=!1,!lv&&kv();try{var t=lv.v||{};yv=void 0!==t[pv]}catch(t){cv(e,2,68,"Cannot access document.cookie - "+Ef(t),{exception:Ol(t)})}}return yv}function Nv(e){var t={};e&&e[sp]&&Ld(Xd(e)[eg](";"),(function(e){if(e=Xd(e||Yg)){var r=lh(e,"=");-1===r?t[e]=null:t[Xd(od(e,r))]=Xd(td(e,r+1))}}));return t}function Mv(e,t){return ul(e[t])?e[t]():null}function Ov(e,t){var r=e||Yg;return wl(t,(function(e,t){r+="; "+e+(al(t)?Yg:"="+t)})),r}function qv(e){var t=Yg;if(!lv&&kv(),lv.v){var r=lv.v[pv]||Yg;Tv!==r&&(Iv=Nv(r),Tv=r),t=Xd(Iv[e]||Yg)}return t}function Uv(e,t){!lv&&kv(),lv.v&&(lv.v[pv]=e+"="+t)}var xv={perfEvtsSendAll:!1};function Lv(e){e.h=null;var t=e.cb;e.cb=[],Ld(t,(function(e){rl(e.fn,[e.arg])}))}function Bv(e,t,r,n){Ld(e,(function(e){e&&e[t]&&(r?(r.cb[mp]({fn:n,arg:e}),r.h=r.h||yh(Lv,0,r)):rl(n,[e]))}))}var Hv=function(){function e(t){var r,n;this.listeners=[];var o=[],i={h:null,cb:[]},a=Bm(t,xv);n=a[pp]((function(e){r=!!e.cfg.perfEvtsSendAll})),Zh(e,this,(function(e){Al(e,"listeners",{g:function(){return o}}),e[Ep]=function(e){o[mp](e)},e[wp]=function(e){for(var t=Bd(o,e);t>-1;)o[vp](t,1),t=Bd(o,e)},e[of]=function(e){Bv(o,of,i,(function(t){t[of](e)}))},e[af]=function(e,t){Bv(o,af,i,(function(r){r[af](e,t)}))},e[sf]=function(e,t){Bv(o,sf,t?i:null,(function(r){r[sf](e,t)}))},e[cf]=function(e){e&&(!r&&e[cg]()||Bv(o,cf,null,(function(t){e[Qp]?yh((function(){return t[cf](e)}),0):t[cf](e)})))},e[uf]=function(e){e&&e[sp]&&Bv(o,uf,i,(function(t){t[uf](e)}))},e[lf]=function(e){e&&e[ug]&&Bv(o,lf,i,(function(t){t[lf](e)}))},e[df]=function(e,t){if(e>0){var r=t||0;Bv(o,df,i,(function(t){t[df](e,r)}))}},e[Bp]=function(e){var t,r=function(){n&&n.rm(),n=null,o=[],i.h&&i.h[Cp](),i.h=null,i.cb=[]};if(Bv(o,"unload",null,(function(r){var n=r[Bp](e);n&&(t||(t=[]),t[mp](n))})),t)return Qg((function(e){return Eg(Wg(t),(function(){r(),e()}))}));r()}}))}return e.__ieDyn=1,e}(),Dv="ctx",Fv="ParentContextKey",Kv="ChildrenContextKey",zv=function(){function e(t,r,n){var o,i=this;(i.start=Qd(),i[Pp]=t,i[Qp]=n,i[cg]=function(){return!1},ul(r))&&Al(i,"payload",{g:function(){return!o&&ul(r)&&(o=r(),r=null),o}});i[lg]=function(t){return t?t===e[Fv]||t===e[Kv]?i[t]:(i[Dv]||{})[t]:null},i[dg]=function(t,r){if(t)if(t===e[Fv])i[t]||(i[cg]=function(){return!0}),i[t]=r;else if(t===e[Kv])i[t]=r;else{(i[Dv]=i[Dv]||{})[t]=r}},i[hg]=function(){var t=0,r=i[lg](e[Kv]);if(dl(r))for(var n=0;n<r[sp];n++){var o=r[n];o&&(t+=o[Mp])}i[Mp]=Qd()-i.start,i.exTime=i[Mp]-t,i[hg]=function(){}}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Gv=function(){function e(t){this.ctx={},Zh(e,this,(function(e){e.create=function(e,t,r){return new zv(e,t,r)},e.fire=function(e){e&&(e[hg](),t&&ul(t[cf])&&t[cf](e))},e[dg]=function(t,r){t&&((e[Dv]=e[Dv]||{})[t]=r)},e[lg]=function(t){return(e[Dv]||{})[t]}}))}return e.__ieDyn=1,e}(),jv="CoreUtils.doPerf";function Qv(e,t,r,n,o){if(e){var i=e;if(i[hf]&&(i=i[hf]()),i){var a=void 0,s=i[lg](jv);try{if(a=i.create(t(),n,o)){if(s&&a[dg]&&(a[dg](zv[Fv],s),s[lg]&&s[dg])){var c=s[lg](zv[Kv]);c||(c=[],s[dg](zv[Kv],c)),c[mp](a)}return i[dg](jv,a),r(a)}}catch(e){a&&a[dg]&&a[dg]("exception",e)}finally{a&&i.fire(a),i[dg](jv,s)}}}return r()}function Wv(){var e=Vv();return td(e,0,8)+"-"+td(e,8,12)+"-"+td(e,12,16)+"-"+td(e,16,20)+"-"+td(e,20)}function Vv(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r=Yg,n=0;n<4;n++)r+=t[15&(e=lm())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var o=t[8+(3&lm())|0];return rd(r,0,8)+rd(r,9,4)+"4"+rd(r,13,3)+o+rd(r,16,3)+rd(r,19,12)}var Yv="00000000000000000000000000000000",$v="0000000000000000";function Jv(e,t,r){return!(!e||e[sp]!==t||e===r)&&!!e.match(/^[\da-f]*$/i)}function Xv(e){return Jv(e,32,Yv)}function Zv(e){return Jv(e,16,$v)}var ey=vm("plugin");function ty(e){return ey.get(e,"state",{},!0)}function ry(e,t){for(var r,n=[],o=null,i=e[$p]();i;){var a=i[Rp]();if(a){o&&o[Jp]&&a[rf]&&o[Jp](a);var s=!!(r=ty(a))[kp];a[kp]&&(s=a[kp]()),s||n[mp](a),o=a,i=i[$p]()}}Ld(n,(function(n){var o=e[Jg]();n[Tp](e.getCfg(),o,t,e[$p]()),r=ty(n),n[Jg]||r[Jg]||(r[Jg]=o),r[kp]=!0,delete r[zp]}))}function ny(e){return e.sort((function(e,t){var r=0;if(t){var n=t[rf];e[rf]?r=n?e[nf]-t[nf]:1:n&&(r=-1)}else r=e?1:-1;return r}))}var oy,iy="TelemetryPluginChain",ay="_hasRun",sy="_getTelCtx",cy=0;function uy(e,t,r,n){var o=null,i=[];t||(t=Bm({},null,r[gp])),null!==n&&(o=n?function(e,t,r){for(;e;){if(e[Rp]()===r)return e;e=e[$p]()}return py([r],t.config||{},t)}(e,r,n):e);var a={_next:function(){var e=o;if(o=e?e[$p]():null,!e){var t=i;t&&t[sp]>0&&(Ld(t,(function(e){try{e.func.call(e.self,e.args)}catch(e){cv(r[gp],2,73,"Unexpected Exception during onComplete - "+Ol(e))}})),i=[])}return e},ctx:{core:function(){return r},diagLog:function(){return nv(r,t.cfg)},getCfg:function(){return t.cfg},getExtCfg:function(e,r){var n=s(e,!0);r&&wl(r,(function(e,r){if(al(n[e])){var o=t.cfg[e];!o&&al(o)||(n[e]=o)}Im(t,n,e,r)}));return t[hp](n,r)},getConfig:function(e,r,n){void 0===n&&(n=!1);var o,i=s(e,!1),a=t.cfg;!i||!i[r]&&al(i[r])?!a[r]&&al(a[r])||(o=a[r]):o=i[r];return o||!al(o)?o:n},hasNext:function(){return!!o},getNext:function(){return o},setNext:function(e){o=e},iterate:function(e){var t;for(;t=a._next();){var r=t[Rp]();r&&e(r)}},onComplete:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];e&&i[mp]({func:e,self:il(t)?a.ctx:t,args:r})}}};function s(e,r){var n=null,o=t.cfg;if(o&&e){var i=o[ef];!i&&r&&(i={}),o[ef]=i,(i=t.ref(o,ef))&&(!(n=i[e])&&r&&(n={}),i[e]=n,n=t.ref(i,e))}return n}return a}function ly(e,t,r,n){var o=Bm(t),i=uy(e,o,r,n),a=i.ctx;return a[Op]=function(e){var t=i._next();return t&&t[rf](e,a),!t},a[Kp]=function(e,t){return void 0===e&&(e=null),dl(e)&&(e=py(e,o.cfg,r,t)),ly(e||a[$p](),o.cfg,r,t)},a}function dy(e,t,r){var n=Bm(t.config),o=uy(e,n,t,r),i=o.ctx;return i[Op]=function(e){var t=o._next();return t&&t[Bp](i,e),!t},i[Kp]=function(e,r){return void 0===e&&(e=null),dl(e)&&(e=py(e,n.cfg,t,r)),dy(e||i[$p](),t,r)},i}function hy(e,t,r){var n=Bm(t.config),o=uy(e,n,t,r).ctx;return o[Op]=function(e){return o.iterate((function(t){ul(t[Yp])&&t[Yp](o,e)}))},o[Kp]=function(e,r){return void 0===e&&(e=null),dl(e)&&(e=py(e,n.cfg,t,r)),hy(e||o[$p](),t,r)},o}function py(e,t,r,n){var o=null,i=!n;if(dl(e)&&e[sp]>0){var a=null;Ld(e,(function(e){if(i||n!==e||(i=!0),i&&e&&ul(e[rf])){var s=function(e,t,r){var n,o=null,i=ul(e[rf]),a=ul(e[Jp]);n=e?e[Ip]+"-"+e[nf]+"-"+cy++:"Unknown-0-"+cy++;var s={getPlugin:function(){return e},getNext:function(){return o},processTelemetry:l,unload:d,update:h,_id:n,_setNext:function(e){o=e}};function c(){var n;return e&&ul(e[sy])&&(n=e[sy]()),n||(n=ly(s,t,r)),n}function u(t,r,i,a,s){var c=!1,u=e?e[Ip]:iy,l=t[ay];return l||(l=t[ay]={}),t.setNext(o),e&&Qv(t[Jg](),(function(){return u+":"+i}),(function(){l[n]=!0;try{var e=o?o._id:Yg;e&&(l[e]=!1),c=r(t)}catch(e){var a=!o||l[o._id];a&&(c=!0),o&&a||cv(t[Wp](),1,73,"Plugin ["+u+"] failed during "+i+" - "+Ol(e)+", run flags: "+Ol(l))}}),a,s),c}function l(t,r){function n(r){if(!e||!i)return!1;var n=ty(e);return!n[zp]&&!n[Zg]&&(a&&e[Jp](o),e[rf](t,r),!0)}u(r=r||c(),n,"processTelemetry",(function(){return{item:t}}),!t.sync)||r[Op](t)}function d(t,r){function n(){var n=!1;if(e){var o=ty(e),i=e[Jg]||o[Jg];!e||i&&i!==t.core()||o[zp]||(o[Jg]=null,o[zp]=!0,o[kp]=!1,e[zp]&&!0===e[zp](t,r)&&(n=!0))}return n}u(t,n,"unload",(function(){}),r[Qp])||t[Op](r)}function h(t,r){function n(){var n=!1;if(e){var o=ty(e),i=e[Jg]||o[Jg];!e||i&&i!==t.core()||o[zp]||e[Yp]&&!0===e[Yp](t,r)&&(n=!0)}return n}u(t,n,"update",(function(){}),!1)||t[Op](r)}return Kl(s)}(e,t,r);o||(o=s),a&&a._setNext(s),a=s}}))}return n&&!o?py([n],t,r):o}function gy(){var e=[];return{add:function(t){t&&e[mp](t)},run:function(t,r){Ld(e,(function(e){try{e(t,r)}catch(e){cv(t[Wp](),2,73,"Unexpected error calling unload handler - "+Ol(e))}})),e=[]}}}function fy(){var e=[];return{run:function(t){var r=e;e=[],Ld(r,(function(e){try{(e.rm||e.remove).call(e)}catch(e){cv(t,2,73,"Unloading:"+Ol(e))}}))},add:function(t){t&&xd(e,t)}}}var my="getPlugin",vy=((oy={})[ef]={isVal:Cf,v:{}},oy),yy=function(){function e(){var t,r,n,o,i,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var o=r||ly(null,{},a[Jg]);t=n&&n[my]?o[Kp](null,n[my]):o[Kp](null,n)}return t}function c(e,t,o){Bm(e,vy,nv(t)),!o&&t&&(o=t[qp]()[$p]());var i=n;n&&n[my]&&(i=n[my]()),a[Jg]=t,r=ly(o,e,t,i)}function u(){t=!1,a[Jg]=null,r=null,n=null,i=fy(),o=gy()}u(),Zh(e,a,(function(e){e[Tp]=function(e,r,n,o){c(e,r,o),t=!0},e[zp]=function(t,r){var a,s=e[Jg];if(s&&(!t||s===t[Jg]())){var c,l=!1,d=t||dy(null,s,n&&n[my]?n[my]():n),h=r||((a={reason:0})[Qp]=!1,a);return e[Vp]&&!0===e[Vp](d,h,p)?c=!0:p(),c}function p(){l||(l=!0,o.run(d,r),i.run(d[Wp]()),!0===c&&d[Op](h),u())}},e[Yp]=function(t,r){var o=e[Jg];if(o&&(!t||o===t[Jg]())){var i,a=!1,s=t||hy(null,o,n&&n[my]?n[my]():n),u=r||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,u,l)?i=!0:l(),i}function l(){a||(a=!0,c(s.getCfg(),s.core(),s[$p]()))}},Sf(e,"_addUnloadCb",(function(){return o}),"add"),Sf(e,"_addHook",(function(){return i}),"add"),Al(e,"_unloadHooks",{g:function(){return i}})})),a[Wp]=function(e){return s(e)[Wp]()},a[kp]=function(){return t},a.setInitialized=function(e){t=e},a[Jp]=function(e){n=e},a[Op]=function(e,t){t?t[Op](e):n&&ul(n[rf])&&n[rf](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}();var Cy,Ty=function(e){function t(){var r,n,o=e.call(this)||this;function i(){r=0,n=[]}return o.identifier="TelemetryInitializerPlugin",o.priority=199,i(),Zh(t,o,(function(e,t){e.addTelemetryInitializer=function(e){return function(e,t,r){var n={id:t,fn:r};return xd(e,n),{remove:function(){Ld(e,(function(t,r){if(t.id===n.id)return e[vp](r,1),-1}))}}}(n,r++,e)},e[rf]=function(t,r){(function(e,t,r){for(var n=!1,o=e[sp],i=0;i<o;++i){var a=e[i];if(a)try{if(!1===a.fn[fp](null,[t])){n=!0;break}}catch(e){cv(r,2,64,"Telemetry initializer failed: "+Ef(e),{exception:Ol(e)},!0)}}return!n})(n,t,r?r[Wp]():e[Wp]())&&e[Op](t,r)},e[Vp]=function(){i()}})),o}return Ih(t,e),t.__ieDyn=1,t}(yy),Iy="Plugins must provide initialize method",wy="SDK is still unloading...",Ey=Fl(((Cy={cookieCfg:{}})[tf]={rdOnly:!0,ref:!0,v:[]},Cy[$g]={rdOnly:!0,ref:!0,v:[]},Cy[ef]={ref:!0,v:{}},Cy[Xg]=Vg,Cy.loggingLevelConsole=0,Cy.diagnosticLogInterval=Vg,Cy));function ky(e,t){return new Gv(t)}function Sy(e,t){var r=!1;return Ld(t,(function(t){if(t===e)return r=!0,-1})),r}function by(e,t,r,n){r&&wl(r,(function(r,o){n&&Zd(o)&&Zd(t[r])&&by(e,t[r],o,n),n&&Zd(o)&&Zd(t[r])?by(e,t[r],o,n):e.set(t,r,o)}))}function Ay(e,t){var r=null,n=-1;return Ld(e,(function(e,o){if(e.w===t)return r=e,n=o,-1})),{i:n,l:r}}function _y(e,t,r,n){return t.add(e[pp]((function(e){var t=e.cfg.disableDbgExt;!0===t&&n&&(r[wp](n),n=null),r&&!n&&!0!==t&&(n=function(e){if(!jm){jm={};for(var t=0;t<Wm[sp];t++)jm[Wm[t]]=Ym(Wm[t],e)}return jm}(e.cfg),r[Ep](n))}))),n}var Ry=function(){function e(){var t,r,n,o,i,a,s,c,u,l,d,h,p,g,f,m,v,y,C,T,I,w,E,k,S,b,A,_,R,P,N,M;Zh(e,this,(function(e){function O(){R=!0,al(I)?(b=op[bp],cv(n,1,112,"ikey can't be resolved from promises")):b=op.ACTIVE,q()}function q(){r&&(e.releaseQueue(),e[Up]())}function U(e){P&&P[xp]||M||(e||n&&n.queue[sp]>0)&&(N||(N=!0,V(t[pp]((function(e){var t=e.cfg.diagnosticLogInterval;t&&t>0||(t=1e4);var r=!1;P&&(r=P[xp],P[Cp]()),P=function(e,t){return vh(!1,Ou,tl[Qu](arguments))}(z,t),P.unref(),P[xp]=r})))),P[xp]=!0);return P}function x(){var e={};k=[];var t=function(t){t&&Ld(t,(function(t){if(t[Ip]&&t[Dp]&&!e[t.identifier]){var r=t[Ip]+"="+t[Dp];k[mp](r),e[t.identifier]=t}}))};t(h),d&&Ld(d,(function(e){t(e)})),t(l)}function L(){r=!1,(t=Bm({},Ey,e[gp])).cfg[Fp]=1,Al(e,"config",{g:function(){return t.cfg},s:function(t){e.updateCfg(t,!1)}}),Al(e,"pluginVersionStringArr",{g:function(){return k||x(),k}}),Al(e,"pluginVersionString",{g:function(){return S||(k||x(),S=k.join(";")),S||Yg}}),Al(e,"logger",{g:function(){return n||(n=new av(t.cfg),t[gp]=n),n},s:function(e){t[gp]=e,n!==e&&(Dm(n,!1),n=e)}}),e[gp]=new av(t.cfg),E=[];var C=e.config[tf]||[];C.splice(0,C[sp]),xd(C,E),g=new Ty,o=[],Dm(i,!1),i=null,a=null,s=null,Dm(c,!1),c=null,u=null,l=[],d=null,h=null,p=!1,f=null,m=mm("AIBaseCore",!0),v=gy(),T=null,I=null,y=fy(),w=[],S=null,k=null,M=!1,P=null,N=!1,b=0,A=null,_=null,R=!1}function B(){var r=ly(F(),t.cfg,e);return r[Hp](U),r}function H(t){var r=function(e,t,r){var n,o=[],i=[],a={};return Ld(r,(function(r){(al(r)||al(r[Tp]))&&ql(Iy);var n=r[nf],s=r[Ip];r&&n&&(al(a[n])?a[n]=s:uv(e,"Two extensions have same priority #"+n+" - "+a[n]+", "+s)),!n||n<t?o[mp](r):i[mp](r)})),(n={})[Jg]=o,n[$g]=i,n}(e[gp],500,l);u=null,S=null,k=null,h=ny(xd(h=(d||[])[0]||[],r[$g]));var n=xd(ny(r[Jg]),h);E=Kl(n);var o=e.config[tf]||[];o.splice(0,o[sp]),xd(o,E);var i=B();h&&h[sp]>0&&ry(i[Kp](h),n),ry(i,n),t&&j(t)}function D(e){var t=null,r=null,n=[];return Ld(E,(function(t){if(t[Ip]===e&&t!==g)return r=t,-1;t.getChannel&&n[mp](t)})),!r&&n[sp]>0&&Ld(n,(function(t){if(!(r=t.getChannel(e)))return-1})),r&&(t={plugin:r,setEnabled:function(e){ty(r)[Zg]=!e},isEnabled:function(){var e=ty(r);return!e[zp]&&!e[Zg]},remove:function(e,t){var n;void 0===e&&(e=!0);var o=[r],i=((n={reason:1})[Qp]=e,n);K(o,i,(function(e){e&&H({reason:32,removed:o}),t&&t(e)}))}}),t}function F(){if(!u){var r=(E||[]).slice();-1===Bd(r,g)&&r[mp](g),u=py(ny(r),t.cfg,e)}return u}function K(r,n,o){if(r&&r[sp]>0){var i=dy(py(r,t.cfg,e),e);i[Hp]((function(){var e=!1,t=[];Ld(l,(function(n,o){Sy(n,r)?e=!0:t[mp](n)})),l=t,S=null,k=null;var n=[];d&&(Ld(d,(function(t,o){var i=[];Ld(t,(function(t){Sy(t,r)?e=!0:i[mp](t)})),n[mp](i)})),d=n),o&&o(e),U()})),i[Op](n)}else o(!1)}function z(){if(n&&n.queue){var t=n.queue.slice(0);n.queue[sp]=0,Ld(t,(function(t){var r,n=((r={})[Pp]=f||"InternalMessageId: "+t[Gp],r[Np]=I,r[Mp]=wf(new Date),r.baseType=rv.dataType,r.baseData={message:t[jp]},r);e.track(n)}))}}function G(e,t,r,n){var o=1,i=!1,a=null;function s(){o--,i&&0===o&&(a&&a[Cp](),a=null,t&&t(i),t=null)}(n=n||5e3,h&&h[sp]>0)&&B()[Kp](h).iterate((function(t){if(t.flush){o++;var i=!1;t.flush(e,(function(){i=!0,s()}),r)||i||(e&&null==a?a=yh((function(){a=null,s()}),n):s())}}));return i=!0,s(),!0}function j(t){var r=hy(F(),e);r[Hp](U),e._updateHook&&!0===e._updateHook(r,t)||r[Op](t)}function Q(t){var r=e[gp];r?(cv(r,2,73,t),U()):ql(t)}function W(t){var r=e[_p]();r&&r[af]([t],2)}function V(e){y.add(e)}L(),e._getDbgPlgTargets=function(){return[E,o]},e[kp]=function(){return r},e.activeStatus=function(){return b},e._setPendingStatus=function(){b=3},e[Tp]=function(o,c,u,g){var f;p&&ql(wy),e[kp]()&&ql("Core cannot be initialized more than once"),t=Bm(o,Ey,u||e[gp],!1),o=t.cfg,V(t[pp]((function(e){var t=e.cfg;if(!(3===b)){_=t.initInMemoMaxSize||100;var i=t[Sp],a=t.endpointUrl;if(al(i)){I=null,b=op[bp];var s="Please provide instrumentation key";r?(cv(n,1,100,s),q()):ql(s)}else{var c=[];if(ml(i)?(c[mp](i),I=null):I=i,ml(a)?(c[mp](a),A=null):A=a,c[sp]){R=!1,b=3;var u=Cf(t.initTimeOut)?t.initTimeOut:5e4,l=jg(c);yh((function(){R||O()}),u),Eg(l,(function(e){try{if(R)return;if(!e.rejected){var t=e[Ap];if(t&&t[sp]){var r=t[0];if(I=r&&r[Ap],t[sp]>1){var n=t[1];A=n&&n[Ap]}}I&&(o[Sp]=I,o.endpointUrl=A)}O()}catch(e){R||O()}}))}else O();var d=e.ref(e.cfg,ef);wl(d,(function(t){e.ref(d,t)}))}}}))),C=_y(t,y,(i=g)&&e[_p](),C),V(t[pp]((function(t){var r,n,o,i;if(t.cfg.enablePerfMgr){var c=t.cfg[Xg];f===c&&f||(c||(c=ky),r=t.cfg,n=Xg,o=c,r?!(i=r[n])&&al(i)&&(i=il(o)?{}:o,r[n]=i):i=il(o)?{}:o,f=c,s=null),a||s||!ul(c)||(s=c(e,e[_p]()))}else s=null,f=null}))),e[gp]=u;var m=o[tf];if((l=[])[mp].apply(l,wh(wh([],c),m)),d=o[$g],H(null),h&&0!==h[sp]||ql("No "+$g+" available"),d&&d[sp]>1){var v=e[Rp]("TeeChannelController");v&&v.plugin||cv(n,1,28,"TeeChannel required")}!function(e,t,r){Ld(t,(function(t){var n=Hm(e,t.w,r);delete t.w,t.rm=function(){n.rm()}}))}(o,w,n),w=null,r=!0,b===op.ACTIVE&&q()},e.getChannels=function(){var e=[];return h&&Ld(h,(function(t){e[mp](t)})),Kl(e)},e.track=function(t){Qv(e[hf](),(function(){return"AppInsightsCore:track"}),(function(){null===t&&(W(t),ql("Invalid telemetry item")),!t[Pp]&&al(t[Pp])&&(W(t),ql("telemetry name required")),t[Np]=t[Np]||I,t[Mp]=t[Mp]||wf(new Date),t.ver=t.ver||"4.0",!p&&e[kp]()&&b===op.ACTIVE?B()[Op](t):b!==op[bp]&&o[sp]<=_&&o[mp](t)}),(function(){return{item:t}}),!t.sync)},e[qp]=B,e[_p]=function(){return i||(i=new Hv(t.cfg),e._notificationManager=i),i},e[Ep]=function(t){e.getNotifyMgr()[Ep](t)},e[wp]=function(e){i&&i[wp](e)},e.getCookieMgr=function(){return c||(c=Rv(t.cfg,e[gp])),c},e.setCookieMgr=function(e){c!==e&&(Dm(c,!1),c=e)},e[hf]=function(){return a||s||null},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return o[sp]},e.releaseQueue=function(){if(r&&o[sp]>0){var e=o;o=[],2===b?Ld(e,(function(e){e[Np]=e[Np]||I,B()[Op](e)})):cv(n,2,20,"core init status is not active")}},e[Up]=function(e){return f=e||null,M=!1,P&&P[Cp](),U(!0)},e[Lp]=function(){M=!0,P&&P[Cp](),z()},bf(e,(function(){return g}),["addTelemetryInitializer"]),e[Bp]=function(t,o,a){var s;void 0===t&&(t=!0),r||ql("SDK is not initialized"),p&&ql(wy);var u,l=((s={reason:50})[Qp]=t,s.flushComplete=!1,s);t&&!o&&(u=Qg((function(e){o=e})));var d=dy(F(),e);return d[Hp]((function(){y.run(e[gp]),Fm([c,i,n],t,(function(){L(),o&&o(l)}))}),e),z(),G(t,(function(t){l.flushComplete=t,p=!0,v.run(d,l),e[Lp](),d[Op](l)}),6,a),u},e[Rp]=D,e.addPlugin=function(e,t,r,n){if(!e)return n&&n(!1),void Q(Iy);var o=D(e[Ip]);if(o&&!t)return n&&n(!1),void Q("Plugin ["+e[Ip]+"] is already loaded!");var i={reason:16};function a(t){l[mp](e),i.added=[e],H(i),n&&n(!0)}if(o){var s=[o.plugin];K(s,{reason:2,isAsync:!!r},(function(e){e?(i.removed=s,i.reason|=32,a()):n&&n(!1)}))}else a()},e.updateCfg=function(r,n){var o;if(void 0===n&&(n=!0),e[kp]()){o={reason:1,cfg:t.cfg,oldCfg:ah({},t.cfg),newConfig:ah({},r),merge:n},r=o.newConfig;var i=t.cfg;r[tf]=i[tf],r[$g]=i[$g]}t._block((function(e){var t=e.cfg;by(e,t,r,n),n||wl(t,(function(n){Tl(r,n)||e.set(t,n,Vg)})),e[hp](t,Ey)}),!0),t[up](),o&&j(o)},e.evtNamespace=function(){return m},e.flush=G,e.getTraceCtx=function(e){var t,r;return T||(r={},T={getName:function(){return r[Pp]},setName:function(e){t&&t.setName(e),r[Pp]=e},getTraceId:function(){return r[yg]},setTraceId:function(e){t&&t.setTraceId(e),Xv(e)&&(r[yg]=e)},getSpanId:function(){return r[Cg]},setSpanId:function(e){t&&t.setSpanId(e),Zv(e)&&(r[Cg]=e)},getTraceFlags:function(){return r[Tg]},setTraceFlags:function(e){t&&t.setTraceFlags(e),r[Tg]=e}}),T},e.setTraceCtx=function(e){T=e||null},e.addUnloadHook=V,Sf(e,"addUnloadCb",(function(){return v}),"add"),e.onCfgChange=function(n){var o,i,a,s;return r?o=Hm(t.cfg,n,e[gp]):((s=Ay(i=w,a=n).l)||(s={w:a,rm:function(){var e=Ay(i,a);-1!==e.i&&i[vp](e.i,1)}},i[mp](s)),o=s),function(e){return Al({rm:function(){e.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(e)+">"}})}(o)},e.getWParam=function(){return yd()||t.cfg.enableWParam?0:-1}}))}return e.__ieDyn=1,e}(),Py="",Ny="&NoResponseBody=true",My="POST",Oy=function(){function e(){var t,r,n,o,i,a,s,c,u,l,d,h,p,g,f=0;Zh(e,this,(function(e,m){var v=!0;function y(e,t){cv(n,2,26,"Failed to send telemetry.",{message:e}),T(t,400,{})}function C(e){y("No endpoint url is provided for the batch",e)}function T(e,t,r,n){try{e&&e(t,r,n)}catch(e){}}function I(e,t){var r=kd(),n=e[pg];if(!n)return C(t),!0;n=e[pg]+(p?Ny:Py);var i=e[ug],a=o?i:new Blob([i],{type:"text/plain;charset=UTF-8"});return r.sendBeacon(n,a)}function w(e,t,r){var a=e[ug];try{if(a)if(I(e,t))T(t,200,{},Py);else{var s=i&&i.beaconOnRetry;s&&ul(s)?s(e,t,I):(c&&c[gg](e,t,!0),cv(n,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(e){o&&uv(n,"Failed to send telemetry using sendBeacon API. Ex:"+Ol(e)),T(t,o?0:400,{},Py)}}function E(e,r,n){var a,s,c,u=e[fg]||{};!n&&t&&(a=Qg((function(e,t){s=e,c=t}))),o&&n&&e.disableXhrSync&&(n=!1);var l=e[pg];if(!l)return C(r),void(s&&s(!1));var d=function(e,t,r,n,o,i){function a(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===o&&(o=!1);var s=new XMLHttpRequest;return n&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",n),r&&a(s,Nf,r),s.open(e,t,!o),r&&a(s,Nf,r),!o&&i&&a(s,"timeout",i),s}(My,l,v,!0,n,e[mg]);function h(t){var n=i&&i.xhrOnComplete;if(n&&ul(n))n(t,r,e);else{var a=_f(t);T(r,t[ig],Of(t,o),a)}}return o||d[vg]("Content-type","application/json"),Ld(Dl(u),(function(e){d[vg](e,u[e])})),d.onreadystatechange=function(){o||(h(d),4===d.readyState&&s&&s(!0))},d.onload=function(){o&&h(d)},d.onerror=function(e){T(r,o?d[ig]:400,Of(d,o),o?Py:Rf(d)),c&&c(e)},d.ontimeout=function(){T(r,o?d[ig]:500,Of(d,o),o?Py:Rf(d)),s&&s(!1)},d.send(e[ug]),a}function k(e,r,n){var a,c,u,l,d=e[pg],h=e[ug],m=o?h:new Blob([h],{type:"application/json"}),y=new Headers,I=h[sp],w=!1,E=!1,k=e[fg]||{},S=((a={method:My,body:m})[Km]=!0,a);e.headers&&Dl(e.headers)[sp]>0&&(Ld(Dl(k),(function(e){y.append(e,k[e])})),S[fg]=y),s?S.credentials=s:v&&o&&(S.credentials="include"),n&&(S.keepalive=!0,f+=I,o?2===e._sendReason&&(w=!0,p&&(d+=Ny)):w=!0);var b=new Request(d,S);try{b[Km]=!0}catch(e){}if(!n&&t&&(c=Qg((function(e,t){u=e,l=t}))),!d)return C(r),void(u&&u(!1));function A(e){T(r,o?0:400,{},o?Py:e)}function _(e,t,n){var o=e[ig],a=i.fetchOnComplete;a&&ul(a)?a(e,r,n||Py,t):T(r,o,{},n||Py)}try{Eg(fetch(o?d:b,o?S:null),(function(t){if(n&&(f-=I,I=0),!E)if(E=!0,t.rejected)A(t.reason&&t.reason[jp]),l&&l(t.reason);else{var r=t[Ap];try{o||r.ok?o&&!r.body?(_(r,null,Py),u&&u(!0)):Eg(r.text(),(function(t){_(r,e,t[Ap]),u&&u(!0)})):(A(r.statusText),u&&u(!1))}catch(e){A(Ol(e)),l&&l(e)}}}))}catch(e){E||(A(Ol(e)),l&&l(e))}return w&&!E&&(E=!0,T(r,200,{}),u&&u(!0)),o&&!E&&e[mg]>0&&g&&g.set((function(){E||(E=!0,T(r,500,{}),u&&u(!0))}),e[mg]),c}function S(e,t,r){var a=Td(),s=new XDomainRequest,c=e[ug];s.onload=function(){var r=_f(s),n=i&&i.xdrOnComplete;n&&ul(n)?n(s,t,e):T(t,200,{},r)},s.onerror=function(){T(t,400,{},o?Py:function(e,t){return e?"XDomainRequest,Response:"+_f(e)||"":t}(s))},s.ontimeout=function(){T(t,500,{})},s.onprogress=function(){};var u=a&&a.location&&a.location[Xp]||"",l=e[pg];if(l){if(!o&&0!==l.lastIndexOf(u,0)){var d="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";return cv(n,2,40,". "+d),void y(d,t)}var h=o?l:l[rg](/^(https?:)/,"");s.open(My,h),e[mg]&&(s[mg]=e[mg]),s.send(c),o&&r?g&&g.set((function(){s.send(c)}),0):s.send(c)}else C(t)}function b(){f=0,r=!1,t=!1,n=null,o=null,i=null,a=null,s=null,c=null,u=!1,l=!1,d=!1,h=!1,p=!1,g=null}b(),e[Tp]=function(t,o){n=o,r&&cv(n,1,28,"Sender is already initialized"),e.SetConfig(t),r=!0},e._getDbgPlgTargets=function(){return[r,o,a,t]},e.SetConfig=function(e){try{if(i=e.senderOnCompleteCallBack||{},a=!!e.disableCredentials,s=e.fetchCredentials,o=!!e.isOneDs,t=!!e.enableSendPromise,u=!!e.disableXhr,l=!!e.disableBeacon,d=!!e.disableBeaconSync,g=e.timeWrapper,p=!!e.addNoResponse,h=!!e.disableFetchKeepAlive,c={sendPOST:E},o||(v=!1),a){var r=Vf();r&&r.protocol&&"file:"===r.protocol[ip]()&&(v=!1)}return!0}catch(e){}return!1},e.getSyncFetchPayload=function(){return f},e.getSenderInst=function(e,t){return e&&e[sp]?function(e,t){var r,n=0,o=null,i=0;for(;null==o&&i<e[sp];)n=e[i],u||1!==n?2!==n||!Zf(t)||t&&h?3!==n||!Xf()||(t?d:l)||(o=w):o=k:em()?o=S:tm()&&(o=E),i++;if(o)return(r={_transport:n,_isSync:t})[gg]=o,r;return null}(e,t):null},e.getFallbackInst=function(){return c},e[Vp]=function(e,t){b()}}))}return e.__ieDyn=1,e}(),qy="on",Uy="attachEvent",xy="addEventListener",Ly="detachEvent",By="removeEventListener",Hy="events",Dy="visibilitychange",Fy="pagehide",Ky="pageshow",zy="unload",Gy="beforeunload",jy=mm("aiEvtPageHide"),Qy=mm("aiEvtPageShow"),Wy=/\.[\.]+/g,Vy=/[\.]+$/,Yy=1,$y=vm("events"),Jy=/^([^.]*)(?:\.(.+)|)/;function Xy(e){return e&&e[rg]?e[rg](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Yg):e}function Zy(e,t){var r;if(t){var n=Yg;dl(t)?(n=Yg,Ld(t,(function(e){(e=Xy(e))&&("."!==e[0]&&(e="."+e),n+=e)}))):n=Xy(t),n&&("."!==n[0]&&(n="."+n),e=(e||Yg)+n)}var o=Jy.exec(e||Yg)||[];return(r={})[ng]=o[1],r.ns=(o[2]||Yg).replace(Wy,".").replace(Vy,Yg)[eg](".").sort().join("."),r}function eC(e,t,r){void 0===r&&(r=!0);var n=$y.get(e,Hy,{},r),o=n[t];return o||(o=n[t]=[]),o}function tC(e,t,r,n){e&&t&&t[ng]&&(e[By]?e[By](t[ng],r,n):e[Ly]&&e[Ly](qy+t[ng],r))}function rC(e,t,r,n){for(var o=t[sp];o--;){var i=t[o];i&&(r.ns&&r.ns!==i.evtName.ns||n&&!n(i)||(tC(e,i.evtName,i[og],i.capture),t[vp](o,1)))}}function nC(e,t){return t?Zy("xx",dl(t)?[e].concat(t):[e,t]).ns[eg]("."):e}function oC(e,t,r,n,o){var i;void 0===o&&(o=!1);var a=!1;if(e)try{var s=Zy(t,n);if(a=function(e,t,r,n){var o=!1;return e&&t&&t[ng]&&r&&(e[xy]?(e[xy](t[ng],r,n),o=!0):e[Uy]&&(e[Uy](qy+t[ng],r),o=!0)),o}(e,s,r,o),a&&$y.accept(e)){var c=((i={guid:Yy++,evtName:s})[og]=r,i.capture=o,i);eC(e,s.type)[mp](c)}}catch(e){}return a}function iC(e,t,r,n,o){if(void 0===o&&(o=!1),e)try{var i=Zy(t,n),a=!1;!function(e,t,r){if(t[ng])rC(e,eC(e,t[ng]),t,r);else{var n=$y.get(e,Hy,{});wl(n,(function(n,o){rC(e,o,t,r)})),0===Dl(n)[sp]&&$y.kill(e,Hy)}}(e,i,(function(e){return!((!i.ns||r)&&e[og]!==r)&&(a=!0,!0)})),a||tC(e,i,r,o)}catch(e){}}function aC(e,t,r,n){var o=!1;return t&&e&&e[sp]>0&&Ld(e,(function(e){e&&(r&&-1!==Bd(r,e)||(o=function(e,t,r){var n=!1,o=Td();o&&(n=oC(o,e,t,r),n=oC(o.body,e,t,r)||n);var i=Cd();return i&&(n=oC(i,e,t,r)||n),n}(e,t,n)||o))})),o}function sC(e,t,r){e&&dl(e)&&Ld(e,(function(e){e&&function(e,t,r){var n=Td();n&&(iC(n,e,t,r),iC(n.body,e,t,r));var o=Cd();o&&iC(o,e,t,r)}(e,t,r)}))}function cC(e,t,r){return function(e,t,r,n){var o=!1;return t&&e&&dl(e)&&!(o=aC(e,t,r,n))&&r&&r[sp]>0&&(o=aC(e,t,null,n)),o}([Gy,zy,Fy],e,t,r)}function uC(e,t,r){var n=nC(jy,r),o=aC([Fy],e,t,n);return t&&-1!==Bd(t,Dy)||(o=aC([Dy],(function(t){var r=Cd();e&&r&&"hidden"===r.visibilityState&&e(t)}),t,n)||o),!o&&t&&(o=uC(e,null,r)),o}function lC(e,t,r){var n=nC(Qy,r),o=aC([Ky],e,t,n);return!(o=aC([Dy],(function(t){var r=Cd();e&&r&&"visible"===r.visibilityState&&e(t)}),t,n)||o)&&t&&(o=lC(e,null,r)),o}var dC,hC="",pC="version",gC="properties",fC="initialize",mC="logger",vC="timings",yC="pollInternalLogs",CC="value",TC="kind",IC="length",wC="processTelemetryStart",EC="1DS-Web-JS-4.3.5",kC=Ru.hasOwnProperty,SC=((dC={})[0]=0,dC[2]=6,dC[1]=1,dC[3]=7,dC[4098]=6,dC[4097]=1,dC[4099]=7,dC);function bC(e){return!(e===hC||al(e))}function AC(e,t,r){if(!t&&!bC(t)||"string"!=typeof e)return null;var n=typeof t;if("string"===n||"number"===n||"boolean"===n||dl(t))t={value:t};else if("object"!==n||kC.call(t,"value")){if(al(t[CC])||t[CC]===hC||!cl(t[CC])&&!pl(t[CC])&&!gl(t[CC])&&!dl(t[CC]))return null}else t={value:r?JSON.stringify(t):t};if(dl(t[CC])&&!(t[CC][IC]>0))return null;if(!al(t[TC])){if(dl(t[CC])||!function(e){if(0===e||e>0&&e<=13||32===e)return!0;return!1}(t[TC]))return null;t[CC]=t[CC].toString()}return t}function _C(e,t,r){var n=-1;if(!il(e))if(t>0&&(32===t?n=8192:t<=13&&(n=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(r))-1===n&&(n=0),n|=r;else{var o=SC[qC(e)]||-1;-1!==n&&-1!==o?n|=o:6===o&&(n=o)}return n}function RC(e,t,r){var n;return void 0===r&&(r=!0),e&&(n=e.get(t),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||hC}function PC(e){void 0===e&&(e="D");var t=Wv();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,hC)),t}function NC(e,t,r,n,o){var i={},a=!1,s=0,c=arguments[IC],u=arguments;for(gl(u[0])&&(a=u[0],s++);s<c;s++){wl(u[s],(function(e,t){a&&t&&ll(t)?dl(t)?(i[e]=i[e]||[],Ld(t,(function(t,r){t&&ll(t)?i[e][r]=NC(!0,i[e][r],t):i[e][r]=t}))):i[e]=NC(!0,i[e],t):i[e]=t}))}return i}var MC=function(){return Qd()};function OC(e,t){var r=e;r[vC]=r[vC]||{},r[vC][wC]=r[vC][wC]||{},r[vC][wC][t]=MC()}function qC(e){var t=0;if(null!=e){var r=typeof e;"string"===r?t=1:"number"===r?t=2:"boolean"===r?t=3:r===Su&&(t=4,dl(e)?(t=4096,e[IC]>0&&(t|=qC(e[0]))):kC.call(e,"value")&&(t=8192|qC(e[CC])))}return t}function UC(e){return e>0}var xC=Fl({endpointUrl:"https://browser.events.data.microsoft.com/OneCollector/1.0/",propertyStorageOverride:{isVal:function(e){!e||e.getProperty&&e.setProperty||ql("Invalid property storage override passed.");return!0}}});var LC,BC=function(e){function t(){var r=e.call(this)||this;return Zh(t,r,(function(e,t){e[fC]=function(r,n,o,i){Qv(e,(function(){return"AppInsightsCore.initialize"}),(function(){try{t[fC](Bm(r,xC,o||e[mC],!1).cfg,n,o,i)}catch(t){var a=e[mC],s=Ol(t);-1!==s.indexOf("channels")&&(s+="\n - Channels must be provided through config.channels only!"),cv(a,1,514,"SDK Initialization Failed - no telemetry will be sent: "+s)}}),(function(){return{config:r,extensions:n,logger:o,notificationManager:i}}))},e.track=function(r){Qv(e,(function(){return"AppInsightsCore.track"}),(function(){var n,o=r;if(o){o[vC]=o[vC]||{},o[vC].trackStart=MC(),(n=o.latency)&&pl(n)&&n>=1&&n<=4||(o.latency=1);var i=o.ext=o.ext||{};i.sdk=i.sdk||{},i.sdk.ver=EC;var a=o.baseData=o.baseData||{};a[gC]=a[gC]||{};var s=a[gC];s[pC]=s[pC]||e.pluginVersionString||hC}t.track(o)}),(function(){return{item:r}}),!r.sync)},e[yC]=function(e){return t[yC](e||"InternalLog")}})),r}return Ih(t,e),t.__ieDyn=1,t}(Ry),HC="locale",DC="ver",FC="name",KC=rp({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),zC=rp({id:[0,"id"],ver:[1,DC],appName:[2,FC],locale:[3,HC],expId:[4,"expId"],env:[5,"env"]}),GC=rp({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),jC=rp({locale:[0,HC],localId:[1,"localId"],id:[2,"id"]}),QC=rp({osName:[0,FC],ver:[1,DC]}),WC=rp({ver:[0,DC],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),VC=rp({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),YC=rp({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),$C=rp({tz:[0,"tz"]}),JC=rp({sessionId:[0,"sesId"]}),XC=rp({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),ZC=rp({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),eT=rp({traceId:[0,"traceID"],traceName:[1,FC],parentId:[2,"parentID"]}),tT=rp({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]});function rT(){return void 0===LC&&(LC=!!oT(0)),LC}function nT(){return rT()?oT(0):null}function oT(e){var t,r,n=null;try{var o=md();if(!o)return null;r=new Date,(n=0===e?o.localStorage:o.sessionStorage)&&ul(n.setItem)&&(n.setItem(r,r),t=n.getItem(r)!==r,n.removeItem(r),t&&(n=null))}catch(e){n=null}return n}
/**
    * Session.ts
    * @copyright Microsoft 2019
    */
function iT(){return this.getId()}function aT(e){this.setId(e)}var sT=function(){function e(){Zh(e,this,(function(e){e.setId=function(t){e.customId=t},e.getId=function(){return cl(e.customId)?e.customId:e.automaticId}}))}return e._staticInit=void Al(e.prototype,"id",{g:iT,s:aT}),e}(),cT="ai_session",uT=function(){function e(t,r,n){var o,i,a,s=nv(t),c=_v(t);Zh(e,this,(function(t){var u=Hm(r,(function(){a=r,t.config=a}));function l(e){var r=t.automaticSession,n=e.split("|");n.length>0&&r.setId(n[0]);try{if(n.length>1){var o=+n[1];r.acquisitionDate=+new Date(o),r.acquisitionDate=r.acquisitionDate>0?r.acquisitionDate:0}if(n.length>2){var i=+n[2];r.renewalDate=+new Date(i),r.renewalDate=r.renewalDate>0?r.renewalDate:0}}catch(e){cv(s,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===r.renewalDate&&cv(s,2,517,"AI session renewal date is 0, session will be reset.")}function d(){var e=t.automaticSession,r=(new Date).getTime(),n=t.config.sessionAsGuid;!il(n)&&n?gl(n)?e.setId(PC()):e.setId(PC(n)):e.setId(dm(a.idLength||22)),e.acquisitionDate=r,e.renewalDate=r,h(e.getId(),e.acquisitionDate,e.renewalDate),rT()||cv(s,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function h(e,r,n){var a=r+t.config.sessionExpirationMs,s=n+t.config.sessionRenewalMs,u=new Date,l=[e,r,n];a<s?u.setTime(a):u.setTime(s);var d=t.config.cookieDomain||null;c.set(i(),l.join("|")+";expires="+u.toUTCString(),null,d),o=(new Date).getTime()}n&&n.add(u),i=function(){return t.config.namePrefix?cT+t.config.namePrefix:cT},t.automaticSession=new sT,t.update=function(){t.automaticSession.getId()||function(){var e=c.get(i());if(e&&ul(e.split))l(e);else{var r=function(e,t){var r=nT();if(null!==r)try{return r.getItem(t)}catch(t){LC=!1,cv(e,1,503,"Browser failed read of local storage. "+t)}return null}(s,i());r&&l(r)}t.automaticSession.getId()||d()}();var r=t.automaticSession,n=t.config,a=(new Date).getTime(),u=a-r.acquisitionDate>n.sessionExpirationMs,p=a-r.renewalDate>n.sessionRenewalMs;if(u||p)d();else{(!o||a-o>e.cookieUpdateInterval)&&(r.renewalDate=a,h(r.getId(),r.acquisitionDate,r.renewalDate))}},t.backup=function(){var e,r,n,o=t.automaticSession;e=o.getId(),r=o.acquisitionDate,n=o.renewalDate,function(e,t,r){var n=nT();if(null!==n)try{return n.setItem(t,r),!0}catch(t){LC=!1,cv(e,1,504,"Browser failed write to local storage. "+t)}}(s,i(),[e,r,n].join("|"))}}))}return e.cookieUpdateInterval=6e4,e}(),lT=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];
/**
    * SessionManager.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function dT(e,t){void 0===t&&(t=lT);var r=null;if(e)for(var n=e.split(","),o=0;o<n.length;o++)hT(n[o],t)&&(r?r+=","+n[o]:r=n[o]);return r}function hT(e,t){if(void 0===t&&(t=lT),!e||e.length<4)return!1;for(var r=!1,n=e.substring(0,3).toString().toUpperCase(),o=0;o<t.length;o++)if(t[o]+":"===n&&e.length<=256){r=!0;break}return r}function pT(){return this.getExpId()}var gT=function(){function e(t,r,n){var o,i=null,a=lT.slice(0),s="Treatments",c=null;Zh(e,this,(function(e){var u,l;if(l=Hm(u=t,(function(){o=r&&r.getCookieMgr(),c=u||{},e.env=c.env||function(e){var t,r={},n=Cd();if(n){t=n&&n.querySelectorAll("meta");for(var o=0;o<t.length;o++){var i=t[o];i.name&&0===i.name.toLowerCase().indexOf(e)&&(r[i.name.replace(e,"")]=i.content)}}return r}("awa-").env})),n&&n.add(l),yd()){var d=Cd().documentElement;d&&(e.locale=d.lang)}function h(e){e!==i&&(i=dT(e,a))}e.getExpId=function(){return c.expId?(h(c.expId),i):(h(RC(o,s)),i)}}))}return e.validateAppExpId=dT,e._staticInit=void Al(e.prototype,"expId",{g:pT}),e}(),fT=function(){},mT=function(){};
/**
    * Cloud.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2020
    */
/**
    * IntWeb.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */
function vT(){return this.getMsfpc()}function yT(){return this.getAnid()}var CT=function(){function e(t,r,n){var o;Zh(e,this,(function(e){var i,a;a=Hm(i=t,(function(){o=r&&r.getCookieMgr();var t=i||{};t.serviceName&&(e.serviceName=t.serviceName)})),n&&n.add(a),e.getMsfpc=function(){return RC(o,"MSFPC")},e.getAnid=function(){return RC(o,"ANON").slice(0,34)}}))}var t;return e._staticInit=(Al(t=e.prototype,"msfpc",{g:vT}),void Al(t,"anid",{g:yT})),e}(),TT=function(){var e=(new Date).getTimezoneOffset(),t=e%60,r=(e-t)/60,n="+";r>0&&(n="-"),r=Math.abs(r),t=Math.abs(t),this.tz=n+(r<10?"0"+r:r.toString())+":"+(t<10?"0"+t:t.toString())},IT={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},wT={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},ET="([\\d,.]+)",kT="([\\d,_,.]+)",ST="Unknown",bT=[{r:IT.WINPHONE,os:"Windows Phone"},{r:IT.WINRT,os:"Windows RT"},{r:IT.WIN,os:"Windows"},{r:IT.IOS,os:"iOS"},{r:IT.ANDROID,os:"Android"},{r:IT.LINUX,os:"Linux"},{r:IT.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:IT.OSX,os:"Mac OS X"}];
/**
    * Loc.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function AT(e,t){return"Windows"===t?_T(e,"Windows NT"):"Android"===t?_T(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X "+kT));if(t){var r=t[1].replace(/_/g,".");if(r){var n=RT(r);return n?r.split(n)[0]:r}}return ST}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS "+kT));if(t){var r=t[1].replace(/_/g,".");if(r){var n=RT(r);return n?r.split(n)[0]:r}}return ST}(e):ST}function _T(e,t){var r=e.match(new RegExp(t+" "+ET));return r?wT[r[1]]?wT[r[1]]:r[1]:ST}function RT(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var PT=function(e,t){var r=null,n=null,o=null,i=null,a=Hm(e,(function(){if((e||{}).populateOperatingSystemInfo){var t=kd()||{},o=e.userAgent||t.userAgent||"",i=(e.userAgentData||{}).platform||(t.userAgentData||{}).platform;if(o){var a=function(e){for(var t=0;t<bT.length;t++){var r=bT[t];if(r.r&&e.match(r.r))return r.os;if(r.s&&-1!==e.indexOf(r.s))return r.os}return ST}(o.toLowerCase());r=a,n=AT(o,a)}r&&r!==ST||!cl(i)||(r=i)}}));t&&t.add(a),Al(this,"name",{s:function(e){o=e},g:function(){return o||r}}),Al(this,"ver",{s:function(e){i=e},g:function(){return i||n}})},NT="MicrosoftApplicationsTelemetryDeviceId";
/**
    * Sdk.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */var MT=function(){function e(t,r,n){var o,i=0;Zh(e,this,(function(e){e.seq=i,e.epoch=lm(!1).toString(),e.getSequenceId=function(){return++i};var a=Hm(t,(function(t){o=r&&r.getCookieMgr();var n=t.cfg.propertyStorageOverride;if(o.isEnabled()||n){var i=function(e,t,r){return t?t.getProperty(r)||"":RC(e,r)}(o,n,NT);i||(i=Wv()),function(e,t,r,n){t?t.setProperty(r,n):e.set(r,n,31536e3)}(o,n,NT,i),e.installId=i}else o.purge(NT)}));n&&n.add(a)}))}return e.__ieDyn=1,e}(),OT=function(e,t,r,n,o){var i=this;i.traceId=t||Vv();var a=Hm(e,(function(){var t=e;if(t.enableDistributedTracing&&!r&&(r=Vv().substring(0,16)),i.parentId=i.parentId||r,t.enableApplicationInsightsTrace&&!n){var o=Vf();o&&o.pathname&&(n=o.pathname)}i.name=i.name||n}));o&&o.add(a)},qT="setLocalId";
/**
    * AITrace.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function UT(){return this.getLocalId()}function xT(e){this[qT](e)}var LT=function(){function e(t,r,n,o){var i,a,s;Zh(e,this,(function(c){var u,l;if(l=Hm(u=r,(function(){if(s=n&&n.getCookieMgr(),i=u,a=null,s&&s.isEnabled()&&(h(),i.enableApplicationInsightsUser)){var r=RC(s,e.userCookieName);if(r){var o=r.split(e.cookieSeparator);o.length>0&&(c.id=o[0])}if(!c.id){c.id=dm(t&&!il(t.idLength)?t.idLength:22);var l=wf(new Date);c.accountAcquisitionDate=l;var d=[c.id,l],p=i.cookieDomain?i.cookieDomain:void 0;s.set(e.userCookieName,d.join(e.cookieSeparator),31536e3,p)}}})),o&&o.add(l),"undefined"!=typeof navigator){var d=navigator;c.locale=d.userLanguage||d.language}function h(){if(!i.hashIdentifiers&&!i.dropIdentifiers){var e=RC(s,"MUID");e&&(a="t:"+e)}return a}c.getLocalId=function(){return a||h()},c[qT]=function(e){a=e}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void Al(e.prototype,"localId",{g:UT,s:xT}),e}(),BT=function(e,t){var r=this;r.popSample=100;var n=Hm(e,(function(){r.eventFlags=0,e.hashIdentifiers&&(r.eventFlags=1048576|r.eventFlags),e.dropIdentifiers&&(r.eventFlags=2097152|r.eventFlags),e.scrubIpOnly&&(r.eventFlags=4194304|r.eventFlags)}));t&&t.add(n)},HT=["Required","Analytics","SocialMedia","Advertising"],DT="([\\d,.]+)",FT="Unknown",KT="Edg/",zT="EdgiOS/",GT=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:KT,b:"Edge"},{ua:zT,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],jT=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];
/**
    * Utc.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function QT(e,t){return t.indexOf(e)>-1}function WT(e,t){for(var r=0;r<t.length;r++)if(e==t[r].brand)return t[r].version;return null}function VT(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE "+DT));if(t)return t[1];var r=e.match(new RegExp("rv:"+DT));if(r)return r[1]}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&(QT(KT,t)?e="Edg":QT(zT,t)&&(e="EdgiOS"));var r=t.match(new RegExp(e+"/"+DT));if(r)return r[1];if("Opera"===e&&(r=t.match(new RegExp("OPR/"+DT))))return r[1];return FT}(t,e)}function YT(){return this.getUserConsent()}var $T=function(){function e(t,r,n){_v(r);var o=t||{},i=null,a=null,s=null,c=null,u=null,l=null,d=null;Zh(e,this,(function(e){var r,h;h=Hm(r=t,(function(){if((o=r).populateBrowserInfo){var e=o.userAgent,t=(o.userAgentData||{}).brands;if(e!==i||t!==a){if(!e||!t||0===t.length){var n=kd();n&&(e=e||n.userAgent||"",t=t||(n.userAgentData||{}).brands)}!function(e,t){if(dl(t))try{for(var r=0;r<jT.length;r++){var n=WT(jT[r].br,t);if(n)return u=jT[r].b,void(l=n)}}catch(e){}if(e){var o=function(e){if(e)for(var t=0;t<GT.length;t++)if(QT(GT[t].ua,e))return GT[t].b;return FT}(e);u=o,l=VT(e,o)}}(e,t),i=e,a=t}}d=gl(o.gpcDataSharingOptIn)?o.gpcDataSharingOptIn:null})),n&&n.add(h);var p=Vf();if(p){var g=p.hostname;g&&(e.domain="file:"===p.protocol?"local":g)}var f=function(){var e={h:0,w:0},t=Td();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=f.w+"X"+f.h,e.getUserConsent=function(){return!1},e.getUserConsentDetails=function(){var e=null;try{var t=o.callback;if(t&&t.userConsentDetails){var r=t.userConsentDetails();if(r){e=o.disableConsentDetailsSanitize?r:{};for(var n=0;n<HT.length;n++){var i=HT[n];e[i]=r[i]||!1}}}return null!==d&&((e=e||{}).GPC_DataSharingOptIn=!!d),e?JSON.stringify(e):null}catch(e){}};_l(e,{userConsent:{g:e.getUserConsent},browser:{s:function(e){s=e},g:function(){return s||u}},browserVer:{s:function(e){c=e},g:function(){return c||l}},gpcDataSharingOptIn:{g:function(){return d},s:function(e){d=gl(e)?e:null,o.gpcDataSharingOptIn=d}}})}))}return e._staticInit=void Al(e.prototype,"userConsent",{g:YT}),e}();
/**
    * TelemetryContext.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function JT(e,t,r,n,o){var i=t.ext[KC[e]];if(i)try{wl(n,(function(e,t){if(cl(t)||pl(t)||gl(t)){var n=i[r[e]];!o&&(n||cl(n)||pl(n)||gl(n))&&(t=n),i[r[e]]=t}}))}catch(e){}return i}var XT,ZT=function(){function e(t,r,n,o){Zh(e,this,(function(e){e.app=new gT(r,n,o),e.cloud=new fT,e.user=new LT(t,r,n,o),e.os=new PT(r,o),e.web=new $T(r,n,o);var i=new MT(t,n,o),a=new CT(r,n,o),s=new BT(r,o);e.loc=new TT,e.device=new mT;var c=new uT(n,r,o);e.session=new sT;var u,l,d,h=void 0,p=(u=new OT(r,h,h,h,o),l=m(),d=u||{},{getName:function(){return d.name},setName:function(e){l&&l.setName(e),d.name=e},getTraceId:function(){return d.traceId},setTraceId:function(e){l&&l.setTraceId(e),Xv(e)&&(d.traceId=e)},getSpanId:function(){return d.parentId},setSpanId:function(e){l&&l.setSpanId(e),Zv(e)&&(d.parentId=e)},getTraceFlags:function(){return d.traceFlags},setTraceFlags:function(e){l&&l.setTraceFlags(e),d.traceFlags=e}}),g=!(r||{}).eventContainExtFields;function f(){var t=e.session;if(t&&cl(t.customId))return t.customId;c.update();var r=c.automaticSession;if(r){var n=r.getId();n&&cl(n)&&(t.automaticId=n)}return t.automaticId}function m(){var e=p;return n&&n.getTraceCtx&&(e=n.getTraceCtx(!1)||p),e}e.getTraceCtx=function(){return p},e.getSessionId=f,e.applyApplicationContext=function(t){var r,n=e.app;JT(4,t,zC,((r={})[0]=n.id,r[1]=n.ver,r[2]=n.name,r[3]=n.locale,r[4]=n.getExpId(),r[5]=n.env,r),g)},e.applyUserContext=function(t){var r,n=e.user;JT(0,t,jC,((r={})[1]=n.getLocalId(),r[0]=n.locale,r[2]=n.id,r),g)},e.applyWebContext=function(t){var r,n=e.web;JT(3,t,GC,((r={})[0]=n.domain,r[1]=n.browser,r[2]=n.browserVer,r[3]=n.screenRes,r[5]=n.getUserConsentDetails(),r[4]=!1,r),g)},e.applyOsContext=function(t){var r,n=e.os;JT(5,t,QC,((r={})[0]=n.name,r[1]=n.ver,r),g)},e.applySdkContext=function(e){var t;JT(6,e,WC,((t={})[2]=i.installId,t[1]=i.getSequenceId(),t[3]=i.epoch,t),g)},e.applyIntWebContext=function(e){var t;JT(7,e,VC,((t={})[0]=a.getMsfpc(),t[1]=a.getAnid(),t[2]=a.serviceName,t),g)},e.applyUtcContext=function(e){var t,r=((t={})[0]=s.popSample,t);s.eventFlags>0&&(r[1]=s.eventFlags),JT(8,e,YC,r,g)},e.applyLocContext=function(t){var r;JT(9,t,$C,((r={})[0]=e.loc.tz,r),g)},e.applySessionContext=function(e){var t;JT(4,e,JC,((t={})[0]=f(),t),g)},e.applyDeviceContext=function(t){var r,n=e.device;JT(1,t,XC,((r={})[0]=n.localId,r[2]=n.make,r[3]=n.model,r[1]=n.deviceClass,r),g)},e.applyCloudContext=function(t){var r,n=e.cloud;JT(10,t,ZC,((r={})[0]=n.role,r[1]=n.roleInstance,r[2]=n.roleVer,r),g)},e.applyAITraceContext=function(e){var t;if(r.enableApplicationInsightsTrace){var n=m();n&&JT(2,e,eT,((t={})[0]=n.getTraceId(),t[1]=n.getName(),t[2]=n.getSpanId(),t),!1)}},e.applyDistributedTraceContext=function(e){var t,r=m();if(r){var n=((t={})[0]=r.getTraceId(),t[1]=r.getSpanId(),t),o=r.getTraceFlags();al(o)||(n[2]=o),JT(11,e,tT,n,!1)}}}))}return e.__ieDyn=1,e}();var eI=[KC[4],KC[0],KC[3],KC[5],KC[6],KC[7],KC[8],KC[9],KC[1],KC[2],KC[11],KC[10]],tI=Fl({populateBrowserInfo:!1,populateOperatingSystemInfo:!1,userAgent:Gm(),userAgentData:zm({brands:XT,mobile:XT,platform:XT}),userConsentCookieName:Gm(),userConsented:!1,serviceName:Gm(),env:Gm(),expId:Gm(),sessionRenewalMs:18e5,sessionExpirationMs:864e5,sessionAsGuid:null,cookieDomain:Gm(),namePrefix:Gm(),enableApplicationInsightsTrace:!1,enableApplicationInsightsUser:!1,hashIdentifiers:!1,dropIdentifiers:!1,scrubIpOnly:!1,callback:zm({userConsentDetails:null}),gpcDataSharingOptIn:XT,idLength:22,enableDistributedTracing:!1,eventContainExtFields:!1}),rI=function(e){function t(){var r,n,o,i=e.call(this)||this;return i.identifier="SystemPropertiesCollector",i.priority=3,i.version="4.3.5",Zh(t,i,(function(e,t){function i(){r=null,n={}}i(),e.initialize=function(n,i,a){t.initialize(n,i,a),function(t){var n=e.identifier,i=e.core;e._addHook(Hm(t,(function(){var e=ly(null,t,i);o=e.getExtCfg(n,tI)}))),r=new ZT(t,o,i,e._unloadHooks),i&&i.setTraceCtx&&i.setTraceCtx(r.getTraceCtx())}(n)},e.processTelemetry=function(t,i){OC(t,e.identifier),i=e._getTelCtx(i);var a,s,c=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},Ld(eI,(function(e){c[e]=c[e]||{}})),r&&(r.applyUtcContext(t),r.applyApplicationContext(t),r.applyUserContext(t),r.applyWebContext(t),r.applyOsContext(t),r.applySdkContext(t),r.applyIntWebContext(t),r.applyLocContext(t),r.applySessionContext(t),r.applyDeviceContext(t),o.enableApplicationInsightsTrace&&r.applyAITraceContext(t),o.enableDistributedTracing&&r.applyDistributedTraceContext(t),r.applyCloudContext(t)),Ld(Dl(c),(function(e){0===Dl(c[e]).length&&delete c[e]})),a=n,s=t.data,a&&wl(a,(function(e,t){s[e]||(s[e]=t)})),e.processNext(t,i)},e.getPropertiesContext=function(){return r},e.setProperty=function(e,t){n[e]=t},e._doTeardown=function(e,t){var n=(e||{}).core();if(n&&n.getTraceCtx&&r){var o=n.getTraceCtx(!1);o&&o===r.getTraceCtx()&&n.setTraceCtx(null)}i()},e._getDbgPlgTargets=function(){return[o]}})),i}return Ih(t,e),t.__ieDyn=1,t}(yy),nI="REAL_TIME",oI="",iI="drop",aI="send",sI="requeue",cI="rspFail",uI="no-cache, no-store",lI="application/x-json-stream",dI="cache-control",hI="content-type",pI="kill-tokens",gI="kill-duration",fI="time-delta-millis",mI="client-version",vI="client-id",yI="time-delta-to-apply-millis",CI="upload-time",TI="apikey",II="AuthMsaDeviceTicket",wI="WebAuthToken",EI="AuthXToken",kI="msfpc",SI="trace",bI="user",AI="allowRequestSending",_I="firstRequestSent",RI="shouldAddClockSkewHeaders",PI="getClockSkewHeaderValue",NI="setClockSkew",MI="length",OI="concat",qI="iKey",UI="count",xI="events",LI="push",BI="split",HI="splice",DI="toLowerCase",FI="hdrs",KI="useHdrs",zI="initialize",GI="setTimeoutOverride",jI="clearTimeoutOverride",QI="overrideEndpointUrl",WI="avoidOptions",VI="enableCompoundKey",YI="disableXhrSync",$I="disableFetchKeepAlive",JI="useSendBeacon",XI="fetchCredentials",ZI="alwaysUseXhrOverride",ew="serializeOfflineEvt",tw="getOfflineRequestDetails",rw="createPayload",nw="createOneDSPayload",ow="payloadBlob",iw="headers",aw="_thePayload",sw="urlString",cw="batches",uw="sendType",lw="addHeader",dw="canSendRequest",hw="sendQueuedRequests",pw="isCompletelyIdle",gw="setUnloading",fw="resume",mw="sendSynchronousBatch",vw="_transport",yw="getWParam",Cw="isBeacon",Tw="timings",Iw="isTeardown",ww="isSync",Ew="data",kw="_sendReason",Sw="setKillSwitchTenants",bw="_backOffTransmission",Aw="identifier",_w="eventsLimitInMem",Rw="autoFlushEventsLimit",Pw="baseData",Nw="sendAttempt",Mw="latency",Ow="sync";
/**
    * EventBatch.ts
    * @author Nev Wylie (newylie)
    * @copyright Microsoft 2020
    */
function qw(e){var t=(e.ext||{}).intweb;return t&&bC(t[kI])?t[kI]:null}function Uw(e){for(var t=null,r=0;null===t&&r<e[MI];r++)t=qw(e[r]);return t}var xw=function(){function e(t,r){var n=r?[][OI](r):[],o=this,i=Uw(n);o[qI]=function(){return t},o.Msfpc=function(){return i||oI},o[UI]=function(){return n[MI]},o[xI]=function(){return n},o.addEvent=function(e){return!!e&&(n[LI](e),i||(i=qw(e)),!0)},o[BI]=function(r,o){var a;if(r<n[MI]){var s=n[MI]-r;al(o)||(s=o<s?o:s),a=n[HI](r,s),i=Uw(n)}return new e(t,a)}}return e.create=function(t,r){return new e(t,r)},e}(),Lw=function(){function e(){var t=!0,r=!0,n=!0,o="use-collector-delta",i=!1;Zh(e,this,(function(e){e[AI]=function(){return t},e[_I]=function(){n&&(n=!1,i||(t=!1))},e[RI]=function(){return r},e[PI]=function(){return o},e[NI]=function(e){i||(e?(o=e,r=!0,i=!0):r=!1,t=!0)}}))}return e.__ieDyn=1,e}(),Bw=function(){function e(){var t={};Zh(e,this,(function(e){e[Sw]=function(e,r){if(e&&r)try{var n=(a=e[BI](","),s=[],a&&Ld(a,(function(e){s[LI](Xd(e))})),s);if("this-request-only"===r)return n;for(var o=1e3*parseInt(r,10),i=0;i<n[MI];++i)t[n[i]]=Qd()+o}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var r=t,n=Xd(e);return void 0!==r[n]&&r[n]>Qd()||(delete r[n],!1)}}))}return e.__ieDyn=1,e}();
/**
    * ClockSkewManager.ts
    * @author Abhilash Panwar (abpanwar)
    * @copyright Microsoft 2018
    */function Hw(e){var t,r=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*r,Math.min(t,6e5)}
/**
    * Serializer.ts
    * @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)
    * @copyright Microsoft 2018-2020
    */var Dw,Fw=2e6,Kw=Math.min(Fw,65e3),zw="metadata",Gw="f",jw=/\./,Qw=function(){function e(t,r,n,o,i,a){var s="data",c="baseData",u=!!o,l=!0,d=r,h={},p=!!a,g=i||_C;Zh(e,this,(function(e){function r(e,t,o,i,a,s,c){wl(e,(function(e,l){var p=null;if(l||bC(l)){var g=o,f=e,m=a,v=t;if(u&&!i&&jw.test(e)){var y=e.split("."),C=y.length;if(C>1){m&&(m=m.slice());for(var T=0;T<C-1;T++){var I=y[T];v=v[I]=v[I]||{},g+="."+I,m&&m.push(I)}f=y[C-1]}}var w=i&&function(e){var t=h[e];return void 0===t&&(e.length>=7&&(t=dh(e,"ext.metadata")||dh(e,"ext.web")),h[e]=t),t}(g);if(p=!w&&d&&d.handleField(g,f)?d.value(g,f,l,n):AC(f,l,n)){var E=p.value;if(v[f]=E,s&&s(m,f,p),c&&"object"==typeof E&&!dl(E)){var k=m;k&&(k=k.slice()).push(f),r(l,E,g+"."+f,i,k,s,c)}}}}))}e.createPayload=function(e,t,r,n,o,i){return{apiKeys:[],payloadBlob:oI,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:r,isBeacon:n,sendType:i,sendReason:o}},e.appendPayload=function(r,n,o){var i=r&&n&&!r.overflow;return i&&Qv(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=n.events(),i=r.payloadBlob,a=r.numEvents,s=!1,c=[],u=[],l=r.isBeacon,d=l?65e3:3984588,h=l?Kw:Fw,p=0,g=0;p<t.length;){var f=t[p];if(f){if(a>=o){r.overflow=n.split(p);break}var m=e.getEventBlob(f);if(m&&m.length<=h){var v=m.length;if(i.length+v>d){r.overflow=n.split(p);break}i&&(i+="\n"),i+=m,++g>20&&(rd(i,0,1),g=0),s=!0,a++}else m?c.push(f):u.push(f),t.splice(p,1),p--}p++}if(c.length>0&&r.sizeExceed.push(xw.create(n.iKey(),c)),u.length>0&&r.failedEvts.push(xw.create(n.iKey(),u)),s){r.batches.push(n),r.payloadBlob=i,r.numEvents=a;var y=n.iKey();-1===Bd(r.apiKeys,y)&&r.apiKeys.push(y)}}),(function(){return{payload:r,theBatch:{iKey:n.iKey(),evts:n.events()},max:o}})),i},e.getEventBlob=function(e){try{return Qv(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=lh(e,"-");if(t>-1)return od(e,t)}return hC}(e.iKey);var n,o={};p||(n=function(e,t,r){!function(e,t,r,n,o){if(o&&t){var i=e(o.value,o.kind,o.propertyType);if(i>-1){var a=t[zw];a||(a=t[zw]={f:{}});var s=a[Gw];if(s||(s=a[Gw]={}),r)for(var c=0;c<r.length;c++){var u=r[c];s[u]||(s[u]={f:{}});var l=s[u][Gw];l||(l=s[u][Gw]={}),s=l}s=s[n]={},dl(o.value)?s.a={t:i}:s.t=i}}}
/**
    * TimeoutOverrideWrapper.ts
    * @author  Nev Wylie (newylie)
    * @copyright Microsoft 2022
    * Simple internal timeout wrapper
    */(g,o,e,t,r)});var i=e.ext;i&&(t.ext=o,wl(i,(function(e,t){r(t,o[e]={},"ext."+e,!0,null,null,!0)})));var a=t[s]={};a.baseType=e.baseType;var u=a[c]={};return r(e.baseData,u,c,!1,[c],n,l),r(e.data,a,s,!1,[],n,l),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function Ww(e,t){return{set:function(r,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return function(e,t,r){return vh(!0,e,tl[Qu](arguments,1))}([e,t],r,n,o)}}}var Vw="sendAttempt",Yw="?cors=true&"+hI[DI]()+"="+lI,$w=((Dw={})[1]=sI,Dw[100]=sI,Dw[200]="sent",Dw[8004]=iI,Dw[8003]=iI,Dw),Jw={},Xw={};function Zw(e,t,r){Jw[e]=t,!1!==r&&(Xw[t]=e)}function eE(e,t){var r=!1;if(e&&t){var n=Dl(e);if(n&&n[MI]>0)for(var o=t[DI](),i=0;i<n[MI];i++){var a=n[i];if(a&&Cl(t,a)&&a[DI]()===o){r=!0;break}}}return r}function tE(e,t,r,n){t&&r&&r[MI]>0&&(n&&Jw[t]?(e[FI][Jw[t]]=r,e[KI]=!0):e.url+="&"+t+"="+r)}Zw(II,II,!1),Zw(mI,mI),Zw(vI,"Client-Id"),Zw(TI,TI),Zw(yI,yI),Zw(CI,CI),Zw(EI,EI);var rE=function(){function e(t,r,n,o){var i,a,s,c,u,l,d,h,p,g,f,m,v,y,C,T,I,w,E,k,S,b,A,_,R,P,N,M,O,q,U,x,L=!1;Zh(e,this,(function(e){!function(){var e;i=null,a=new Bw,s=!1,c=new Lw,L=!1,u=0,l=null,d=null,h=null,p=null,g=!0,f=[],m={},v=[],y=null,C=!1,T=null,I=!1,w=!1,E=e,k=e,S=e,b=e,A=e,_=[],R=e,P=e,N=[],M=!1,O=Ww(),q=!1,U=null}();function B(e,t){try{return U&&U.getSenderInst(e,t)}catch(e){}return null}function H(){try{return{enableSendPromise:!1,isOneDs:!0,disableCredentials:!1,fetchCredentials:x,disableXhr:!1,disableBeacon:!L,disableBeaconSync:!L,disableFetchKeepAlive:S,timeWrapper:O,addNoResponse:A,senderOnCompleteCallBack:{xdrOnComplete:D,fetchOnComplete:F,xhrOnComplete:K,beaconOnRetry:G}}}catch(e){}return null}function D(e,t,r){var n=_f(e);z(t,200,{},n),re(n)}function F(e,t,r,n){var o={},i=e[iw];i&&i.forEach((function(e,t){o[t]=e})),function(e,r,n){z(t,e,r,n),re(n)}(e.status,o,r||oI)}function K(e,t,r){var n=_f(e);z(t,e.status,Of(e,!0),n),re(n)}function z(e,t,r,n){try{e(t,r,n)}catch(e){cv(d,2,518,Ol(e))}}function G(e,t,r){var n=200,o=e[aw],i=e[sw]+(A?"&NoResponseBody=true":oI);try{var a=kd();if(o){var s=!!p.getPlugin("LocalStorage"),c=[],u=[];Ld(o[cw],(function(e){if(c&&e&&e[UI]()>0)for(var t=e[xI](),r=0;r<t[MI];r++){if(!a.sendBeacon(i,y.getEventBlob(t[r]))){c[LI](e[BI](r));break}u[LI](e[r])}else c[LI](e[BI](0))})),u[MI]>0&&(o.sentEvts=u),s||ne(c,8003,o[uw],!0)}else n=0}catch(e){uv(d,"Failed to send telemetry using sendBeacon API. Ex:"+Ol(e)),n=0}finally{z(t,n,{},oI)}}function j(e){return 2===e||3===e}function Q(e){return I&&j(e)&&(e=2),e}function W(){return!s&&u<r}function V(){var e=v;return v=[],e}function Y(e,t,r){var n=!1;return e&&e[MI]>0&&!s&&h[t]&&y&&(n=0!==t||W()&&(r>0||c[AI]())),n}function $(e){var t={};return e&&Ld(e,(function(e,r){t[r]={iKey:e[qI](),evts:e[xI]()}})),t}function J(e,r,n,o,i){if(e&&0!==e[MI])if(s)ne(e,1,o);else{o=Q(o);try{var c=e,u=0!==o;Qv(p,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var c=[],l=null,d=MC(),p=h[o]||(u?h[1]:h[0]),g=p&&p[vw],f=b&&(I||j(o)||3===g||p._isSync&&2===g);Y(e,o,r);){var m=e.shift();m&&m[UI]()>0&&(a.isTenantKilled(m[qI]())?c[LI](m):(l=l||y[rw](r,n,u,f,i,o),y.appendPayload(l,m,t)?null!==l.overflow&&(e=[l.overflow][OI](e),l.overflow=null,ee(l,d,MC(),i),d=MC(),l=null):(ee(l,d,MC(),i),d=MC(),e=[m][OI](e),l=null)))}l&&ee(l,d,MC(),i),e[MI]>0&&(v=e[OI](v)),ne(c,8004,o)}),(function(){return{batches:$(c),retryCount:r,isTeardown:n,isSynchronous:u,sendReason:i,useSendBeacon:j(o),sendType:o}}),!u)}catch(e){cv(d,2,48,"Unexpected Exception sending batch: "+Ol(e))}}}function X(e,t){var r={url:i,hdrs:{},useHdrs:!1};t?(r[FI]=NC(r[FI],m),r.useHdrs=Dl(r.hdrs)[MI]>0):wl(m,(function(e,t){Xw[e]?tE(r,Xw[e],t,!1):(r[FI][e]=t,r[KI]=!0)})),tE(r,vI,"NO_AUTH",t),tE(r,mI,EC,t);var n=oI;Ld(e.apiKeys,(function(e){n[MI]>0&&(n+=","),n+=e})),tE(r,TI,n,t),tE(r,CI,Qd().toString(),t);var o=function(e){for(var t=0;t<e.batches[MI];t++){var r=e[cw][t].Msfpc();if(r)return encodeURIComponent(r)}return oI}(e);if(bC(o)&&(r.url+="&ext.intweb.msfpc="+o),c[RI]()&&tE(r,yI,c[PI](),t),p[yw]){var a=p[yw]();a>=0&&(r.url+="&w="+a)}for(var s=0;s<f[MI];s++)r.url+="&"+f[s].name+"="+f[s].value;return r}function Z(e,t,r){e[t]=e[t]||{},e[t][l.identifier]=r}function ee(t,r,o,i){if(t&&t.payloadBlob&&t.payloadBlob[MI]>0){var s=!!R,f=h[t.sendType];!j(t[uw])&&t[Cw]&&2===t.sendReason&&(f=h[2]||h[3]||f);var m=w;(t.isBeacon||3===f[vw])&&(m=!1);var v=X(t,m);m=m||v[KI];var y=MC();Qv(p,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var h=0;h<t.batches[MI];h++)for(var T=t[cw][h][xI](),w=0;w<T[MI];w++){var b=T[w];if(C){var A=b[Tw]=b[Tw]||{};Z(A,"sendEventStart",y),Z(A,"serializationStart",r),Z(A,"serializationCompleted",o)}b[Vw]>0?b[Vw]++:b[Vw]=1}ne(t[cw],1e3+(i||0),t[uw],!0);var _={data:t[ow],urlString:v.url,headers:v[FI],_thePayload:t,_sendReason:i,timeout:E,disableXhrSync:k,disableFetchKeepAlive:S};m&&(eE(_[iw],dI)||(_[iw][dI]=uI),eE(_[iw],hI)||(_[iw][hI]=lI));var N=null;f&&(N=function(r){c[_I]();var o=function(r,o){!function(t,r,o,i){var s=9e3,d=null,h=!1,p=!1;try{var g=!0;if(typeof t!==bu){if(r){c[NI](r[fI]);var f=r[gI]||r["kill-duration-seconds"];Ld(a[Sw](r[pI],f),(function(e){Ld(o[cw],(function(t){if(t[qI]()===e){d=d||[];var r=t[BI](0);o.numEvents-=r[UI](),d[LI](r)}}))}))}if(200==t||204==t)return void(s=200);((v=t)>=300&&v<500&&429!=v||501==v||505==v||o.numEvents<=0)&&(g=!1),s=9e3+t%1e3}if(g){s=100;var m=o.retryCnt;0===o[uw]&&(m<n?(h=!0,te((function(){0===o[uw]&&u--,J(o[cw],m+1,o[Iw],I?2:o[uw],5)}),I,Hw(m))):(p=!0,I&&(s=8001)))}}finally{h||(c[NI](),function(t,r,n,o){try{o&&l[bw]();var i=t[cw];200===r&&(i=t.sentEvts||t[cw],o||t[ww]||l._clearBackOff(),function(e){if(C){var t=MC();Ld(e,(function(e){e&&e[UI]()>0&&function(e,t){C&&Ld(e,(function(e){Z(e[Tw]=e[Tw]||{},"sendEventCompleted",t)}))}(e[xI](),t)}))}}(i)),ne(i,r,t[uw],!0)}finally{0===t[uw]&&(u--,5!==n&&e.sendQueuedRequests(t[uw],n))}}(o,s,i,p)),ne(d,8004,o[uw])}var v}(r,o,t,i)},s=t[Iw]||t[ww];try{f.sendPOST(r,o,s),P&&P(_,r,s,t[Cw])}catch(e){uv(d,"Unexpected exception sending payload. Ex:"+Ol(e)),z(o,0,{})}}),Qv(p,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(N)if(0===t[uw]&&u++,s&&!t.isBeacon&&3!==f[vw]){var e={data:_[Ew],urlString:_[sw],headers:NC({},_[iw]),timeout:_.timeout,disableXhrSync:_[YI],disableFetchKeepAlive:_[$I]},r=!1;Qv(p,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{R(e,(function(e){r=!0,g||e[aw]||(e[aw]=e[aw]||_[aw],e[kw]=e[kw]||_[kw]),N(e)}),t.isSync||t[Iw])}catch(e){r||N(_)}}))}else N(_)}))}),(function(){return{thePayload:t,serializationStart:r,serializationCompleted:o,sendReason:i}}),t[ww])}t.sizeExceed&&t.sizeExceed[MI]>0&&ne(t.sizeExceed,8003,t[uw]),t.failedEvts&&t.failedEvts[MI]>0&&ne(t.failedEvts,8002,t[uw])}function te(e,t,r){t?e():O.set(e,r)}function re(e){var t=N;try{for(var r=0;r<t[MI];r++)try{t[r](e)}catch(e){cv(d,1,519,"Response handler failed: "+e)}if(e){var n=JSON.parse(e);bC(n.webResult)&&bC(n.webResult[kI])&&T.set("MSFPC",n.webResult[kI],31536e3)}}catch(e){}}function ne(e,t,r,n){if(e&&e[MI]>0&&o){var i=o[function(e){var t=$w[e];bC(t)||(t="oth",e>=9e3&&e<=9999?t=cI:e>=8e3&&e<=8999?t=iI:e>=1e3&&e<=1999&&(t=aI));return t}(t)];if(i){var a=0!==r;Qv(p,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){te((function(){try{i.call(o,e,t,a,r)}catch(e){cv(d,1,74,"send request notification failed: "+e)}}),n||a,0)}),(function(){return{batches:$(e),reason:t,isSync:a,sendSync:n,sendType:r}}),!a)}}}e[zI]=function(e,t,r){M||(p=t,T=t.getCookieMgr(),d=(l=r).diagLog(),xd(_,Hm(e,(function(e){var n,o=e.cfg,a=e.cfg.extensionConfig[r.identifier];O=Ww(a[GI],a[jI]),bC(o.anonCookieName)?function(e,t,r){for(var n=0;n<e[MI];n++)if(e[n].name===t)return void(e[n].value=r);e[LI]({name:t,value:r})}(f,"anoncknm",o.anonCookieName):function(e,t){for(var r=0;r<e[MI];r++)if(e[r].name===t)return void e[HI](r,1)}(f,"anoncknm"),R=a.payloadPreprocessor,P=a.payloadListener;var s=a.httpXHROverride,c=a[QI]?a[QI]:o.endpointUrl;i=c+Yw,w=!!il(a[WI])||!a[WI],C=!a.disableEventTimings;var u=a.valueSanitizer,l=a.stringifyObjects,m=!!o[VI];il(a[VI])||(m=!!a[VI]),E=a.xhrTimeout,k=!!a[YI],S=!!a[$I],A=!1!==a.addNoResponse,q=!!a.excludeCsMetaData,t.getPlugin("LocalStorage")&&(S=!0),L=!$f(),y=new Qw(p,u,l,m,_C,q),al(a[JI])||(L=!!a[JI]),a[XI]&&(x=a[XI]);var v=H();U?U.SetConfig(v):(U=new Oy)[zI](v,d);var T=s,I=a[ZI]?s:null,_=a[ZI]?s:null,N=[3,2];if(!s){g=!1;var M=[];$f()?(M=[2,1],N=[2,1,3]):M=[1,2,3],(s=B(M=Pf(M,a.transports),!1))||uv(d,"No available transport to send events"),T=B(M,!0)}I||(I=B(N=Pf(N,a.unloadTransports),!0)),b=!g&&(L&&Xf()||!S&&Zf(!0)),(n={})[0]=s,n[1]=T||B([1,2,3],!0),n[2]=I||T||B([1],!0),n[3]=_||B([2,3],!0)||T||B([1],!0),h=n}))),M=!0)},e.addResponseHandler=function(e){return N[LI](e),{rm:function(){var t=N.indexOf(e);t>=0&&N[HI](t,1)}}},e[ew]=function(e){try{if(y)return y.getEventBlob(e)}catch(e){}return oI},e[tw]=function(){try{return X(y&&y[rw](0,!1,!1,!1,1,0),w)}catch(e){}return null},e[nw]=function(e,r){try{var n=[];Ld(e,(function(e){r&&(e=Af(e));var t=xw.create(e[qI],[e]);n[LI](t)}));for(var o=null;n[MI]>0&&y;){var i=n.shift();i&&i[UI]()>0&&(o=o||y[rw](0,!1,!1,!1,1,0),y.appendPayload(o,i,t))}var a=X(o,w),s={data:o[ow],urlString:a.url,headers:a[FI],timeout:E,disableXhrSync:k,disableFetchKeepAlive:S};return w&&(eE(s[iw],dI)||(s[iw][dI]=uI),eE(s[iw],hI)||(s[iw][hI]=lI)),s}catch(e){}return null},e._getDbgPlgTargets=function(){return[h[0],a,y,h,H(),i]},e[lw]=function(e,t){m[e]=t},e.removeHeader=function(e){delete m[e]},e[dw]=function(){return W()&&c[AI]()},e[hw]=function(e,t){il(e)&&(e=0),I&&(e=Q(e),t=2),Y(v,e,0)&&J(V(),0,!1,e,t||0)},e[pw]=function(){return!s&&0===u&&0===v[MI]},e[gw]=function(e){I=e},e.addBatch=function(e){if(e&&e[UI]()>0){if(a.isTenantKilled(e[qI]()))return!1;v[LI](e)}return!0},e.teardown=function(){v[MI]>0&&J(V(),0,!0,2,2),Ld(_,(function(e){e&&e.rm&&e.rm()})),_=[]},e.pause=function(){s=!0},e[fw]=function(){s=!1,e[hw](0,4)},e[mw]=function(e,t,r){e&&e[UI]()>0&&(al(t)&&(t=1),I&&(t=Q(t),r=2),J([e],0,!1,t,r||0))}}))}return e.__ieDyn=1,e}(),nE=1e4,oE="eventsDiscarded",iE=void 0,aE=Fl({eventsLimitInMem:{isVal:UC,v:nE},immediateEventLimit:{isVal:UC,v:500},autoFlushEventsLimit:{isVal:UC,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:function(e){return e&&e.sendPOST},v:iE},overrideInstrumentationKey:iE,overrideEndpointUrl:iE,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:iE,clearTimeoutOverride:iE,payloadPreprocessor:iE,payloadListener:iE,disableEventTimings:iE,valueSanitizer:iE,stringifyObjects:iE,enableCompoundKey:iE,disableOptimizeObj:!1,fetchCredentials:iE,transports:iE,unloadTransports:iE,useSendBeacon:iE,disableFetchKeepAlive:iE,avoidOptions:!1,xhrTimeout:iE,disableXhrSync:iE,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:pl,v:6},maxUnloadEventRetryAttempts:{isVal:pl,v:2},addNoResponse:iE,excludeCsMetaData:iE});var sE=function(e){function t(){var r,n=e.call(this)||this;n.identifier="PostChannel",n.priority=1011,n.version="4.3.5";var o,i,a,s,c,u,l,d,h,p,g,f,m,v,y,C,T,I,w,E,k,S,b,A,_,R=!1,P=[],N=!1,M=0,O=0,q={},U=nI;return Zh(t,n,(function(e,t){function n(){sC([Gy,zy,Fy],null,I),function(e,t){var r=nC(jy,t);sC([Fy],e,r),sC([Dy],null,r)}(null,I),function(e,t){var r=nC(Qy,t);sC([Ky],e,r),sC([Dy],null,r)}(null,I)}function x(e){var t="";return e&&e[MI]&&Ld(e,(function(e){t&&(t+="\n"),t+=e})),t}function L(e){var t="";try{D(e),t=d[ew](e)}catch(e){}return t}function B(e){"beforeunload"!==(e||Td().event).type&&(y=!0,d[gw](y)),V(2,2)}function H(e){y=!1,d[gw](y)}function D(e){e.ext&&e.ext[SI]&&delete e.ext[SI],e.ext&&e.ext[bI]&&e.ext[bI].id&&delete e.ext[bI].id,v&&(e.ext=Af(e.ext),e[Pw]&&(e[Pw]=Af(e[Pw])),e[Ew]&&(e[Ew]=Af(e[Ew])))}function F(e,t){if(e[Nw]||(e[Nw]=0),e[Mw]||(e[Mw]=1),D(e),e[Ow])if(u||N)e[Mw]=3,e[Ow]=!1;else if(d)return v&&(e=Af(e)),void d[mw](xw.create(e[qI],[e]),!0===e[Ow]?1:e[Ow],3);var r=e[Mw],n=O,o=a;4===r&&(n=M,o=i);var s=!1;if(n<o)s=!J(e,t);else{var c=1,l=20;4===r&&(c=4,l=1),s=!0,function(e,t,r,n){for(;r<=t;){var o=Y(e,t,!0);if(o&&o[UI]()>0){var i=o[BI](0,n),a=i[UI]();if(a>0)return 4===r?M-=a:O-=a,ae(oE,[i],np.QueueFull),!0}r++}return X(),!1}(e[qI],e[Mw],c,l)&&(s=!J(e,t))}s&&ie(oE,[e],np.QueueFull)}function K(e,t,r){var n=Z(e,t,r);return d[hw](t,r),n}function z(){return O>0}function G(){if(f>=0&&Z(f,0,m)&&d[hw](0,m),M>0&&!c&&!N){var e=q[U][2];e>=0&&(c=Q((function(){c=null,K(4,0,1),G()}),e))}var t=q[U][1];!s&&!o&&t>=0&&!N&&(z()?s=Q((function(){s=null,K(0===l?3:1,0,1),l++,l%=2,G()}),t):l=0)}function j(){r=null,R=!1,P=[],o=null,N=!1,M=0,i=500,O=0,a=nE,q={},U=nI,s=null,c=null,u=0,l=0,h={},p=0,b=!1,g=0,f=-1,m=null,v=!0,y=!1,C=6,T=2,I=null,A=null,_=!1,w=Ww(),d=new rE(500,2,1,{requeue:ne,send:se,sent:ce,drop:ue,rspFail:le,oth:de}),re(),h[4]={batches:[],iKeyMap:{}},h[3]={batches:[],iKeyMap:{}},h[2]={batches:[],iKeyMap:{}},h[1]={batches:[],iKeyMap:{}},he()}function Q(e,t){0===t&&u&&(t=1);var r=1e3;return u&&(r=Hw(u-1)),w.set(e,t*r)}function W(){return null!==s&&(s.cancel(),s=null,l=0,!0)}function V(e,t){W(),o&&(o.cancel(),o=null),N||K(1,e,t)}function Y(e,t,r){var n=h[t];n||(n=h[t=1]);var o=n.iKeyMap[e];return!o&&r&&(o=xw.create(e),n.batches[LI](o),n.iKeyMap[e]=o),o}function $(t,r){d[dw]()&&!u&&(p>0&&O>p&&(r=!0),r&&null==o&&e.flush(t,(function(){}),20))}function J(e,t){v&&(e=Af(e));var r=e[Mw],n=Y(e[qI],r,!0);return!!n.addEvent(e)&&(4!==r?(O++,t&&0===e[Nw]&&$(!e.sync,g>0&&n[UI]()>=g)):M++,!0)}function X(){for(var e=0,t=0,r=function(r){var n=h[r];n&&n[cw]&&Ld(n[cw],(function(n){4===r?e+=n[UI]():t+=n[UI]()}))},n=1;n<=4;n++)r(n);O=t,M=e}function Z(t,r,n){var o=!1,i=0===r;return!i||d[dw]()?Qv(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],r=4;r>=t;){var n=h[r];n&&n.batches&&n.batches[MI]>0&&(Ld(n[cw],(function(t){d.addBatch(t)?o=o||t&&t[UI]()>0:e=e[OI](t[xI]()),4===r?M-=t[UI]():O-=t[UI]()})),n[cw]=[],n.iKeyMap={}),r--}e[MI]>0&&ie(oE,e,np.KillSwitch),o&&f>=t&&(f=-1,m=0)}),(function(){return{latency:t,sendType:r,sendReason:n}}),!i):(f=f>=0?Math.min(f,t):t,m=Math.max(m,n)),o}function ee(e,t){K(1,0,t),X(),te((function(){e&&e(),P[MI]>0?o=Q((function(){o=null,ee(P.shift(),t)}),0):(o=null,G())}))}function te(e){d[pw]()?e():o=Q((function(){o=null,te(e)}),.25)}function re(){(q={})[nI]=[2,1,0],q.NEAR_REAL_TIME=[6,3,0],q.BEST_EFFORT=[18,9,0]}function ne(t,r){var n=[],o=C;y&&(o=T),Ld(t,(function(t){t&&t[UI]()>0&&Ld(t[xI](),(function(t){t&&(t[Ow]&&(t[Mw]=4,t[Ow]=!1),t[Nw]<o?(OC(t,e[Aw]),F(t,!1)):n[LI](t))}))})),n[MI]>0&&ie(oE,n,np.NonRetryableStatus),y&&V(2,2)}function oe(t,r){var n=S||{},o=n[t];if(o)try{o.apply(n,r)}catch(r){cv(e.diagLog(),1,74,t+" notification failed: "+r)}}function ie(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t[MI]>0&&oe(e,[t][OI](r))}function ae(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t[MI]>0&&Ld(t,(function(t){t&&t[UI]()>0&&oe(e,[t.events()][OI](r))}))}function se(e,t,r){e&&e[MI]>0&&oe("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==r])}function ce(e,t){ae("eventsSent",e,t),G()}function ue(e,t){ae(oE,e,t>=8e3&&t<=8999?t-8e3:np.Unknown)}function le(e){ae(oE,e,np.NonRetryableStatus),G()}function de(e,t){ae(oE,e,np.Unknown),G()}function he(){g=k?0:Math.max(1500,a/6)}j(),e._getDbgPlgTargets=function(){return[d,r]},e[zI]=function(o,s,c){Qv(s,(function(){return"PostChannel:initialize"}),(function(){t[zI](o,s,c),S=s.getNotifyMgr();try{I=nC(mm(e[Aw]),s.evtNamespace&&s.evtNamespace()),e._addHook(Hm(o,(function(t){var o=t.cfg,c=ly(null,o,s);r=c.getExtCfg(e[Aw],aE),w=Ww(r[GI],r[jI]),v=!r.disableOptimizeObj&&!!vd("chrome"),E=r.ignoreMc1Ms0CookieProcessing,function(e){var t=e[yw];e[yw]=function(){var r=0;return E&&(r|=2),r|t.call(e)}}(s),a=r[_w],i=r.immediateEventLimit,p=r[Rw],C=r.maxEventRetryAttempts,T=r.maxUnloadEventRetryAttempts,k=r.disableAutoBatchFlushLimit,ml(o.endpointUrl)?e.pause():N&&e[fw](),he(),A=r.overrideInstrumentationKey,_=!!r.disableTelemetry,b&&n();var u=o.disablePageUnloadEvents||[];b=cC(B,u,I),b=uC(B,u,I)||b,b=lC(H,o.disablePageShowEvents,I)||b}))),d[zI](o,e.core,e)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{theConfig:o,core:s,extensions:c}}))},e.processTelemetry=function(t,r){OC(t,e[Aw]),r=r||e._getTelCtx(r);var n=t;_||R||(A&&(n[qI]=A),F(n,!0),y?V(2,2):G()),e.processNext(n,r)},e.getOfflineSupport=function(){try{var e=d&&d[tw]();if(d)return{getUrl:function(){return e?e.url:null},serialize:L,batch:x,shouldProcess:function(e){return!_},createPayload:function(e){return null},createOneDSPayload:function(e){if(d[nw])return d[nw](e,v)}}}catch(e){}return null},e._doTeardown=function(e,t){V(2,2),R=!0,d.teardown(),n(),j()},e.setEventQueueLimits=function(e,t){r[_w]=a=UC(e)?e:nE,r[Rw]=p=UC(t)?t:0,he();var n=O>e;if(!n&&g>0)for(var o=1;!n&&o<=3;o++){var i=h[o];i&&i[cw]&&Ld(i[cw],(function(e){e&&e[UI]()>=g&&(n=!0)}))}$(!0,n)},e.pause=function(){W(),N=!0,d&&d.pause()},e[fw]=function(){N=!1,d&&d[fw](),G()},e._loadTransmitProfiles=function(e){W(),re(),U=nI,G(),wl(e,(function(e,t){var r=t[MI];if(r>=2){var n=r>2?t[2]:0;if(t[HI](0,r-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var o=t[0]/t[1];t[0]=Math.ceil(o)*t[1]}n>=0&&t[1]>=0&&n>t[1]&&(n=t[1]),t[LI](n),q[e]=t}}))},e.flush=function(e,t,r){var n;if(void 0===e&&(e=!0),!N)if(r=r||1,e)t||(n=Qg((function(e){t=e}))),null==o?(W(),Z(1,0,r),o=Q((function(){o=null,ee(t,r)}),0)):P[LI](t);else{var i=W();K(1,1,r),t&&t(),i&&G()}return n},e.setMsaAuthTicket=function(e){d[lw](II,e)},e.setAuthPluginHeader=function(e){d[lw](wI,e)},e.removeAuthPluginHeader=function(){d.removeHeader(wI)},e.hasEvents=z,e._setTransmitProfile=function(e){U!==e&&void 0!==q[e]&&(W(),U=e,G())},bf(e,(function(){return d}),["addResponseHandler"]),e[bw]=function(){u<4&&(u++,W(),G())},e._clearBackOff=function(){u&&(u=0,W(),G())}})),n}return Ih(t,e),t.__ieDyn=1,t}(yy),cE=Fl({cookieCfg:{ref:!0,v:{}},extensions:{rdOnly:!0,ref:!0,v:[]},channels:{rdOnly:!0,ref:!0,v:[]},extensionConfig:{ref:!0,v:{}}}),uE=function(e){function t(){var r,n,o=e.call(this)||this;return Zh(t,o,(function(e,t){e.initialize=function(e,i){var a=o;Qv(o,(function(){return"ApplicationInsights:initialize"}),(function(){e=Bm(e,cE,a.logger,!1).cfg,r=new sE;var o=[n=new rI];i&&(o=o.concat(i)),e||ql("You must provide a config object!");var s=e.channels;if(s&&s.length>0){for(var c=!1,u=0;u<s[0].length;u++)if(s[0][u].identifier===r.identifier){c=!0;break}c||xd(s[0],r)}else e.channels.push([r]);var l=e.extensionConfig;l[r.identifier]=l[r.identifier]||e&&e.channelConfiguration||{},l[n.identifier]=l[n.identifier]||e&&e.propertyConfiguration||{};try{t.initialize(e,o),a.isInitialized()&&_l(e,{channelConfiguration:{g:function(){return e.extensionConfig[r.identifier]}},propertyConfiguration:{g:function(){return e.extensionConfig[n.identifier]}}})}catch(e){cv(a.logger,1,514,"Failed to initialize SDK."+Ol(e))}}),(function(){return{config:e,extensions:i}}))},e.getPropertyManager=function(){return n},e.getPostChannel=function(){return r}})),o}return Ih(t,e),t.__ieDyn=1,t}(BC);const lE="mats-telemetry-profile-id";class dE{constructor(e,t,r,n,o,i,a,s,c){this.synthetic=!1,this.observabilityRatio=.1,this.samplingRatio=.01,this.clientId=e,this.logger=t,this.eventsToEmit=new Set(n),this.eventsToSample=new Set(o);const u={instrumentationKey:"d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725",extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0};this.appInsights=new uE,this.appInsights.initialize(u,[]),this.synthetic=a||!1,this.appName=s,this.appVersion=c,this.sessionId=i,this.sampleEvents=Math.random()<=this.samplingRatio,this.logger.verbose(`Sampling for misc event enabled: ${this.sampleEvents}`);try{const e=new ac(this.clientId,t,r),n=e.getItem(lE);if(n)this.profileTelemetryId=n;else{const t=As();this.profileTelemetryId=t,e.setItem(lE,t)}}catch(e){t.warning("PerformanceTelemetryReporter: local storage is not available"),this.profileTelemetryId=""}this.logger.verbose("PerformanceTelemetryReporter: Initialized")}sendCustomEvent(e){if(!this.eventsToEmit.has(e.name)||this.eventsToSample.has(e.name)&&!this.sampleEvents)return void this.logger.verbose(`PerformanceTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId);const t={...e,synthetic:this.synthetic,appName:this.appName,appVersion:this.appVersion,profileTelemetryId:this.profileTelemetryId,sessionId:this.sessionId};var r;!e.success||(r=this.observabilityRatio,Math.random()<=r)?this.logger.verbose(`PerformanceTelemetryReporter: Sending ${t.name} with additional observability for tracking`):(delete t.context,delete t.errorStack,this.logger.verbose(`PerformanceTelemetryReporter: Sending ${t.name} for tracking`));const n={name:e.name,data:t};this.appInsights.track(n),e.name===wu.AcquireTokenPreRedirect&&this.appInsights.flush()}}const hE=[wu.InitializeClientApplication,wu.LocalStorageUpdated],pE=new Set([wu.AcquireTokenSilent,wu.AcquireTokenByCode,wu.AcquireTokenPopup,wu.AcquireTokenRedirect,wu.AcquireTokenPreRedirect,wu.PairwiseBrokerApplicationInitializeBrokering,wu.SsoSilent,wu.EmbeddedClientApplicationSendSSOSilentRequest,wu.EmbeddedClientApplicationSendPopupRequest,wu.EmbeddedClientApplicationSendRedirectRequest,wu.EmbeddedClientApplicationHandleRedirectRequest,wu.EmbeddedClientApplicationSendSilentRefreshRequest,...hE]);class gE{constructor(e,t,r,n,o){this.logger=t;const i=o?.eventsToEmit?.filter((e=>pE?.has(e)))||[...pE];this.perfTelemetryReporter=new dE(e,t,r,i,hE,n,o?.synthetic,o?.appName,o?.appVersion)}sendCustomEvent(e){this.perfTelemetryReporter.sendCustomEvent(e)}getTelemetryCallback(){this.logger.trace("TelemetryReporter: Attaching callback to send custom metrics.");return this.logger.verbose("TelemetryReporter: Returning callback as telemetry emitted."),e=>{e.forEach((e=>{e.name===wu.AcquireTokenByBroker&&(e.name=e.brokerEventName||e.name,e.isBroker=!0,delete e.brokerEventName,this.logger.verbosePii(`TelemetryReporter: Updated broker event ${JSON.stringify(e)}`,e.correlationId)),this.sendCustomEvent(e)}))}}}const fE=[ut.AzurePublic,ut.AzurePpe];class mE extends uu{constructor(e,t){let r;const n="undefined"!=typeof window,o=!t?.disabled&&function(e){return!e.auth.authority||fE.some((t=>0===e.auth.authority?.indexOf(t.toString())))}(e)&&n;if(o?(r=e.telemetry?.client||new Cu(e,new Set(ku),new Map(Eu)),super({...e,telemetry:{...e.telemetry,client:r}})):(super(e),r=new $o),this.performanceClient=r,this.sessionId=n?As():"",o){const n=new gE(e.auth.clientId,this.getLogger(),r,this.sessionId,t);this.addPerformanceCallback(n.getTelemetryCallback())}}static async createPublicClientApplication(e,t,r){const n=new mE(e,t);return await n.initialize({correlationId:r}),n}}const vE="BrokerReady",yE="BrokerHandshakeRequest",CE="BrokerHandshakeResponse",TE="BrokerAuthRequest",IE="BrokerRedirectResponse",wE="BrokerHandleRedirectRequest",EE="BrokerAuthResult",kE="EmbeddedLogoutRequest",SE="EmbeddedLogoutResponse",bE="BrokerAuthError",AE="InteractionRequiredAuthError",_E="ServerError",RE="ClientAuthError",PE="ClientConfigurationError",NE="BrowserAuthError",ME="BrowserConfigurationError",OE="AuthError";class qE{constructor(e,t){this.messageType=e,this.sessionId=t}static validateMessage(e){if(!e.data||!e.data.messageType)return null;switch(e.data.messageType){case yE:case CE:case wE:case TE:case EE:case IE:case kE:return e;default:return null}}}class UE extends qE{constructor(e,t,r=!1,n,o){super(yE,n),this.embeddedClientId=e,this.version=t,this.allowTelemetry=r,this.nonce=o}static validate(e){return e.data&&e.data.messageType===yE&&e.data.embeddedClientId&&e.data.version?new UE(e.data.embeddedClientId,e.data.version,e.data.allowTelemetry,e.data.sessionId,e.data.nonce):null}}class xE extends qE{constructor(e,t,r,n){super(CE,r),this.version=e,this.brokerOrigin=t,this.nonce=n}static validate(e,t){if(!t.includes(e.origin))return null;const r=qE.validateMessage(e);return r&&r.data.messageType===CE&&r.data.version?new xE(r.data.version,r.origin,r.data.sessionId,r.data.nonce):null}}class LE extends qE{get embeddedAppOrigin(){return this._embeddedAppOrigin}constructor(e,t,r,n,o){super(TE,o),this.embeddedClientId=e,this._embeddedAppOrigin=n,this.interactionType=t,this.request=r}static validate(e,t){return e.data&&e.data.messageType===TE&&e.data.embeddedClientId&&e.data.interactionType&&e.data.request?new LE(e.data.embeddedClientId,e.data.interactionType,e.data.request,t,e.data.sessionId):null}}class BE extends qE{constructor(e){super(IE,e)}static validate(e){return e.data&&e.data.messageType===IE?new BE(e.data.sessionId):null}}const HE="broker_response_invalid",DE="broker_popup_will_redirect",FE="broker_timeout",KE="broker_handshake_timeout",zE="broker_handshake_failed",GE="no_trusted_brokers_provided",jE="brokering_disabled",QE="broker_connection_reset",WE="shr_generation_error";var VE=Object.freeze({__proto__:null,BrokerConnectionReset:QE,BrokerHandshakeFailed:zE,BrokerHandshakeTimeout:KE,BrokerPopupWillRedirect:DE,BrokerResponseInvalid:HE,BrokerTimeout:FE,BrokeringDisabled:jE,NoTrustedBrokersProvided:GE,ShrGenerationError:WE});const YE={[HE]:"The broker response did not have the expected values.",[DE]:"The request for a brokered popup requires a redirect by the broker. If your app does not perform the redirect, please check the broker's logs.",[FE]:"Message broker timed out.",[KE]:"Broker handshake response timed out.",[zE]:"Broker handshake failed. Please see logs for details.",[GE]:"No trusted brokers provided.",[jE]:"Brokering is not enabled for the client application. Please check logs to see if handshake was performed.",[QE]:"The broker connection was reset. Please retry the request.",[WE]:"Error generating SHRs. Kid is missing in the request."};class $E extends se{constructor(e,t){super(e,t),Object.setPrototypeOf(this,$E.prototype),this.name=bE}}function JE(e){return new $E(e,YE[e])}class XE extends qE{constructor(e,t,r,n){if(super(EE,r),this.interactionType=e,this.result=t,n){const{setCorrelationId:e,...t}=n;this.errorPayload=t}}static validate(e){return e.data&&e.data.messageType===EE&&e.data.interactionType&&(e.data.result||e.data.errorPayload)?new XE(e.data.interactionType,e.data.result,e.data.sessionId,e.data.errorPayload):null}static detectError(e){let t;switch(e.name){case AE:t=new Eo(e.errorCode,e.errorMessage,e.subError);break;case _E:t=new oo(e.errorCode,e.errorMessage,e.subError);break;case RE:t=new rt(e.errorCode,e.errorMessage);break;case PE:t=new rr(e.errorCode);break;case NE:t=new Xi(e.errorCode);break;case ME:t=new ds(e.errorCode,e.errorMessage);break;case bE:t=new $E(e.errorCode,e.errorMessage);break;case OE:t=new se(e.errorCode,e.errorMessage,e.subError);break;default:t=new se(re,JSON.stringify(e))}return t.setCorrelationId(e.correlationId),t}}class ZE extends qE{constructor(t,r,n){super(wE,n),this.interactionType=e.InteractionType.Redirect,this.embeddedClientId=t,this.version=r}static validate(e){return e.data&&e.data.messageType===wE&&e.data.embeddedClientId&&e.data.version?new ZE(e.data.embeddedClientId,e.data.version,e.data.sessionId):null}}function ek(e){const t={preferredInteractionType:null,brokerRedirectParams:{},actAsBroker:!1,allowBrokering:!1,trustedBrokerDomains:[],brokerHandshakeTimeout:2e3,brokerMessageTimeout:11e3,brokerInteractionTimeout:3e5};return{preferredInteractionType:e?.preferredInteractionType||t.preferredInteractionType,brokerRedirectParams:e?.brokerRedirectParams||t.brokerRedirectParams,actAsBroker:e?.actAsBroker||t.actAsBroker,allowBrokering:e?.allowBrokering||t.allowBrokering,trustedBrokerDomains:e?.trustedBrokerDomains||t.trustedBrokerDomains,brokerHandshakeTimeout:e?.brokerHandshakeTimeout||t.brokerHandshakeTimeout,brokerMessageTimeout:e?.brokerMessageTimeout||t.brokerMessageTimeout,brokerInteractionTimeout:e?.brokerInteractionTimeout||t.brokerInteractionTimeout}}class tk extends qE{constructor(e,t,r){super(kE,r),this.version=e,this.correlationId=t}static validate(e){const t=qE.validateMessage(e);return t&&t.data&&t.data.version?new tk(t.data.version,t.data.correlationId,t.data.sessionId):null}}function rk(e,t,r){try{switch(e.cache?.temporaryCacheLocation){case ca.LocalStorage:return new ac(e.auth.clientId,t,r);case ca.MemoryStorage:return new Ys;default:return new sc}}catch(e){return new Ys}}function nk(e){return`msal.request.${e}`}const ok="4.8.0";function ik(e){const t=e.split("-",1)[0].split(".",3);return{major:parseInt(t[0]),minor:parseInt(t[1]),patch:parseInt(t[2])}}function ak(e){e.port1.close(),e.port2.close()}function sk(e,t,r,n=20){if(0===e.length||r>n)return[0,r-1];let o=r,i=e.length;for(let a=0;a<e.length;a++){e[a].postMessage(t,"*");const[s,c]=sk(e[a],t,r+1,n);i+=s,c>o&&(o=c)}return[i,o]}const{invoke:ck,invokeAsync:uk}=_s;function lk(e){return`${e.clientId}-${e.origin}`}class dk extends mE{constructor(e,t,r){super(e),this.currentBrokerRedirectResponse=void 0,this.hybridAuthPromise=void 0,this.pwbBrokerAppConfiguration=ek(t),this.redirectResponseMap=new Map,this.embeddedAppConfigMap=new Map,this.telemetryAllowedEmbeddedClients=new Set,this.logger=new at(e.system?.loggerOptions||{},"@azure/msal-browser-1p",ok),this.tempCache=rk(e,this.logger,this.performanceClient),this.eventHandler=r,this.messageListener=this.handleBrokerMessage.bind(this),this.isListening=!1}getRedirectCorrelationId(){const e=`msal.${this.getConfiguration().auth.clientId}`,t=this.tempCache.getItem(`${e}.request.native`);try{if(t){const e=JSON.parse(t);return e&&"object"==typeof e?e.correlationId:null}}catch(e){this.logger.error("BrokerClientApplication.getRedirectCorrelationId: Unable to parse native request")}return this.tempCache.getItem(`${e}.request.correlationId`)||""}async handleRedirectPromise(e){const t=this.getRedirectCorrelationId(),r=this.performanceClient.startMeasurement(wu.AcquireTokenByBroker,t);r.add({brokerEventName:wu.AcquireTokenRedirect});try{const t=super.handleRedirectPromise(e);this.currentBrokerRedirectResponse=t;const n=await this.currentBrokerRedirectResponse;if(this.currentBrokerRedirectResponse=void 0,n){const e=function(e){if(!e)return null;try{const t=window.atob(e),r=new Uint8Array(t.length);for(let e=0;e<r.length;e++)r[e]=t.charCodeAt(e);const n=(new TextDecoder).decode(r),o=JSON.parse(n);return o.hasOwnProperty("brokerState")?o:null}catch(e){return null}}(n.state);if(this.setActiveAccount(n.account),!e)return r.end({success:!0}),n;{const t={...n,state:e.userState};this.redirectResponseMap.set(lk({clientId:e.brokerState.requestClientId,origin:e.brokerState.requestOrigin}),t),r.add({embeddedClientId:e.brokerState.requestClientId,embeddedRedirectUri:e.brokerState.requestOrigin}),this.endBrokerPerformanceEvent(e.brokerState.requestClientId,r)}}else r.discard();return null}catch(e){throw e instanceof se&&e.setCorrelationId(t),r.end({success:!1},e),e}}async listenForBrokerMessage(e,t){return this.logger.verbose("listening for child broker messages."),window.addEventListener("message",this.messageListener),this.broadcastBrokerReadyMessage(window.frames,e,t),this.isListening=!0,e&&e.codeRequest&&(this.hybridAuthPromise=this.acquireTokenByCode(e.codeRequest)),this.hybridAuthPromise}broadcastBrokerReadyMessage(e,t,r){this.logger.trace("Broadcasting broker ready message to child frames.");const n={messageType:vE,sessionId:this.sessionId};window.postMessage(n,"*");const[o,i]=ck(sk,wu.PostMessageToAllDescendantFrames,this.logger,this.performanceClient,r?.event.correlationId)(e,n,1,t?.maxChildFrameDepth);r?.add({maxFrameDepthReached:i,framesNotified:o,maxFrameDepthConfigured:t?.maxChildFrameDepth}),this.logger.trace(`Broadcasted broker ready message to ${o} child frames with a max depth of ${i}`)}stopListeningForBrokerMessage(){this.logger.verbose("stop listening for child broker messages."),window.removeEventListener("message",this.messageListener),this.isListening=!1,this.embeddedAppConfigMap.forEach((([e,t])=>{this.logger.verbose(`closing message port for ${e}`),t.close()})),this.embeddedAppConfigMap.clear()}async handleBrokerMessage(e){const t=qE.validateMessage(e);if(t&&t.data.messageType)switch(this.logger.verbose(`Broker received message with type: ${t.data.messageType}`),t.data.messageType){case yE:return this.handleBrokerHandshake(t);case wE:const e=ZE.validate(t);if(!e)return;return this.handleBrokerRedirectResponse(e,t);case TE:const r=LE.validate(t,this.embeddedAppConfigMap.get(t.data.sessionId||t.data.embeddedClientId)?.[0]||t.origin);if(!r)return;r.request.correlationId||(r.request.correlationId=As());const n=this.performanceClient.startMeasurement(wu.AcquireTokenByBroker,r.request.correlationId);n.add({embeddedSessionId:r.sessionId});const o=t.ports?.[0];try{const e=await uk(this.handleBrokerAuthRequest.bind(this),wu.HandleBrokerAuthRequest,this.logger,this.performanceClient,r.request.correlationId)(r,o);if(e?.errorPayload){const{errorCode:t,errorMessage:o,subError:i}={...e.errorPayload};return void this.endBrokerPerformanceEvent(r.embeddedClientId,n,new se(t,o,i))}return void this.endBrokerPerformanceEvent(r.embeddedClientId,n)}catch(e){throw this.endBrokerPerformanceEvent(r.embeddedClientId,n,e),e}default:return}}isDescendantFrame(e){const t=[];for(t.push(e.sourceFrame);t.length>0;){const r=t.pop();if(r)for(let n=0;n<r.frames.length;n++){const o=r.frames[n];if(o===e.targetFrame)return!0;o!==r&&t.push(o)}}return!1}async handleBrokerHandshake(e){if(!e.source||!e.source.window||e.source.window!==e.source)return void this.logger.warning("Broker handshake request validation failed. Message origin is not an iframe");const t=e.source;window===t||this.isDescendantFrame({sourceFrame:window,targetFrame:t})||this.logger.warning("Broker handshake request validation failed. Message origin is not a descendant iframe");const r=UE.validate(e);if(!r)return void this.logger.warning("Broker handshake request validation failed. Message may not have come from MSAL.js.");const n=As(),o=this.performanceClient.startMeasurement(wu.BrokerClientApplicationHandleBrokerHandshake,n);try{if(o.add({embeddedClientId:r.embeddedClientId,embeddedSessionId:r.sessionId}),r.allowTelemetry&&this.telemetryAllowedEmbeddedClients.add(r.embeddedClientId),this.logger.verbose(`${r.messageType} validated for AppId: ${r.embeddedClientId}`),this.hybridAuthPromise)try{await this.hybridAuthPromise}catch(e){this.logger.error(`Broker could not obtain tokens using authorization code initializer: ${e}`)}const t=new xE(ok,"",this.sessionId,e.data.nonce);this.logger.verbose(`Sending handshake response to ${e.origin}`);const n=e.ports?.[0];n&&(n.onmessage=this.messageListener,this.embeddedAppConfigMap.set(r.sessionId||r.embeddedClientId,[e.origin,n]));const i=ik(e.data.version);n&&3===i.major&&i.minor>=15&&i.minor<=19?n?.postMessage(t):e.source?.postMessage(t,e.origin)}catch(e){throw this.endBrokerPerformanceEvent(r.embeddedClientId,o,e),e}}async handleBrokerRedirectResponse(t,r){if(t){const n=this.embeddedAppConfigMap.get(t.sessionId||t.embeddedClientId);let o,i;n?[i,o]=n:(i=r.origin,o=r.ports?.[0]),this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse;const a=this.redirectResponseMap.get(lk({clientId:t.embeddedClientId,origin:i})),s=new XE(e.InteractionType.Redirect,a||null,this.sessionId);this.logger.verbose("Sending auth response"),o?.postMessage(s);const c=`msal.${this.getConfiguration().auth.clientId}`;this.tempCache.removeItem(`${c}.request.native`)}else;}async handleBrokerAuthRequest(t,r){this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse,t.request.correlationId||(t.request.correlationId=As());const n=t.request.correlationId,o=t.request.account||this.getActiveAccount();let i;switch(t.interactionType){case e.InteractionType.Silent:if(o){this.performanceClient.addFields({brokerEventName:wu.AcquireTokenSilent},n),i=ck(this.brokeredSilentRequest.bind(this),wu.BrokeredSilentRequest,this.logger,this.performanceClient,n)(t,o,r);break}this.performanceClient.addFields({brokerEventName:wu.SsoSilent},n),i=ck(this.brokeredSsoSilentRequest.bind(this),wu.BrokeredSsoSilentRequest,this.logger,this.performanceClient,n)(t,r);break;case e.InteractionType.Redirect:case e.InteractionType.Popup:default:const a=this.getInteractionType(t.interactionType);this.performanceClient.addFields({brokerEventName:a===e.InteractionType.Redirect?wu.AcquireTokenRedirect:wu.AcquireTokenPopup},n),i=ck(this.interactiveBrokerRequest.bind(this),wu.InteractiveBrokerRequest,this.logger,this.performanceClient,n)(a,t,r)}return i}getInteractionType(e){const t=this.pwbBrokerAppConfiguration.preferredInteractionType;return t||e}async interactiveBrokerRequest(t,r,n){switch(t){case e.InteractionType.Redirect:return ck(this.brokeredRedirectRequest.bind(this),wu.BrokeredRedirectRequest,this.logger,this.performanceClient,r.request.correlationId)(r,n);case e.InteractionType.Popup:return ck(this.brokeredPopupRequest.bind(this),wu.BrokeredPopupRequest,this.logger,this.performanceClient,r.request.correlationId)(r,n);case e.InteractionType.Silent:return void this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.");case e.InteractionType.None:return void this.logger.error("Broker is blocking interactive requests. Please attempt a silent request or sign into the broker first.");default:return void this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.")}}async brokeredRedirectRequest(t,r){this.logger.verbose("Brokered redirect request initiated.");const n=this.getAllAccounts();this.eventHandler.emitEvent(0===n.length?uc.LOGIN_START:uc.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t.request);const o=this.embeddedAppConfigMap.get(t.sessionId||t.embeddedClientId)?.[1]||r;try{const e=new BE(this.sessionId);o?.postMessage(e),this.logger.verbose(`Sending redirect response: ${e}`);const r=this.addBrokerRequestProperties(t);return r.state=function(e,t){const r={userState:t,brokerState:{requestOrigin:e.embeddedAppOrigin,requestClientId:e.embeddedClientId}},n=JSON.stringify(r),o=(new TextEncoder).encode(n);return window.btoa(Array.from(o,(e=>String.fromCodePoint(e))).join(""))}(t,r.state),await super.acquireTokenRedirect(r)}catch(t){const r=new XE(e.InteractionType.Redirect,null,this.sessionId,t);return this.logger.verbose(`Found auth error in redirect: ${t}`),o?.postMessage(r),this.eventHandler.emitEvent(0===n.length?uc.LOGIN_FAILURE:uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t),r}}async brokeredPopupRequest(t,r){this.logger.verbose("Brokered popup request initiated.");const n=this.getAllAccounts();this.eventHandler.emitEvent(0===n.length?uc.LOGIN_START:uc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t.request);const o=this.embeddedAppConfigMap.get(t.sessionId||t.embeddedClientId)?.[1]||r;try{const r=this.addBrokerRequestProperties(t),i=await super.acquireTokenPopup(r),a=new XE(e.InteractionType.Popup,i,this.sessionId);this.logger.verbosePii("Sending auth response"),o?.postMessage(a);const s=n.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(s?uc.LOGIN_SUCCESS:uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,i),a}catch(t){const r=new XE(e.InteractionType.Popup,null,this.sessionId,t);return this.logger.verbose(`Found auth error in popup: ${t}`),o?.postMessage(r),this.eventHandler.emitEvent(0===n.length?uc.LOGIN_FAILURE:uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t),r}}async brokeredSsoSilentRequest(t,r){this.logger.verbose("Brokered SSO Silent request initiated."),this.eventHandler.emitEvent(uc.SSO_SILENT_START,e.InteractionType.Silent,t.request);const n=this.embeddedAppConfigMap.get(t.sessionId||t.embeddedClientId)?.[1]||r;try{const r=this.addBrokerRequestProperties(t),o=await super.ssoSilent(r),i=new XE(e.InteractionType.Silent,o,this.sessionId);return this.logger.verbosePii("Sending auth response"),n?.postMessage(i),this.eventHandler.emitEvent(uc.SSO_SILENT_SUCCESS,e.InteractionType.Silent,o),i}catch(t){const r=new XE(e.InteractionType.Silent,null,this.sessionId,t);return this.logger.verbose(`Found auth error in ssoSilent: ${t}`),n?.postMessage(r),this.eventHandler.emitEvent(uc.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),r}}async brokeredSilentRequest(t,r,n){this.logger.verbose("Brokered Silent request initiated."),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t.request);const o=this.embeddedAppConfigMap.get(t.sessionId||t.embeddedClientId)?.[1]||n;try{const n=this.addBrokerRequestProperties(t,r);n.cacheLookupPolicy=Na.RefreshTokenAndNetwork;const i=await super.acquireTokenSilent(n),a=new XE(e.InteractionType.Silent,i,this.sessionId);return o?.postMessage(a),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,i),a}catch(t){const r=new XE(e.InteractionType.Silent,null,this.sessionId,t);return this.logger.verbose(`Found auth error in silent: ${t}`),o?.postMessage(r),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),r}}getEmbeddedAppRedirectUri(e){const t=new Ir(e);return`brk-${this.getConfiguration().auth.clientId}://${t.getUrlComponents().HostNameAndPort}`}addBrokerRequestProperties(e,t){const r={...e.request};r.redirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),r.embeddedClientId=e.embeddedClientId,r.storeInCache={idToken:!1,accessToken:!1};const n=t||this.getActiveAccount();return n&&(r.account=n),e.request.correlationId&&this.performanceClient.addFields({embeddedClientId:e.embeddedClientId,embeddedRedirectUri:e.embeddedAppOrigin},e.request.correlationId),r}async sendLogoutRequestToEmbeddedApps(e){this.logger.verbose("sendLogoutRequestToEmbeddedApps called"),await this.messageEmbeddedAppsToLogout(new tk(ok,e?.correlationId||As(),this.sessionId))}async messageEmbeddedAppsToLogout(e){const t=[];this.embeddedAppConfigMap.forEach((r=>{t.push(new Promise(((t,n)=>{const o=window.setTimeout((()=>{t()}),200);try{r[1]?.postMessage(e),r[1].addEventListener("message",(e=>{e.data.messageType===SE&&(this.logger.info(`Received logout response from embedded app: ${e.data.embeddedClientId}`),t(),clearTimeout(o))}))}catch(e){this.logger.error(`Could not logout application ${r[0]}. Error in message channel: ${e}`),n(e)}})))})),await Promise.all(t)}endBrokerPerformanceEvent(e,t,r){this.telemetryAllowedEmbeddedClients.has(e)||(this.logger.verbosePii(`TelemetryReporter: Skipping brokered event as not allowed by the client ${e}`,t.event.correlationId),t.discard()),r?t.end({success:!1},r):t.end({success:!0})}}class hk extends qE{constructor(e,t,r,n){super(SE,n),this.version=e,this.correlationId=r,this.embeddedClientId=t}}const{invoke:pk,invokeAsync:gk}=_s;class fk{constructor(e,t,r,n,o,i,a,s,c){this.pwbBrokeredAppConfiguration=r,this.clientId=e,this.logger=n,this.brokerMetadata=null,this.performanceClient=o,this.hydrateCache=a,this.clearCache=s,this.messageChannelList=[],this.messageChannel=new MessageChannel,this.resolvers=new Map,this.temporaryBrokerStorage=i,this.onWindowMessageCb=this.onWindowMessage.bind(this),this.handshake={correlationId:t,inFlight:!1,wait:Promise.resolve(),resolve:()=>{},reject:()=>{}},this.sessionId=c}async isBrokerConnected(){return this.handshake.inFlight&&await this.handshake.wait.catch((e=>{const t=e;this.logger.error(t.message)})),!!this.brokerMetadata}setHandshakeReference(e){this.handshake.performanceEvent?.discard(),this.handshake.performanceEvent=e;const t=()=>{this.handshake.performanceEvent?.add({brokerHandshakeTimeoutMs:this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout}),this.handshake.reject(JE(KE))};if(this.handshake.inFlight)return clearTimeout(this.handshake.timeoutId),void(this.handshake.timeoutId=setTimeout(t,this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout));this.handshake.inFlight=!0,this.handshake.wait=new Promise(((e,r)=>{this.handshake.timeoutId=setTimeout(t,this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout),this.handshake.resolve=e,this.handshake.reject=r})).then((()=>{this.resolvers.forEach((e=>{clearTimeout(e.timeoutId),e.reject(JE(QE))})),this.resolvers.clear(),this.handshake.performanceEvent?.end({success:!0})})).catch((e=>{const t=e;throw this.logger.error(t.message),this.handshake.performanceEvent?.end({success:!1},t),e})).finally((()=>{this.handshake.inFlight=!1}))}getAncestors(){const e=[];let t=window;for(;t&&t.parent&&t.parent.window!==t;)t=t.parent?.window,e.push(t);return this.logger.verbose(`Attempting to send handshake request to ${e.length} ancestors`),e}async initiateHandshake(e){if(0===this.pwbBrokeredAppConfiguration.trustedBrokerDomains.length)throw JE(GE);this.initMeasurement?.discard(),this.initMeasurement=e;try{this.setHandshakeReference(e),window.addEventListener("message",this.onWindowMessageCb);const t=[];t.push(window),t.push(...this.getAncestors());for(let r=0;r<t.length;r++){const n=t[r],o=t.length-r-1;this.logger.verbose(`Sending handshake request to frame with depth = ${o}`),pk(this.sendHandshakeRequest.bind(this),wu.SendHandshakeRequest,this.logger,this.performanceClient,e?.event.correlationId)(n,o,void 0,e)}await this.isBrokerConnected()}catch(e){const t=e;this.logger.error(t.message)}}async onWindowMessage(e){try{if(e.data&&e.origin&&this.pwbBrokeredAppConfiguration.trustedBrokerDomains.includes(e.origin)){if(e.data.messageType===vE){this.logger.verbose("Broker is available.");const t=this.performanceClient.startMeasurement(wu.PairwiseBrokerApplicationInitializeBrokering,this.handshake.correlationId);t.add({isBackground:!0}),e.origin===this.brokerMetadata?.origin&&(this.brokerMetadata=null,ak(this.messageChannel)),this.setHandshakeReference(t);const r=pk(this.getFrameDepth.bind(this),wu.GetFrameDepth,this.logger,this.performanceClient,this.handshake.correlationId)(e.source);return pk(this.sendHandshakeRequest.bind(this),wu.SendHandshakeRequest,this.logger,this.performanceClient,this.handshake.correlationId)(e.source,r,e.origin,t)}e.data.messageType===CE&&(this.handshake.performanceEvent=this.initMeasurement,this.onHandshakeResponse(e))}}catch(e){const t=e;this.logger.error(t.message)}}getFrameDepth(e){const t=[];t.push(window),t.push(...this.getAncestors());for(let r=0;r<t.length;r++){if(t[r]===e)return t.length-r-1}return 0}closeBrokerConnection(){this.logger.verbose("Closing broker connection."),this.brokerMetadata=null,ak(this.messageChannel),this.messageChannelList.forEach((e=>ak(e.channel))),window.removeEventListener("message",this.onWindowMessageCb)}async sendSsoSilentRequest(t){const r=this.performanceClient.startMeasurement(wu.EmbeddedClientApplicationSendSSOSilentRequest,t.correlationId);ks(!0),r.increment({visibilityChangeCount:0});const n=()=>{this.trackPageVisibility(t.correlationId)};document.addEventListener("visibilitychange",n);try{const n=await gk(this.sendRequest.bind(this),wu.SendRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Silent),o=await gk(this.handleResponse.bind(this),wu.HandleResponse,this.logger,this.performanceClient,t.correlationId)(n,t);if(!o)throw this.logger.errorPii(`Broker response is empty in brokered ssoSilent request: ${JSON.stringify(o)}`),JE(HE);return r.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId},t.correlationId),o}catch(e){throw r.end({success:!1},e),e}finally{document.removeEventListener("visibilitychange",n)}}async sendPopupRequest(t){const r=this.performanceClient.startMeasurement(wu.EmbeddedClientApplicationSendPopupRequest,t.correlationId);ks(!0);try{const n=await gk(this.sendRequest.bind(this),wu.SendRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Popup),o=await gk(this.handleResponse.bind(this),wu.HandleResponse,this.logger,this.performanceClient,t.correlationId)(n,t);if(!o){if(!BE.validate(n))throw this.logger.errorPii(`Broker response is empty in brokered popup request: ${JSON.stringify(o)}`),JE(HE);throw this.logger.verbose("popupRequest requires a redirect by the broker, this app will now redirect."),JE(DE)}return r.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId}),o}catch(e){throw r.end({success:!1},e),e}}async sendHandleRedirectRequest(e){const t=this.performanceClient.startMeasurement(wu.EmbeddedClientApplicationHandleRedirectRequest,e.correlationId);try{const r=new ZE(this.clientId,ok,this.sessionId),n=await gk(this.messageBroker.bind(this),wu.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(r,e.correlationId).catch((t=>{if(t instanceof $E&&t.errorCode===QE)return this.performanceClient.addFields({brokerConnReset:!0},e.correlationId),gk(this.messageBroker.bind(this),wu.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(r,e.correlationId);throw t}));t.add({brokerSessionId:n?.data?.sessionId});const o=await gk(this.handleResponse.bind(this),wu.HandleResponse,this.logger,this.performanceClient,e.correlationId)(n,e);return t.end({success:!0,fromCache:o?.fromCache,accessTokenSize:o?.accessToken.length,idTokenSize:o?.idToken.length,isNativeBroker:o?.fromNativeBroker}),o}catch(e){throw t.end({success:!1},e),e}}async sendSilentRefreshRequest(t){const r=this.performanceClient.startMeasurement(wu.EmbeddedClientApplicationSendSilentRefreshRequest,t.correlationId);ks(!0),r.increment({visibilityChangeCount:0});const n=()=>this.trackPageVisibility(t.correlationId);document.addEventListener("visibilitychange",n);try{const n=await gk(this.sendRequest.bind(this),wu.SendRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Silent),o=await gk(this.handleResponse.bind(this),wu.HandleResponse,this.logger,this.performanceClient,t.correlationId)(n,t);if(!o)throw this.logger.errorPii(`Broker response is empty in brokered silent refresh request: ${JSON.stringify(o)}`),JE(HE);return r.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId}),o}catch(e){throw r.end({success:!1},e),e}finally{document.removeEventListener("visibilitychange",n)}}async sendRequest(e,t){if(e.authenticationScheme===U.POP){const t=new fu(e);e.popKid=await t.generatePublicKeyThumbprint();const r=nk(this.clientId);this.temporaryBrokerStorage.containsKey(r)&&this.temporaryBrokerStorage.setItem(r,JSON.stringify(e))}const r=new LE(this.clientId,t,e,"",this.sessionId);return gk(this.messageBroker.bind(this),wu.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(r,e.correlationId).catch((t=>{if(t instanceof $E&&t.errorCode===QE)return gk(this.messageBroker.bind(this),wu.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(r,e.correlationId);throw t}))}getMessageChannelProperties(e){return e?this.messageChannelList.find((t=>t.nonce===e)):this.getMessageChannelPropertiesByDepth(0)}getMessageChannelPropertiesByDepth(e){return this.messageChannelList.find((t=>t.depth===e))}onHandshakeResponse(e){const t=this.handshake.performanceEvent;try{const r=xE.validate(e,this.pwbBrokeredAppConfiguration.trustedBrokerDomains);if(r){const e=this.getMessageChannelProperties(r.nonce);if(!e)return this.logger.trace("No MessageChannel found, ignoring this response"),void t?.increment({handshakeIgnoredCount:1});if(r.nonce&&r.nonce!==e.nonce)return this.logger.trace("Received handshake response but there is a newer handshake request in flight, ignoring this one"),void t?.increment({handshakeIgnoredCount:1});this.handshake.timeoutId&&clearTimeout(this.handshake.timeoutId),this.logger.verbose("Received handshake response");const n=ik(r.version);n.major<=3&&n.minor<15&&ak(e.channel),ak(this.messageChannel),this.messageChannel=e.channel,this.brokerMetadata={origin:r.brokerOrigin,version:r.version,semver:n,frameDepth:e.depth},t?.add({brokerFrameDepth:e.depth,brokerSessionId:r.sessionId}),this.handshake.resolve()}}catch(e){this.handshake.reject(e)}}sendHandshakeRequest(e=window.top,t,r,n){if(this.logger.trace("Pairwise Broker - sendHandshakeRequest called."),!e)throw this.logger.error("Target frame is undefined."),JE(zE);let o=new MessageChannel;const i=As();o.port1.onmessage=async t=>{t.data&&(t.data.messageType===CE?(this.logger.warning("Received handshake response but the broker app is using a version of MSAL.js that does not report its origin, attempting direct communication with each trusted broker domain to resolve. This is a known issue with versions 3.15.0-3.19.1, consider asking the broker app to upgrade."),this.pwbBrokeredAppConfiguration.trustedBrokerDomains.forEach((t=>{const r=new MessageChannel;r.port1.onmessage=e=>(ak(o),o=r,pk(this.onHandshakeResponse.bind(this),wu.OnHandshakeResponse,this.logger,this.performanceClient,n?.event.correlationId)({...e,data:{...e.data},origin:t})),this.logger.verbose(`Sending handshake request to ${t}`),e?.postMessage(a,t,[r.port2])}))):await gk(this.handleBrokerMessage.bind(this),wu.HandleBrokerMessage,this.logger,this.performanceClient,n?.event.correlationId)(t))};const a=new UE(this.clientId,ok,!0,this.sessionId,i),s=this.getMessageChannelPropertiesByDepth(t);s?(ak(s.channel),s.channel=o,s.nonce=i):this.messageChannelList.push({channel:o,nonce:i,depth:t}),this.logger.verbose("Sending handshake request"),n?.increment({handshakeSentCount:1}),e?.postMessage(a,r||"*",[o.port2])}async handleBrokerMessage(t){const r=t.data?.result?.correlationId||t.data?.errorPayload?.correlationId,n=t.data.messageType;if(this.logger.verbose(`Received message from broker of type: ${n} with correlationId: ${r}`),!n)return;let o;if(n===kE)return this.logger.verbose("Received logout message from broker."),await this.handleLogoutMessageFromBroker(t),void this.messageChannel.port1.postMessage(new hk(ok,this.clientId,r,this.sessionId));if(n===EE&&t.data.interactionType===e.InteractionType.Redirect)this.logger.verbose("Received redirect response from broker."),o=e.InteractionType.Redirect;else{if(!r)return void this.logger.verbose(`No correlationId found in message: ${n}.`);this.logger.verbose(`Resolving message for ${r}.`),o=r}const i=this.resolvers.get(o);i?(clearTimeout(i.timeoutId),i.resolve(t),this.resolvers.delete(o)):this.logger.warning(`Cannot resolve message for ${r}. Ignoring.`)}async messageBroker(t,r){return new Promise(((n,o)=>{if(!this.brokerMetadata)return void o(JE(jE));let i=this.pwbBrokeredAppConfiguration.brokerMessageTimeout;const a={};t.interactionType===e.InteractionType.Popup?(a.brokerInteractionTimeoutMs=this.pwbBrokeredAppConfiguration.brokerInteractionTimeout,i=this.pwbBrokeredAppConfiguration.brokerInteractionTimeout):a.brokerMessageTimeoutMs=this.pwbBrokeredAppConfiguration.brokerMessageTimeout,this.performanceClient.addFields(a,r);const s=setTimeout((()=>{o(JE(FE))}),i),c=t.messageType===wE?e.InteractionType.Redirect:r;if(this.resolvers.set(c,{resolve:n,reject:o,timeoutId:s}),this.brokerMetadata.semver.major>3||3===this.brokerMetadata.semver.major&&this.brokerMetadata.semver.minor>=15)this.messageChannel.port1.postMessage(t);else{const e=new MessageChannel;e.port1.onmessage=this.handleBrokerMessage.bind(this),window.top?.postMessage(t,this.brokerMetadata.origin,[e.port2])}}))}async handleResponse(e,t){const r=XE.validate(e);if(!r)return null;if(t.correlationId&&this.performanceClient.addFields({brokerSessionId:r.sessionId},t.correlationId),r.errorPayload)throw XE.detectError(r.errorPayload);if(!r.result)throw JE(HE);let n;if(await this.hydrateCache(r.result,t),t.authenticationScheme===U.POP){if(!t.popKid)throw JE(WE);const e=new fu(t);n=await e.signRequest(r.result.accessToken,t.popKid)}return{...r.result,accessToken:n||r.result.accessToken,pairwiseBrokerOrigin:this.brokerMetadata?.origin}}async handleLogoutMessageFromBroker(e){tk.validate(e)&&(this.logger.verbose("Logout request received from broker and validated. Logging out embedded app."),await this.clearCache())}trackPageVisibility(e){this.logger.info("Embedded client: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e)}}e.AccountEntity=vr,e.ApiId=Sa,e.AuthError=se,e.AuthErrorCodes=oe,e.AuthErrorMessage=ae,e.AuthenticationHeaderParser=class{constructor(e){this.headers=e}getShrNonce(){const e=this.headers[c.AuthenticationInfo];if(e){const t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw nr(Yt)}const t=this.headers[c.WWWAuthenticate];if(t){const e=this.parseChallenges(t);if(e.nonce)return e.nonce;throw nr(Yt)}throw nr(Vt)}parseChallenges(e){const r=e.indexOf(" "),n=e.substr(r+1).split(","),o={};return n.forEach((e=>{const[r,n]=e.split("=");o[r]=unescape(n.replace(/['"]+/g,t.EMPTY_STRING))})),o}},e.AuthenticationScheme=U,e.AzureCloudInstance=ut,e.BrokerAuthError=$E,e.BrokerAuthErrorCodes=VE,e.BrowserAuthError=Xi,e.BrowserAuthErrorCodes=Vi,e.BrowserAuthErrorMessage=Ji,e.BrowserCacheLocation=ca,e.BrowserConfigurationAuthError=ds,e.BrowserConfigurationAuthErrorCodes=cs,e.BrowserConfigurationAuthErrorMessage=ls,e.BrowserPerformanceClient=Cu,e.BrowserPerformanceMeasurement=Tu,e.BrowserUtils=_s,e.CacheLookupPolicy=Na,e.ClientAuthError=rt,e.ClientAuthErrorCodes=Ze,e.ClientAuthErrorMessage=tt,e.ClientConfigurationError=rr,e.ClientConfigurationErrorCodes=Zt,e.ClientConfigurationErrorMessage=tr,e.DEFAULT_IFRAME_TIMEOUT_MS=Os,e.EventHandler=Tc,e.EventMessageUtils=class{static getInteractionStatusFromEvent(t,r){switch(t.eventType){case uc.LOGIN_START:return Aa.Login;case uc.SSO_SILENT_START:return Aa.SsoSilent;case uc.ACQUIRE_TOKEN_START:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup)return Aa.AcquireToken;break;case uc.HANDLE_REDIRECT_START:return Aa.HandleRedirect;case uc.LOGOUT_START:return Aa.Logout;case uc.SSO_SILENT_SUCCESS:case uc.SSO_SILENT_FAILURE:if(r&&r!==Aa.SsoSilent)break;return Aa.None;case uc.LOGOUT_END:if(r&&r!==Aa.Logout)break;return Aa.None;case uc.HANDLE_REDIRECT_END:if(r&&r!==Aa.HandleRedirect)break;return Aa.None;case uc.LOGIN_SUCCESS:case uc.LOGIN_FAILURE:case uc.ACQUIRE_TOKEN_SUCCESS:case uc.ACQUIRE_TOKEN_FAILURE:case uc.RESTORE_FROM_BFCACHE:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup){if(r&&r!==Aa.Login&&r!==Aa.AcquireToken)break;return Aa.None}}return null}},e.EventType=uc,e.InteractionRequiredAuthError=Eo,e.InteractionRequiredAuthErrorCodes=yo,e.InteractionRequiredAuthErrorMessage=wo,e.InteractionStatus=Aa,e.JsonWebTokenTypes=te,e.LocalStorage=ac,e.Logger=at,e.MemoryStorage=Ys,e.NavigationClient=Rs,e.OIDC_DEFAULT_SCOPES=a,e.PairwiseBrokerApplication=class extends mE{constructor(e,t,r){super(e,r),this.pwbBrokerAppConfig=ek(t),this.temporaryBrokerStorage=rk(e,this.getLogger(),this.performanceClient),this.eventHandler=new Tc(this.getLogger()),this.redirectResponse=new Map,this.initialized=!1}async initialize(e){await super.initialize(e),this.initialized=!0}async initializeBrokering(e,t){if("undefined"==typeof window)return;const r={...t,correlationId:t?.correlationId||As()},n=this.performanceClient.startMeasurement(wu.PairwiseBrokerApplicationInitializeBrokering,r.correlationId);n.add({isBackground:!1});try{this.pwbBrokerAppConfig.actAsBroker?(this.pwbBrokerAppConfig.allowBrokering&&this.getLogger().verbose("Running in top frame and both actAsBroker, allowBrokering flags set to true. actAsBroker takes precedence."),n.add({isBroker:!0}),this.broker||(this.getLogger().verbose("Acting as Broker"),this.broker=new dk(this.getConfiguration(),this.pwbBrokerAppConfig,this.eventHandler),await this.broker.initialize(r)),this.broker.isListening?this.getLogger().info("Broker already initialized"):await this.broker.listenForBrokerMessage(e,n),n.end({success:!0})):this.pwbBrokerAppConfig.allowBrokering&&(this.getLogger().verbose("Acting as child"),n.add({isBroker:!1}),this.embeddedApp?await this.embeddedApp.isBrokerConnected()?this.getLogger().info("Embedded app is already connected to the broker"):(this.getLogger().info("initializeBrokering was called again, retrying handshake"),await this.embeddedApp.initiateHandshake(n)):(this.embeddedApp=new fk(this.getConfiguration().auth.clientId,r.correlationId,this.pwbBrokerAppConfig,this.getLogger(),this.performanceClient,this.temporaryBrokerStorage,this.hydrateCache.bind(this),this.clearCache.bind(this),this.sessionId),await this.embeddedApp.initiateHandshake(n)))}catch(e){throw n.end({success:!1},e),e}}createEmbeddedRequest(e){const t={...e,correlationId:e.correlationId||As()};return t.account||t.sid||t.loginHint||(t.account=this.getActiveAccount()||void 0),t}async handleRedirectPromise(t){if(Es(this.initialized),"undefined"!=typeof window){const r=t||"";let n=this.redirectResponse.get(r);if(void 0===n){this.eventHandler.emitEvent(uc.HANDLE_REDIRECT_START,e.InteractionType.Redirect);const o=this.getAllAccounts();n=this.handleRedirectPromiseInternal(t).then((t=>{if(!t)return null;const r=o.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(r?uc.LOGIN_SUCCESS:uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t),t})).catch((t=>{throw this.eventHandler.emitEvent(o.length>0?uc.ACQUIRE_TOKEN_FAILURE:uc.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),t})).finally((()=>{this.eventHandler.emitEvent(uc.HANDLE_REDIRECT_END,e.InteractionType.Redirect)})),this.redirectResponse.set(r,n)}return n}return null}async handleRedirectPromiseInternal(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected()){const e=nk(this.controller.getConfiguration().auth.clientId),t=this.temporaryBrokerStorage.getItem(e);if(t){const r=JSON.parse(t);return await this.embeddedApp.sendHandleRedirectRequest(r).catch((e=>{throw e instanceof se&&e.setCorrelationId(r.correlationId),e})).finally((()=>{this.temporaryBrokerStorage.removeItem(e)}))}return null}return this.broker?this.broker.handleRedirectPromise(e):super.handleRedirectPromise(e)}async loginRedirect(e){return this.acquireTokenRedirect(e||{scopes:a})}async acquireTokenRedirect(t){const r=0===this.getAllAccounts().length;return this.eventHandler.emitEvent(r?uc.LOGIN_START:uc.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t),super.acquireTokenRedirect(t).catch((t=>(this.eventHandler.emitEvent(r?uc.LOGIN_FAILURE:uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t),Promise.reject(t))))}async loginPopup(e){return this.acquireTokenPopup(e||{scopes:a})}async acquireTokenPopup(t){ks(!0);const r=this.createEmbeddedRequest(t),n=this.getAllAccounts();return this.eventHandler.emitEvent(0===n.length?uc.LOGIN_START:uc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,r),this.acquireTokenPopupInternal(r).then((t=>{const r=n.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(r?uc.LOGIN_SUCCESS:uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t),t})).catch((t=>{t instanceof se&&t.setCorrelationId(r.correlationId);const o=0===n.length;return this.eventHandler.emitEvent(o?uc.LOGIN_FAILURE:uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t),Promise.reject(t)}))}async acquireTokenPopupInternal(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected()){this.getLogger().verbose("pairwise broker (embedded app) acquireTokenPopup called",e.correlationId);const t=nk(this.controller.getConfiguration().auth.clientId);this.temporaryBrokerStorage.setItem(t,JSON.stringify(e));return await this.embeddedApp.sendPopupRequest(e).finally((()=>{this.temporaryBrokerStorage.removeItem(t)}))}return super.acquireTokenPopup(e)}async ssoSilent(t){ks(!0);const r=this.createEmbeddedRequest(t);return this.eventHandler.emitEvent(uc.SSO_SILENT_START,e.InteractionType.Silent,r),this.ssoSilentInternal(r).then((t=>(this.eventHandler.emitEvent(uc.SSO_SILENT_SUCCESS,e.InteractionType.Silent,t),t))).catch((t=>{throw t instanceof se&&t.setCorrelationId(r.correlationId),this.eventHandler.emitEvent(uc.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),t}))}async ssoSilentInternal(e){return this.embeddedApp&&await this.embeddedApp.isBrokerConnected()?(this.getLogger().verbose("ssoSilent called",e.correlationId),this.embeddedApp.sendSsoSilentRequest(e)):super.ssoSilent(e)}async acquireTokenSilent(t){ks(!0);const r=this.createEmbeddedRequest(t);return this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,r),this.acquireTokenSilentInternal(r).then((t=>(this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,t),t))).catch((t=>(t instanceof se&&t.setCorrelationId(r.correlationId),this.eventHandler.emitEvent(uc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),Promise.reject(t))))}async acquireTokenSilentInternal(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected()){this.getLogger().verbose("acquireTokenSilent - attempting to acquire token from web flow");const t={...e,cacheLookupPolicy:Na.AccessToken};let r;r=e.cacheLookupPolicy===Na.RefreshToken||e.cacheLookupPolicy===Na.RefreshTokenAndNetwork||e.cacheLookupPolicy===Na.Skip||e.forceRefresh?Promise.reject(new rt(Fe)):super.acquireTokenSilent(t);const n=this.embeddedApp;return r.catch((async t=>{if(e.cacheLookupPolicy===Na.AccessToken)throw t;return n.sendSilentRefreshRequest(e)}))}return super.acquireTokenSilent(e)}async logoutRedirect(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected())this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutRedirect(e)}async logoutPopup(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected())this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutPopup(e)}setActiveAccount(e){this.broker&&this.broker.setActiveAccount(e),super.setActiveAccount(e)}addEventCallback(e,t=Object.values(uc)){const r=[uc.ACQUIRE_TOKEN_START,uc.ACQUIRE_TOKEN_SUCCESS,uc.ACQUIRE_TOKEN_FAILURE,uc.LOGIN_START,uc.LOGIN_SUCCESS,uc.LOGIN_FAILURE,uc.SSO_SILENT_START,uc.SSO_SILENT_SUCCESS,uc.SSO_SILENT_FAILURE,uc.HANDLE_REDIRECT_START,uc.HANDLE_REDIRECT_END],n=[],o=[];t.forEach((e=>{r.includes(e)?n.push(e):o.push(e)}));const i=super.addEventCallback(e,o);return i?(this.eventHandler.addEventCallback(e,n,i),i):null}removeEventCallback(e){super.removeEventCallback(e),this.eventHandler.removeEventCallback(e)}},e.PerformanceEvents=Qn,e.PromptValue=g,e.ProtocolMode=mr,e.PublicClientApplication=mE,e.PublicClientNext=pu,e.ServerError=oo,e.ServerResponseType=m,e.SessionStorage=sc,e.SignedHttpRequest=fu,e.StringUtils=or,e.StubPerformanceClient=$o,e.UrlString=Ir,e.WrapperSKU={React:"@azure/msal-react",Angular:"@azure/msal-angular"},e.createNestablePublicClientApplication=async function(e){const t=new Qs(e);if(await t.initialize(),t.isAvailable()){const r=new su(t),n=new uu(e,r);return await n.initialize(),n}return lu(e)},e.createStandardPublicClientApplication=lu,e.stubbedPublicClientApplication=gu,e.version=ok})),function(e){function t(){return"true"===e.sessionStorage.getItem("MsalJsV4")}let r;async function n(t){const r=(t.requestHeaders||[]).concat([["Content-Type",t.contentType],["Authorization",t.authHeader],["x-ms-client-session-id",e.sessionStorage.getItem("Redirect_SessionId")]]),n=await fetch(t.uri,{method:t.httpMethod||"GET",headers:r,body:t.data}),o=await n.json(),i=n.headers;if(!n.ok)throw new Error(JSON.stringify({message:"RequestError",responseHeaders:i,responseText:o,status:n.status,statusText:n.statusText,uri:t.uri}));return{value:o,headers:i}}function o(e){let t;if(e)try{t=JSON.parse(e)}catch{}return t}e.useMsalJsV4InCurrentSession=t,function(r){const n=window.msalv2,o=window.msalv4;r.getPublicClientAppWrapper=r=>{const{requestedPublicClientAppId:i,portalClientId:a,authority:s,tenant:c,isNativeBrokerEnabled:u}=r,l=window.location.origin,d=()=>({auth:{clientId:i,authority:e.ensureTrailingSlash(s)+c},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}});let h;return t()?(h=i===a?{actAsBroker:!0,preferredInteractionType:o.InteractionType.Redirect,brokerMessageTimeout:6e4}:{preferredInteractionType:o.InteractionType.Redirect,allowBrokering:!0,trustedBrokerDomains:[l],brokerMessageTimeout:6e4},new o.PairwiseBrokerApplication({...d(),system:{allowPlatformBroker:u}},h)):(h=i===a?{brokerOptions:{actAsBroker:!0,preferredInteractionType:n.InteractionType.Redirect,brokerMessageTimeout:6e4}}:{brokerOptions:{preferredInteractionType:n.InteractionType.Redirect,allowBrokering:!0,trustedBrokerDomains:[l],brokerMessageTimeout:6e4}},new n.ExperimentalPublicClientApplication(d(),h))},r.loginRedirect=async(e,t)=>await e.portalPcApp.loginRedirect({redirectUri:`${window.location.origin}/auth/login/`,redirectStartPage:`${window.location.origin}/auth/login/`,scopes:[`${e.armAadResource}/.default`],...t}),r.handleRedirectPromise=async e=>await e.handleRedirectPromise(),r.acquireTokenSilent=async e=>{const{account:t,authority:r,forceRefresh:n,publicClientApp:o,scopes:i,cacheLookupPolicy:a}=e;return await o.acquireTokenSilent({account:t,authority:r,forceRefresh:n,scopes:i,cacheLookupPolicy:a})},r.initialize=async e=>await e.initialize(),r.initializeBrokering=async e=>await e.initializeBrokering()}(r=e.MsalWrappers||(e.MsalWrappers={})),e.request=n,e.parseJsonOrDefault=o;const i=o(e.sessionStorage.getItem("SavedLogs"))||[];function a(t){const{source:r,action:n,actionModifier:o,duration:a}=t,s=t.data||{};i.push({timestamp:Date.now(),source:r,action:n,actionModifier:o,duration:a,data:{...s,sessionId:e.sessionStorage.getItem("Redirect_SessionId")}});try{e.sessionStorage.setItem("SavedLogs",JSON.stringify(i))}catch{}}let s;function c(t){const{lookupPreservedOptionAcrossRedirect:r,portalServerMsalJsConfig:n,requestedTenant:i,userQueryStringInUrl:a}=t;let s,c,u;if(r&&(s=o(e.sessionStorage.getItem("MsalJsLoginParams")),s))return"organizations"===i?(delete s.extraQueryParameters?.acr_values,delete s.extraQueryParameters?.claims,s):s;if("true"===e.extractValueFromQueryString(a,"selectAccount")?.toLowerCase())c="select_account";else{const t=e.extractValueFromQueryString(a,"loginHint".toLowerCase());t&&(u=decodeURIComponent(t))}const l=o(decodeURIComponent(e.extractValueFromQueryString(a,"signInParameters")));s={prompt:c,loginHint:u,extraQueryParameters:{site_id:n.site_id,...l}},n.cobrandid&&(s.extraQueryParameters.cobrandid=n.cobrandid),n.msafed&&(s.extraQueryParameters.msafed=n.msafed);const d=e.extractValueFromQueryString(a,"whr");return d&&(s.extraQueryParameters.whr=d),e.sessionStorage.setItem("MsalJsLoginParams",JSON.stringify({extraQueryParameters:{...s.extraQueryParameters}})),s}e.saveLog=a,e.fetchCrossTenantSettings=async function(e){try{const t=`${location.protocol}//${location.host}`;s||(s=await n({uri:`${t}/api/Settings/Select`,httpMethod:"POST",authHeader:e.armAccessToken,contentType:"application/json",data:JSON.stringify(["CrossTenant"])}))}catch(t){e.onError(t.message||t.toString())}return s},e.writeMfaSatisfiedByUserToSettings=async function(e){try{const t=`${location.protocol}//${location.host}`;await n({uri:`${t}/api/Settings/Update`,httpMethod:"POST",authHeader:e.armAccessToken,contentType:"application/json",data:JSON.stringify({save:{Login:{MfaSatisfied:"true"}}})})}catch(t){e.onError(t.message||t.toString())}},e.buildMsaljsLoginRedirectParams=c,e.loginUsingMsalJs=async function(n){const{isNativeBrokerEnabled:i,loginStage:s,portalOptions:u,portalServerMsalJsConfig:l,source:d,userQueryStringInUrl:h}=n,p=u.portalRequestedTenantInfo.id,g=r.getPublicClientAppWrapper({authority:u.authority,isNativeBrokerEnabled:i,portalClientId:u.portalClientId,requestedPublicClientAppId:u.portalClientId,tenant:p});let f;const m={portalServerMsalJsConfig:l,requestedTenant:p,source:d,userQueryStringInUrl:h};switch(s.type){case"Startup":a({source:d,action:"Startup",data:{requestedTenant:p}}),f=c(m);break;case"HandleLoginRedirect":a({source:d,action:"HandleLoginRedirect",data:{requestedTenant:p}}),f=c({...m,lookupPreservedOptionAcrossRedirect:!0});break;case"MfaEnforcedSignIn":a({source:d,action:"MfaEnforcedSignIn",data:{requestedTenant:p}}),f=c({...m,lookupPreservedOptionAcrossRedirect:!0}),f.loginHint=s.mfaEnforcedSignInData.loginHint,p&&"organizations"!==p&&(f.extraQueryParameters={...f.extraQueryParameters,claims:'{"id_token":{"acrs":{"essential":true,"value":"p1"}}}'},function(e,t,r){a({source:e,action:"MfaClaimsAdded",data:{reason:t,requestedTenant:r}})}(d,"MfaEnforcedSignInBeforeClientLoad",p));break;case"SignInToDefault":{const t=s.signInToDefaultStageData;f={...o(e.sessionStorage.getItem("MsalJsLoginParams"))||{},loginHint:t.loginHint};break}}a({source:d,action:"MsalJsLoginInitiated",data:{tenant:p,loginStage:s.type}}),(t()||i)&&await r.initialize(g),await r.initializeBrokering(g);const v=await r.handleRedirectPromise(g);if(!v||f.extraQueryParameters?.acr_values||f.extraQueryParameters?.claims){"organizations"!==p&&e.sessionStorage.setItem("PortalRequestedTenant",JSON.stringify(u.portalRequestedTenantInfo));const t=e.parseJsonOrDefault(e.sessionStorage.getItem("PreservedPortalQueryStrings"))||{};return["mfalogin","loginHint"].forEach((r=>{const n=e.extractValueFromQueryString(h,r);n&&(t[r]=n)})),u.forceSignInQueryStringValue&&(t.forcesignin=u.forceSignInQueryStringValue.toLowerCase()),i&&(t.nativebroker=i+""),e.sessionStorage.setItem("PreservedPortalQueryStrings",JSON.stringify(t)),a({source:d,action:"RedirectingToIdp",data:{tenant:p,loginStage:s.type}}),await r.loginRedirect({portalPcApp:g,armAadResource:u.armAadResource},f)}return a({source:d,action:"MsalJsLoginComplete",data:{tenant:p,loginStage:s.type,isNonEmptyAuthenticationResult:!!v}}),{portalPcApp:g,authenticationResult:v}}}(MsPortalImpl||(MsPortalImpl={})),function(e){e.getTokenExpirationInMs=function(e,t){const r=e.getTime()-Date.now(),n=r-t;return Math.floor(n<0?r:n)};e.AadIdentity=class{constructor(t){this._idTokenClaims=t,this.tenantRegionScope=t.tenant_region_scope,this.xmsWsit=t.xms_wsit,this.sid=t.sid,this.tid=t.tid,this.ctry=t.ctry,this.givenName=t.given_name,this.familyName=t.family_name,this.oid=t.oid,this.aai=t.aai,this.xmsEt=t.xms_et,this.gitHubUserId=null,t.prov_data?.length&&(this.gitHubUserId=t.prov_data.map((e=>{const t=e,r=e;return{prov:t.Prov||r.prov,altsecid:t.Altsecid||r.altsecid,at:t.At||r.at}})).find((e=>"github.com"===e.prov.toLowerCase()))?.altsecid??null),e.saveLog({source:"AadIdentity",action:"xms_et",data:{xms_et:this.xmsEt}})}tryGetPuid(){const e=this._idTokenClaims,t=e.idp,r=e.iss;let n=!1,o=!1,i="";if(t&&t!==r){const t=e.altsecid||"";if(t){const e=t.toLowerCase();if(e.startsWith("1:live.com:"))i=t.substring(11),n=!1,o=!0;else{if(!e.startsWith("5::"))throw e.startsWith("6:")?new Error(`The logged in user's claim includes an AAD intermediate Alternative Security ID claim (altSecId). The claim value was: ${t}`):new Error(`The logged in user's claim includes an Alternative Security Id claim (altsecid), but does not start with the expected prefixes '1:live.com:' or '5::'. The claim value was: ${t}`);i=t.substring(3),n=!0,o=!0}}}else o=!1,i=e.puid,n=!!i;return{puid:i,isOrgId:n,isForeignPrincipalObject:o}}getEmailAddress(e){const t=this._idTokenClaims,r=t.upn||"",n=t.email||"";return e?r||n:n||r}getFirstName(e){return this._idTokenClaims.given_name||this.getEmailAddress(e)}getIsMfa(t){const r=(this._idTokenClaims.acrs||[]).includes("p1"),n=(this._idTokenClaims.amr||[]).includes("mfa"),o=function(t){try{const e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r).amr.includes("mfa")}catch(t){e.saveLog({source:"AadIdentity",action:"errorParsingAccessToken",data:{exception:t}})}return!1}(t);return e.saveLog({source:"AadIdentity",action:"GetIsMfa",data:{idTokenAcrsP1:r,legacyIdTokenMfaIndicators:n,accessTokenMfaIndicator:o}}),r||n||o}getIsTenantAdmin(e){return!!e&&(this._idTokenClaims.wids||[]).some((t=>t===e))}getPreferredUsername(e){const t=this._idTokenClaims;return e?this.getEmailAddress(e):t.preferred_username||""}getRawName(){const e=this._idTokenClaims;return e.unique_name||e.preferred_username||""}}}(MsPortalImpl||(MsPortalImpl={})),function(e){let t=window,r=t.document,n=t.location,o=r.body;function i(e){return(e||"")+""}e.stringify=i;let a=i(navigator&&navigator.userAgent);function s(e,t){return e.includes(t)}const c=JSON.stringify,u=encodeURIComponent;e.cobrand=function(){};const l="Redirect_SomeRandomKey";function d(e){const t=s(a,"Windows");if((s(a,"Macintosh; Intel")||t)&&s(a,"Safari")&&!s(a,"Chrome")&&function(e){if(s(a,e)){const t=new RegExp(`\\s${e}/(\\d+)[\\.\\s$]`).exec(a),r=i(t&&t[1]);return parseInt(r,10)}}("Version")<=11)return e+"?reason=isSafari";const n=!!r.documentMode,o=/Trident\//i.test(a),c=s(a,"MSIE"),u=!Array.prototype.find;return n||o||c||u?e+"?reason=isIE":Promise&&Promise.prototype.finally&&Promise.allSettled&&Promise.any?"":e+"?reason=promise"}function h(e){return p("clearedStorage=true",`${e}/Html5StorageExceeded`,!0)}function p(t,r,o){return n.search.includes(t)?r:(o&&(e.localStorage.clear(),e.sessionStorage.clear()),(n.search&&n.search+"&"||"?")+t+n.hash)}function g(e,t){if(void 0!==e)return e;if(t&&t.startsWith("flight:")){const e=parseFloat(t.split(":")[1]);return Math.random()<e?"true":"false"}return t}e.redirect=async function(a){const s=a.portalServerConfig,f=a.portalServerFeatures,m=s.errorUri;if("aad.portal.azure.com"===n.hostname.toLowerCase()&&["","#","#home"].includes(n.hash.toLowerCase()))return void(n.href=`https://entra.microsoft.com${n.pathname||""}${n.search||""}#view/Microsoft_AAD_IAM/TenantOverview.ReactView`);let v;try{const u=function(t){let r;try{[e.localStorage,e.sessionStorage].forEach((e=>{if(r=e.length,e.setItem(l,l),l!==e.getItem(l))throw l;e.removeItem(l)}))}catch(e){return 22===e.code&&r?h(t):p("storagepolyfill=true",`${t}/UE_NoHtml5Storage`)}}(m),y=s.portalQuery,C=s.applicationPath,T=s.supportedLanguages,I=e.parseQuery(t.location.search),w=[...I],E=s.unsupportedUri,k=(t,r)=>g(e.extractValueFromQueryString(w,"feature."+t),r),S=t=>e.getFirstQueryValue(w,t,!0);if(v=d(E)||function(e){return t.Intl?"":e+"?reason=intl"}(E)||u,!v){const u=e.sessionStorage,l=e.localStorage;l.removeItem("signOutAll");const d=S("Referrer");y.env=e.getPortalEnv(),"true"===S("feature.armbreakglass")&&u.setItem("Redirect_ArmBreakGlass","true");const h=S("sessionId"),p=FxImpl.createGuid(h,!0);u.setItem("Redirect_SessionId",p),e.trySaveAllowedState(s.environment,w,!0,y),e.savePageTelemetry("EntryPoint"),u.setItem("Redirect_Referrers",c([i(r.referrer),i(d)]));const E=`${n.protocol}//${n.host}${C}`,b=function(t,r){const n=[];return Object.keys(r).forEach((o=>{const i="feature."+o,a=g(e.extractValueFromQueryString(t,i),r[o]);a&&n.push(`${i}=${a}`)})),n.join("&")}(w,{settingsportalinstance:f.settingsPortalInstanceValue,inmemorysettings:f.inMemorySettingsValue,argsubscriptions:f.argSubscriptionsValue,showservicehealthalerts:f.showServiceHealthAlertsValue,prefetchtokens:f.prefetchTokensValue,internalgraphapiversion:f.internalGraphApiVersionValue,cae:f.caeValue,selftoken:f.selfTokenValue,globalresourcefilter:f.globalResourceFilterValue,msaljs:f.msalJsValue,fetchpolicyforrestypes:f.fetchPolicyForResTypesValue,allowthirdpartyidp:f.allowThirdPartyIdpValue,testcrosscloudpuid:f.testCrossCloudPuidValue,useredirecthint:f.useRedirectHintValue,usetenanthint:f.useTenantHintValue,nativebroker:f.nativeBrokerValue});let A=e.getTenantFromPath(n.pathname,!0);const _=l.getItem("preferredPortalUri"),R=parseInt(function(e,t){const r=e.getItem(t);return e.removeItem(t),r}(u,"Redirect_PreferredPortalRedirectCount"))||0,P=k("useredirecthint",f.useRedirectHintValue),N=k("msaljs",f.msalJsValue),M="true"===k("msaljslogin",f.msalJsLoginValue);if(!A&&function(t){const r=e.sessionStorage.getItem("authState");if(r){try{const n=JSON.parse(r),o=n?.oAuthToken;let i=0;o?.authHeader&&(i=o.expiresAt);let a=o&&i>=Date.now();const s=n?.selfOAuthToken;if(s?.authHeader&&(a=a&&(s.expiresAt||0)>=Date.now()),a=t?a&&!!n.isInitializedUsingSpaAuthCode:a&&!!n.refreshToken,a)return e.localStorage.removeItem("authState"),!0}catch(e){}e.sessionStorage.removeItem("authState")}return!1}("true"===N))v=e.getPortalUri(E,T);else if("true"===P&&_&&_!==n.hostname&&!(w||[]).length&&!A&&R<3)u.setItem("Redirect_PreferredPortalRedirectCount",R+1+""),v=e.getPortalUri(_,T,{portalQuery:s.portalQuery});else{let r=parseInt(u.getItem("Redirect_IdpRedirectCount"))||0;A=/^#@([^/]*)|$/.exec(/#.*|$/.exec(t.location.href)[0])[1]||A;const c=k("usetenanthint",f.useTenantHintValue);let d="";const h=l.getItem("tenantHint");"true"===c&&h&&(d=`&tenantHint=${h}`,l.removeItem("tenantHint"),u.setItem("usedTenantHint",h));const g="/signin/index/"===e.sessionStorage.getItem("sessionreplyurl");if(M||!g&&"true"===e.localStorage.getItem("msaljsloginexp")){e.localStorage.removeItem("msaljsloginexp"),"true"===e.localStorage.getItem("MsalJsV4")?e.sessionStorage.setItem("MsalJsV4","true"):e.sessionStorage.removeItem("MsalJsV4");try{let t=A.startsWith("@")?A.substring(1):A;t=t||"organizations";const r={armAadResource:s.armAadResource,authority:s.authority,forceSignInQueryStringValue:e.extractValueFromQueryString(I,"forcesignin")||"",portalClientId:s.portalClientId,portalRequestedTenantInfo:{id:t,domainName:"",displayName:""}};await e.loginUsingMsalJs({isNativeBrokerEnabled:e.useMsalJsV4InCurrentSession()&&"true"===k("nativebroker",f.nativeBrokerValue),portalOptions:r,portalServerMsalJsConfig:a.portalServerMsalJsConfig,source:"Startup",userQueryStringInUrl:I,loginStage:{type:"Startup"}})}catch(t){e.saveLog({source:"Startup",action:"FallbackToLegacySignIn",data:{errorMessage:t.message+(t.stack||"")||t.toString()}}),e.sessionStorage.removeItem("PortalRequestedTenant")}}const v=t.document.createElement("script"),y=e.localStorage.getItem("SavedDefaultDirectory"),C=y?`&savedDefaultDirectory=${y}`:"",w=["signInParameters","loginHint","selectAccount","forcesignin","whr","slice","mfalogin"].reduce(((t,r)=>{const n=e.extractValueFromQueryString(I,r);return n&&(t+=`&${r}=${n}`),t}),"");v.src=`${s.signinUri}${A}?sessionId=${p}&${b}&idpc=${r}${d}${C}${w}`,o.appendChild(v),setTimeout((()=>{u.setItem("Redirect_IdpRedirectCount",i(++r)),r%3?n.reload():n.href=m+"/UE_IDP"}),6e4);const S=e.getPortalUri(E,T),_=new XMLHttpRequest;_.open("GET",S),_.send(null)}}}catch(e){if(22===(e=e||{}).code)v=h(m);else{let t=u(i(e));const r=e.message;r&&(t=u(r)+"&stack="+u(e.stack)),v=m+"/Unhandled?err="+t}}v&&(n.href=v)}}(MsPortalImpl||(MsPortalImpl={}));
MsPortalImpl.redirect({"portalServerFeatures":{"settingsPortalInstanceValue":"devicemanagement","argSubscriptionsValue":"","showServiceHealthAlertsValue":"false","inMemorySettingsValue":"","prefetchTokensValue":"","internalGraphApiVersionValue":"true","caeValue":"","selfTokenValue":"true","globalResourceFilterValue":"true","msalJsValue":"true","msalJsLoginValue":"","fetchPolicyForResTypesValue":"","allowThirdPartyIdpValue":"","testCrossCloudPuidValue":"true","useRedirectHintValue":"","useTenantHintValue":"","nativeBrokerValue":""},"portalServerConfig":{"portalQuery":{"configHash":"mO9qAXBHhHjk","pageVersion":"15.190.9.1"},"environment":{"extensionsManifestHash":{"assetTypes":[["6NUPD3ddeM0C","4gvYqJa573jE"],["m8r451AkrWAa","w5YaF00PMkbQ"],["m5CK9npK-zNB","aXK1uqubO1V_"],["2EnivNj_GeTi","m7_VUt6wwnQ1"],["DeV3JmVcjLg8","i3HBWmvRnqhG"],["v3QVLGih6WXX","Jh-TQtjJS9HM"],["V3FomDDfABdG","XBmHkEBqZlor"],["N4BZ0oQhzpgX","UKioB43X8DuH"],["yaf1WJdtBZcv","Q5XqO65V9r-o"],["r98-eXzsuUaQ","KX0h0gCAviMC"],["TdvPlZKw4Q5w","0-X3pyDYlqv_"],["QJoivvbZhOL-","ACSltNnUMzsJ"],["kdn_orWmOONl","4tg0bNgOvQ5w"],["xjsvmlYB25al","hfZGcC-5QFwR"],["wb5q1w0pvNIk","OO0KVBPYOwtZ"],["yMVBZP_caSaP","PUREGPrcOtBG"],["2KHwtC2W9JDO","PrB1IIeGZQdF"],["gd0W_VLmqE4a","BfPf1Ij7eb8Z"],["nCDK_ZZIjvDP","KxTWtG-PhzYX"],["yzjtUhCuOX6c","86CHJ2t7HAfG"]],"assetTypesBrowse":[["Arvl57cKcicw","ggwcLWI3rAj_"],["sb_PlLgXsFHs","YSAPeysbYw5G"],["bPiypvAHl25a","ZAegaI3WK1t5"],["IwSIwQNy-16t","BJ2GcL0wda3M"],["CZYHYNQZk7UB","zYlFkva7Laig"],["nOl_lpO59r9v","EP4HqYbSPRGK"],["C9WHpPuPy7yl","bXX_UUqQj9WX"],["T7UPLNinOOa6","8dLA9S73Gvih"],["pSHIrvvSbn8m","ft8WFsbRhQyf"],["cM_e3QUuFwrs","Cr4wBDJIzHsQ"],["ekj7x8meLYyM","X3YX0NsC32jB"],["e36Fsjgt5AHX","sceqUJyolCvL"],["VSgxc-JHLpCM","cKaLReyTtdCy"],["y2PxxOqV7PEx","Sq4SVt9zsVrz"],["cJbJQTLuy_K_","3ZUjEFpDhQ2h"],["I-my6yObnUUz","0c3R6teKkM1F"],["si5QYZ0qDN3u","0Q-NMOd28RPj"],["OpMKvxFCofDb","6u0FynnsNR6s"],["uvNnLY0K3wi5","fBuepI8-pLSb"],["uYwWwvFbYDwv","YcwyG-dakrwX"]],"assetTypesMenu":[["cMXxNV6E_o9Z","oObmmE1PaZr7"],["37zn1FU_Vpw-","kiy-r-hLAwmh"],["AgOkgAN-reQm","kZYCvEElnJ_h"],["we27VcQZm949","UJAfr19kBvJX"],["Sl2aDX1G1V4q","1VucXntQjauk"],["SOAswTV7zAHS","XI_5bkAx4Ndd"],["L5hpDiNCZyrS","BGtiY8tt-SZY"],["34A2YJylsu6E","Syo5C1Yf4Sqk"],["ICBmu9K9gtC8","QJrireDMlnRN"],["t2hm9q1lJisi","KxjamyfFrDoy"],["iXLPD4tMRJ9I","az22IeEFH1ux"],["bwcBWR3IqAq_","NN-cdtptV5et"],["RqGhwAfVl3w4","sNjkO6_Yr06r"],["uloLWmJByj79","5JRGrDPByMt5"],["dZIbxfcm7cko","aCEMclN0SAH4"],["frOzUweX4sR0","7O1Wk3LUPr-I"],["D-11pBlqS6tZ","akr9RaFuqCUD"],["x25vWoymhRuE","K8L8d6ZvhWqh"],["a8SfvcmuG-WO","e_1HYFWEbCVt"],["aQ4oW0pXpd4z","a7NePcNrX5aS"]],"browseMenus":[["5bIrdOmJCYct","Grd7foQucRfo"],["Hh_Z9qgGPm3a","w45Upv_SAlgQ"],["86H7WHHa5aw0","8lmypwuPLjRl"],["T47UF2UphvAE","6zvfl1kMuyac"],["xxno-RMbVLSG","AybsoFZAsE_w"],["gagPRVFil9Vg","r2BwpjXAojZb"],["zaM02RwbAG_e","HdPfnRYLUNBi"],["3NEzMLRHUsTb","I7sljp7fy1KC"],["__mFVN1LRBVv","-5qthWa0C8jz"],["FKcrjvyj981n","nL_J_s7dJVEA"],["FewWz0aR3T_g","aOasVyxFJEu9"],["YUozzB9CWp2Y","SANphJqHkWey"],["A8QWar8guLWr","tyMZuHsp1aha"],["hmIF6Do2EaCQ","h_che5N05yhQ"],["Sg89-AYZJZJN","eNCCdpnChiY7"],["UHhUJTtVsLWA","iDslShylfIWn"],["2KzM3jnquNNA","HGh6qmRgqhCr"],["MaPGA0YU_QFS","ZLihJv6YSe8_"],["P2YXmIK0NY-n","r8ptjBChXwJm"],["5bIrdOmJCYct","92Mr3AYoBNWB"]],"copilot":[["zPHRZaE_hU11","J0xsevobxEpr"],["bpgkC542ZdDi","dT5XEMiUDYwk"],["gHv6ukaBIIAx","9nK4zYiNey1t"],["oD4N9ym69lFX","qokLeRl4yZNW"],["49JyDYYrnJ8u","-rSKSgHrbdjC"],["EydDOWkb-oE9","PjevSfM5-dDy"],["5SbcAACXohg5","5luLdYj6sc5u"],["ylhKMEBhQmNx","BwShE6k69pMZ"],["kwtPxb007_Mb","S8t_t71CPKir"],["VYnRjze3tGEx","o3P2rHxeYU0y"],["nQCmb8OJEOmj","mx61N4w96QVw"],["RZ7Mcush2wq1","NMocTHC9CgqK"],["mPjMEHYnXbV9","GbOEgWaTH-89"],["ga-_ouJEB0ZZ","OUyBtK0X77f5"],["L_XRcjXkGhN8","jr_WxWWbw6fb"],["ev_gmYrydY_n","_bu9PqumSvzx"],["4oPYeXEuWlg8","AuisEBTLzFGD"],["FIYuKd3_p7qg","7eXNpWJuyw6X"],["Fs0Q950H84B7","O7Qum4qwNGdv"],["zPHRZaE_hU11","J0xsevobxEpr"]],"extensionConfiguration":[["GvwHeuQiD1ac","XGtRanvHGjD7"],["RMVGSiTIxnNG","C-rT9Z-jCygi"],["7KS3V_QdhgYJ","RjkaBspuq3UZ"],["1fVh8Zt5J_ix","4CPfwxhSLeO2"],["-ISMjVnW35--","Dv9KRzuGrEn5"],["XPoaPsDGk3Je","r8H4AnSUKuFW"],["urQ1eiqnrk-7","iYn8EoIjOolV"],["QTMGf1eUFO-f","QvCsL1yyJObp"],["EuKO0oCS1C2a","ocrzjf5IEmtc"],["jL2ugsdgzHJW","S3W3jI4N85qe"],["k_aEkUi5gBL4","CpOX3bqHdzfA"],["rdwtjbmtHLMS","eglUaQp9ALnB"],["gfHe794cFprX","T0CFYnybDDps"],["gQ8E9FKPWxAN","DOEk3_HA8NTZ"],["crj-PkfngWPr","bicK4z3Uluhv"],["zC8C4xzGVmIG","sGumSX9LnuYj"],["BwX5JFlKeDJk","pF-8Fai2hAVj"],["k6rC-esxG2cU","ADIQUm6-sPSM"],["l9fSGE73dd01","OGiaV_VDxA7M"],["GvwHeuQiD1ac","XGtRanvHGjD7"]],"featureCards":[["WJhG1Fd4zlms","HxMyMW9NLqdh"],["6UXClij2sOqk","uWZZFyQOICOK"],["PrL9C1RHRfSu","HjREbZPblKRW"],["6L-NUEQEMuB4","aUnA6hsK0NZQ"],["tsjP25husd_M","sJCSMruoWUjJ"],["a9VGuyRK-TJ4","T2OWs94H3pVb"],["saUrigOuYN3s","t5zbM2oS4DRC"],["LtJrOhcXuIfI","AhhztKMrXwMW"],["W-jxtrY3n4Cf","7whPoF8AsZ5P"],["O3UvTMsutmIq","AxghqjnDdzGs"],["3KTUsb2OWvBj","ABrwYlt1Cbs6"],["3TALeluwGkbw","rY7-K6pK5T74"],["F4yMge-nuROI","-tCFuTDXgn3-"],["7Fe4v0iiTKgQ","9NjtEtil0LxS"],["NNnD9w1ieeda","qQsy41zkbHUg"],["xUhdgqIJmiie","WFplmb7fFfuC"],["Ub4ZOP0SacTq","wbPp51I6E1id"],["5pKl87BfTIcW","Uy60Tnjilg8V"],["lK0xckouEERV","f9aH7d973_vM"],["T60qNL3Y3luP","U9ahP9JXGZzL"]],"galleryParts":[["7u7KGxtyZoJT","I2feViXEX98P"],["BbfhjzzzQiQL","_bsRq7lyvbDV"],["3pycbhjPrQYt","LZYbbxF8tmoh"],["i1bdrR73K5sM","YdTYfbLWlYIS"],["MmPjw7cM2erC","8wC7nwHSuZ0-"],["xDbyeeq0h6pD","WJ5Rpp6IB6nx"],["7II57R8IWAFT","I8GM5LbH313V"],["hSdpTiA9qpRg","ZxJ-J0CQTeLm"],["EZp2JA5LzFhA","juDx5A-D8gvR"],["4ezPcmqJpPRz","hL_oLatyUcS8"],["Cy8oG_s_8BFt","3wf6m7pYOLBI"],["kS-yQo4xh6AA","yAGSYzW2V8BS"],["5v-LibzVgGHg","Ig504kp8gyLX"],["B9GeSHbTOn2Z","OXBP0CT3w3jP"],["C8acI2NhTIrN","_ibwQuWS2eco"],["oJ8hf3AFbuJ2","OxfVMYbgF7fE"],["f2B-y1lrGKjf","HqxAN6hMhlw-"],["61aPOBzSMFsT","AQHI5ckLPryT"],["YkzisNPKDJ9X","DAFK6zpc6hlk"],["J9J5K4RJKZEF","VXniBbzsBDig"]],"menus":[["2SbGSGwlf4_W","Wq-akueZUErH"],["jXyH_J8sy4UE","bnEqPXc4z69g"],["B_Bb7YiPK1zL","UGa1yvNGSK-E"],["REDcOjCj--Ov","fS_otOZ0pMHM"],["NGQWrtimhgkg","OOcWlFbqvHlN"],["oBqikn4IqDm3","d7oKiCJoMmwE"],["ItxEadTaFTLG","wC-DQLnZGdoj"],["k32gHZ2EQfbA","GRtPS6l2vf7Y"],["sGt4aRMZDiQK","fNGGJuvXSiCs"],["vlOFaf-Owuzm","Eu0ZTRSRmMBv"],["YMd3DVhkgck0","BSGv7VNhMP98"],["yXZ_HQhzBTZf","B0sU69mBTRHy"],["P3oDcVLHZC0p","xwIKHCYogbqo"],["zD--k1vzmE_q","hy7XUj_FXzHS"],["qF23-Joe_-Xn","Timghy78xQnG"],["Eytsz3q_GjwA","9lic2uYkPscU"],["UcitJkOG7L3E","iUGL9LEZoU1v"],["aOcmiv2NYxH_","dmFAGzvE65YJ"],["lF3K362-Zpjl","vtzFaSRESIq7"],["2SbGSGwlf4_W","Wq-akueZUErH"]],"portalServices":[["8IpOKAk6fePU","4jAc5ui55pOe"],["ozafTd5hULUY","kGDFG4w4TIWT"],["6GGoqnUeClNY","x9mN710jU4_b"],["aIIT35dfAx4C","hUTabr1-SjbO"],["RjpkbySMrHro","3DCgFECV-r50"],["rheepC8RnC-M","DDdqegVCPM__"],["6lNdKgKr-283","tqcO7gYAe9Mx"],["HSeAG_8TtkeP","8zg8Bc8YY5UH"],["kpOLc523vokW","MsFH1rAO5nms"],["MJTQI7WAQ-VC","m9IXOF4nUwCZ"],["KO_GMiQyXdSy","F-_JqITjwSaQ"],["Bu1pRrSDw9SB","s9m2W9GsCFra"],["qCQhhxDQG3fp","gxPaPX0-ChK7"],["eLfCN6_9n6C1","bfr_knBSn7Y6"],["bajp3fI-kPuR","GI846oP7R7SP"],["BHJpPha1yM-L","6MaYhzutX7nk"],["IeOaLoh9FLXr","OPzFYZcJjv7i"],["ZQDzAh6xr6Ja","5gAkeVKs-PTr"],["6BjRFA7hdgOV","zMCNwyh8i3uQ"],["ZMwabAb2hby4","-95fWsEhRhm2"]],"surveys":[["7MuXfKP4XXM3"],["PD5Nz7Sv557I"],["vaeWmkTaHIZt"],["H-zYHM1KWmXz"],["1BSpKgjxaTEV"],["Q9xqunk2vkDy"],["8Ngoo9x7GpUU"],["Pr21rv5lbH5b"],["jeIA3jAWcFJu"],["99l9Wt4IkdNV"],["s7xG4Xcu5fIr"],["r-eZSaXREGRz"],["a18LjTWfgsdA"],["OLszz7lN0K4A"],["MKu6ELlM6icM"],["NQZ5g2mABLTZ"],["40IxySc82D30"],["ZJeYiOlMTzMl"],["FwAQoEiyekCg"],["xZSGUVvmofKT"]],"tourGuide":[["TPDtCQjby9JT","UxbsxDBu5yll"],["NcBVG4ApYt0r","Y3gInksTmyIJ"],["M7Y2OxftBLuR","BzY9b05zyJyY"],["B0j_agSn7_kA","uG66CSk-OQnS"],["nDcMscxLw2-T","x_LBKNVtqNA6"],["DCQSo0j7axWI","VkcAVDSUFL_0"],["s0OSlAWxIIEl","004t2UV23O-V"],["WO5ziIh-Ozpu","gB44fZdPLwIt"],["nzu6HhZY1HFN","IAvsMikUoNh_"],["XP545Pq8rBim","IPX9epNq-u5l"],["ou953w1tSKYV","uneXk4qwhTLZ"],["TJuIj90Sph_v","0enxxoR80L98"],["3Y2SblC9J14i","_ALR97RDyCnR"],["zbYPeblTeiwh","dwI1Mb601t3a"],["sRqFOSoVmgu2","M9HCEjQcGzw1"],["JTNzLHJZSiTX","-s9EjvbLpeeX"],["J-eM-xr6Ywig","hvbMOg-OaCDT"],["pQ5-oB-qa9Vx","rClfJ7kZ9AJA"],["tUtaL0_iz7qL","pxSmjhprqHay"],["TPDtCQjby9JT","UxbsxDBu5yll"]],"uiDefinition":[["gsmXAIcsIPCu"],["X5kPf9nhy7c5"],["PGmbg9cFuAjf"],["Wp04yxoDR8Y2"],["Hkqf-GFkptQF"],["cxZ9jM6WmElr"],["aH_Yymn4vT58"],["_XLISBVX2IF3"],["cquVQv8b8TL1"],["5arnk8blKhWj"],["dLPPxWAn-0Ha"],["45vBL1SroYrs"],["SqHumxtn92ld"],["4lgw7dKfXb26"],["XNTO6_Eia09f"],["oZC8uA3nKoO-"],["YwUy3qIY2Wxg"],["lKh6mwettKt8"],["bPNknLITkeb7"],["gsmXAIcsIPCu"]]},"extensionsPageVersion":{"AppInsightsExtension":["1.0.20250501.0156","1.0.20250501.2259"],"AppPlatformExtension":["1.0.03032.322"],"AzureCacheExtension":["1.0.3033.1"],"AzureTfsExtension":["19.255.36007.37"],"Azure_Marketplace_Astronomer":["0.9.029521-3895778"],"Azure_Marketplace_Confluent":["0.9.0303423-6623"],"Azure_Marketplace_Datadog":["2.2101.030262-3056","2.2101.030321-4493694"],"Azure_Marketplace_Dell":["0.9.030401-536"],"Azure_Marketplace_Dynatrace":["0.9.030221-68084"],"Azure_Marketplace_Elastic":["0.1.029801-6729356"],"Azure_Marketplace_Informatica":["0.9.030261-995"],"Azure_Marketplace_Liftr_Logz":["0.9.028681-288"],"Azure_Marketplace_Liftr_NewRelic":["0.9.029801-275453"],"Azure_MarketPlace_NativeISVService":["0.9.030439-937336","0.9.03041460-606575"],"Azure_Marketplace_Neon":["0.9.030411-9059"],"Azure_Marketplace_NGINX":["2.2101.030342-092408"],"Azure_Marketplace_PaloAltoNetworks_Cloudngfw":["1.0.0.250319-1232"],"Azure_Marketplace_Pilot":["0.9.030401-2543"],"Azure_Marketplace_PureStorage":["0.9.030211-4510329","0.9.030211-4364177"],"Azure_Marketplace_Qumulo":["0.1.029832-44245"],"Azure_Marketplace_SamplePartner":["0.9.026611-97"],"Azure_Marketplace_SolarWindsObservability":["0.9.028741-97813"],"HubsExtension":["15.190.9.1/HMpjetXN_m84"],"Microsoft_AAD_AuthenticationMethods":["1.0.03015208"],"Microsoft_AAD_B2CAdmin":["1.1.770.0"],"Microsoft_AAD_ConditionalAccess":["1.0.03038971"],"Microsoft_AAD_Connect_Provisioning":["3.0.030391105"],"Microsoft_AAD_DecentralizedIdentity":["1.0.03028444"],"Microsoft_AAD_Devices":["1.0.03013567","1.0.03040570"],"Microsoft_AAD_DomainServices":["2.0.216.0"],"Microsoft_AAD_DXP":["1.0.03028.1555-"],"Microsoft_AAD_ERM":["1.2.870.373"],"Microsoft_AAD_IAM":["3.0.030391938"],"Microsoft_AAD_IdentityProtection":["1.0.03034342"],"Microsoft_AAD_LifecycleManagement":["1.0.03014.277","1.0.03042.306"],"Microsoft_AAD_RegisteredApps":["1.0.3035.1251"],"Microsoft_AAD_UsersAndTenants":["1.0.03035.1261-185010"],"Microsoft_AzureCXP_BusinessReview":["0.1.5335"],"Microsoft_AzureCXP_Cpoe":["0.1.4856"],"Microsoft_AzureCXP_EngageHub":["0.1.4792","0.1.4992"],"Microsoft_AzureCXP_EngageHubInsights":["0.1.4956"],"Microsoft_AzureCXP_EngageHub_Learning":["0.1.5104","0.1.5311"],"Microsoft_AzureCXP_EngageHub_Spaces":["0.1.3950","0.1.5211"],"Microsoft_AzureCXP_EngageHub_Support":["0.1.5144","0.1.5109-0002"],"Microsoft_AzureStackHCI_PortalExtension":["1.0.03042.3610--8157337"],"Microsoft_AzureStack_LabHardware":["1.0.948.0"],"Microsoft_Azure_ActivityLog":["3.0.02996.254","3.0.03012.257"],"Microsoft_Azure_AD":["1.0.4463.1"],"Microsoft_Azure_ADHybridHealth":["2.0.03019309"],"Microsoft_Azure_ADU":["20250403.2"],"Microsoft_Azure_AdvisorPortalExtension":["1.0.03004.297"],"Microsoft_Azure_AFDX":["1.8.030061620"],"Microsoft_Azure_AgFoodPlatform":["2.0.0.2"],"Microsoft_Azure_AgriculturePlatform":["0.0.1.250210-0834"],"Microsoft_Azure_AnalysisServices":["1.2.2.63"],"Microsoft_Azure_Analytics":["1.0.02934.1"],"Microsoft_Azure_ANMVerifier":["1.0.03012.166-392550"],"Microsoft_Azure_AP5GC":["2-2501280610"],"Microsoft_Azure_ApiManagement":["1.1164.0.0","1.1166.0.0"],"Microsoft_Azure_APISecurity":["1.25.04.142308"],"Microsoft_Azure_AppComplianceAutomation":["202504210526"],"Microsoft_Azure_Appliance":["4.0.300.196","4.0.200.145"],"Microsoft_Azure_AppProtection":["1.0.02986.172"],"Microsoft_Azure_ArcCenterUX":["1.0.115.0","1.0.120.0"],"Microsoft_Azure_ArcClusterUX":["1.0.1115.0"],"Microsoft_Azure_ArcNetworking":["1.4.2.0"],"Microsoft_Azure_ASCInformationProtection":["1.25.04.081347"],"Microsoft_Azure_Attestation":["1.0.14.287.1"],"Microsoft_Azure_AutoManagedVirtualMachines":["1.0.02990.466"],"Microsoft_Azure_AutomaticAKS":["5.13.393.2014"],"Microsoft_Azure_Automation":["7.3.3097.0.250418-0737","7.3.3114.0.250502-0718"],"Microsoft_Azure_AzConfig":["1.0.03042160-1371151"],"Microsoft_Azure_AzFleet":["5.13.393.2011"],"Microsoft_Azure_Batch":["1.1.03018.425"],"Microsoft_Azure_BCDRCenter":["1.0.03034.1552","1.0.02984.1419"],"Microsoft_Azure_Billing":["25.4.03032.193-8473","1.0.03041.1249-8577446"],"Microsoft_Azure_BotService":["1.4.1.407243"],"Microsoft_Azure_Capacity":["250416-0914"],"Microsoft_Azure_Cdn":["1.0.03033.493--8477"],"Microsoft_Azure_ChangeAnalysis":["1.0.03001.152"],"Microsoft_Azure_Chaos":["1.0.0-1.0.03035.3-50349911"],"Microsoft_Azure_Classic_Compute":["5.13.393.1969"],"Microsoft_Azure_CloudforSovereignty":["1.0.250127.1822"],"Microsoft_Azure_CloudHSM":["1.0.03013.414"],"Microsoft_Azure_CloudNative":["5.13.393.2000","5.13.393.2008"],"Microsoft_Azure_CloudNativeTesting":["2025042120250422.4","2025042820250505.2"],"Microsoft_Azure_CloudPC":["1.0.250328.119238217"],"Microsoft_Azure_CloudServices":["5.13.393.2014"],"Microsoft_Azure_CloudServices_Arm":["5.13.393.2022"],"Microsoft_Azure_CloudTest":["2.0.29885218"],"Microsoft_Azure_CodeOptimizations":["1.0.02973.47"],"Microsoft_Azure_CodeSigning":["1.0.20250422.107"],"Microsoft_Azure_CommunicationServices":["1.0.20250404.1","1.0.20250502.3"],"Microsoft_Azure_CommunicationsGatewayExtension":["2.0.0.4"],"Microsoft_Azure_CommunityTraining":["1.0.11.0"],"Microsoft_Azure_ComplianceCenter":["1.0.0.20250211060443"],"Microsoft_Azure_Compute":["5.13.393.2032","5.13.393.2044"],"Microsoft_Azure_ComputeHub":["5.13.393.2012","5.13.393.2041"],"Microsoft_Azure_ConfidentialLedger":["23.4.0.4"],"Microsoft_Azure_ConfigManager":["20250428.1"],"Microsoft_Azure_ContainerInsightsExt":["2.0.20250423.2156","2.0.20250430.2250"],"Microsoft_Azure_ContainerRegistries":["1.0.20250404.2"],"Microsoft_Azure_ContainerService":["5.13.393.2041/kmQ3n0uyfNO_"],"Microsoft_Azure_ContainerStorage":["5.13.393.1697","5.13.393.1698"],"Microsoft_Azure_Copilot":["1.200.03035.770","1.200.03041.779"],"Microsoft_Azure_CopilotMetadata":["1.300.03029.221","1.300.03041.229"],"Microsoft_Azure_CostManagement":["250429-1731"],"Microsoft_Azure_CreateUIDef":["1.0.300.349","1.0.200.623"],"Microsoft_Azure_CtsExtension":["1.4.0.5"],"Microsoft_Azure_CustomerHub":["20250404.2","20250505.1.751807521156599457109435563468"],"Microsoft_Azure_Dashboard":["2.0.2145.0"],"Microsoft_Azure_DatabaseInsights":["1.0.03004.544"],"Microsoft_Azure_Databricks":["1.0.03039.335"],"Microsoft_Azure_DataFactory":["1.0.20250313.1"],"Microsoft_Azure_DataLakeAnalytics":["20250401.2"],"Microsoft_Azure_DataLakeStore":["5.13.393.1980"],"Microsoft_Azure_DataProtection":["250423-064435"],"Microsoft_Azure_DataShare":["3.0.20250425-1649"],"Microsoft_Azure_Dedicated_ClusterStor":["240909-1921"],"Microsoft_Azure_DetonationService":["2.00.00.06"],"Microsoft_Azure_DevCenter":["15.118.0.1.250422-2209"],"Microsoft_Azure_DeviceRegistry":["1.0.03011.122-"],"Microsoft_Azure_DeviceUpdate":["1.0.02991.140-"],"Microsoft_Azure_DevOpsInfrastructure":["1.0.20250425.2"],"Microsoft_Azure_DevTestLab":["14.274.0.1.250402-2050","14.274.0.1.250430-0621"],"Microsoft_Azure_DevTunnels":["1.0.231005.2128","1.0.230613.1659"],"Microsoft_Azure_DigitalTwins":["1.0.03028.226-041717"],"Microsoft_Azure_DiskMgmt":["5.13.393.2032","5.13.393.2043"],"Microsoft_Azure_DMS":["5.1.6598.1"],"Microsoft_Azure_DNS":["1.0.03007.285"],"Microsoft_Azure_DNSManagedResolver":["1.0.02816.276","1.0.02927.282"],"Microsoft_Azure_DnsSecurityPolicy":["1.0.03014.115"],"Microsoft_Azure_DocumentDB":["2.0.20250422.1.0","2.0.20250429.9.0"],"Microsoft_Azure_DocumentManagement":["1.0.02852.2"],"Microsoft_Azure_Ea":["20250403.2"],"Microsoft_Azure_EASM":["1.0.03000.1519"],"Microsoft_Azure_ECE":["1.0.03007.47-39107"],"Microsoft_Azure_EdgeAction":["1.0.0294514"],"Microsoft_Azure_EdgeAIExtension":["1.0.03007.32","1.0.03043.43"],"Microsoft_Azure_EdgeGateway":["1.0.02972.1739"],"Microsoft_Azure_EdgeManagementCopilot":["1.0.03011.305"],"Microsoft_Azure_EdgeOrder":["1.0.02964402"],"Microsoft_Azure_Education":["2025.03.07-1649"],"Microsoft_Azure_ElasticSan":["5.13.393.2032","5.13.393.2039"],"Microsoft_Azure_ELMAdmin":["2.79.03026.2893"],"Microsoft_Azure_EMA":["2.50324.1.11","2.50425.1.5"],"Microsoft_Azure_EmailCommunicationServices":["1.0.202504242215"],"Microsoft_Azure_EpicManagement":["1.2.10205.10621"],"Microsoft_Azure_EventGrid":["2.0.03040.255"],"Microsoft_Azure_EventHub":["2.0.03042.373"],"Microsoft_Azure_Experimentation":["2.0.02951.65"],"Microsoft_Azure_Expert":["1.20250401.1"],"Microsoft_Azure_ExpressPod":["2024.0.275.0"],"Microsoft_Azure_FairfieldGardens":["1.0.02965.71-"],"Microsoft_Azure_FileShare":["5.13.393.2038","5.13.393.2043"],"Microsoft_Azure_FileStorage":["5.13.393.2038","5.13.393.2043"],"Microsoft_Azure_FIST":["2025.03.17.150126"],"Microsoft_Azure_FlowLog":["2.0.0.317.250313-0737","2.0.0.320.250414-1304"],"Microsoft_Azure_FluidRelay":["1.0.2.6.250204-1810"],"Microsoft_Azure_Frontdoor":["1.0.03033.481--9155"],"Microsoft_Azure_GeneratedExtension":["1.200.03032.741","1.200.03041.743"],"Microsoft_Azure_GlobalView":["1.0.0.5","1.0.0.7"],"Microsoft_Azure_GraphDataConnect":["1.20250324.8.0"],"Microsoft_Azure_GTM":["25.4.03042.458-406031","1.0.03041.2811-8047287"],"Microsoft_Azure_HDInsight":["1.0.03025.1675"],"Microsoft_Azure_Health":["1.1.1.504"],"Microsoft_Azure_HealthBot":["1.0.0.113"],"Microsoft_Azure_HealthDataDeidentification":["1.0.56445.1"],"Microsoft_Azure_HealthModels":["0.2023.82.333"],"Microsoft_Azure_HybridCompute":["1.0.4523.0"],"Microsoft_Azure_HybridData_Platform":["1.0.03021.239"],"Microsoft_Azure_HybridNetworking":["20250422.1"],"Microsoft_Azure_IacAutomation":["0.0.1.241017-0944","0.0.1.241018-0643"],"Microsoft_Azure_IdentityGovernance":["1.0.02992.244"],"Microsoft_Azure_IoTCentral":["2.0.9197.41787"],"Microsoft_Azure_IotHub":["1.0.03006.590-"],"Microsoft_Azure_IoTOperations":["1.0.03040.230-"],"Microsoft_Azure_IoT_Defender":["2025-04-27--07-38-24"],"Microsoft_Azure_IPAddressManager":["1.0.03027.225-9211012"],"Microsoft_Azure_Kailani":["5.13.393.2038","5.13.393.2043"],"Microsoft_Azure_KeyVault":["1.2.370.0"],"Microsoft_Azure_KubernetesFleet":["5.13.393.2025","5.13.393.2035"],"Microsoft_Azure_Kusto":["1.0.2456.0"],"Microsoft_Azure_LocationServices":["3.0.03004.298"],"Microsoft_Azure_Lockbox":["2.64.0.0"],"Microsoft_Azure_Maintenance":["5.13.393.2022","5.13.393.2041"],"Microsoft_Azure_ManagedHSM":["1.0.03040.548-32497"],"Microsoft_Azure_ManagedLab":["14.287.0.1.250325-1839"],"Microsoft_Azure_ManagedNetwork":["1.0.03000.264-26","1.0.03042.304-092955"],"Microsoft_Azure_ManagedServiceIdentity":["2.1.9042.0"],"Microsoft_Azure_ManagedStorageClass":["1.4.0.202410290745","1.4.0.202411050815"],"Microsoft_Azure_Marketplace":["50.0.03042.72-03061","30.0.03046.59-97456"],"Microsoft_Azure_MarketplaceTransact":["1.0.20250409.88925"],"Microsoft_Azure_Migrate":["1.0.10.532"],"Microsoft_Azure_MigrateAssessment":["1.0.10.7"],"Microsoft_Azure_MigrateModernization":["1.51.1240903.11134"],"Microsoft_Azure_MLTeamAccounts":["1.0.0.250429-1552"],"Microsoft_Azure_MonitorDashboard":["2.0.24.0"],"Microsoft_Azure_Monitoring":["22.20250423.2.0.03034.458"],"Microsoft_Azure_MonitoringMetrics":["2.0.20250417.1959"],"Microsoft_Azure_Monitoring_Alerts":["1.0.03022.1484","1.0.03038.1500"],"Microsoft_Azure_NetApp":["2501.0.27"],"Microsoft_Azure_Network":["5.13.393.2033","5.13.393.2044"],"Microsoft_Azure_NetworkCloud":["6.0.6","5.1250.0-1"],"Microsoft_Azure_NetworkCopilot":["1.0.02985.137-753"],"Microsoft_Azure_NetworkCopilotExtension":["1.0.02986.67-80494","1.0.03013.73-733533"],"Microsoft_Azure_NetworkingCopilot":["1.0.02992.149-34146","1.0.02991.148-34146"],"Microsoft_Azure_NetworkSecurityPerimeter":["2.4.0.256"],"Microsoft_Azure_Network_Access":["1.0.03038.1775","1.0.03042.1788"],"Microsoft_Azure_NotificationHubs":["20250423.1.250423-1611"],"Microsoft_Azure_OneInventory":["1.0.03040.271"],"Microsoft_Azure_OneMigrate":["1.0.10.49"],"Microsoft_Azure_OnlineExperimentation":["1.0.030352-6824"],"Microsoft_Azure_OpenEnergyPlatform":["1.0.245"],"Microsoft_Azure_OperationsMgr":["1.2.633.0"],"Microsoft_Azure_Orbital":["2024.10.03039.527"],"Microsoft_Azure_OSSDatabases":["2.1.03041.147--082284"],"Microsoft_Azure_PaasServerless":["5.250.0.3","5.251.0.3"],"Microsoft_Azure_Peering":["1.2.0.258"],"Microsoft_Azure_PIMCommon":["2.0.32.1826"],"Microsoft_Azure_PinToGrafana":["1.2.271.1"],"Microsoft_Azure_Playground":["14.287.0.1"],"Microsoft_Azure_PlaywrightService":["1.0.0.50"],"Microsoft_Azure_Policy":["1.0.9.722","1.0.9.724"],"Microsoft_Azure_PortalDashboard":["1.100.03013.570"],"Microsoft_Azure_PowerBIDedicated":["1.1.2957.1"],"Microsoft_Azure_PowerPlatform":["0.0.0.77"],"Microsoft_Azure_PrivateDNS":["1.0.03007.285"],"Microsoft_Azure_ProgrammableConnectivity":["1.5.3"],"Microsoft_Azure_ProjectBabylon":["1.0.20250326.426","1.0.20240729.400"],"Microsoft_Azure_ProjectOxford":["250403-0510"],"Microsoft_Azure_PSC":["0.1.2"],"Microsoft_Azure_Quantum":["2.2.0.3"],"Microsoft_Azure_RecommendationsService":["9.32.02744.262"],"Microsoft_Azure_RecoveryServices":["3.40.2504.161"],"Microsoft_Azure_Relay":["2.0.03018.223"],"Microsoft_Azure_Reservations":["04.23.2025.0733"],"Microsoft_Azure_ResiliencyHub":["1.0.02982.30"],"Microsoft_Azure_ResourceMove":["1.1.10422.12151"],"Microsoft_Azure_Resources":["1.0.102.1130","1.102.1157.0"],"Microsoft_Azure_RpExt":["2.0.0.0"],"Microsoft_Azure_SaasHub":["1.0.02970.65-390"],"Microsoft_Azure_SapHanaInstances":["1.0.50.153"],"Microsoft_Azure_SAPManagement":["2.1.10331.10446"],"Microsoft_Azure_SAPMigrate":["1.2.10316.12135"],"Microsoft_Azure_Search":["170201352.20250428.1"],"Microsoft_Azure_Security":["1.25.05.041743"],"Microsoft_Azure_Security_AzureDefenderForData":["1.25.04.301709"],"Microsoft_Azure_Security_CloudNativeCompute":["1.25.04.271107"],"Microsoft_Azure_Security_DevOps":["1.25.04.291711"],"Microsoft_Azure_Security_Insights":["1.0.03040.520-250429-092927"],"Microsoft_Azure_Security_IoT":["2025-04-27--07-41-20"],"Microsoft_Azure_Security_R3":["1.25.05.041228"],"Microsoft_Azure_SentinelUS":["1.0.03040.6069-250429-1538"],"Microsoft_Azure_ServiceBus":["2.0.03040.238"],"Microsoft_Azure_ServiceFabric":["5.13.393.2022"],"Microsoft_Azure_ServiceHub":["1.300.02978.80"],"Microsoft_Azure_SignalR":["1.0.03021.83--1569413"],"Microsoft_Azure_SiteManager":["1.0.03033.961--287928"],"Microsoft_Azure_SiteRecovery":["1.51.12504.276"],"Microsoft_Azure_SolutionCenter":["5.13.393.1967"],"Microsoft_Azure_Sphere":["2.0.25094.1"],"Microsoft_Azure_SpringApps":["20241218.1"],"Microsoft_Azure_Stack_Migrate":["2.250425.0447.1"],"Microsoft_Azure_Startups":["1.0.03043.97"],"Microsoft_Azure_Storage":["5.13.393.2038","5.13.393.2043"],"Microsoft_Azure_StorageCache":["1.0.03011.1216"],"Microsoft_Azure_StorageDiscovery":["5.13.393.1989"],"Microsoft_Azure_StorageHub":["5.13.393.1823","5.13.393.2018"],"Microsoft_Azure_StorageInsights":["4.13.393.1126"],"Microsoft_Azure_StorageMover":["5.13.393.2038","5.13.393.2039"],"Microsoft_Azure_StorageTasks":["5.13.393.2038","5.13.393.2042"],"Microsoft_Azure_StreamAnalytics":["20250130.1"],"Microsoft_Azure_SubscriptionManagement":["2025.4.16.2"],"Microsoft_Azure_Support":["1.596.20250424.3"],"Microsoft_Azure_Surface":["2.76.0","2.77.0"],"Microsoft_Azure_Sustainability":["1.0.1.199","1.0.1.201"],"Microsoft_Azure_Synapse":["1.0.03011.1"],"Microsoft_Azure_TemplateSpecs":["1.0.1.93"],"Microsoft_Azure_Toolbox":["2.0.03028.391"],"Microsoft_Azure_UsageBilling":["0.0.0"],"Microsoft_Azure_VirtualEnclaves":["2.1.402.0"],"Microsoft_Azure_VirtualMachineScaleSets":["5.13.393.2009","5.13.393.2044"],"Microsoft_Azure_VirtualVisitsBuilder":["1.0.0.17"],"Microsoft_Azure_VnfManager":["1.11.0","1.99.0-1"],"Microsoft_Azure_WaveMigration":["1.0.10.9"],"Microsoft_Azure_WhatsNew":["1.0.02900138"],"Microsoft_Azure_Winfields":["1.0.028335"],"Microsoft_Azure_WorkbooksExtension":["1.30.03040.518","1.30.03042.520"],"Microsoft_Azure_WorkloadInsight":["1.0.03035.114"],"Microsoft_Azure_WorkloadInsights":["2.0.20250422.2158","2.0.20250501.2114"],"Microsoft_Azure_WorkloadMonitor":["3.1.10211.10613"],"Microsoft_Azure_WVD":["1.0.02990.697","1.0.03034.727"],"Microsoft_Azure_ZeroTrustSegmentation":["20250429.2"],"Microsoft_Bing_Api":["250429-1344"],"Microsoft_CloudHealth_HealthModels":["2.0.03040.130"],"Microsoft_Cognition_MixedReality":["38.0.0.0"],"Microsoft_ConnectedCache_Enterprise":["1.0.0.2.0"],"Microsoft_ConnectedCache_ISP":["1.0.0.3.0"],"Microsoft_EMM_ModernWorkplace":["1.2504.401.04"],"Microsoft_Entra_Copilot":["3.0.0304298"],"Microsoft_Entra_GSA_Connect":["1.0.0304261"],"Microsoft_Entra_IDX":["1.0.0303273"],"Microsoft_Entra_PM":["2025.4.29.1"],"Microsoft_Entra_PMAnalytics":["2025.3.11.2-117649844"],"Microsoft_Entra_PMDashboard":["2025.2.25.2-116221595"],"Microsoft_Healthcare_APIs":["1.0.660460.1"],"Microsoft_Intune":["1.2504.18.3002.250423-2444"],"Microsoft_Intune_Apps":["2.2504.18.3003.250424-1751"],"Microsoft_Intune_DeviceExplorer":["1.0.241205.054721"],"Microsoft_Intune_Devices":["6.2504.34.3002.250421-2259"],"Microsoft_Intune_DeviceSettings":["1.2504.77.3004.250428-2224"],"Microsoft_Intune_Edu":["6.2504.11.3005.250429-2115"],"Microsoft_Intune_Enrollment":["7.2504.50.3006.250502-1355"],"Microsoft_Intune_MTM":["6.2504.1.30"],"Microsoft_Intune_Workflows":["1.2504.117.3032.250503-0147"],"Microsoft_ManufacturingPlatform_DMM":["21.03.2025-05.23"],"Microsoft_Marketplace_SolutionFinder":["1.0.20250406.2"],"Microsoft_OneFleet_DataHub":["1.0.02963.279"],"Microsoft_OperationsManagementSuite_Workspace":["3.0.03023.2398","3.0.03040.2420"],"Microsoft_R2DScheduler":["1.0.6.0"],"Microsoft_SafeflyV2":["1.0.2025-04-23-15-50"],"Microsoft_Security_Copilot":["111"],"Microsoft_ServicesHub_Extension":["6.3.4.0"],"Microsoft_VideoIndexer":["1.0.03010.1-250330"],"Oracle_Databases_At_Azure":["1.203.698"],"ScanX_Management":["1.0.0.288"],"ServiceLinkerExtension":["2.0.20250423.1"],"SqlAzureExtension":["2.1.03035.262--95169","2.1.03040.566--6829"],"Universal_Print":["3.20250425.3"],"VLCentral_Agreement":["1.0.03035.2","1.0.02984.1"],"VLCentral_Amendments":["1.0.03029.34"],"VLCentral_Approval":["1.0.03025.1"],"VLCentral_CaseManagement":["1.0.02970.1"],"VLCentral_HelpAndSupport":["1.0.03026.2"],"VLCentral_Home":["1.0.03021.3"],"VLCentral_OrderCredits":["1.0.03029.1"],"VLCentral_Ordering":["15.1.03039.1"],"VLCentral_OrganizationManagementService":["1.0.03032.1"],"VLCentral_Platform":["1.0.03035.1"],"VLCentral_Quote":["1.0.03046.1"],"VLCentral_ReportingNAnalytics":["1.0.03025.1"],"VLCentral_UUM":["1.0.03021.64"],"VMCP":["1.2.03011.1083","1.2.03033.1117"],"WandiscoExtension":["1.14.16.0"],"WebsitesExtension":["5.250.1.7","5.251.0.5"]}},"signinUri":"/signin/idpRedirect.js/","errorUri":"/Error","unsupportedUri":"/Error/UE_Unsupported","applicationPath":"","supportedLanguages":["en","cs","de","es","fr","hu","id","it","ja","ko","nl","pl","pt-br","pt-pt","ru","sv","tr","zh-hans","zh-hant","qps-ploc"],"portalClientId":"c44b4083-3bb0-49c1-b47d-974e53cbdf3c","authority":"https://login.microsoftonline.com/","armAadResource":"https://management.core.windows.net/","tokenLifetimeClockSkewIntervalInMs":300000.0,"graphEndpoint":"https://graph.windows.net","msGraphEndpoint":"https://graph.microsoft.com","orgIdChangePasswordUri":"https://go.microsoft.com/fwlink/?LinkID=522342","changePasswordUri":"https://go.microsoft.com/fwlink/?LinkID=522343","isAdfs":false,"roleIdForCompanyAdmin":"62e90394-69f5-4237-9190-012177145e10"},"portalServerMsalJsConfig":{"site_id":"501430","cobrandid":null,"msafed":null,"nativeBroker":0}});
</script></body></html>";}